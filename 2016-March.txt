From jiaxuan at chinamobile.com  Tue Mar  1 06:21:33 2016
From: jiaxuan at chinamobile.com (jiaxuan)
Date: Tue, 1 Mar 2016 19:21:33 +0800
Subject: [Project Clearwater] =?gb2312?b?tPC4tDogIFRlc3QgQ2xlYXJ3YXRlciBv?=
	=?gb2312?b?biBPcGVuc2hpZnQ=?=
References: <008501d16fa8$b7658e50$2630aaf0$@com>	<SN1PR0201MB1856FD019CDE8B7CF5ACABD1E1A60@SN1PR0201MB1856.namprd02.prod.outlook.com>	<002101d17074$5c862ef0$15928cd0$@com>
	<SN1PR0201MB185664708CA9B1CD9778401EE1A70@SN1PR0201MB1856.namprd02.prod.outlook.com>
	<CY1PR0201MB15639CE35CB2C5DEDDCB9E3390A70@CY1PR0201MB1563.namprd02.prod.outlook.com>
	<002c01d172e9$9bc3ec70$d34bc550$@com>
	<CY1PR0201MB1563C776A08F7BA3C9943C3E90BA0@CY1PR0201MB1563.namprd02.prod.outlook.com>
Message-ID: <002101d173ac$839675a0$8ac360e0$@com>

Yep, you?re right that?s the root cause. But after trying several times,
it still can?t load any plugins. Do you have any way to load these plugins
manually ??

 

I wrote an C language file ?test?, and ran it as ?sprout? user. Seems it
works.

root at sprout-1-1pp1p:~# su sprout -c '/var/log/sprout/test
/usr/share/clearwater/sprout/plugins'

Open Directory /usr/share/clearwater/sprout/plugins Error?Success

.

..

sprout_bgcf.so

sprout_icscf.so

sprout_mmtel_as.so

sprout_scscf.so

Open Directory /usr/share/clearwater/sprout/plugins Error?Success

Open Directory /usr/share/clearwater/sprout/plugins Error?Success

root at sprout-1-1pp1p:~#

 

Read source code, the logic is very simple in
https://github.com/Metaswitch/sprout/blob/dev/src/pluginloader.cpp#L68 .
What may cause this issue ? Selinux?? or Filesystem? 

 

>From this page http://linux.die.net/man/3/readdir  : ?Currently, only some
file systems (among them: Btrfs, ext2, ext3, and ext4) have full support for
returning the file type in d_type?

 

Currently rhel7 is using xfs as it?s default file system. And the container
is using it !!!

root at sprout-1-1pp1p:~# df -T -h

Filesystem
Type   Size  Used Avail Use% Mounted on

/dev/mapper/docker-253:0-67648440-e939ea7b2b39ce24a000b0e068e6feba0626504abe
909818797e9f48ce7bdd91 xfs    100G  370M  100G   1% /

tmpfs
tmpfs   16G     0   16G   0% /dev

shm
tmpfs   64M     0   64M   0% /dev/shm

tmpfs
tmpfs   16G     0   16G   0% /sys/fs/cgroup

tmpfs
tmpfs   16G   40K   16G   1% /run/secrets

/dev/mapper/rhel_mac002590f16385-root
xfs     45G   29G   17G  64% /etc/hosts

tmpfs
tmpfs   16G  8.0K   16G   1% /run/secrets/kubernetes.io/serviceaccount

tmpfs
tmpfs   16G     0   16G   0% /proc/kcore

tmpfs
tmpfs   16G     0   16G   0% /proc/timer_stats

root at sprout-1-1pp1p:~#

 

Well, do we have some simple solution for this ?  

 

Great thanks J

 

Jia Xuan

 

China Mobile Research Institute

 

 

???: jiaxuan [mailto:jiaxuan at chinamobile.com] 
????: 2016?3?1? 10:07
???: 'Matt Williams (projectclearwater.org)'
??: 'clearwater at lists.projectclearwater.org'; 'Chris Elford'
??: ??: [Project Clearwater] Test Clearwater on Openshift

 

Matt:

 

root at sprout-1-u9v45:~# cd /usr/share/clearwater/sprout

root at sprout-1-u9v45:/usr/share/clearwater/sprout# ls -l

total 4

drwxr-xr-x. 2 root root 4096 Dec 11 09:58 lib

drwxr-xr-x. 2 root root   96 Mar  1 02:00 plugins

root at sprout-1-u9v45:/usr/share/clearwater/sprout# cd plugins/

root at sprout-1-u9v45:/usr/share/clearwater/sprout/plugins# ls -l

total 608

-rw-r--r--. 1 root root 171456 Dec  7 16:00 sprout_bgcf.so

-rw-r--r--. 1 root root 212808 Dec  7 16:00 sprout_icscf.so

-rw-r--r--. 1 root root 113960 Dec  7 16:00 sprout_mmtel_as.so

-rw-r--r--. 1 root root 122504 Dec  7 16:00 sprout_scscf.so

root at sprout-1-u9v45:/usr/share/clearwater/sprout/plugins#

 

 

 

???: Matt Williams (projectclearwater.org)
[mailto:matt at projectclearwater.org] 
????: 2016?3?1? 1:31
???: jiaxuan
??: clearwater at lists.projectclearwater.org; Chris Elford
??: RE: [Project Clearwater] Test Clearwater on Openshift

 

Jia,

 

Thanks for these diagnostics.  To me, the interesting bit is (in
sprout_*.txt):

 

29-02-2016 11:20:03.678 UTC Status pluginloader.cpp:63: Loading plug-ins
from /usr/share/clearwater/sprout/plugins

29-02-2016 11:20:03.679 UTC Status pluginloader.cpp:148: Finished loading
plug-ins

 

Sprout is architected as a base executable with plug-ins (often referred to
as "Sproutlets") on top of it to implement function.  The Sproutlets are
loaded as shared objects (i.e. .so files) from the
/usr/share/clearwater/sprout/plugins directory.  The log above indicates
that it doesn't find any plugins.

 

Plugins are contained in separate Debian packages, such as sprout-icscf,
sprout-scscf and sprout-bgcf (for each of the functions that Sprout
provides).  I've checked the cw_package_info.txt file that you provided, and
this shows that these packages are installed, so the shared objects should
be present.

 

So I think the key question is whether these shared objects are present.  On
the Sprout node, please can you

-   run "ls -l /usr/share/clearwater/sprout/plugins" to list the contents of
this directory

-   run "ls -l /usr/share/clearwater/sprout" to check that the permissions
on the containing directory?

 

Please let me know.

 

Thanks,

 

Matt

 

--

 

Matt Williams
Lead Architect, Project Clearwater

+44 (0) 20 8366 1177

 

From: jiaxuan [mailto:jiaxuan at chinamobile.com] 
Sent: 29 February 2016 12:06
To: Matt Williams <Matt.Williams at metaswitch.com>
Cc: clearwater at lists.projectclearwater.org; Chris Elford
<Chris.Elford at metaswitch.com>
Subject: ??: [Project Clearwater] Test Clearwater on Openshift

 

Hi Matt, Chris,

Firstly , thanks for answering my questions. That makes me more confident to
move docker-compose into Openshift platform. 

Well, Openshift is using RHEL7 as its host OS. But the container is still
using ubuntu system, as far as I know the base image is Ubuntu14.04. I
change nothing in Dockerfile.  I am sorry I can?t find the log about
?docker build? and ?docker compose?. But all the call succeeds. So I
copy these images into Openshift Platform, and set some environment values,
make all the models can be connected by
requirements(https://raw.githubusercontent.com/Metaswitch/clearwater-docker/
master/minimal-distributed.yaml).

 

For openshift platform:

1. All the subscribers are from Ellis web UI. From the client(x-lite or
zoiper), I can see all the subscribers are registered.

2. The request ?INVITE? has been sent from bono to sprout. After at least
10 seconds, bono reply 408 to UE.

 

I attach the log file which you wanted, please check .

 

Great thanks.

 

Jia Xuan

 

 

???: Matt Williams [mailto:Matt.Williams at metaswitch.com] 
????: 2016?2?26? 20:42
???: jiaxuan
??: clearwater at lists.projectclearwater.org; Chris Elford
??: RE: [Project Clearwater] Test Clearwater on Openshift

 

Jia,

 

I think I'm a bit more positive that we can make this work than Chris is -
my understanding is that OpenShift is a Platform as a Service (Paas) built
on Docker, and we've successfully run Clearwater under Docker before, so
unless OpenShift disables something we rely on, Clearwater should run on
OpenShift.

 

His concern was that you were trying to port Clearwater to run on Red Hat
Enterprise Linux (RHEL), rather than under Ubuntu.  However, I think it
should be possible to run Clearwater in its native Ubuntu, even if the host
OS is RHEL.  Please can you confirm which guest OS your containers are
running?  ...and have you made any changes to the clearwater-docker scripts?

 

When Chris asked about "subscribers", he was referring to the telephone
numbers you're calling between.  How did you pick the numbers 6505550219 and
6505550782, for example?  Did you create them through the Ellis web UI?  Are
these the only 2 subscribers you've created?

 

The diagnostics we've got so far haven't been conclusive, but there are
three things that would be useful.

?         The complete logs from the output from the "docker build" and
"docker compose" commands, showing all the packages being installed to build
the images and then the images being deployed, just in case there's
something odd going on there.

?         On the Sprout node, stop the sprout process (with "sudo service
sprout stop"), wait 30s so that it has definitely restarted and then attempt
a call, and send us the logs from that - it's possible that something is
going wrong on start-up.

?         Clearwater has a built-in tool to gather the key diagnostics
together.  On the Sprout node, run "/usr/share/clearwater/bin/gather_diags"
and then gather the diagnostic dump from
/var/clearwater-diags-monitor/dumps/*.tar.gz and send it to us.

 

Please let us know.

 

Thanks,

 

Matt

 

--

 

Matt Williams
Lead Architect, Project Clearwater

+44 (0) 20 8366 1177

 

From: Clearwater [mailto:clearwater-bounces at lists.projectclearwater.org] On
Behalf Of Chris Elford
Sent: 26 February 2016 11:59
To: jiaxuan <jiaxuan at chinamobile.com>
Cc: clearwater at lists.projectclearwater.org
Subject: Re: [Project Clearwater] Test Clearwater on Openshift

 

I notice below that you say you are using Openshift and Kubernetes. As far
as I know, nobody is currently running Project Clearwater using these
platforms, and I would not expect it to work without some development work
to port it to this new platform.

 

I think that we need to understand what you did to allow you to install
Project Clearwater on this new platform before we can provide any help.

 

Yours,

 

Chris

 

From: jiaxuan [mailto:jiaxuan at chinamobile.com] 
Sent: 26 February 2016 09:02
To: Chris Elford <Chris.Elford at metaswitch.com>
Cc: clearwater at lists.projectclearwater.org
Subject: ??: [Project Clearwater] Test Clearwater on Openshift

 

Sorry? I have no idea about what?s ?subscriber?. It?s almost same with
the environment which is setup by docker-compose
(https://github.com/Metaswitch/clearwater-docker).  But all call fail. 

 

I found a PUBLISH message : The content-Length is zero.  

 

PUBLISH sip:6505550219 at example.com;transport=TCP SIP/2.0^M

Via: SIP/2.0/TCP
175.128.0.113:55316;branch=z9hG4bK-524287-1---4b2b34f926a6c876;rport^M

Max-Forwards: 70^M

Route: <sip:10.1.0.217:5054;transport=TCP;lr;orig>^M

Contact: <sip:6505550219 at 175.128.0.113:55316;transport=TCP>^M

To: "2323"<sip:6505550219 at example.com;transport=TCP>^M

From: "2323"<sip:6505550219 at example.com;transport=TCP>;tag=ea19e074^M

Call-ID: ZuNcniFDAQplqlNX3qyFJQ..^M

CSeq: 319 PUBLISH^M

Expires: 600^M

Allow: INVITE, ACK, CANCEL, BYE, NOTIFY, REFER, MESSAGE, OPTIONS, INFO,
SUBSCRIBE^M

Supported: replaces, norefersub, extended-refer, timer, outbound, path,
X-cisco-serviceuri^M

User-Agent: Z 3.9.32144 r32121^M

Event: presence^M

Allow-Events: presence, kpml^M

Content-Length: 0^M

^M

While checking the docker-compose env, I got           

Max-Forwards: 70^M

Route: <sip:172.17.0.5:5054;transport=TCP;lr;orig>^M

Contact: <sip:6505550782 at 192.168.34.178:51158;transport=TCP>^M

To: "123"<sip:6505550782 at example.com;transport=TCP>^M

From: "123"<sip:6505550782 at example.com;transport=TCP>;tag=e72f4e32^M

Call-ID: vqETasJUaN4hD1h5scKyUA..^M

CSeq: 1 PUBLISH^M

Expires: 600^M

Allow: INVITE, ACK, CANCEL, BYE, NOTIFY, REFER, MESSAGE, OPTIONS, INFO,
SUBSCRIBE^M

Content-Type: application/pidf+xml^M

Supported: replaces, norefersub, extended-refer, timer, outbound, path,
X-cisco-serviceuri^M

User-Agent: Z 3.9.32144 r32121^M

Event: presence^M

Allow-Events: presence, kpml^M

Content-Length: 271^M

^M

<?xml version="1.0" encoding="UTF-8"?>^M

<presence xmlns="urn:ietf:params:xml:ns:pidf"^M

          entity="sip:6505550782 at example.com;transport=TCP">^M

  <tuple id="6505550782" >^M

     <status><basic>open</basic></status>^M

     <note>Online</note>^M

  </tuple>^M

</presence>^M

 

Is that helpful? Thanks. 

 

Jia Xuan

 

???: Chris Elford [mailto:Chris.Elford at metaswitch.com] 
????: 2016?2?26? 0:27
???: jiaxuan
??: clearwater at lists.projectclearwater.org
??: RE: [Project Clearwater] Test Clearwater on Openshift

 

Hi,

 

I?ve taken a look at your Sprout logs. In order to diagnose your problem,
it would be useful to have some more information about what you are seeing.

?       What are the subscribers are you trying to call between?

?       Are you seeing all calls fail or just occasional ones?

 

We?ve looked into the two issues that you mentioned below.

 

It looks like Ralf is configured to send billing data to a CDF at
example.com. The logs in your message show that it is failing to do so. You
can configure a real CDF by changing the value of ?cdf_identity? in the
deployment?s shared config. See
http://clearwater.readthedocs.org/en/latest/Clearwater_Configuration_Options
_Reference/index.html for details.

 

We have looked into the tombstone issue that you mention below. We do not
think that this will cause any problems. We have raised
https://github.com/Metaswitch/sprout/issues/1334 to track working around it
and cleaning up those entries.

 

Yours,

 

Chris

 

From: Clearwater [mailto:clearwater-bounces at lists.projectclearwater.org] On
Behalf Of jiaxuan
Sent: 25 February 2016 08:44
To: clearwater at lists.projectclearwater.org
Subject: [Project Clearwater] Test Clearwater on Openshift

 

Hi list:

  

  I have installed clearwater, following ?Manual Install Instrutions?. The
difference is that it?s running on Openshift which is using Kurbernetes.
Currently the Ellis model is running well, as I can make my X-Lite client
registered in. The problem is that: The call function doesn?t work
properly. I list what I have found:

  1. Ralf: from /var/log/ralf/ralf_2016XXX

    24-02-2016 13:00:34.447 UTC Verbose diameterstack.cpp:1413: Sending
Diameter message of type 271 on transaction 0x7f17d0005100

24-02-2016 13:00:34.447 UTC Debug diameterstack.cpp:397: Routing out
callback from freeDiameter

24-02-2016 13:00:34.447 UTC Error diameterstack.cpp:293: Routing error: 'No
remaining suitable candidate to route the message to' for message with
Command-Code 271, Destination-Host  and Destination-Realm example.com

24-02-2016 13:00:34.447 UTC Debug freeDiameter: Iterating on rules of
COMMAND: '(generic error format)'.

24-02-2016 13:00:34.447 UTC Debug freeDiameter: Calling callback registered
when query was sent (0x437910, 0x7f17d0005100)

24-02-2016 13:00:34.447 UTC Verbose diameterstack.cpp:1093: Got Diameter
response of type 271 - calling callback on transaction 0x7f17d0005100

24-02-2016 13:00:34.447 UTC Warning peer_message_sender.cpp:125: Failed to
send ACR to  (number 0)

24-02-2016 13:00:34.447 UTC Error peer_message_sender.cpp:145: Failed to
connect to all CCFs, message not sent

24-02-2016 13:00:34.447 UTC Warning session_manager.cpp:319: Session for
79048MzlhMGNjMzc4YmEyY2NlMGEyZmU2ODNmYjZjM2E1ZGY received error from CDF

24-02-2016 13:00:34.470 UTC Verbose httpstack.cpp:286: Process request for
URL /call-id/79048MzlhMGNjMzc4YmEyY2NlMGEyZmU2ODNmYjZjM2E1ZGY, args (null)

  2. Sprout:from /var/log/sprout/sprout_current.txt . We can see there?re
several ?tombstone? element in this json. 

25-02-2016 08:05:00.076 UTC Debug avstore.cpp:72: Set AV for
6505550502 at example.com\7b66730d304dcdcb

{"digest":{"ha1":"3fb2ca6bb49c77b0907e080079d325a0","realm":"example.com","q
op":"auth"},"branch":"z9hG4bKPjbALlVrXogjQKxNGPi1wmdGhDKXTFBr7h","tombstone"
:true,"tombstone":true,"tombstone":true}

 

  I attached all the log files in this email. 

We appreciate your response. Thanks. 

                                                      

Jia Xuan

China Mobile Research Institute

-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.projectclearwater.org/pipermail/clearwater_lists.projectclearwater.org/attachments/20160301/28da90c2/attachment.html>

From matt at projectclearwater.org  Tue Mar  1 06:54:34 2016
From: matt at projectclearwater.org (Matt Williams (projectclearwater.org))
Date: Tue, 1 Mar 2016 11:54:34 +0000
Subject: [Project Clearwater] Test Clearwater on Openshift
In-Reply-To: <002101d173ac$839675a0$8ac360e0$@com>
References: <008501d16fa8$b7658e50$2630aaf0$@com>
	<SN1PR0201MB1856FD019CDE8B7CF5ACABD1E1A60@SN1PR0201MB1856.namprd02.prod.outlook.com>
	<002101d17074$5c862ef0$15928cd0$@com>
	<SN1PR0201MB185664708CA9B1CD9778401EE1A70@SN1PR0201MB1856.namprd02.prod.outlook.com>
	<CY1PR0201MB15639CE35CB2C5DEDDCB9E3390A70@CY1PR0201MB1563.namprd02.prod.outlook.com>
	<002c01d172e9$9bc3ec70$d34bc550$@com>
	<CY1PR0201MB1563C776A08F7BA3C9943C3E90BA0@CY1PR0201MB1563.namprd02.prod.outlook.com>
	<002101d173ac$839675a0$8ac360e0$@com>
Message-ID: <BLUPR0201MB1556D1AA7878248088CE57C990BB0@BLUPR0201MB1556.namprd02.prod.outlook.com>

Good investigation!

Yes, it looks like the issue is that Sprout's PluginLoader uses readdir's d_type.  I've raised https://github.com/Metaswitch/sprout/issues/1340 to get this fixed, and marked it high priority so we'll aim to fix it in the next week or so.  I think we might just be able to remove the d_type check - we don't expect to find any other files in this directory, so we could just try loading everything.

In the meantime (if you're keen to make progress before then), would it be possible to try on another filesystem, e.g. ext4?

Thanks,

Matt

--

Matt Williams
Lead Architect, Project Clearwater
+44 (0) 20 8366 1177

From: jiaxuan [mailto:jiaxuan at chinamobile.com]
Sent: 01 March 2016 11:22
To: Matt Williams (projectclearwater.org) <matt at projectclearwater.org>
Cc: clearwater at lists.projectclearwater.org; Chris Elford <Chris.Elford at metaswitch.com>
Subject: ??: [Project Clearwater] Test Clearwater on Openshift

Yep, you?re right that?s the root cause. But after trying several times, it still can?t load any plugins. Do you have any way to load these plugins manually ??

I wrote an C language file ?test?, and ran it as ?sprout? user. Seems it works.
root at sprout-1-1pp1p:~# su sprout -c '/var/log/sprout/test /usr/share/clearwater/sprout/plugins'
Open Directory /usr/share/clearwater/sprout/plugins Error?Success
.
..
sprout_bgcf.so
sprout_icscf.so
sprout_mmtel_as.so
sprout_scscf.so
Open Directory /usr/share/clearwater/sprout/plugins Error?Success
Open Directory /usr/share/clearwater/sprout/plugins Error?Success
root at sprout-1-1pp1p:~#

Read source code, the logic is very simple in https://github.com/Metaswitch/sprout/blob/dev/src/pluginloader.cpp#L68 . What may cause this issue ? Selinux?? or Filesystem?

From this page http://linux.die.net/man/3/readdir  : ?Currently, only some file systems (among them: Btrfs, ext2, ext3, and ext4) have full support for returning the file type in d_type?

Currently rhel7 is using xfs as it?s default file system. And the container is using it !!!
root at sprout-1-1pp1p:~# df -T -h
Filesystem                                                                                         Type   Size  Used Avail Use% Mounted on
/dev/mapper/docker-253:0-67648440-e939ea7b2b39ce24a000b0e068e6feba0626504abe909818797e9f48ce7bdd91 xfs    100G  370M  100G   1% /
tmpfs                                                                                              tmpfs   16G     0   16G   0% /dev
shm                                                                                                tmpfs   64M     0   64M   0% /dev/shm
tmpfs                                                                                              tmpfs   16G     0   16G   0% /sys/fs/cgroup
tmpfs                                                                                              tmpfs   16G   40K   16G   1% /run/secrets
/dev/mapper/rhel_mac002590f16385-root                                                              xfs     45G   29G   17G  64% /etc/hosts
tmpfs                                                                                              tmpfs   16G  8.0K   16G   1% /run/secrets/kubernetes.io/serviceaccount
tmpfs                                                                                              tmpfs   16G     0   16G   0% /proc/kcore
tmpfs                                                                                              tmpfs   16G     0   16G   0% /proc/timer_stats
root at sprout-1-1pp1p:~#

Well, do we have some simple solution for this ?

Great thanks :)

Jia Xuan

China Mobile Research Institute


???: jiaxuan [mailto:jiaxuan at chinamobile.com]
????: 2016?3?1? 10:07
???: 'Matt Williams (projectclearwater.org)'
??: 'clearwater at lists.projectclearwater.org'; 'Chris Elford'
??: ??: [Project Clearwater] Test Clearwater on Openshift

Matt:

root at sprout-1-u9v45:~# cd /usr/share/clearwater/sprout
root at sprout-1-u9v45:/usr/share/clearwater/sprout# ls -l
total 4
drwxr-xr-x. 2 root root 4096 Dec 11 09:58 lib
drwxr-xr-x. 2 root root   96 Mar  1 02:00 plugins
root at sprout-1-u9v45:/usr/share/clearwater/sprout# cd plugins/
root at sprout-1-u9v45:/usr/share/clearwater/sprout/plugins# ls -l
total 608
-rw-r--r--. 1 root root 171456 Dec  7 16:00 sprout_bgcf.so
-rw-r--r--. 1 root root 212808 Dec  7 16:00 sprout_icscf.so
-rw-r--r--. 1 root root 113960 Dec  7 16:00 sprout_mmtel_as.so
-rw-r--r--. 1 root root 122504 Dec  7 16:00 sprout_scscf.so
root at sprout-1-u9v45:/usr/share/clearwater/sprout/plugins#



???: Matt Williams (projectclearwater.org) [mailto:matt at projectclearwater.org]
????: 2016?3?1? 1:31
???: jiaxuan
??: clearwater at lists.projectclearwater.org<mailto:clearwater at lists.projectclearwater.org>; Chris Elford
??: RE: [Project Clearwater] Test Clearwater on Openshift

Jia,

Thanks for these diagnostics.  To me, the interesting bit is (in sprout_*.txt):

29-02-2016 11:20:03.678 UTC Status pluginloader.cpp:63: Loading plug-ins from /usr/share/clearwater/sprout/plugins
29-02-2016 11:20:03.679 UTC Status pluginloader.cpp:148: Finished loading plug-ins

Sprout is architected as a base executable with plug-ins (often referred to as "Sproutlets") on top of it to implement function.  The Sproutlets are loaded as shared objects (i.e. .so files) from the /usr/share/clearwater/sprout/plugins directory.  The log above indicates that it doesn't find any plugins.

Plugins are contained in separate Debian packages, such as sprout-icscf, sprout-scscf and sprout-bgcf (for each of the functions that Sprout provides).  I've checked the cw_package_info.txt file that you provided, and this shows that these packages are installed, so the shared objects should be present.

So I think the key question is whether these shared objects are present.  On the Sprout node, please can you
-   run "ls -l /usr/share/clearwater/sprout/plugins" to list the contents of this directory
-   run "ls -l /usr/share/clearwater/sprout" to check that the permissions on the containing directory?

Please let me know.

Thanks,

Matt

--

Matt Williams
Lead Architect, Project Clearwater
+44 (0) 20 8366 1177

From: jiaxuan [mailto:jiaxuan at chinamobile.com]
Sent: 29 February 2016 12:06
To: Matt Williams <Matt.Williams at metaswitch.com<mailto:Matt.Williams at metaswitch.com>>
Cc: clearwater at lists.projectclearwater.org<mailto:clearwater at lists.projectclearwater.org>; Chris Elford <Chris.Elford at metaswitch.com<mailto:Chris.Elford at metaswitch.com>>
Subject: ??: [Project Clearwater] Test Clearwater on Openshift

Hi Matt, Chris,
Firstly , thanks for answering my questions. That makes me more confident to move docker-compose into Openshift platform.
Well, Openshift is using RHEL7 as its host OS. But the container is still using ubuntu system, as far as I know the base image is Ubuntu14.04. I change nothing in Dockerfile.  I am sorry I can?t find the log about ?docker build? and ?docker compose?. But all the call succeeds. So I copy these images into Openshift Platform, and set some environment values, make all the models can be connected by requirements(https://raw.githubusercontent.com/Metaswitch/clearwater-docker/master/minimal-distributed.yaml).

For openshift platform:
1. All the subscribers are from Ellis web UI. From the client(x-lite or zoiper), I can see all the subscribers are registered.
2. The request ?INVITE? has been sent from bono to sprout. After at least 10 seconds, bono reply 408 to UE.

I attach the log file which you wanted, please check .

Great thanks.

Jia Xuan


???: Matt Williams [mailto:Matt.Williams at metaswitch.com]
????: 2016?2?26? 20:42
???: jiaxuan
??: clearwater at lists.projectclearwater.org<mailto:clearwater at lists.projectclearwater.org>; Chris Elford
??: RE: [Project Clearwater] Test Clearwater on Openshift

Jia,

I think I'm a bit more positive that we can make this work than Chris is - my understanding is that OpenShift is a Platform as a Service (Paas) built on Docker, and we've successfully run Clearwater under Docker before, so unless OpenShift disables something we rely on, Clearwater should run on OpenShift.

His concern was that you were trying to port Clearwater to run on Red Hat Enterprise Linux (RHEL), rather than under Ubuntu.  However, I think it should be possible to run Clearwater in its native Ubuntu, even if the host OS is RHEL.  Please can you confirm which guest OS your containers are running?  ...and have you made any changes to the clearwater-docker scripts?

When Chris asked about "subscribers", he was referring to the telephone numbers you're calling between.  How did you pick the numbers 6505550219 and 6505550782, for example?  Did you create them through the Ellis web UI?  Are these the only 2 subscribers you've created?

The diagnostics we've got so far haven't been conclusive, but there are three things that would be useful.

*         The complete logs from the output from the "docker build" and "docker compose" commands, showing all the packages being installed to build the images and then the images being deployed, just in case there's something odd going on there.

*         On the Sprout node, stop the sprout process (with "sudo service sprout stop"), wait 30s so that it has definitely restarted and then attempt a call, and send us the logs from that - it's possible that something is going wrong on start-up.

*         Clearwater has a built-in tool to gather the key diagnostics together.  On the Sprout node, run "/usr/share/clearwater/bin/gather_diags" and then gather the diagnostic dump from /var/clearwater-diags-monitor/dumps/*.tar.gz and send it to us.

Please let us know.

Thanks,

Matt

--

Matt Williams
Lead Architect, Project Clearwater
+44 (0) 20 8366 1177

From: Clearwater [mailto:clearwater-bounces at lists.projectclearwater.org] On Behalf Of Chris Elford
Sent: 26 February 2016 11:59
To: jiaxuan <jiaxuan at chinamobile.com<mailto:jiaxuan at chinamobile.com>>
Cc: clearwater at lists.projectclearwater.org<mailto:clearwater at lists.projectclearwater.org>
Subject: Re: [Project Clearwater] Test Clearwater on Openshift

I notice below that you say you are using Openshift and Kubernetes. As far as I know, nobody is currently running Project Clearwater using these platforms, and I would not expect it to work without some development work to port it to this new platform.

I think that we need to understand what you did to allow you to install Project Clearwater on this new platform before we can provide any help.

Yours,

Chris

From: jiaxuan [mailto:jiaxuan at chinamobile.com]
Sent: 26 February 2016 09:02
To: Chris Elford <Chris.Elford at metaswitch.com<mailto:Chris.Elford at metaswitch.com>>
Cc: clearwater at lists.projectclearwater.org<mailto:clearwater at lists.projectclearwater.org>
Subject: ??: [Project Clearwater] Test Clearwater on Openshift

Sorry? I have no idea about what?s ?subscriber?. It?s almost same with the environment which is setup by docker-compose (https://github.com/Metaswitch/clearwater-docker).  But all call fail.

I found a PUBLISH message : The content-Length is zero.

PUBLISH sip:6505550219 at example.com;transport=TCP SIP/2.0^M
Via: SIP/2.0/TCP 175.128.0.113:55316;branch=z9hG4bK-524287-1---4b2b34f926a6c876;rport^M
Max-Forwards: 70^M
Route: <sip:10.1.0.217:5054;transport=TCP;lr;orig>^M
Contact: <sip:6505550219 at 175.128.0.113:55316;transport=TCP>^M
To: "2323"<sip:6505550219 at example.com;transport=TCP>^M
From: "2323"<sip:6505550219 at example.com;transport=TCP>;tag=ea19e074^M
Call-ID: ZuNcniFDAQplqlNX3qyFJQ..^M
CSeq: 319 PUBLISH^M
Expires: 600^M
Allow: INVITE, ACK, CANCEL, BYE, NOTIFY, REFER, MESSAGE, OPTIONS, INFO, SUBSCRIBE^M
Supported: replaces, norefersub, extended-refer, timer, outbound, path, X-cisco-serviceuri^M
User-Agent: Z 3.9.32144 r32121^M
Event: presence^M
Allow-Events: presence, kpml^M
Content-Length: 0^M
^M
While checking the docker-compose env, I got
Max-Forwards: 70^M
Route: <sip:172.17.0.5:5054;transport=TCP;lr;orig>^M
Contact: <sip:6505550782 at 192.168.34.178:51158;transport=TCP>^M
To: "123"<sip:6505550782 at example.com;transport=TCP>^M
From: "123"<sip:6505550782 at example.com;transport=TCP>;tag=e72f4e32^M
Call-ID: vqETasJUaN4hD1h5scKyUA..^M
CSeq: 1 PUBLISH^M
Expires: 600^M
Allow: INVITE, ACK, CANCEL, BYE, NOTIFY, REFER, MESSAGE, OPTIONS, INFO, SUBSCRIBE^M
Content-Type: application/pidf+xml^M
Supported: replaces, norefersub, extended-refer, timer, outbound, path, X-cisco-serviceuri^M
User-Agent: Z 3.9.32144 r32121^M
Event: presence^M
Allow-Events: presence, kpml^M
Content-Length: 271^M
^M
<?xml version="1.0" encoding="UTF-8"?>^M
<presence xmlns="urn:ietf:params:xml:ns:pidf"^M
          entity="sip:6505550782 at example.com;transport=TCP">^M
  <tuple id="6505550782" >^M
     <status><basic>open</basic></status>^M
     <note>Online</note>^M
  </tuple>^M
</presence>^M

Is that helpful? Thanks.

Jia Xuan

???: Chris Elford [mailto:Chris.Elford at metaswitch.com]
????: 2016?2?26? 0:27
???: jiaxuan
??: clearwater at lists.projectclearwater.org<mailto:clearwater at lists.projectclearwater.org>
??: RE: [Project Clearwater] Test Clearwater on Openshift

Hi,

I?ve taken a look at your Sprout logs. In order to diagnose your problem, it would be useful to have some more information about what you are seeing.

*       What are the subscribers are you trying to call between?

*       Are you seeing all calls fail or just occasional ones?

We?ve looked into the two issues that you mentioned below.

It looks like Ralf is configured to send billing data to a CDF at example.com. The logs in your message show that it is failing to do so. You can configure a real CDF by changing the value of ?cdf_identity? in the deployment?s shared config. See http://clearwater.readthedocs.org/en/latest/Clearwater_Configuration_Options_Reference/index.html for details.

We have looked into the tombstone issue that you mention below. We do not think that this will cause any problems. We have raised https://github.com/Metaswitch/sprout/issues/1334 to track working around it and cleaning up those entries.

Yours,

Chris

From: Clearwater [mailto:clearwater-bounces at lists.projectclearwater.org] On Behalf Of jiaxuan
Sent: 25 February 2016 08:44
To: clearwater at lists.projectclearwater.org<mailto:clearwater at lists.projectclearwater.org>
Subject: [Project Clearwater] Test Clearwater on Openshift

Hi list:

  I have installed clearwater, following ?Manual Install Instrutions?. The difference is that it?s running on Openshift which is using Kurbernetes. Currently the Ellis model is running well, as I can make my X-Lite client registered in. The problem is that: The call function doesn?t work properly. I list what I have found:
  1. Ralf: from /var/log/ralf/ralf_2016XXX
    24-02-2016 13:00:34.447 UTC Verbose diameterstack.cpp:1413: Sending Diameter message of type 271 on transaction 0x7f17d0005100
24-02-2016 13:00:34.447 UTC Debug diameterstack.cpp:397: Routing out callback from freeDiameter
24-02-2016 13:00:34.447 UTC Error diameterstack.cpp:293: Routing error: 'No remaining suitable candidate to route the message to' for message with Command-Code 271, Destination-Host  and Destination-Realm example.com
24-02-2016 13:00:34.447 UTC Debug freeDiameter: Iterating on rules of COMMAND: '(generic error format)'.
24-02-2016 13:00:34.447 UTC Debug freeDiameter: Calling callback registered when query was sent (0x437910, 0x7f17d0005100)
24-02-2016 13:00:34.447 UTC Verbose diameterstack.cpp:1093: Got Diameter response of type 271 - calling callback on transaction 0x7f17d0005100
24-02-2016 13:00:34.447 UTC Warning peer_message_sender.cpp:125: Failed to send ACR to  (number 0)
24-02-2016 13:00:34.447 UTC Error peer_message_sender.cpp:145: Failed to connect to all CCFs, message not sent
24-02-2016 13:00:34.447 UTC Warning session_manager.cpp:319: Session for 79048MzlhMGNjMzc4YmEyY2NlMGEyZmU2ODNmYjZjM2E1ZGY received error from CDF
24-02-2016 13:00:34.470 UTC Verbose httpstack.cpp:286: Process request for URL /call-id/79048MzlhMGNjMzc4YmEyY2NlMGEyZmU2ODNmYjZjM2E1ZGY, args (null)
  2. Sprout:from /var/log/sprout/sprout_current.txt . We can see there?re several ?tombstone? element in this json.
25-02-2016 08:05:00.076 UTC Debug avstore.cpp:72: Set AV for 6505550502 at example.com\7b66730d304dcdcb<mailto:6505550502 at example.com\7b66730d304dcdcb>
{"digest":{"ha1":"3fb2ca6bb49c77b0907e080079d325a0","realm":"example.com","qop":"auth"},"branch":"z9hG4bKPjbALlVrXogjQKxNGPi1wmdGhDKXTFBr7h","tombstone":true,"tombstone":true,"tombstone":true}

  I attached all the log files in this email.
We appreciate your response. Thanks.

Jia Xuan
China Mobile Research Institute
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.projectclearwater.org/pipermail/clearwater_lists.projectclearwater.org/attachments/20160301/82b6fecc/attachment.html>

From matt at projectclearwater.org  Tue Mar  1 12:19:04 2016
From: matt at projectclearwater.org (Matt Williams (projectclearwater.org))
Date: Tue, 1 Mar 2016 17:19:04 +0000
Subject: [Project Clearwater] Test Clearwater on Openshift
References: <008501d16fa8$b7658e50$2630aaf0$@com>
	<SN1PR0201MB1856FD019CDE8B7CF5ACABD1E1A60@SN1PR0201MB1856.namprd02.prod.outlook.com>
	<002101d17074$5c862ef0$15928cd0$@com>
	<SN1PR0201MB185664708CA9B1CD9778401EE1A70@SN1PR0201MB1856.namprd02.prod.outlook.com>
	<CY1PR0201MB15639CE35CB2C5DEDDCB9E3390A70@CY1PR0201MB1563.namprd02.prod.outlook.com>
	<002c01d172e9$9bc3ec70$d34bc550$@com>
	<CY1PR0201MB1563C776A08F7BA3C9943C3E90BA0@CY1PR0201MB1563.namprd02.prod.outlook.com>
	<002101d173ac$839675a0$8ac360e0$@com> 
Message-ID: <BLUPR0201MB1556949F09FC71C4E21BB72490BB0@BLUPR0201MB1556.namprd02.prod.outlook.com>

Jia,

You'll be pleased to know that https://github.com/Metaswitch/sprout/issues/1340 is fixed.

We haven't cut the updated code to our stable repository yet - we'd expect to do that sometime next week.

If you'd like to test with this before then, you could pick it up from the "latest" repository.  To try this, please modify your copy of https://github.com/Metaswitch/clearwater-docker/blob/master/base/Dockerfile#L19 to specify "RUN echo deb http://repo.cw-ngv.com/latest binary/ > /etc/apt/sources.list.d/clearwater.list" and rebuild your containers.  Note, however, that this code is bleeding edge and may be less stable - I'd suggest undoing this change once the new stable release comes out.

Please let us know how you get on.

Thanks,

Matt

--

Matt Williams
Lead Architect, Project Clearwater
+44 (0) 20 8366 1177

From: Matt Williams (projectclearwater.org)
Sent: 01 March 2016 11:53
To: 'jiaxuan' <jiaxuan at chinamobile.com>
Cc: clearwater at lists.projectclearwater.org; Chris Elford <Chris.Elford at metaswitch.com>
Subject: RE: [Project Clearwater] Test Clearwater on Openshift

Good investigation!

Yes, it looks like the issue is that Sprout's PluginLoader uses readdir's d_type.  I've raised https://github.com/Metaswitch/sprout/issues/1340 to get this fixed, and marked it high priority so we'll aim to fix it in the next week or so.  I think we might just be able to remove the d_type check - we don't expect to find any other files in this directory, so we could just try loading everything.

In the meantime (if you're keen to make progress before then), would it be possible to try on another filesystem, e.g. ext4?

Thanks,

Matt

--

Matt Williams
Lead Architect, Project Clearwater
+44 (0) 20 8366 1177

From: jiaxuan [mailto:jiaxuan at chinamobile.com]
Sent: 01 March 2016 11:22
To: Matt Williams (projectclearwater.org) <matt at projectclearwater.org>
Cc: clearwater at lists.projectclearwater.org; Chris Elford <Chris.Elford at metaswitch.com>
Subject: ??: [Project Clearwater] Test Clearwater on Openshift

Yep, you?re right that?s the root cause. But after trying several times, it still can?t load any plugins. Do you have any way to load these plugins manually ??

I wrote an C language file ?test?, and ran it as ?sprout? user. Seems it works.
root at sprout-1-1pp1p:~# su sprout -c '/var/log/sprout/test /usr/share/clearwater/sprout/plugins'
Open Directory /usr/share/clearwater/sprout/plugins Error?Success
.
..
sprout_bgcf.so
sprout_icscf.so
sprout_mmtel_as.so
sprout_scscf.so
Open Directory /usr/share/clearwater/sprout/plugins Error?Success
Open Directory /usr/share/clearwater/sprout/plugins Error?Success
root at sprout-1-1pp1p:~#

Read source code, the logic is very simple in https://github.com/Metaswitch/sprout/blob/dev/src/pluginloader.cpp#L68 . What may cause this issue ? Selinux?? or Filesystem?

From this page http://linux.die.net/man/3/readdir  : ?Currently, only some file systems (among them: Btrfs, ext2, ext3, and ext4) have full support for returning the file type in d_type?

Currently rhel7 is using xfs as it?s default file system. And the container is using it !!!
root at sprout-1-1pp1p:~# df -T -h
Filesystem                                                                                         Type   Size  Used Avail Use% Mounted on
/dev/mapper/docker-253:0-67648440-e939ea7b2b39ce24a000b0e068e6feba0626504abe909818797e9f48ce7bdd91 xfs    100G  370M  100G   1% /
tmpfs                                                                                              tmpfs   16G     0   16G   0% /dev
shm                                                                                                tmpfs   64M     0   64M   0% /dev/shm
tmpfs                                                                                              tmpfs   16G     0   16G   0% /sys/fs/cgroup
tmpfs                                                                                              tmpfs   16G   40K   16G   1% /run/secrets
/dev/mapper/rhel_mac002590f16385-root                                                              xfs     45G   29G   17G  64% /etc/hosts
tmpfs                                                                                              tmpfs   16G  8.0K   16G   1% /run/secrets/kubernetes.io/serviceaccount
tmpfs                                                                                              tmpfs   16G     0   16G   0% /proc/kcore
tmpfs                                                                                              tmpfs   16G     0   16G   0% /proc/timer_stats
root at sprout-1-1pp1p:~#

Well, do we have some simple solution for this ?

Great thanks :)

Jia Xuan

China Mobile Research Institute


???: jiaxuan [mailto:jiaxuan at chinamobile.com]
????: 2016?3?1? 10:07
???: 'Matt Williams (projectclearwater.org)'
??: 'clearwater at lists.projectclearwater.org'; 'Chris Elford'
??: ??: [Project Clearwater] Test Clearwater on Openshift

Matt:

root at sprout-1-u9v45:~# cd /usr/share/clearwater/sprout
root at sprout-1-u9v45:/usr/share/clearwater/sprout# ls -l
total 4
drwxr-xr-x. 2 root root 4096 Dec 11 09:58 lib
drwxr-xr-x. 2 root root   96 Mar  1 02:00 plugins
root at sprout-1-u9v45:/usr/share/clearwater/sprout# cd plugins/
root at sprout-1-u9v45:/usr/share/clearwater/sprout/plugins# ls -l
total 608
-rw-r--r--. 1 root root 171456 Dec  7 16:00 sprout_bgcf.so
-rw-r--r--. 1 root root 212808 Dec  7 16:00 sprout_icscf.so
-rw-r--r--. 1 root root 113960 Dec  7 16:00 sprout_mmtel_as.so
-rw-r--r--. 1 root root 122504 Dec  7 16:00 sprout_scscf.so
root at sprout-1-u9v45:/usr/share/clearwater/sprout/plugins#



???: Matt Williams (projectclearwater.org) [mailto:matt at projectclearwater.org]
????: 2016?3?1? 1:31
???: jiaxuan
??: clearwater at lists.projectclearwater.org<mailto:clearwater at lists.projectclearwater.org>; Chris Elford
??: RE: [Project Clearwater] Test Clearwater on Openshift

Jia,

Thanks for these diagnostics.  To me, the interesting bit is (in sprout_*.txt):

29-02-2016 11:20:03.678 UTC Status pluginloader.cpp:63: Loading plug-ins from /usr/share/clearwater/sprout/plugins
29-02-2016 11:20:03.679 UTC Status pluginloader.cpp:148: Finished loading plug-ins

Sprout is architected as a base executable with plug-ins (often referred to as "Sproutlets") on top of it to implement function.  The Sproutlets are loaded as shared objects (i.e. .so files) from the /usr/share/clearwater/sprout/plugins directory.  The log above indicates that it doesn't find any plugins.

Plugins are contained in separate Debian packages, such as sprout-icscf, sprout-scscf and sprout-bgcf (for each of the functions that Sprout provides).  I've checked the cw_package_info.txt file that you provided, and this shows that these packages are installed, so the shared objects should be present.

So I think the key question is whether these shared objects are present.  On the Sprout node, please can you
-   run "ls -l /usr/share/clearwater/sprout/plugins" to list the contents of this directory
-   run "ls -l /usr/share/clearwater/sprout" to check that the permissions on the containing directory?

Please let me know.

Thanks,

Matt

--

Matt Williams
Lead Architect, Project Clearwater
+44 (0) 20 8366 1177

From: jiaxuan [mailto:jiaxuan at chinamobile.com]
Sent: 29 February 2016 12:06
To: Matt Williams <Matt.Williams at metaswitch.com<mailto:Matt.Williams at metaswitch.com>>
Cc: clearwater at lists.projectclearwater.org<mailto:clearwater at lists.projectclearwater.org>; Chris Elford <Chris.Elford at metaswitch.com<mailto:Chris.Elford at metaswitch.com>>
Subject: ??: [Project Clearwater] Test Clearwater on Openshift

Hi Matt, Chris,
Firstly , thanks for answering my questions. That makes me more confident to move docker-compose into Openshift platform.
Well, Openshift is using RHEL7 as its host OS. But the container is still using ubuntu system, as far as I know the base image is Ubuntu14.04. I change nothing in Dockerfile.  I am sorry I can?t find the log about ?docker build? and ?docker compose?. But all the call succeeds. So I copy these images into Openshift Platform, and set some environment values, make all the models can be connected by requirements(https://raw.githubusercontent.com/Metaswitch/clearwater-docker/master/minimal-distributed.yaml).

For openshift platform:
1. All the subscribers are from Ellis web UI. From the client(x-lite or zoiper), I can see all the subscribers are registered.
2. The request ?INVITE? has been sent from bono to sprout. After at least 10 seconds, bono reply 408 to UE.

I attach the log file which you wanted, please check .

Great thanks.

Jia Xuan


???: Matt Williams [mailto:Matt.Williams at metaswitch.com]
????: 2016?2?26? 20:42
???: jiaxuan
??: clearwater at lists.projectclearwater.org<mailto:clearwater at lists.projectclearwater.org>; Chris Elford
??: RE: [Project Clearwater] Test Clearwater on Openshift

Jia,

I think I'm a bit more positive that we can make this work than Chris is - my understanding is that OpenShift is a Platform as a Service (Paas) built on Docker, and we've successfully run Clearwater under Docker before, so unless OpenShift disables something we rely on, Clearwater should run on OpenShift.

His concern was that you were trying to port Clearwater to run on Red Hat Enterprise Linux (RHEL), rather than under Ubuntu.  However, I think it should be possible to run Clearwater in its native Ubuntu, even if the host OS is RHEL.  Please can you confirm which guest OS your containers are running?  ...and have you made any changes to the clearwater-docker scripts?

When Chris asked about "subscribers", he was referring to the telephone numbers you're calling between.  How did you pick the numbers 6505550219 and 6505550782, for example?  Did you create them through the Ellis web UI?  Are these the only 2 subscribers you've created?

The diagnostics we've got so far haven't been conclusive, but there are three things that would be useful.

*         The complete logs from the output from the "docker build" and "docker compose" commands, showing all the packages being installed to build the images and then the images being deployed, just in case there's something odd going on there.

*         On the Sprout node, stop the sprout process (with "sudo service sprout stop"), wait 30s so that it has definitely restarted and then attempt a call, and send us the logs from that - it's possible that something is going wrong on start-up.

*         Clearwater has a built-in tool to gather the key diagnostics together.  On the Sprout node, run "/usr/share/clearwater/bin/gather_diags" and then gather the diagnostic dump from /var/clearwater-diags-monitor/dumps/*.tar.gz and send it to us.

Please let us know.

Thanks,

Matt

--

Matt Williams
Lead Architect, Project Clearwater
+44 (0) 20 8366 1177

From: Clearwater [mailto:clearwater-bounces at lists.projectclearwater.org] On Behalf Of Chris Elford
Sent: 26 February 2016 11:59
To: jiaxuan <jiaxuan at chinamobile.com<mailto:jiaxuan at chinamobile.com>>
Cc: clearwater at lists.projectclearwater.org<mailto:clearwater at lists.projectclearwater.org>
Subject: Re: [Project Clearwater] Test Clearwater on Openshift

I notice below that you say you are using Openshift and Kubernetes. As far as I know, nobody is currently running Project Clearwater using these platforms, and I would not expect it to work without some development work to port it to this new platform.

I think that we need to understand what you did to allow you to install Project Clearwater on this new platform before we can provide any help.

Yours,

Chris

From: jiaxuan [mailto:jiaxuan at chinamobile.com]
Sent: 26 February 2016 09:02
To: Chris Elford <Chris.Elford at metaswitch.com<mailto:Chris.Elford at metaswitch.com>>
Cc: clearwater at lists.projectclearwater.org<mailto:clearwater at lists.projectclearwater.org>
Subject: ??: [Project Clearwater] Test Clearwater on Openshift

Sorry? I have no idea about what?s ?subscriber?. It?s almost same with the environment which is setup by docker-compose (https://github.com/Metaswitch/clearwater-docker).  But all call fail.

I found a PUBLISH message : The content-Length is zero.

PUBLISH sip:6505550219 at example.com;transport=TCP SIP/2.0^M
Via: SIP/2.0/TCP 175.128.0.113:55316;branch=z9hG4bK-524287-1---4b2b34f926a6c876;rport^M
Max-Forwards: 70^M
Route: <sip:10.1.0.217:5054;transport=TCP;lr;orig>^M
Contact: <sip:6505550219 at 175.128.0.113:55316;transport=TCP>^M
To: "2323"<sip:6505550219 at example.com;transport=TCP>^M
From: "2323"<sip:6505550219 at example.com;transport=TCP>;tag=ea19e074^M
Call-ID: ZuNcniFDAQplqlNX3qyFJQ..^M
CSeq: 319 PUBLISH^M
Expires: 600^M
Allow: INVITE, ACK, CANCEL, BYE, NOTIFY, REFER, MESSAGE, OPTIONS, INFO, SUBSCRIBE^M
Supported: replaces, norefersub, extended-refer, timer, outbound, path, X-cisco-serviceuri^M
User-Agent: Z 3.9.32144 r32121^M
Event: presence^M
Allow-Events: presence, kpml^M
Content-Length: 0^M
^M
While checking the docker-compose env, I got
Max-Forwards: 70^M
Route: <sip:172.17.0.5:5054;transport=TCP;lr;orig>^M
Contact: <sip:6505550782 at 192.168.34.178:51158;transport=TCP>^M
To: "123"<sip:6505550782 at example.com;transport=TCP>^M
From: "123"<sip:6505550782 at example.com;transport=TCP>;tag=e72f4e32^M
Call-ID: vqETasJUaN4hD1h5scKyUA..^M
CSeq: 1 PUBLISH^M
Expires: 600^M
Allow: INVITE, ACK, CANCEL, BYE, NOTIFY, REFER, MESSAGE, OPTIONS, INFO, SUBSCRIBE^M
Content-Type: application/pidf+xml^M
Supported: replaces, norefersub, extended-refer, timer, outbound, path, X-cisco-serviceuri^M
User-Agent: Z 3.9.32144 r32121^M
Event: presence^M
Allow-Events: presence, kpml^M
Content-Length: 271^M
^M
<?xml version="1.0" encoding="UTF-8"?>^M
<presence xmlns="urn:ietf:params:xml:ns:pidf"^M
          entity="sip:6505550782 at example.com;transport=TCP">^M
  <tuple id="6505550782" >^M
     <status><basic>open</basic></status>^M
     <note>Online</note>^M
  </tuple>^M
</presence>^M

Is that helpful? Thanks.

Jia Xuan

???: Chris Elford [mailto:Chris.Elford at metaswitch.com]
????: 2016?2?26? 0:27
???: jiaxuan
??: clearwater at lists.projectclearwater.org<mailto:clearwater at lists.projectclearwater.org>
??: RE: [Project Clearwater] Test Clearwater on Openshift

Hi,

I?ve taken a look at your Sprout logs. In order to diagnose your problem, it would be useful to have some more information about what you are seeing.

*       What are the subscribers are you trying to call between?

*       Are you seeing all calls fail or just occasional ones?

We?ve looked into the two issues that you mentioned below.

It looks like Ralf is configured to send billing data to a CDF at example.com. The logs in your message show that it is failing to do so. You can configure a real CDF by changing the value of ?cdf_identity? in the deployment?s shared config. See http://clearwater.readthedocs.org/en/latest/Clearwater_Configuration_Options_Reference/index.html for details.

We have looked into the tombstone issue that you mention below. We do not think that this will cause any problems. We have raised https://github.com/Metaswitch/sprout/issues/1334 to track working around it and cleaning up those entries.

Yours,

Chris

From: Clearwater [mailto:clearwater-bounces at lists.projectclearwater.org] On Behalf Of jiaxuan
Sent: 25 February 2016 08:44
To: clearwater at lists.projectclearwater.org<mailto:clearwater at lists.projectclearwater.org>
Subject: [Project Clearwater] Test Clearwater on Openshift

Hi list:

  I have installed clearwater, following ?Manual Install Instrutions?. The difference is that it?s running on Openshift which is using Kurbernetes. Currently the Ellis model is running well, as I can make my X-Lite client registered in. The problem is that: The call function doesn?t work properly. I list what I have found:
  1. Ralf: from /var/log/ralf/ralf_2016XXX
    24-02-2016 13:00:34.447 UTC Verbose diameterstack.cpp:1413: Sending Diameter message of type 271 on transaction 0x7f17d0005100
24-02-2016 13:00:34.447 UTC Debug diameterstack.cpp:397: Routing out callback from freeDiameter
24-02-2016 13:00:34.447 UTC Error diameterstack.cpp:293: Routing error: 'No remaining suitable candidate to route the message to' for message with Command-Code 271, Destination-Host  and Destination-Realm example.com
24-02-2016 13:00:34.447 UTC Debug freeDiameter: Iterating on rules of COMMAND: '(generic error format)'.
24-02-2016 13:00:34.447 UTC Debug freeDiameter: Calling callback registered when query was sent (0x437910, 0x7f17d0005100)
24-02-2016 13:00:34.447 UTC Verbose diameterstack.cpp:1093: Got Diameter response of type 271 - calling callback on transaction 0x7f17d0005100
24-02-2016 13:00:34.447 UTC Warning peer_message_sender.cpp:125: Failed to send ACR to  (number 0)
24-02-2016 13:00:34.447 UTC Error peer_message_sender.cpp:145: Failed to connect to all CCFs, message not sent
24-02-2016 13:00:34.447 UTC Warning session_manager.cpp:319: Session for 79048MzlhMGNjMzc4YmEyY2NlMGEyZmU2ODNmYjZjM2E1ZGY received error from CDF
24-02-2016 13:00:34.470 UTC Verbose httpstack.cpp:286: Process request for URL /call-id/79048MzlhMGNjMzc4YmEyY2NlMGEyZmU2ODNmYjZjM2E1ZGY, args (null)
  2. Sprout:from /var/log/sprout/sprout_current.txt . We can see there?re several ?tombstone? element in this json.
25-02-2016 08:05:00.076 UTC Debug avstore.cpp:72: Set AV for 6505550502 at example.com\7b66730d304dcdcb<mailto:6505550502 at example.com\7b66730d304dcdcb>
{"digest":{"ha1":"3fb2ca6bb49c77b0907e080079d325a0","realm":"example.com","qop":"auth"},"branch":"z9hG4bKPjbALlVrXogjQKxNGPi1wmdGhDKXTFBr7h","tombstone":true,"tombstone":true,"tombstone":true}

  I attached all the log files in this email.
We appreciate your response. Thanks.

Jia Xuan
China Mobile Research Institute
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.projectclearwater.org/pipermail/clearwater_lists.projectclearwater.org/attachments/20160301/583f9bb5/attachment.html>

From jiaxuan at chinamobile.com  Wed Mar  2 01:45:14 2016
From: jiaxuan at chinamobile.com (jiaxuan)
Date: Wed, 2 Mar 2016 14:45:14 +0800
Subject: [Project Clearwater] =?gb2312?b?tPC4tDogIFRlc3QgQ2xlYXJ3YXRlciBv?=
	=?gb2312?b?biBPcGVuc2hpZnQ=?=
In-Reply-To: <BLUPR0201MB1556949F09FC71C4E21BB72490BB0@BLUPR0201MB1556.namprd02.prod.outlook.com>
References: <008501d16fa8$b7658e50$2630aaf0$@com>	<SN1PR0201MB1856FD019CDE8B7CF5ACABD1E1A60@SN1PR0201MB1856.namprd02.prod.outlook.com>	<002101d17074$5c862ef0$15928cd0$@com>
	<SN1PR0201MB185664708CA9B1CD9778401EE1A70@SN1PR0201MB1856.namprd02.prod.outlook.com>
	<CY1PR0201MB15639CE35CB2C5DEDDCB9E3390A70@CY1PR0201MB1563.namprd02.prod.outlook.com>
	<002c01d172e9$9bc3ec70$d34bc550$@com>
	<CY1PR0201MB1563C776A08F7BA3C9943C3E90BA0@CY1PR0201MB1563.namprd02.prod.outlook.com>
	<002101d173ac$839675a0$8ac360e0$@com>
	<BLUPR0201MB1556949F09FC71C4E21BB72490BB0@BLUPR0201MB1556.namprd02.prod.outlook.com>
Message-ID: <004001d1744f$1486ec00$3d94c400$@com>

Hi matt:

 

Great news : Clearwater is running on Openshift!! 

 

I changed the configuration of docker

[root at node1 ~]# cat /etc/sysconfig/docker-storage

DOCKER_STORAGE_OPTIONS=--storage-driver devicemapper --storage-opt
dm.fs=ext4 --storage-opt
dm.thinpooldev=/dev/mapper/rhel_mac002590f16385-docker--pool --storage-opt
dm.use_deferred_removal=true

 

Make usre dm.fs=ext4.  And restart docker service. (if it fails, you should
delete /var/lib/docker/*, and restart docker service)

 

[root at node1 ~]# ssh sprout

Warning: Permanently added 'sprout,10.1.0.7' (ECDSA) to the list of known
hosts.

root at sprout's password: 

Welcome to Ubuntu 14.04.3 LTS (GNU/Linux 3.10.0-327.10.1.el7.x86_64 x86_64)

 

* Documentation:  https://help.ubuntu.com/

Last login: Wed Mar  2 06:05:31 2016 from 10.1.0.1

root at sprout-1-uq0qi:~# df -T -h

Filesystem
Type   Size  Used Avail Use% Mounted on

/dev/mapper/docker-253:0-16087588-742fbffe1fb7f7486463d1cd1f4142d4b041970e20
e8760d5a8acc70e2051d03 ext4    99G  400M   93G   1% /

tmpfs
tmpfs   16G     0   16G   0% /dev

shm
tmpfs   64M     0   64M   0% /dev/shm

tmpfs
tmpfs   16G     0   16G   0% /sys/fs/cgroup

tmpfs
tmpfs   16G   40K   16G   1% /run/secrets

/dev/mapper/rhel_mac002590f16385-root
xfs     45G   29G   17G  64% /etc/hosts

tmpfs
tmpfs   16G  8.0K   16G   1% /run/secrets/kubernetes.io/serviceaccount

tmpfs
tmpfs   16G     0   16G   0% /proc/kcore

tmpfs
tmpfs   16G     0   16G   0% /proc/timer_stats

 

 

Great thanks.

 

Jia Xuan

 

China Mobile Research Institute

 

 

???: Matt Williams (projectclearwater.org)
[mailto:matt at projectclearwater.org] 
????: 2016?3?2? 1:19
???: jiaxuan
??: clearwater at lists.projectclearwater.org; Chris Elford
??: RE: [Project Clearwater] Test Clearwater on Openshift

 

Jia,

 

You'll be pleased to know that
https://github.com/Metaswitch/sprout/issues/1340 is fixed.

 

We haven't cut the updated code to our stable repository yet - we'd expect
to do that sometime next week.

 

If you'd like to test with this before then, you could pick it up from the
"latest" repository.  To try this, please modify your copy of
https://github.com/Metaswitch/clearwater-docker/blob/master/base/Dockerfile#
L19 to specify "RUN echo deb http://repo.cw-ngv.com/latest binary/ >
/etc/apt/sources.list.d/clearwater.list" and rebuild your containers.  Note,
however, that this code is bleeding edge and may be less stable - I'd
suggest undoing this change once the new stable release comes out.

 

Please let us know how you get on.

 

Thanks,

 

Matt

 

--

 

Matt Williams
Lead Architect, Project Clearwater

+44 (0) 20 8366 1177

 

From: Matt Williams (projectclearwater.org) 
Sent: 01 March 2016 11:53
To: 'jiaxuan' <jiaxuan at chinamobile.com>
Cc: clearwater at lists.projectclearwater.org; Chris Elford
<Chris.Elford at metaswitch.com>
Subject: RE: [Project Clearwater] Test Clearwater on Openshift

 

Good investigation!

 

Yes, it looks like the issue is that Sprout's PluginLoader uses readdir's
d_type.  I've raised https://github.com/Metaswitch/sprout/issues/1340 to get
this fixed, and marked it high priority so we'll aim to fix it in the next
week or so.  I think we might just be able to remove the d_type check - we
don't expect to find any other files in this directory, so we could just try
loading everything.

 

In the meantime (if you're keen to make progress before then), would it be
possible to try on another filesystem, e.g. ext4?

 

Thanks,

 

Matt

 

--

 

Matt Williams
Lead Architect, Project Clearwater

+44 (0) 20 8366 1177

 

From: jiaxuan [mailto:jiaxuan at chinamobile.com] 
Sent: 01 March 2016 11:22
To: Matt Williams (projectclearwater.org) <matt at projectclearwater.org>
Cc: clearwater at lists.projectclearwater.org; Chris Elford
<Chris.Elford at metaswitch.com>
Subject: ??: [Project Clearwater] Test Clearwater on Openshift

 

Yep, you?re right that?s the root cause. But after trying several times,
it still can?t load any plugins. Do you have any way to load these plugins
manually ??

 

I wrote an C language file ?test?, and ran it as ?sprout? user. Seems it
works.

root at sprout-1-1pp1p:~# su sprout -c '/var/log/sprout/test
/usr/share/clearwater/sprout/plugins'

Open Directory /usr/share/clearwater/sprout/plugins Error?Success

.

..

sprout_bgcf.so

sprout_icscf.so

sprout_mmtel_as.so

sprout_scscf.so

Open Directory /usr/share/clearwater/sprout/plugins Error?Success

Open Directory /usr/share/clearwater/sprout/plugins Error?Success

root at sprout-1-1pp1p:~#

 

Read source code, the logic is very simple in
https://github.com/Metaswitch/sprout/blob/dev/src/pluginloader.cpp#L68 .
What may cause this issue ? Selinux?? or Filesystem? 

 

>From this page http://linux.die.net/man/3/readdir  : ?Currently, only some
file systems (among them: Btrfs, ext2, ext3, and ext4) have full support for
returning the file type in d_type?

 

Currently rhel7 is using xfs as it?s default file system. And the container
is using it !!!

root at sprout-1-1pp1p:~# df -T -h

Filesystem
Type   Size  Used Avail Use% Mounted on

/dev/mapper/docker-253:0-67648440-e939ea7b2b39ce24a000b0e068e6feba0626504abe
909818797e9f48ce7bdd91 xfs    100G  370M  100G   1% /

tmpfs
tmpfs   16G     0   16G   0% /dev

shm
tmpfs   64M     0   64M   0% /dev/shm

tmpfs
tmpfs   16G     0   16G   0% /sys/fs/cgroup

tmpfs
tmpfs   16G   40K   16G   1% /run/secrets

/dev/mapper/rhel_mac002590f16385-root
xfs     45G   29G   17G  64% /etc/hosts

tmpfs
tmpfs   16G  8.0K   16G   1% /run/secrets/kubernetes.io/serviceaccount

tmpfs
tmpfs   16G     0   16G   0% /proc/kcore

tmpfs
tmpfs   16G     0   16G   0% /proc/timer_stats

root at sprout-1-1pp1p:~#

 

Well, do we have some simple solution for this ?  

 

Great thanks J

 

Jia Xuan

 

China Mobile Research Institute

 

 

???: jiaxuan [mailto:jiaxuan at chinamobile.com] 
????: 2016?3?1? 10:07
???: 'Matt Williams (projectclearwater.org)'
??: 'clearwater at lists.projectclearwater.org'; 'Chris Elford'
??: ??: [Project Clearwater] Test Clearwater on Openshift

 

Matt:

 

root at sprout-1-u9v45:~# cd /usr/share/clearwater/sprout

root at sprout-1-u9v45:/usr/share/clearwater/sprout# ls -l

total 4

drwxr-xr-x. 2 root root 4096 Dec 11 09:58 lib

drwxr-xr-x. 2 root root   96 Mar  1 02:00 plugins

root at sprout-1-u9v45:/usr/share/clearwater/sprout# cd plugins/

root at sprout-1-u9v45:/usr/share/clearwater/sprout/plugins# ls -l

total 608

-rw-r--r--. 1 root root 171456 Dec  7 16:00 sprout_bgcf.so

-rw-r--r--. 1 root root 212808 Dec  7 16:00 sprout_icscf.so

-rw-r--r--. 1 root root 113960 Dec  7 16:00 sprout_mmtel_as.so

-rw-r--r--. 1 root root 122504 Dec  7 16:00 sprout_scscf.so

root at sprout-1-u9v45:/usr/share/clearwater/sprout/plugins#

 

 

 

???: Matt Williams (projectclearwater.org)
[mailto:matt at projectclearwater.org] 
????: 2016?3?1? 1:31
???: jiaxuan
??: clearwater at lists.projectclearwater.org; Chris Elford
??: RE: [Project Clearwater] Test Clearwater on Openshift

 

Jia,

 

Thanks for these diagnostics.  To me, the interesting bit is (in
sprout_*.txt):

 

29-02-2016 11:20:03.678 UTC Status pluginloader.cpp:63: Loading plug-ins
from /usr/share/clearwater/sprout/plugins

29-02-2016 11:20:03.679 UTC Status pluginloader.cpp:148: Finished loading
plug-ins

 

Sprout is architected as a base executable with plug-ins (often referred to
as "Sproutlets") on top of it to implement function.  The Sproutlets are
loaded as shared objects (i.e. .so files) from the
/usr/share/clearwater/sprout/plugins directory.  The log above indicates
that it doesn't find any plugins.

 

Plugins are contained in separate Debian packages, such as sprout-icscf,
sprout-scscf and sprout-bgcf (for each of the functions that Sprout
provides).  I've checked the cw_package_info.txt file that you provided, and
this shows that these packages are installed, so the shared objects should
be present.

 

So I think the key question is whether these shared objects are present.  On
the Sprout node, please can you

-   run "ls -l /usr/share/clearwater/sprout/plugins" to list the contents of
this directory

-   run "ls -l /usr/share/clearwater/sprout" to check that the permissions
on the containing directory?

 

Please let me know.

 

Thanks,

 

Matt

 

--

 

Matt Williams
Lead Architect, Project Clearwater

+44 (0) 20 8366 1177

 

From: jiaxuan [mailto:jiaxuan at chinamobile.com] 
Sent: 29 February 2016 12:06
To: Matt Williams <Matt.Williams at metaswitch.com>
Cc: clearwater at lists.projectclearwater.org; Chris Elford
<Chris.Elford at metaswitch.com>
Subject: ??: [Project Clearwater] Test Clearwater on Openshift

 

Hi Matt, Chris,

Firstly , thanks for answering my questions. That makes me more confident to
move docker-compose into Openshift platform. 

Well, Openshift is using RHEL7 as its host OS. But the container is still
using ubuntu system, as far as I know the base image is Ubuntu14.04. I
change nothing in Dockerfile.  I am sorry I can?t find the log about
?docker build? and ?docker compose?. But all the call succeeds. So I
copy these images into Openshift Platform, and set some environment values,
make all the models can be connected by
requirements(https://raw.githubusercontent.com/Metaswitch/clearwater-docker/
master/minimal-distributed.yaml).

 

For openshift platform:

1. All the subscribers are from Ellis web UI. From the client(x-lite or
zoiper), I can see all the subscribers are registered.

2. The request ?INVITE? has been sent from bono to sprout. After at least
10 seconds, bono reply 408 to UE.

 

I attach the log file which you wanted, please check .

 

Great thanks.

 

Jia Xuan

 

 

???: Matt Williams [mailto:Matt.Williams at metaswitch.com] 
????: 2016?2?26? 20:42
???: jiaxuan
??: clearwater at lists.projectclearwater.org; Chris Elford
??: RE: [Project Clearwater] Test Clearwater on Openshift

 

Jia,

 

I think I'm a bit more positive that we can make this work than Chris is -
my understanding is that OpenShift is a Platform as a Service (Paas) built
on Docker, and we've successfully run Clearwater under Docker before, so
unless OpenShift disables something we rely on, Clearwater should run on
OpenShift.

 

His concern was that you were trying to port Clearwater to run on Red Hat
Enterprise Linux (RHEL), rather than under Ubuntu.  However, I think it
should be possible to run Clearwater in its native Ubuntu, even if the host
OS is RHEL.  Please can you confirm which guest OS your containers are
running?  ...and have you made any changes to the clearwater-docker scripts?

 

When Chris asked about "subscribers", he was referring to the telephone
numbers you're calling between.  How did you pick the numbers 6505550219 and
6505550782, for example?  Did you create them through the Ellis web UI?  Are
these the only 2 subscribers you've created?

 

The diagnostics we've got so far haven't been conclusive, but there are
three things that would be useful.

?         The complete logs from the output from the "docker build" and
"docker compose" commands, showing all the packages being installed to build
the images and then the images being deployed, just in case there's
something odd going on there.

?         On the Sprout node, stop the sprout process (with "sudo service
sprout stop"), wait 30s so that it has definitely restarted and then attempt
a call, and send us the logs from that - it's possible that something is
going wrong on start-up.

?         Clearwater has a built-in tool to gather the key diagnostics
together.  On the Sprout node, run "/usr/share/clearwater/bin/gather_diags"
and then gather the diagnostic dump from
/var/clearwater-diags-monitor/dumps/*.tar.gz and send it to us.

 

Please let us know.

 

Thanks,

 

Matt

 

--

 

Matt Williams
Lead Architect, Project Clearwater

+44 (0) 20 8366 1177

 

From: Clearwater [mailto:clearwater-bounces at lists.projectclearwater.org] On
Behalf Of Chris Elford
Sent: 26 February 2016 11:59
To: jiaxuan <jiaxuan at chinamobile.com>
Cc: clearwater at lists.projectclearwater.org
Subject: Re: [Project Clearwater] Test Clearwater on Openshift

 

I notice below that you say you are using Openshift and Kubernetes. As far
as I know, nobody is currently running Project Clearwater using these
platforms, and I would not expect it to work without some development work
to port it to this new platform.

 

I think that we need to understand what you did to allow you to install
Project Clearwater on this new platform before we can provide any help.

 

Yours,

 

Chris

 

From: jiaxuan [mailto:jiaxuan at chinamobile.com] 
Sent: 26 February 2016 09:02
To: Chris Elford <Chris.Elford at metaswitch.com>
Cc: clearwater at lists.projectclearwater.org
Subject: ??: [Project Clearwater] Test Clearwater on Openshift

 

Sorry? I have no idea about what?s ?subscriber?. It?s almost same with
the environment which is setup by docker-compose
(https://github.com/Metaswitch/clearwater-docker).  But all call fail. 

 

I found a PUBLISH message : The content-Length is zero.  

 

PUBLISH sip:6505550219 at example.com;transport=TCP SIP/2.0^M

Via: SIP/2.0/TCP
175.128.0.113:55316;branch=z9hG4bK-524287-1---4b2b34f926a6c876;rport^M

Max-Forwards: 70^M

Route: <sip:10.1.0.217:5054;transport=TCP;lr;orig>^M

Contact: <sip:6505550219 at 175.128.0.113:55316;transport=TCP>^M

To: "2323"<sip:6505550219 at example.com;transport=TCP>^M

From: "2323"<sip:6505550219 at example.com;transport=TCP>;tag=ea19e074^M

Call-ID: ZuNcniFDAQplqlNX3qyFJQ..^M

CSeq: 319 PUBLISH^M

Expires: 600^M

Allow: INVITE, ACK, CANCEL, BYE, NOTIFY, REFER, MESSAGE, OPTIONS, INFO,
SUBSCRIBE^M

Supported: replaces, norefersub, extended-refer, timer, outbound, path,
X-cisco-serviceuri^M

User-Agent: Z 3.9.32144 r32121^M

Event: presence^M

Allow-Events: presence, kpml^M

Content-Length: 0^M

^M

While checking the docker-compose env, I got           

Max-Forwards: 70^M

Route: <sip:172.17.0.5:5054;transport=TCP;lr;orig>^M

Contact: <sip:6505550782 at 192.168.34.178:51158;transport=TCP>^M

To: "123"<sip:6505550782 at example.com;transport=TCP>^M

From: "123"<sip:6505550782 at example.com;transport=TCP>;tag=e72f4e32^M

Call-ID: vqETasJUaN4hD1h5scKyUA..^M

CSeq: 1 PUBLISH^M

Expires: 600^M

Allow: INVITE, ACK, CANCEL, BYE, NOTIFY, REFER, MESSAGE, OPTIONS, INFO,
SUBSCRIBE^M

Content-Type: application/pidf+xml^M

Supported: replaces, norefersub, extended-refer, timer, outbound, path,
X-cisco-serviceuri^M

User-Agent: Z 3.9.32144 r32121^M

Event: presence^M

Allow-Events: presence, kpml^M

Content-Length: 271^M

^M

<?xml version="1.0" encoding="UTF-8"?>^M

<presence xmlns="urn:ietf:params:xml:ns:pidf"^M

          entity="sip:6505550782 at example.com;transport=TCP">^M

  <tuple id="6505550782" >^M

     <status><basic>open</basic></status>^M

     <note>Online</note>^M

  </tuple>^M

</presence>^M

 

Is that helpful? Thanks. 

 

Jia Xuan

 

???: Chris Elford [mailto:Chris.Elford at metaswitch.com] 
????: 2016?2?26? 0:27
???: jiaxuan
??: clearwater at lists.projectclearwater.org
??: RE: [Project Clearwater] Test Clearwater on Openshift

 

Hi,

 

I?ve taken a look at your Sprout logs. In order to diagnose your problem,
it would be useful to have some more information about what you are seeing.

?       What are the subscribers are you trying to call between?

?       Are you seeing all calls fail or just occasional ones?

 

We?ve looked into the two issues that you mentioned below.

 

It looks like Ralf is configured to send billing data to a CDF at
example.com. The logs in your message show that it is failing to do so. You
can configure a real CDF by changing the value of ?cdf_identity? in the
deployment?s shared config. See
http://clearwater.readthedocs.org/en/latest/Clearwater_Configuration_Options
_Reference/index.html for details.

 

We have looked into the tombstone issue that you mention below. We do not
think that this will cause any problems. We have raised
https://github.com/Metaswitch/sprout/issues/1334 to track working around it
and cleaning up those entries.

 

Yours,

 

Chris

 

From: Clearwater [mailto:clearwater-bounces at lists.projectclearwater.org] On
Behalf Of jiaxuan
Sent: 25 February 2016 08:44
To: clearwater at lists.projectclearwater.org
Subject: [Project Clearwater] Test Clearwater on Openshift

 

Hi list:

  

  I have installed clearwater, following ?Manual Install Instrutions?. The
difference is that it?s running on Openshift which is using Kurbernetes.
Currently the Ellis model is running well, as I can make my X-Lite client
registered in. The problem is that: The call function doesn?t work
properly. I list what I have found:

  1. Ralf: from /var/log/ralf/ralf_2016XXX

    24-02-2016 13:00:34.447 UTC Verbose diameterstack.cpp:1413: Sending
Diameter message of type 271 on transaction 0x7f17d0005100

24-02-2016 13:00:34.447 UTC Debug diameterstack.cpp:397: Routing out
callback from freeDiameter

24-02-2016 13:00:34.447 UTC Error diameterstack.cpp:293: Routing error: 'No
remaining suitable candidate to route the message to' for message with
Command-Code 271, Destination-Host  and Destination-Realm example.com

24-02-2016 13:00:34.447 UTC Debug freeDiameter: Iterating on rules of
COMMAND: '(generic error format)'.

24-02-2016 13:00:34.447 UTC Debug freeDiameter: Calling callback registered
when query was sent (0x437910, 0x7f17d0005100)

24-02-2016 13:00:34.447 UTC Verbose diameterstack.cpp:1093: Got Diameter
response of type 271 - calling callback on transaction 0x7f17d0005100

24-02-2016 13:00:34.447 UTC Warning peer_message_sender.cpp:125: Failed to
send ACR to  (number 0)

24-02-2016 13:00:34.447 UTC Error peer_message_sender.cpp:145: Failed to
connect to all CCFs, message not sent

24-02-2016 13:00:34.447 UTC Warning session_manager.cpp:319: Session for
79048MzlhMGNjMzc4YmEyY2NlMGEyZmU2ODNmYjZjM2E1ZGY received error from CDF

24-02-2016 13:00:34.470 UTC Verbose httpstack.cpp:286: Process request for
URL /call-id/79048MzlhMGNjMzc4YmEyY2NlMGEyZmU2ODNmYjZjM2E1ZGY, args (null)

  2. Sprout:from /var/log/sprout/sprout_current.txt . We can see there?re
several ?tombstone? element in this json. 

25-02-2016 08:05:00.076 UTC Debug avstore.cpp:72: Set AV for
6505550502 at example.com\7b66730d304dcdcb

{"digest":{"ha1":"3fb2ca6bb49c77b0907e080079d325a0","realm":"example.com","q
op":"auth"},"branch":"z9hG4bKPjbALlVrXogjQKxNGPi1wmdGhDKXTFBr7h","tombstone"
:true,"tombstone":true,"tombstone":true}

 

  I attached all the log files in this email. 

We appreciate your response. Thanks. 

                                                      

Jia Xuan

China Mobile Research Institute

-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.projectclearwater.org/pipermail/clearwater_lists.projectclearwater.org/attachments/20160302/4a4dcc18/attachment.html>

From paul.sun at syniverse.com  Wed Mar  2 04:03:15 2016
From: paul.sun at syniverse.com (Paul Sun)
Date: Wed, 2 Mar 2016 09:03:15 +0000
Subject: [Project Clearwater] Problem on the Diameter connection between
 HOMESTEAD and OpenIMSCore_HSS
Message-ID: <61D7C199BADE404A8DB174EA3BEE0E909140BCAA@BGLMBX01.ad.syniverse.com>

Hi

I have created a connection between homestead and OpenIMScore_HSS, it works for sometimes, however, it suddenly not working, HOMESTEAD complain there is no available HSS connection, however, I cannot figure out what is going wrong.  10.1.1.114 is the IP address of HOMESTEAD while 10.1.1.117 is the HSS.

Please advice.


-          Paul

-
root at HSS-MIRROR01-APP1-VM1:/etc/clearwater# netstat -an|grep 3868
tcp        0      0 0.0.0.0:3868            0.0.0.0:*               LISTEN
tcp        0      0 10.1.1.114:48860        10.1.1.117:3868         ESTABLISHED
tcp        0      0 10.1.1.114:48110        10.1.1.117:3868         ESTABLISHED
tcp6       0      0 :::3868                 :::*                    LISTEN


02-03-2016 08:52:57.005 UTC Status diameterstack.cpp:415: Configuring Diameter stack from file /var/lib/homestead/homestead.conf
02-03-2016 08:52:57.695 UTC Status freeDiameter: All extensions loaded.
02-03-2016 08:52:57.696 UTC Status freeDiameter: freeDiameter configuration:
02-03-2016 08:52:57.696 UTC Status freeDiameter:   Default trace level .... : +3
02-03-2016 08:52:57.696 UTC Status freeDiameter:   Configuration file ..... : /var/lib/homestead/homestead.conf
02-03-2016 08:52:57.696 UTC Status freeDiameter:   Diameter Identity ...... : 192.168.206.114 (l:15)
02-03-2016 08:52:57.696 UTC Status freeDiameter:   Diameter Realm ......... : hs.rcs011.syniverse.com (l:23)
02-03-2016 08:52:57.696 UTC Status freeDiameter:   Tc Timer ............... : 30
02-03-2016 08:52:57.696 UTC Status freeDiameter:   Tw Timer ............... : 30
02-03-2016 08:52:57.696 UTC Status freeDiameter:   Local port ............. : 3868
02-03-2016 08:52:57.696 UTC Status freeDiameter:   Local secure port ...... : 5658
02-03-2016 08:52:57.696 UTC Status freeDiameter:   Number of SCTP streams . : 3
02-03-2016 08:52:57.696 UTC Status freeDiameter:   Number of clients thr .. : 5
02-03-2016 08:52:57.696 UTC Status freeDiameter:   Number of app threads .. : 4
02-03-2016 08:52:57.696 UTC Status freeDiameter:   Local endpoints ........ : Default (use all available)
02-03-2016 08:52:57.696 UTC Status freeDiameter:   Local applications ..... : (none)
02-03-2016 08:52:57.696 UTC Status freeDiameter:   Flags : - IP ........... : Enabled
02-03-2016 08:52:57.696 UTC Status freeDiameter:           - IPv6 ......... : Enabled
02-03-2016 08:52:57.696 UTC Status freeDiameter:           - Relay app .... : Enabled
02-03-2016 08:52:57.696 UTC Status freeDiameter:           - TCP .......... : Enabled
02-03-2016 08:52:57.696 UTC Status freeDiameter:           - SCTP ......... : Enabled
02-03-2016 08:52:57.696 UTC Status freeDiameter:           - Pref. proto .. : SCTP
02-03-2016 08:52:57.696 UTC Status freeDiameter:           - TLS method ... : Separate port
02-03-2016 08:52:57.696 UTC Status freeDiameter:   TLS :   - Certificate .. : /var/lib/homestead/cert.pem
02-03-2016 08:52:57.696 UTC Status freeDiameter:           - Private key .. : /var/lib/homestead/privkey.pem
02-03-2016 08:52:57.696 UTC Status freeDiameter:           - CA (trust) ... : /var/lib/homestead/ca.pem (1 certs)
02-03-2016 08:52:57.696 UTC Status freeDiameter:           - CRL .......... : (none)
02-03-2016 08:52:57.696 UTC Status freeDiameter:           - Priority ..... : (default: 'NORMAL')
02-03-2016 08:52:57.696 UTC Status freeDiameter:           - DH bits ...... : 1024
02-03-2016 08:52:57.696 UTC Status freeDiameter:   Origin-State-Id ........ : 1456908776
02-03-2016 08:52:57.696 UTC Status freeDiameter: Loaded extensions: '/usr/share/clearwater/homestead/lib/freeDiameter//dbg_monitor.fdx'[(no config file)], loaded
02-03-2016 08:52:57.696 UTC Status freeDiameter: Loaded extensions: '/usr/share/clearwater/homestead/lib/freeDiameter//dict_nasreq.fdx'[(no config file)], loaded
02-03-2016 08:52:57.696 UTC Status freeDiameter: Loaded extensions: '/usr/share/clearwater/homestead/lib/freeDiameter//dict_sip.fdx'[(no config file)], loaded
02-03-2016 08:52:57.696 UTC Status freeDiameter: Loaded extensions: '/usr/share/clearwater/homestead/lib/freeDiameter//dict_dcca.fdx'[(no config file)], loaded
02-03-2016 08:52:57.696 UTC Status freeDiameter: Loaded extensions: '/usr/share/clearwater/homestead/lib/freeDiameter//dict_dcca_3gpp.fdx'[(no config file)], loaded
02-03-2016 08:52:57.696 UTC Status freeDiameter: {signal:12}'dbg_monitor'->0x7f85381dfe70
02-03-2016 08:52:57.696 UTC Status diameterstack.cpp:573: Starting Diameter stack
02-03-2016 08:52:57.711 UTC Status freeDiameter: Local server address(es): 10.1.1.114{---L-}      192.168.206.114{---L-}
02-03-2016 08:52:57.711 UTC Status handlers.cpp:85: Configuring HssCacheTask
02-03-2016 08:52:57.711 UTC Status handlers.cpp:86:   Dest-Realm:  rcs011.syniverse.com
02-03-2016 08:52:57.711 UTC Status handlers.cpp:87:   Dest-Host:   10.1.1.117
02-03-2016 08:52:57.711 UTC Status handlers.cpp:88:   Server-Name: sip:sprout.rcs011.syniverse.com:5054;transport=TCP
02-03-2016 08:52:57.711 UTC Status httpstack.cpp:136: Configuring HTTP stack
02-03-2016 08:52:57.711 UTC Status httpstack.cpp:137:   Bind address: 10.1.1.114
02-03-2016 08:52:57.711 UTC Status httpstack.cpp:138:   Bind port:    8888
02-03-2016 08:52:57.711 UTC Status httpstack.cpp:139:   Num threads:  200
02-03-2016 08:52:58.771 UTC Status diameterresolver.cpp:62: Created Diameter resolver
02-03-2016 08:52:58.771 UTC Status main.cpp:861: Start-up complete - wait for termination signal
02-03-2016 08:52:58.771 UTC Warning diameterstack.cpp:862: No connected Diameter peers have been found
02-03-2016 08:53:03.772 UTC Warning diameterstack.cpp:862: No connected Diameter peers have been found
02-03-2016 08:53:08.772 UTC Warning diameterstack.cpp:862: No connected Diameter peers have been found
02-03-2016 08:53:09.365 UTC Error realmmanager.cpp:142: Failed to connect to 10.1.1.117
02-03-2016 08:53:09.365 UTC Warning diameterstack.cpp:862: No connected Diameter peers have been found
02-03-2016 08:53:09.365 UTC Status freeDiameter: 10.1.1.117: Going to ZOMBIE state (no more activity)
02-03-2016 08:53:09.365 UTC Status freeDiameter: 'STATE_CLOSED'         -> STATE_ZOMBIE (terminated)                '10.1.1.117'
02-03-2016 08:53:14.365 UTC Warning diameterstack.cpp:862: No connected Diameter peers have been found
02-03-2016 08:53:19.366 UTC Warning diameterstack.cpp:862: No connected Diameter peers have been found
02-03-2016 08:53:24.366 UTC Warning diameterstack.cpp:862: No connected Diameter peers have been found
02-03-2016 08:53:29.366 UTC Warning diameterstack.cpp:862: No connected Diameter peers have been found
02-03-2016 08:53:34.366 UTC Warning diameterstack.cpp:862: No connected Diameter peers have been found
02-03-2016 08:53:39.366 UTC Warning diameterstack.cpp:862: No connected Diameter peers have been found
02-03-2016 08:53:44.367 UTC Warning diameterstack.cpp:862: No connected Diameter peers have been found
02-03-2016 08:53:49.367 UTC Warning diameterstack.cpp:862: No connected Diameter peers have been found
02-03-2016 08:53:54.367 UTC Warning diameterstack.cpp:862: No connected Diameter peers have been found
02-03-2016 08:53:59.367 UTC Warning diameterstack.cpp:862: No connected Diameter peers have been found
02-03-2016 08:54:04.368 UTC Warning diameterstack.cpp:862: No connected Diameter peers have been found
02-03-2016 08:54:09.368 UTC Warning diameterstack.cpp:862: No connected Diameter peers have been found
02-03-2016 08:54:14.368 UTC Warning diameterstack.cpp:862: No connected Diameter peers have been found
02-03-2016 08:54:19.368 UTC Warning diameterstack.cpp:862: No connected Diameter peers have been found
02-03-2016 08:54:24.369 UTC Warning diameterstack.cpp:862: No connected Diameter peers have been found
02-03-2016 08:54:29.369 UTC Warning diameterstack.cpp:862: No connected Diameter peers have been found
02-03-2016 08:54:34.369 UTC Warning diameterstack.cpp:862: No connected Diameter peers have been found
02-03-2016 08:54:39.369 UTC Warning diameterstack.cpp:862: No connected Diameter peers have been found
02-03-2016 08:54:44.370 UTC Warning diameterstack.cpp:862: No connected Diameter peers have been found
02-03-2016 08:54:49.370 UTC Warning diameterstack.cpp:862: No connected Diameter peers have been found
02-03-2016 08:54:54.370 UTC Warning diameterstack.cpp:862: No connected Diameter peers have been found
02-03-2016 08:54:57.005 UTC Status freeDiameter: Garbage Collect: delete zombie peer '10.1.1.117'
02-03-2016 08:54:59.370 UTC Warning diameterstack.cpp:862: No connected Diameter peers have been found
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.projectclearwater.org/pipermail/clearwater_lists.projectclearwater.org/attachments/20160302/a7013035/attachment.html>

From chris at projectclearwater.org  Thu Mar  3 06:53:09 2016
From: chris at projectclearwater.org (Chris Elford (projectclearwater.org))
Date: Thu, 3 Mar 2016 11:53:09 +0000
Subject: [Project Clearwater] Problem on the Diameter connection between
 HOMESTEAD and OpenIMSCore_HSS
In-Reply-To: <61D7C199BADE404A8DB174EA3BEE0E909140BCAA@BGLMBX01.ad.syniverse.com>
References: <61D7C199BADE404A8DB174EA3BEE0E909140BCAA@BGLMBX01.ad.syniverse.com>
Message-ID: <SN1PR0201MB1856788C730CB6A9D0B2735FE1BD0@SN1PR0201MB1856.namprd02.prod.outlook.com>

Hi Paul,

We should try to find out why Homestead cannot connect to the HSS.

The first thing to try is to confirm that there is still TCP connectivity from the Homestead node to the HSS. You can do this by logging on to the Homestead box and running telnet 10.1.1.117 3868. This will allow us to be certain that it is possible to connect to the HSS on your configured port.

We can also try to get some more diagnostics from the Homestead node by turning on debug logs:

1.       Edit /etc/Clearwater/user_settings and add the line log_level=5

2.       Restart the Homestead process by running sudo service homestead stop && sudo service homestead-prov stop.

The most interesting logs are printed at startup so you should only have to leave the process a couple of minutes before copying off the log. Make sure to turn off debug logging when you are done (by removing the log_level line and stopping the process as above).

Finally, is there anything that you have changed in your network recently? Have you upgraded Homestead or your HSS? Have you changed any network settings? This might give us a clue as to what has caused the problem.

Yours,

Chris


From: Clearwater [mailto:clearwater-bounces at lists.projectclearwater.org] On Behalf Of Paul Sun
Sent: 02 March 2016 09:03
To: clearwater at lists.projectclearwater.org
Subject: [Project Clearwater] Problem on the Diameter connection between HOMESTEAD and OpenIMSCore_HSS

Hi

I have created a connection between homestead and OpenIMScore_HSS, it works for sometimes, however, it suddenly not working, HOMESTEAD complain there is no available HSS connection, however, I cannot figure out what is going wrong.  10.1.1.114 is the IP address of HOMESTEAD while 10.1.1.117 is the HSS.

Please advice.


-          Paul

-
root at HSS-MIRROR01-APP1-VM1:/etc/clearwater# netstat -an|grep 3868
tcp        0      0 0.0.0.0:3868            0.0.0.0:*               LISTEN
tcp        0      0 10.1.1.114:48860        10.1.1.117:3868         ESTABLISHED
tcp        0      0 10.1.1.114:48110        10.1.1.117:3868         ESTABLISHED
tcp6       0      0 :::3868                 :::*                    LISTEN


02-03-2016 08:52:57.005 UTC Status diameterstack.cpp:415: Configuring Diameter stack from file /var/lib/homestead/homestead.conf
02-03-2016 08:52:57.695 UTC Status freeDiameter: All extensions loaded.
02-03-2016 08:52:57.696 UTC Status freeDiameter: freeDiameter configuration:
02-03-2016 08:52:57.696 UTC Status freeDiameter:   Default trace level .... : +3
02-03-2016 08:52:57.696 UTC Status freeDiameter:   Configuration file ..... : /var/lib/homestead/homestead.conf
02-03-2016 08:52:57.696 UTC Status freeDiameter:   Diameter Identity ...... : 192.168.206.114 (l:15)
02-03-2016 08:52:57.696 UTC Status freeDiameter:   Diameter Realm ......... : hs.rcs011.syniverse.com (l:23)
02-03-2016 08:52:57.696 UTC Status freeDiameter:   Tc Timer ............... : 30
02-03-2016 08:52:57.696 UTC Status freeDiameter:   Tw Timer ............... : 30
02-03-2016 08:52:57.696 UTC Status freeDiameter:   Local port ............. : 3868
02-03-2016 08:52:57.696 UTC Status freeDiameter:   Local secure port ...... : 5658
02-03-2016 08:52:57.696 UTC Status freeDiameter:   Number of SCTP streams . : 3
02-03-2016 08:52:57.696 UTC Status freeDiameter:   Number of clients thr .. : 5
02-03-2016 08:52:57.696 UTC Status freeDiameter:   Number of app threads .. : 4
02-03-2016 08:52:57.696 UTC Status freeDiameter:   Local endpoints ........ : Default (use all available)
02-03-2016 08:52:57.696 UTC Status freeDiameter:   Local applications ..... : (none)
02-03-2016 08:52:57.696 UTC Status freeDiameter:   Flags : - IP ........... : Enabled
02-03-2016 08:52:57.696 UTC Status freeDiameter:           - IPv6 ......... : Enabled
02-03-2016 08:52:57.696 UTC Status freeDiameter:           - Relay app .... : Enabled
02-03-2016 08:52:57.696 UTC Status freeDiameter:           - TCP .......... : Enabled
02-03-2016 08:52:57.696 UTC Status freeDiameter:           - SCTP ......... : Enabled
02-03-2016 08:52:57.696 UTC Status freeDiameter:           - Pref. proto .. : SCTP
02-03-2016 08:52:57.696 UTC Status freeDiameter:           - TLS method ... : Separate port
02-03-2016 08:52:57.696 UTC Status freeDiameter:   TLS :   - Certificate .. : /var/lib/homestead/cert.pem
02-03-2016 08:52:57.696 UTC Status freeDiameter:           - Private key .. : /var/lib/homestead/privkey.pem
02-03-2016 08:52:57.696 UTC Status freeDiameter:           - CA (trust) ... : /var/lib/homestead/ca.pem (1 certs)
02-03-2016 08:52:57.696 UTC Status freeDiameter:           - CRL .......... : (none)
02-03-2016 08:52:57.696 UTC Status freeDiameter:           - Priority ..... : (default: 'NORMAL')
02-03-2016 08:52:57.696 UTC Status freeDiameter:           - DH bits ...... : 1024
02-03-2016 08:52:57.696 UTC Status freeDiameter:   Origin-State-Id ........ : 1456908776
02-03-2016 08:52:57.696 UTC Status freeDiameter: Loaded extensions: '/usr/share/clearwater/homestead/lib/freeDiameter//dbg_monitor.fdx'[(no config file)], loaded
02-03-2016 08:52:57.696 UTC Status freeDiameter: Loaded extensions: '/usr/share/clearwater/homestead/lib/freeDiameter//dict_nasreq.fdx'[(no config file)], loaded
02-03-2016 08:52:57.696 UTC Status freeDiameter: Loaded extensions: '/usr/share/clearwater/homestead/lib/freeDiameter//dict_sip.fdx'[(no config file)], loaded
02-03-2016 08:52:57.696 UTC Status freeDiameter: Loaded extensions: '/usr/share/clearwater/homestead/lib/freeDiameter//dict_dcca.fdx'[(no config file)], loaded
02-03-2016 08:52:57.696 UTC Status freeDiameter: Loaded extensions: '/usr/share/clearwater/homestead/lib/freeDiameter//dict_dcca_3gpp.fdx'[(no config file)], loaded
02-03-2016 08:52:57.696 UTC Status freeDiameter: {signal:12}'dbg_monitor'->0x7f85381dfe70
02-03-2016 08:52:57.696 UTC Status diameterstack.cpp:573: Starting Diameter stack
02-03-2016 08:52:57.711 UTC Status freeDiameter: Local server address(es): 10.1.1.114{---L-}      192.168.206.114{---L-}
02-03-2016 08:52:57.711 UTC Status handlers.cpp:85: Configuring HssCacheTask
02-03-2016 08:52:57.711 UTC Status handlers.cpp:86:   Dest-Realm:  rcs011.syniverse.com
02-03-2016 08:52:57.711 UTC Status handlers.cpp:87:   Dest-Host:   10.1.1.117
02-03-2016 08:52:57.711 UTC Status handlers.cpp:88:   Server-Name: sip:sprout.rcs011.syniverse.com:5054;transport=TCP
02-03-2016 08:52:57.711 UTC Status httpstack.cpp:136: Configuring HTTP stack
02-03-2016 08:52:57.711 UTC Status httpstack.cpp:137:   Bind address: 10.1.1.114
02-03-2016 08:52:57.711 UTC Status httpstack.cpp:138:   Bind port:    8888
02-03-2016 08:52:57.711 UTC Status httpstack.cpp:139:   Num threads:  200
02-03-2016 08:52:58.771 UTC Status diameterresolver.cpp:62: Created Diameter resolver
02-03-2016 08:52:58.771 UTC Status main.cpp:861: Start-up complete - wait for termination signal
02-03-2016 08:52:58.771 UTC Warning diameterstack.cpp:862: No connected Diameter peers have been found
02-03-2016 08:53:03.772 UTC Warning diameterstack.cpp:862: No connected Diameter peers have been found
02-03-2016 08:53:08.772 UTC Warning diameterstack.cpp:862: No connected Diameter peers have been found
02-03-2016 08:53:09.365 UTC Error realmmanager.cpp:142: Failed to connect to 10.1.1.117
02-03-2016 08:53:09.365 UTC Warning diameterstack.cpp:862: No connected Diameter peers have been found
02-03-2016 08:53:09.365 UTC Status freeDiameter: 10.1.1.117: Going to ZOMBIE state (no more activity)
02-03-2016 08:53:09.365 UTC Status freeDiameter: 'STATE_CLOSED'         -> STATE_ZOMBIE (terminated)                '10.1.1.117'
02-03-2016 08:53:14.365 UTC Warning diameterstack.cpp:862: No connected Diameter peers have been found
02-03-2016 08:53:19.366 UTC Warning diameterstack.cpp:862: No connected Diameter peers have been found
02-03-2016 08:53:24.366 UTC Warning diameterstack.cpp:862: No connected Diameter peers have been found
02-03-2016 08:53:29.366 UTC Warning diameterstack.cpp:862: No connected Diameter peers have been found
02-03-2016 08:53:34.366 UTC Warning diameterstack.cpp:862: No connected Diameter peers have been found
02-03-2016 08:53:39.366 UTC Warning diameterstack.cpp:862: No connected Diameter peers have been found
02-03-2016 08:53:44.367 UTC Warning diameterstack.cpp:862: No connected Diameter peers have been found
02-03-2016 08:53:49.367 UTC Warning diameterstack.cpp:862: No connected Diameter peers have been found
02-03-2016 08:53:54.367 UTC Warning diameterstack.cpp:862: No connected Diameter peers have been found
02-03-2016 08:53:59.367 UTC Warning diameterstack.cpp:862: No connected Diameter peers have been found
02-03-2016 08:54:04.368 UTC Warning diameterstack.cpp:862: No connected Diameter peers have been found
02-03-2016 08:54:09.368 UTC Warning diameterstack.cpp:862: No connected Diameter peers have been found
02-03-2016 08:54:14.368 UTC Warning diameterstack.cpp:862: No connected Diameter peers have been found
02-03-2016 08:54:19.368 UTC Warning diameterstack.cpp:862: No connected Diameter peers have been found
02-03-2016 08:54:24.369 UTC Warning diameterstack.cpp:862: No connected Diameter peers have been found
02-03-2016 08:54:29.369 UTC Warning diameterstack.cpp:862: No connected Diameter peers have been found
02-03-2016 08:54:34.369 UTC Warning diameterstack.cpp:862: No connected Diameter peers have been found
02-03-2016 08:54:39.369 UTC Warning diameterstack.cpp:862: No connected Diameter peers have been found
02-03-2016 08:54:44.370 UTC Warning diameterstack.cpp:862: No connected Diameter peers have been found
02-03-2016 08:54:49.370 UTC Warning diameterstack.cpp:862: No connected Diameter peers have been found
02-03-2016 08:54:54.370 UTC Warning diameterstack.cpp:862: No connected Diameter peers have been found
02-03-2016 08:54:57.005 UTC Status freeDiameter: Garbage Collect: delete zombie peer '10.1.1.117'
02-03-2016 08:54:59.370 UTC Warning diameterstack.cpp:862: No connected Diameter peers have been found
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.projectclearwater.org/pipermail/clearwater_lists.projectclearwater.org/attachments/20160303/009a1890/attachment.html>

From jiaxuan at chinamobile.com  Fri Mar  4 05:08:25 2016
From: jiaxuan at chinamobile.com (jiaxuan)
Date: Fri, 4 Mar 2016 18:08:25 +0800
Subject: [Project Clearwater] How to scale out sprout node if it's running
	in docker.
Message-ID: <006701d175fd$cad13920$6073ab60$@com>

Hi list:

Question again J

My environment is that six containers
(bono,sprout,ellis,homer,homestead,ralf), all of them are running in
kubernetes. Now I want to scale out my sprout docker container. Do you have
some recommendation? Where can i begin from ?  

(1)Does this doc(
https://github.com/Metaswitch/clearwater-readthedocs/blob/master/docs/Clearw
ater_Elastic_Scaling.md#if-you-did-a-manual-install-without-automatic-cluste
ring)  suit for my situation? 

(2)Kubernetes can provide etcd, so i think i don't have to use
clearwater-etcd service. What can i do next ? 

(3)While, I see two words 'Memento' and 'astaire', what are they used for ? 

 

Greate Thanks.

 

Jia Xuan

 

-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.projectclearwater.org/pipermail/clearwater_lists.projectclearwater.org/attachments/20160304/f2da95be/attachment.html>

From chris at projectclearwater.org  Fri Mar  4 12:54:15 2016
From: chris at projectclearwater.org (Chris Elford (projectclearwater.org))
Date: Fri, 4 Mar 2016 17:54:15 +0000
Subject: [Project Clearwater] How to scale out sprout node if it's
	running	in docker.
In-Reply-To: <006701d175fd$cad13920$6073ab60$@com>
References: <006701d175fd$cad13920$6073ab60$@com>
Message-ID: <SN1PR0201MB185616AF4E46E773F2429FF6E1BE0@SN1PR0201MB1856.namprd02.prod.outlook.com>

Hi Jia,

To work out the right way to scale your cluster, we need to work out whether you are using etcd in your deployment. 'Automatic Clustering' describes deployments which use this technology to share configuration. Our manual install instructions cover installing this, and we recommend that you do so, but our clearwater-docker setup does not use this. You can check whether you are already using etcd by running clearwater-etcdctl cluster-health. If you are using etcd (which should make it simpler to use Project Clearwater), you should follow the instructions at http://clearwater.readthedocs.org/en/latest/Clearwater_Elastic_Scaling.html#if-you-did-a-manual-install. If not, then http://clearwater.readthedocs.org/en/latest/Clearwater_Elastic_Scaling.html#if-you-did-a-manual-install-without-automatic-clustering should be the right instructions.

I can see why you would want to use Kubernetes' own etcd service, but Clearwater's automatic clustering relies on its etcd process, and it is not currently possible to use a separate Kubernetes-provided etcd process to achieve this function.

Finally, you asked about 'Memento' and 'astaire'.

Memento<https://github.com/Metaswitch/memento/blob/dev/docs/memento_overview.md> is an application server which stores lists of calls between the users of the Clearwater deployment. It is possible that you do not have it installed.
Astaire<https://github.com/Metaswitch/astaire> is a process which allows the Memcached cluster to handle scaling up and down, and to recover from failures. This should be installed in all Clearwater deployments?

I hope that helps.

Yours,

Chris

From: Clearwater [mailto:clearwater-bounces at lists.projectclearwater.org] On Behalf Of jiaxuan
Sent: 04 March 2016 10:08
To: clearwater at lists.projectclearwater.org
Subject: [Project Clearwater] How to scale out sprout node if it's running in docker.

Hi list:
Question again :)
My environment is that six containers (bono,sprout,ellis,homer,homestead,ralf), all of them are running in kubernetes. Now I want to scale out my sprout docker container. Do you have some recommendation? Where can i begin from ?
(1)Does this doc( https://github.com/Metaswitch/clearwater-readthedocs/blob/master/docs/Clearwater_Elastic_Scaling.md#if-you-did-a-manual-install-without-automatic-clustering)  suit for my situation?
(2)Kubernetes can provide etcd, so i think i don't have to use clearwater-etcd service. What can i do next ?
(3)While, I see two words 'Memento' and 'astaire', what are they used for ?

Greate Thanks.

Jia Xuan

-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.projectclearwater.org/pipermail/clearwater_lists.projectclearwater.org/attachments/20160304/ed0069dc/attachment.html>

From syeoman at opencloud.com  Mon Mar  7 09:47:44 2016
From: syeoman at opencloud.com (Steve Yeoman)
Date: Mon, 7 Mar 2016 09:47:44 -0500
Subject: [Project Clearwater] preserving user=phone parameter on 3rd-party
	registration
Message-ID: <CAM+QopuHxqsHGwpdz1gmO2ksen+ytA7fwpW-iH5HHoMBZd=UOw@mail.gmail.com>

Hi,

I am trying to register a subscriber with a user=phone parameter. I want
the user=phone parameter to be passed to the TAS for the 3rd-party
registration.

It looks like sprout receives the To header as:

To: <sip:+6505550202 at example.com;user=phone>

But sends the HSS lookup to Homestead like this:

07-03-2016 14:35:53.552 UTC Debug httpconnection.cpp:623: Sending HTTP
request :
http://ec2-52-3-140-139.compute-1.amazonaws.com:8888/impi/%2B6505550202%40example.com/registration-status?impu=sip%3A%2B6505550202%40example.com&visited-network=example.com&auth-type=REG
(trying 172.31.45.86) on new connection

which fails to find my IMPU because I have sip:+6505550202 at example.com
;user=phone in the HSS. So the registration fails.

I tried adding a second IMPU in the HSS without user=phone (i.e.
sip:+6505550202 at example.com), but then Homestead finds that entry and
Sprout sends the 3rd-party reg to the TAS without user=phone.

Is there a way to preserve the user=phone param throughout the whole
registration?

I tried adding enforce_user_phone=Y and enforce_global_only_lookups=Y to my
/etc/cleawater/shared_config file but that didn't seem to help.

cheers
Steve Yeoman
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.projectclearwater.org/pipermail/clearwater_lists.projectclearwater.org/attachments/20160307/888d78bd/attachment.html>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: registration-with-userphone.log
Type: text/x-log
Size: 14182 bytes
Desc: not available
URL: <http://lists.projectclearwater.org/pipermail/clearwater_lists.projectclearwater.org/attachments/20160307/888d78bd/attachment.bin>

From Chris.Elford at metaswitch.com  Wed Mar  9 08:42:23 2016
From: Chris.Elford at metaswitch.com (Chris Elford)
Date: Wed, 9 Mar 2016 13:42:23 +0000
Subject: [Project Clearwater] preserving user=phone parameter on
	3rd-party	registration
In-Reply-To: <CAM+QopuHxqsHGwpdz1gmO2ksen+ytA7fwpW-iH5HHoMBZd=UOw@mail.gmail.com>
References: <CAM+QopuHxqsHGwpdz1gmO2ksen+ytA7fwpW-iH5HHoMBZd=UOw@mail.gmail.com>
Message-ID: <SN1PR0201MB18568A77F51B10759955512CE1B30@SN1PR0201MB1856.namprd02.prod.outlook.com>

Hi Steve,

Thank you for letting us know about this.

I ran this past some of the other Project Clearwater developers. We based Project Clearwater?s behaviour on our interpretation of the 3GPP specs. In particular, 3GPP TS 23.003<http://www.3gpp.org/dynareport/23003.htm> contains the following paragraph:

?The canonical form of a SIP URI for a Public User Identity shall take the form "sip:username at domain" as specified in IETF RFC 3261 [26], section 10.3. SIP URI comparisons shall be performed as defined in IETF RFC 3261 [26], section 19.1.4.?

We interpreted this as meaning that we should be sending IMPUs in SIP messages in this form, with all URI parameters removed. Looking more closely, the spec states that the canonical form must be used over Diameter interfaces, but it does not specify the behaviour for SIP interfaces:

?According to 3GPP TS 29.229 [95] and 3GPP TS 29.329 [96] the canonical forms of SIP URI and Tel URI shall be used over the corresponding Diameter interfaces.?

Do you have a different interpretation of this part of the spec to the one we used?

In any case, we may be able to help. What is the use-case that you are trying to address here?

Yours,

Chris

From: Clearwater [mailto:clearwater-bounces at lists.projectclearwater.org] On Behalf Of Steve Yeoman
Sent: 07 March 2016 14:48
To: clearwater at lists.projectclearwater.org
Subject: [Project Clearwater] preserving user=phone parameter on 3rd-party registration

Hi,

I am trying to register a subscriber with a user=phone parameter. I want the user=phone parameter to be passed to the TAS for the 3rd-party registration.

It looks like sprout receives the To header as:

To: <sip:+6505550202 at example.com<mailto:sip%3A%2B6505550202 at example.com>;user=phone>

But sends the HSS lookup to Homestead like this:

07-03-2016 14:35:53.552 UTC Debug httpconnection.cpp:623: Sending HTTP request : http://ec2-52-3-140-139.compute-1.amazonaws.com:8888/impi/%2B6505550202%40example.com/registration-status?impu=sip%3A%2B6505550202%40example.com&visited-network=example.com&auth-type=REG (trying 172.31.45.86) on new connection

which fails to find my IMPU because I have sip:+6505550202 at example.com<mailto:sip%3A%2B6505550202 at example.com>;user=phone in the HSS. So the registration fails.

I tried adding a second IMPU in the HSS without user=phone (i.e. sip:+6505550202 at example.com<mailto:sip%3A%2B6505550202 at example.com>), but then Homestead finds that entry and Sprout sends the 3rd-party reg to the TAS without user=phone.

Is there a way to preserve the user=phone param throughout the whole registration?

I tried adding enforce_user_phone=Y and enforce_global_only_lookups=Y to my /etc/cleawater/shared_config file but that didn't seem to help.

cheers
Steve Yeoman


-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.projectclearwater.org/pipermail/clearwater_lists.projectclearwater.org/attachments/20160309/4b21a22c/attachment.html>

From syeoman at opencloud.com  Wed Mar  9 09:41:37 2016
From: syeoman at opencloud.com (Steve Yeoman)
Date: Wed, 9 Mar 2016 09:41:37 -0500
Subject: [Project Clearwater] preserving user=phone parameter on
	3rd-party registration
In-Reply-To: <SN1PR0201MB18568A77F51B10759955512CE1B30@SN1PR0201MB1856.namprd02.prod.outlook.com>
References: <CAM+QopuHxqsHGwpdz1gmO2ksen+ytA7fwpW-iH5HHoMBZd=UOw@mail.gmail.com>
	<SN1PR0201MB18568A77F51B10759955512CE1B30@SN1PR0201MB1856.namprd02.prod.outlook.com>
Message-ID: <CAM+QopviKVU9UYgjZvgiLrVkvM_RrYhsqQW=6bwRhXQstn4ADw@mail.gmail.com>

Hi,

Those are good points.

I was looking at 3GPP 24.229 5.4.1.7.c:

"the To header field, which shall contain a non-barred public user identity
belonging to the service profile of the processed Filter Criteria. It may
be either a public user identity as contained in the REGISTER request
received from the UE or one of the implicitly registered public user
identities in the service profile, as configured by the operator;"

I read that as meaning there are 2 options for the SCSCF:

1. Populate the To header value with the value that came "as contained" in
the registration (i.e. with user=phone)
2. Populate the To header with the value that came from the HSS (without
user=phone)

So I thought perhaps there should be a config toggle for both choices?

Although if the spec says there are 2 options for the SCSCF with a "it may
be either" statement that could also mean you only need to implement one of
them, not a choice of either of them.

cheers
Steve














------------------------------------------------------------------------------------------
Steve Yeoman, Software Engineer, http://www.opencloud.com
Tel: +1 647 342 6183, Mobile: +1 416 662 4490


On 9 March 2016 at 08:42, Chris Elford <Chris.Elford at metaswitch.com> wrote:

> Hi Steve,
>
>
>
> Thank you for letting us know about this.
>
>
>
> I ran this past some of the other Project Clearwater developers. We based
> Project Clearwater?s behaviour on our interpretation of the 3GPP specs. In
> particular, 3GPP TS 23.003 <http://www.3gpp.org/dynareport/23003.htm>
> contains the following paragraph:
>
>
>
> ?The canonical form of a SIP URI for a Public User Identity shall take the
> form "sip:username at domain" as specified in IETF RFC 3261 [26], section
> 10.3. SIP URI comparisons shall be performed as defined in IETF RFC 3261
> [26], section 19.1.4.?
>
>
>
> We interpreted this as meaning that we should be sending IMPUs in SIP
> messages in this form, with all URI parameters removed. Looking more
> closely, the spec states that the canonical form must be used over Diameter
> interfaces, but it does not specify the behaviour for SIP interfaces:
>
>
>
> ?According to 3GPP TS 29.229 [95] and 3GPP TS 29.329 [96] the canonical
> forms of SIP URI and Tel URI shall be used over the corresponding Diameter
> interfaces.?
>
>
>
> Do you have a different interpretation of this part of the spec to the one
> we used?
>
>
>
> In any case, we may be able to help. What is the use-case that you are
> trying to address here?
>
>
>
> Yours,
>
>
>
> Chris
>
>
>
> *From:* Clearwater [mailto:clearwater-bounces at lists.projectclearwater.org]
> *On Behalf Of *Steve Yeoman
> *Sent:* 07 March 2016 14:48
> *To:* clearwater at lists.projectclearwater.org
> *Subject:* [Project Clearwater] preserving user=phone parameter on
> 3rd-party registration
>
>
>
> Hi,
>
>
>
> I am trying to register a subscriber with a user=phone parameter. I want
> the user=phone parameter to be passed to the TAS for the 3rd-party
> registration.
>
>
>
> It looks like sprout receives the To header as:
>
>
>
> To: <sip:+6505550202 at example.com;user=phone>
>
>
>
> But sends the HSS lookup to Homestead like this:
>
>
>
> 07-03-2016 14:35:53.552 UTC Debug httpconnection.cpp:623: Sending HTTP
> request :
> http://ec2-52-3-140-139.compute-1.amazonaws.com:8888/impi/%2B6505550202%40example.com/registration-status?impu=sip%3A%2B6505550202%40example.com&visited-network=example.com&auth-type=REG
> (trying 172.31.45.86) on new connection
>
>
> which fails to find my IMPU because I have sip:+6505550202 at example.com
> ;user=phone in the HSS. So the registration fails.
>
> I tried adding a second IMPU in the HSS without user=phone (i.e.
> sip:+6505550202 at example.com), but then Homestead finds that entry and
> Sprout sends the 3rd-party reg to the TAS without user=phone.
>
>
>
> Is there a way to preserve the user=phone param throughout the whole
> registration?
>
>
>
> I tried adding enforce_user_phone=Y and enforce_global_only_lookups=Y to
> my /etc/cleawater/shared_config file but that didn't seem to help.
>
>
>
> cheers
>
> Steve Yeoman
>
>
>
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.projectclearwater.org/pipermail/clearwater_lists.projectclearwater.org/attachments/20160309/59b9bc61/attachment.html>

From Chris.Elford at metaswitch.com  Thu Mar 10 09:28:12 2016
From: Chris.Elford at metaswitch.com (Chris Elford)
Date: Thu, 10 Mar 2016 14:28:12 +0000
Subject: [Project Clearwater] preserving user=phone parameter on
 3rd-party registration
In-Reply-To: <CAM+QopviKVU9UYgjZvgiLrVkvM_RrYhsqQW=6bwRhXQstn4ADw@mail.gmail.com>
References: <CAM+QopuHxqsHGwpdz1gmO2ksen+ytA7fwpW-iH5HHoMBZd=UOw@mail.gmail.com>
	<SN1PR0201MB18568A77F51B10759955512CE1B30@SN1PR0201MB1856.namprd02.prod.outlook.com>
	<CAM+QopviKVU9UYgjZvgiLrVkvM_RrYhsqQW=6bwRhXQstn4ADw@mail.gmail.com>
Message-ID: <SN1PR0201MB1856EC735220ED0E8E3C778DE1B40@SN1PR0201MB1856.namprd02.prod.outlook.com>

Thanks Steve,

I agree that it is possible to read the specification in two ways, so it makes sense to support both interpretations. It will help us to prioritise this issue if we understand how this is affecting you, and what impact this has in your specific use case.

As a result of this conversation, Rob has raised an issue<https://github.com/Metaswitch/sprout/issues/1343> against Sprout to make sure that we send addresses in the right format over Diameter.

Yours,

Chris

From: Steve Yeoman [mailto:syeoman at opencloud.com]
Sent: 09 March 2016 14:42
To: Chris Elford <Chris.Elford at metaswitch.com>
Cc: clearwater at lists.projectclearwater.org
Subject: Re: [Project Clearwater] preserving user=phone parameter on 3rd-party registration

Hi,

Those are good points.

I was looking at 3GPP 24.229 5.4.1.7.c:

"the To header field, which shall contain a non-barred public user identity belonging to the service profile of the processed Filter Criteria. It may be either a public user identity as contained in the REGISTER request received from the UE or one of the implicitly registered public user identities in the service profile, as configured by the operator;"

I read that as meaning there are 2 options for the SCSCF:

1. Populate the To header value with the value that came "as contained" in the registration (i.e. with user=phone)
2. Populate the To header with the value that came from the HSS (without user=phone)

So I thought perhaps there should be a config toggle for both choices?

Although if the spec says there are 2 options for the SCSCF with a "it may be either" statement that could also mean you only need to implement one of them, not a choice of either of them.

cheers
Steve














------------------------------------------------------------------------------------------
Steve Yeoman, Software Engineer, http://www.opencloud.com<http://www.opencloud.com/>
Tel: +1 647 342 6183, Mobile: +1 416 662 4490


On 9 March 2016 at 08:42, Chris Elford <Chris.Elford at metaswitch.com<mailto:Chris.Elford at metaswitch.com>> wrote:
Hi Steve,

Thank you for letting us know about this.

I ran this past some of the other Project Clearwater developers. We based Project Clearwater?s behaviour on our interpretation of the 3GPP specs. In particular, 3GPP TS 23.003<http://www.3gpp.org/dynareport/23003.htm> contains the following paragraph:

?The canonical form of a SIP URI for a Public User Identity shall take the form "sip:username at domain" as specified in IETF RFC 3261 [26], section 10.3. SIP URI comparisons shall be performed as defined in IETF RFC 3261 [26], section 19.1.4.?

We interpreted this as meaning that we should be sending IMPUs in SIP messages in this form, with all URI parameters removed. Looking more closely, the spec states that the canonical form must be used over Diameter interfaces, but it does not specify the behaviour for SIP interfaces:

?According to 3GPP TS 29.229 [95] and 3GPP TS 29.329 [96] the canonical forms of SIP URI and Tel URI shall be used over the corresponding Diameter interfaces.?

Do you have a different interpretation of this part of the spec to the one we used?

In any case, we may be able to help. What is the use-case that you are trying to address here?

Yours,

Chris

From: Clearwater [mailto:clearwater-bounces at lists.projectclearwater.org<mailto:clearwater-bounces at lists.projectclearwater.org>] On Behalf Of Steve Yeoman
Sent: 07 March 2016 14:48
To: clearwater at lists.projectclearwater.org<mailto:clearwater at lists.projectclearwater.org>
Subject: [Project Clearwater] preserving user=phone parameter on 3rd-party registration

Hi,

I am trying to register a subscriber with a user=phone parameter. I want the user=phone parameter to be passed to the TAS for the 3rd-party registration.

It looks like sprout receives the To header as:

To: <sip:+6505550202 at example.com<mailto:sip%3A%2B6505550202 at example.com>;user=phone>

But sends the HSS lookup to Homestead like this:

07-03-2016 14:35:53.552 UTC Debug httpconnection.cpp:623: Sending HTTP request : http://ec2-52-3-140-139.compute-1.amazonaws.com:8888/impi/%2B6505550202%40example.com/registration-status?impu=sip%3A%2B6505550202%40example.com&visited-network=example.com&auth-type=REG (trying 172.31.45.86) on new connection

which fails to find my IMPU because I have sip:+6505550202 at example.com<mailto:sip%3A%2B6505550202 at example.com>;user=phone in the HSS. So the registration fails.

I tried adding a second IMPU in the HSS without user=phone (i.e. sip:+6505550202 at example.com<mailto:sip%3A%2B6505550202 at example.com>), but then Homestead finds that entry and Sprout sends the 3rd-party reg to the TAS without user=phone.

Is there a way to preserve the user=phone param throughout the whole registration?

I tried adding enforce_user_phone=Y and enforce_global_only_lookups=Y to my /etc/cleawater/shared_config file but that didn't seem to help.

cheers
Steve Yeoman



-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.projectclearwater.org/pipermail/clearwater_lists.projectclearwater.org/attachments/20160310/774f7feb/attachment.html>

From syeoman at opencloud.com  Thu Mar 10 10:02:50 2016
From: syeoman at opencloud.com (Steve Yeoman)
Date: Thu, 10 Mar 2016 10:02:50 -0500
Subject: [Project Clearwater] preserving user=phone parameter on
	3rd-party registration
In-Reply-To: <SN1PR0201MB1856EC735220ED0E8E3C778DE1B40@SN1PR0201MB1856.namprd02.prod.outlook.com>
References: <CAM+QopuHxqsHGwpdz1gmO2ksen+ytA7fwpW-iH5HHoMBZd=UOw@mail.gmail.com>
	<SN1PR0201MB18568A77F51B10759955512CE1B30@SN1PR0201MB1856.namprd02.prod.outlook.com>
	<CAM+QopviKVU9UYgjZvgiLrVkvM_RrYhsqQW=6bwRhXQstn4ADw@mail.gmail.com>
	<SN1PR0201MB1856EC735220ED0E8E3C778DE1B40@SN1PR0201MB1856.namprd02.prod.outlook.com>
Message-ID: <CAM+QopvkVZEhRZWJFTkCfsJ5ZkAcTLYQUOqZVXOAptSR-xy5Og@mail.gmail.com>

Hi Chris,

ok, thanks.

The use-case for this is 3rd-party ATM registrations for IP-SM-GW
scenarios. I am testing that the TAS can handle all the logical
permutations of SIP identities that can come from the S-CSCF - SIP URIs,
Tel URIs, combinations etc. Having a sip identity with the user=phone param
is one possible permutation on the list.

It's not a blocker issue. The S-CSCF and TAS work fine without the
user=phone param. Once you add support for it, I can check the TAS handles
it as expected.

cheers
Steve



------------------------------------------------------------------------------------------
Steve Yeoman, Software Engineer, http://www.opencloud.com
Tel: +1 647 342 6183, Mobile: +1 416 662 4490


On 10 March 2016 at 09:28, Chris Elford <Chris.Elford at metaswitch.com> wrote:

> Thanks Steve,
>
>
>
> I agree that it is possible to read the specification in two ways, so it
> makes sense to support both interpretations. It will help us to prioritise
> this issue if we understand how this is affecting you, and what impact this
> has in your specific use case.
>
>
>
> As a result of this conversation, Rob has raised an issue
> <https://github.com/Metaswitch/sprout/issues/1343> against Sprout to make
> sure that we send addresses in the right format over Diameter.
>
>
>
> Yours,
>
>
>
> Chris
>
>
>
> *From:* Steve Yeoman [mailto:syeoman at opencloud.com]
> *Sent:* 09 March 2016 14:42
> *To:* Chris Elford <Chris.Elford at metaswitch.com>
> *Cc:* clearwater at lists.projectclearwater.org
> *Subject:* Re: [Project Clearwater] preserving user=phone parameter on
> 3rd-party registration
>
>
>
> Hi,
>
>
>
> Those are good points.
>
>
>
> I was looking at 3GPP 24.229 5.4.1.7.c:
>
>
>
> "the To header field, which shall contain a non-barred public user
> identity belonging to the service profile of the processed Filter Criteria.
> It may be either a public user identity as contained in the REGISTER
> request received from the UE or one of the implicitly registered public
> user identities in the service profile, as configured by the operator;"
>
>
>
> I read that as meaning there are 2 options for the SCSCF:
>
>
>
> 1. Populate the To header value with the value that came "as contained" in
> the registration (i.e. with user=phone)
>
> 2. Populate the To header with the value that came from the HSS (without
> user=phone)
>
>
>
> So I thought perhaps there should be a config toggle for both choices?
>
>
>
> Although if the spec says there are 2 options for the SCSCF with a "it may
> be either" statement that could also mean you only need to implement one of
> them, not a choice of either of them.
>
>
>
> cheers
>
> Steve
>
>
>
>
>
>
>
>
>
>
>
>
>
>
>
>
>
>
>
>
>
>
>
>
>
>
>
>
>
>
> ------------------------------------------------------------------------------------------
>
> Steve Yeoman, Software Engineer, http://www.opencloud.com
>
> Tel: +1 647 342 6183, Mobile: +1 416 662 4490
>
>
>
>
>
> On 9 March 2016 at 08:42, Chris Elford <Chris.Elford at metaswitch.com>
> wrote:
>
> Hi Steve,
>
>
>
> Thank you for letting us know about this.
>
>
>
> I ran this past some of the other Project Clearwater developers. We based
> Project Clearwater?s behaviour on our interpretation of the 3GPP specs. In
> particular, 3GPP TS 23.003 <http://www.3gpp.org/dynareport/23003.htm>
> contains the following paragraph:
>
>
>
> ?The canonical form of a SIP URI for a Public User Identity shall take the
> form "sip:username at domain" as specified in IETF RFC 3261 [26], section
> 10.3. SIP URI comparisons shall be performed as defined in IETF RFC 3261
> [26], section 19.1.4.?
>
>
>
> We interpreted this as meaning that we should be sending IMPUs in SIP
> messages in this form, with all URI parameters removed. Looking more
> closely, the spec states that the canonical form must be used over Diameter
> interfaces, but it does not specify the behaviour for SIP interfaces:
>
>
>
> ?According to 3GPP TS 29.229 [95] and 3GPP TS 29.329 [96] the canonical
> forms of SIP URI and Tel URI shall be used over the corresponding Diameter
> interfaces.?
>
>
>
> Do you have a different interpretation of this part of the spec to the one
> we used?
>
>
>
> In any case, we may be able to help. What is the use-case that you are
> trying to address here?
>
>
>
> Yours,
>
>
>
> Chris
>
>
>
> *From:* Clearwater [mailto:clearwater-bounces at lists.projectclearwater.org]
> *On Behalf Of *Steve Yeoman
> *Sent:* 07 March 2016 14:48
> *To:* clearwater at lists.projectclearwater.org
> *Subject:* [Project Clearwater] preserving user=phone parameter on
> 3rd-party registration
>
>
>
> Hi,
>
>
>
> I am trying to register a subscriber with a user=phone parameter. I want
> the user=phone parameter to be passed to the TAS for the 3rd-party
> registration.
>
>
>
> It looks like sprout receives the To header as:
>
>
>
> To: <sip:+6505550202 at example.com;user=phone>
>
>
>
> But sends the HSS lookup to Homestead like this:
>
>
>
> 07-03-2016 14:35:53.552 UTC Debug httpconnection.cpp:623: Sending HTTP
> request :
> http://ec2-52-3-140-139.compute-1.amazonaws.com:8888/impi/%2B6505550202%40example.com/registration-status?impu=sip%3A%2B6505550202%40example.com&visited-network=example.com&auth-type=REG
> (trying 172.31.45.86) on new connection
>
>
> which fails to find my IMPU because I have sip:+6505550202 at example.com
> ;user=phone in the HSS. So the registration fails.
>
> I tried adding a second IMPU in the HSS without user=phone (i.e.
> sip:+6505550202 at example.com), but then Homestead finds that entry and
> Sprout sends the 3rd-party reg to the TAS without user=phone.
>
>
>
> Is there a way to preserve the user=phone param throughout the whole
> registration?
>
>
>
> I tried adding enforce_user_phone=Y and enforce_global_only_lookups=Y to
> my /etc/cleawater/shared_config file but that didn't seem to help.
>
>
>
> cheers
>
> Steve Yeoman
>
>
>
>
>
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.projectclearwater.org/pipermail/clearwater_lists.projectclearwater.org/attachments/20160310/ea228b64/attachment.html>

From Chris.Elford at metaswitch.com  Fri Mar 11 04:07:06 2016
From: Chris.Elford at metaswitch.com (Chris Elford)
Date: Fri, 11 Mar 2016 09:07:06 +0000
Subject: [Project Clearwater] preserving user=phone parameter on
 3rd-party registration
In-Reply-To: <CAM+QopvkVZEhRZWJFTkCfsJ5ZkAcTLYQUOqZVXOAptSR-xy5Og@mail.gmail.com>
References: <CAM+QopuHxqsHGwpdz1gmO2ksen+ytA7fwpW-iH5HHoMBZd=UOw@mail.gmail.com>
	<SN1PR0201MB18568A77F51B10759955512CE1B30@SN1PR0201MB1856.namprd02.prod.outlook.com>
	<CAM+QopviKVU9UYgjZvgiLrVkvM_RrYhsqQW=6bwRhXQstn4ADw@mail.gmail.com>
	<SN1PR0201MB1856EC735220ED0E8E3C778DE1B40@SN1PR0201MB1856.namprd02.prod.outlook.com>
	<CAM+QopvkVZEhRZWJFTkCfsJ5ZkAcTLYQUOqZVXOAptSR-xy5Og@mail.gmail.com>
Message-ID: <SN1PR0201MB18560462D1AAA57B9F511624E1B50@SN1PR0201MB1856.namprd02.prod.outlook.com>

Thanks Steve,

I?ve raised this with our product owner, and he?s going to prioritise it against our other work. I?ll let you when I have an answer from him.

Chris

From: Steve Yeoman [mailto:syeoman at opencloud.com]
Sent: 10 March 2016 15:03
To: Chris Elford <Chris.Elford at metaswitch.com>
Cc: clearwater at lists.projectclearwater.org
Subject: Re: [Project Clearwater] preserving user=phone parameter on 3rd-party registration

Hi Chris,

ok, thanks.

The use-case for this is 3rd-party ATM registrations for IP-SM-GW scenarios. I am testing that the TAS can handle all the logical permutations of SIP identities that can come from the S-CSCF - SIP URIs, Tel URIs, combinations etc. Having a sip identity with the user=phone param is one possible permutation on the list.

It's not a blocker issue. The S-CSCF and TAS work fine without the user=phone param. Once you add support for it, I can check the TAS handles it as expected.

cheers
Steve



------------------------------------------------------------------------------------------
Steve Yeoman, Software Engineer, http://www.opencloud.com<http://www.opencloud.com/>
Tel: +1 647 342 6183, Mobile: +1 416 662 4490


On 10 March 2016 at 09:28, Chris Elford <Chris.Elford at metaswitch.com<mailto:Chris.Elford at metaswitch.com>> wrote:
Thanks Steve,

I agree that it is possible to read the specification in two ways, so it makes sense to support both interpretations. It will help us to prioritise this issue if we understand how this is affecting you, and what impact this has in your specific use case.

As a result of this conversation, Rob has raised an issue<https://github.com/Metaswitch/sprout/issues/1343> against Sprout to make sure that we send addresses in the right format over Diameter.

Yours,

Chris

From: Steve Yeoman [mailto:syeoman at opencloud.com<mailto:syeoman at opencloud.com>]
Sent: 09 March 2016 14:42
To: Chris Elford <Chris.Elford at metaswitch.com<mailto:Chris.Elford at metaswitch.com>>
Cc: clearwater at lists.projectclearwater.org<mailto:clearwater at lists.projectclearwater.org>
Subject: Re: [Project Clearwater] preserving user=phone parameter on 3rd-party registration

Hi,

Those are good points.

I was looking at 3GPP 24.229 5.4.1.7.c:

"the To header field, which shall contain a non-barred public user identity belonging to the service profile of the processed Filter Criteria. It may be either a public user identity as contained in the REGISTER request received from the UE or one of the implicitly registered public user identities in the service profile, as configured by the operator;"

I read that as meaning there are 2 options for the SCSCF:

1. Populate the To header value with the value that came "as contained" in the registration (i.e. with user=phone)
2. Populate the To header with the value that came from the HSS (without user=phone)

So I thought perhaps there should be a config toggle for both choices?

Although if the spec says there are 2 options for the SCSCF with a "it may be either" statement that could also mean you only need to implement one of them, not a choice of either of them.

cheers
Steve














------------------------------------------------------------------------------------------
Steve Yeoman, Software Engineer, http://www.opencloud.com<http://www.opencloud.com/>
Tel: +1 647 342 6183<tel:%2B1%20647%20342%206183>, Mobile: +1 416 662 4490<tel:%2B1%20416%20662%204490>


On 9 March 2016 at 08:42, Chris Elford <Chris.Elford at metaswitch.com<mailto:Chris.Elford at metaswitch.com>> wrote:
Hi Steve,

Thank you for letting us know about this.

I ran this past some of the other Project Clearwater developers. We based Project Clearwater?s behaviour on our interpretation of the 3GPP specs. In particular, 3GPP TS 23.003<http://www.3gpp.org/dynareport/23003.htm> contains the following paragraph:

?The canonical form of a SIP URI for a Public User Identity shall take the form "sip:username at domain" as specified in IETF RFC 3261 [26], section 10.3. SIP URI comparisons shall be performed as defined in IETF RFC 3261 [26], section 19.1.4.?

We interpreted this as meaning that we should be sending IMPUs in SIP messages in this form, with all URI parameters removed. Looking more closely, the spec states that the canonical form must be used over Diameter interfaces, but it does not specify the behaviour for SIP interfaces:

?According to 3GPP TS 29.229 [95] and 3GPP TS 29.329 [96] the canonical forms of SIP URI and Tel URI shall be used over the corresponding Diameter interfaces.?

Do you have a different interpretation of this part of the spec to the one we used?

In any case, we may be able to help. What is the use-case that you are trying to address here?

Yours,

Chris

From: Clearwater [mailto:clearwater-bounces at lists.projectclearwater.org<mailto:clearwater-bounces at lists.projectclearwater.org>] On Behalf Of Steve Yeoman
Sent: 07 March 2016 14:48
To: clearwater at lists.projectclearwater.org<mailto:clearwater at lists.projectclearwater.org>
Subject: [Project Clearwater] preserving user=phone parameter on 3rd-party registration

Hi,

I am trying to register a subscriber with a user=phone parameter. I want the user=phone parameter to be passed to the TAS for the 3rd-party registration.

It looks like sprout receives the To header as:

To: <sip:+6505550202 at example.com<mailto:sip%3A%2B6505550202 at example.com>;user=phone>

But sends the HSS lookup to Homestead like this:

07-03-2016 14:35:53.552 UTC Debug httpconnection.cpp:623: Sending HTTP request : http://ec2-52-3-140-139.compute-1.amazonaws.com:8888/impi/%2B6505550202%40example.com/registration-status?impu=sip%3A%2B6505550202%40example.com&visited-network=example.com&auth-type=REG (trying 172.31.45.86) on new connection

which fails to find my IMPU because I have sip:+6505550202 at example.com<mailto:sip%3A%2B6505550202 at example.com>;user=phone in the HSS. So the registration fails.

I tried adding a second IMPU in the HSS without user=phone (i.e. sip:+6505550202 at example.com<mailto:sip%3A%2B6505550202 at example.com>), but then Homestead finds that entry and Sprout sends the 3rd-party reg to the TAS without user=phone.

Is there a way to preserve the user=phone param throughout the whole registration?

I tried adding enforce_user_phone=Y and enforce_global_only_lookups=Y to my /etc/cleawater/shared_config file but that didn't seem to help.

cheers
Steve Yeoman




-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.projectclearwater.org/pipermail/clearwater_lists.projectclearwater.org/attachments/20160311/f2f6fd2b/attachment.html>

From Andrew.Caldwell at metaswitch.com  Fri Mar 11 10:43:40 2016
From: Andrew.Caldwell at metaswitch.com (Andrew Caldwell)
Date: Fri, 11 Mar 2016 15:43:40 +0000
Subject: [Project Clearwater] [Clearwater] Zen and the Art of Motorcycle
	Maintenance release note
Message-ID: <CY1PR0201MB1849CED733E109FC1E1C757B87B50@CY1PR0201MB1849.namprd02.prod.outlook.com>

The release for Project Clearwater sprint "Zen and the Art of Motorcycle Maintenance" has been cut. The code for this release is tagged as release-93 in GitHub.

This release contains the following fixes:


*         Sprout can't load any plugins on XFS (https://github.com/Metaswitch/sprout/issues/1340)

*         UTs should control time more (https://github.com/Metaswitch/sprout/issues/1324)

*         ICSCF generates an ACR for Cx request on REGISTER (https://github.com/Metaswitch/sprout/issues/1245)

*         HSS deregisters due to Chronos timer pops are not logged to SAS (https://github.com/Metaswitch/sprout/issues/1201)

*         Sprout congestion causes unnecessary location lookups to Homestead, and the generation of malformed ACR info to Ralf (https://github.com/Metaswitch/sprout/issues/921)

*         If one Homestead out of two loses its connection to the HSS, things fail (https://github.com/Metaswitch/homestead/issues/273)

*         Unexpected call failures during Homestead recovery (https://github.com/Metaswitch/homestead/issues/177)

*         Accounting-Record-Number AVP for INVITE session ACRs does not increment correctly (https://github.com/Metaswitch/ralf/issues/182)

*         Chronos should work out when it needs to build dependencies (https://github.com/Metaswitch/chronos/issues/227)

*         CHRONOS_TIMER_POP_ERROR alarm is never cleared, and also possibly shouldn't be an alarm (https://github.com/Metaswitch/chronos/issues/219)

*         Chronos' build process differs from other components (https://github.com/Metaswitch/chronos/issues/215)

*         Phantom chronos running after reboot (https://github.com/Metaswitch/chronos/issues/164)

*         On boot, cassandra/homestead somtimes need restarting (https://github.com/Metaswitch/crest/issues/148)

*         create_users interacts badly with clearwater_queue_manager (https://github.com/Metaswitch/ellis/issues/155)

*         Local hostname and public_hostname must resolve (https://github.com/Metaswitch/clearwater-infrastructure/issues/67)

*         ActiveAlarmTable handler should have a mechanism for ensuring sychronization with alarmers (https://github.com/Metaswitch/clearwater-snmp-handlers/issues/108)

*         Some alarms are thrown way on boot because snmpd/alarm-agent isn't up yet (https://github.com/Metaswitch/clearwater-snmp-handlers/issues/96)

*         clearwater.readthedocs.org's link to the readthedocs repository is broken. (https://github.com/Metaswitch/clearwater-readthedocs/issues/138)

*         local_ip is mistakenly used in init.d script (https://github.com/Metaswitch/clearwater-etcd/issues/243)

*         TOO_LONG_CLUSTERING not cleared (sometimes) (https://github.com/Metaswitch/clearwater-etcd/issues/212)


To upgrade to this release, follow the instructions at http://clearwater.readthedocs.org/en/latest/Upgrading_a_Clearwater_deployment/index.html. If you are deploying an all-in-one node, the standard image (http://vm-images.cw-ngv.com/cw-aio.ova) has been updated for this release.



Thanks,
Andy

--

Andy Caldwell
Software Developer, Project Clearwater
+44 208 362 3414

METASWITCH NETWORKS
THE BRAINS OF THE NEW GLOBAL NETWORK
www.metaswitch.com<http://www.metaswitch.com>

-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.projectclearwater.org/pipermail/clearwater_lists.projectclearwater.org/attachments/20160311/f4106389/attachment.html>

From rashidmijumbi at gmail.com  Mon Mar 14 02:17:56 2016
From: rashidmijumbi at gmail.com (Rashid Mijumbi)
Date: Mon, 14 Mar 2016 06:17:56 +0000
Subject: [Project Clearwater] Meaning of Cacti Graphs
Message-ID: <CAErTDA4vnu9YNmRPNoHcS=fzosMfN8XBADaY7zpUPGDnXtpJqQ@mail.gmail.com>

Dear all,

I am seeking guidance on the meaning of project cleawater's SNMP
statistics. I have a manual installation with 6 VM nodes one for each of
sprout, bono, ellis, homer, homestead and ralf.

I could not find an explanation for the Cacti graphs which show the
following:

1) Immediately after setup, the Bono Client count is 30 (on average) even
before I registered any numbers. When the SIPp stress test node is started,
this client count reduces to 0. If my understanding of client count as
"active calls" is right, then this doesn't seem right.

2) What is the meaning of bono latency, sprout latency, and sprout PRR ?
PRR also reduces when the system is stressed!

3) All the Chronos related statistics do not show up.

4) Is there a statistic which captures failed registrations/calls ?

Thank you,

Rashid
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.projectclearwater.org/pipermail/clearwater_lists.projectclearwater.org/attachments/20160314/20d4732b/attachment.html>

From Chris.Elford at metaswitch.com  Mon Mar 14 12:04:44 2016
From: Chris.Elford at metaswitch.com (Chris Elford)
Date: Mon, 14 Mar 2016 16:04:44 +0000
Subject: [Project Clearwater] Meaning of Cacti Graphs
In-Reply-To: <CAErTDA4vnu9YNmRPNoHcS=fzosMfN8XBADaY7zpUPGDnXtpJqQ@mail.gmail.com>
References: <CAErTDA4vnu9YNmRPNoHcS=fzosMfN8XBADaY7zpUPGDnXtpJqQ@mail.gmail.com>
Message-ID: <SN1PR0201MB18568B27854E8FB0D8876AF7E1880@SN1PR0201MB1856.namprd02.prod.outlook.com>

Hi Rashid,

Thanks for raising your issues.

I?ve tried to tackle each of your points in order.

1) Immediately after setup, the Bono Client count is 30 (on average) even before I registered any numbers. When the SIPp stress test node is started, this client count reduces to 0. If my understanding of client count as "active calls" is right, then this doesn't seem right.

That is strange. I think the stat that you are referring to is the number of TCP connections which clients have tried to register over, so I would expect it to start at 0. We should be able to work out what is going on with some more diagnostics.

Firstly, can you send me the output of running snmpwalk to query that statistic, and the command that you ran, to make sure that we are talking about the same one.

Second, can you send me the output of netstat -lp when the extra clients have shown up? That should allow us to check whether the TCP connections really exist.

Thirdly, can you please turn on debug logging<http://clearwater.readthedocs.org/en/latest/Troubleshooting_and_Recovery.html?highlight=debug%20log#bono> on your Bono node, and send the Bono logs from /var/log/bono? This will help us to debug if there is an issue with the code.

2) What is the meaning of bono latency, sprout latency, and sprout PRR ? PRR also reduces when the system is stressed!

The permitted request rate (PRR) is an estimate of how much load the system can handle. As Sprout takes on more load, it is able to build a better estimate of how much more it can handle, and this will cause it to lower the PRR. This is detailed internal information, so it?s likely that you will not need it. You can find details of how our load monitoring and overload control work in two blog posts:

?         http://www.projectclearwater.org/clearwater-performance-and-our-load-monitor/

?         http://www.projectclearwater.org/overload-control-2/

Bono and Sprout both provide statistics covering latency of SIP requests handled by this node over the given period in an SNMP table. The table contains statistics for average latency, variance, highest latency, and lowest latency. Latency is measured in microseconds. Our article on statistics<http://clearwater.readthedocs.org/en/latest/Clearwater_SNMP_Statistics.html#usage> explains how to read these tables.

3) All the Chronos related statistics do not show up.

First, we should make sure that you have all of the necessary packages installed to get these statistics. You can ensure this by running sudo apt-get install clearwater-snmpd on each node, and sudo apt-get install clearwater-snmp-handler-astaire on your Sprout and Ralf nodes.

Second, how are you querying these statistics? Are you using the snmpget and snmptable commands as described in http://clearwater.readthedocs.org/en/latest/Clearwater_SNMP_Statistics.html? If so, can you send the exact commands you ran, and what the output was?

4) Is there a statistics which captures failed registrations/calls?

You can find out the number of failed registrations in each time period by looking in the sproutInitialRegistrationTable. It contains counts of the number of attempts, successes, and failures of initial registrations. There are similar tables for re-registrations and de-registrations.
You can find out the number of failed calls in each time period by looking in the sproutSCSCFIncomingSIPTransactionsTable. It contains the number of attempts, successes, and failures of incoming SIP transactions for the SCSCF. The number of failed INVITE transactions will be the number of failed calls.

I hope that helps.

Yours,

Chris

From: Clearwater [mailto:clearwater-bounces at lists.projectclearwater.org] On Behalf Of Rashid Mijumbi
Sent: 14 March 2016 06:18
To: clearwater at lists.projectclearwater.org
Subject: [Project Clearwater] Meaning of Cacti Graphs

Dear all,

I am seeking guidance on the meaning of project cleawater's SNMP statistics. I have a manual installation with 6 VM nodes one for each of sprout, bono, ellis, homer, homestead and ralf.

I could not find an explanation for the Cacti graphs which show the following:

1) Immediately after setup, the Bono Client count is 30 (on average) even before I registered any numbers. When the SIPp stress test node is started, this client count reduces to 0. If my understanding of client count as "active calls" is right, then this doesn't seem right.

2) What is the meaning of bono latency, sprout latency, and sprout PRR ? PRR also reduces when the system is stressed!

3) All the Chronos related statistics do not show up.

4) Is there a statistic which captures failed registrations/calls ?

Thank you,

Rashid
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.projectclearwater.org/pipermail/clearwater_lists.projectclearwater.org/attachments/20160314/f1f46076/attachment.html>

From Chris.Elford at metaswitch.com  Tue Mar 15 12:57:00 2016
From: Chris.Elford at metaswitch.com (Chris Elford)
Date: Tue, 15 Mar 2016 16:57:00 +0000
Subject: [Project Clearwater] Meaning of Cacti Graphs
In-Reply-To: <CAErTDA7M4MBTX4Jaf1oHGT5-xWX5zJpKBYmDHGyHXBkcXop15A@mail.gmail.com>
References: <CAErTDA4vnu9YNmRPNoHcS=fzosMfN8XBADaY7zpUPGDnXtpJqQ@mail.gmail.com>
	<SN1PR0201MB18568B27854E8FB0D8876AF7E1880@SN1PR0201MB1856.namprd02.prod.outlook.com>
	<CAErTDA7M4MBTX4Jaf1oHGT5-xWX5zJpKBYmDHGyHXBkcXop15A@mail.gmail.com>
Message-ID: <SN1PR0201MB185633E1622D266A86DD99B0E1890@SN1PR0201MB1856.namprd02.prod.outlook.com>

Glad to hear it!

From: Rashid Mijumbi [mailto:rashidmijumbi at gmail.com]
Sent: 14 March 2016 22:52
To: Chris Elford <Chris.Elford at metaswitch.com>
Subject: Re: [Project Clearwater] Meaning of Cacti Graphs

Hi Chris,

Many thanks for your detailed response. I now have a better understanding of the statistics.

With regard to how I am getting the statistics, I downloaded templates provided at

https://github.com/Metaswitch/chef/blob/master/cookbooks/clearwater/files/default/cacti/templates/

I was following the manual Cacti node setup guidelines at

http://clearwater.readthedocs.org/en/latest/Cacti.html

The values shown in the graph (e.g. for bono) were similar to those obtained from running:

snmpwalk -v2c -c clearwater 192.168.33.10 PROJECT-CLEARWATER-MIB::bonoConnectedClients

where 192.168.33.10 is IP of bono which gives:

PROJECT-CLEARWATER-MIB::bonoConnectedClients = Gauge32: 28

However, when I restarted bono (after changing the log level), this statistic seems to have gone to zero - as it should be. See attached.

Moreover, after looking at bono's logs, it appears the effect is from the sipp node, which continues to contact bono after I have re-installed all other nodes but sipp.

Therefore, at the moment, the problem seems to be with my setup. I will confirm this (later this week) and - if I encounter the same problems again - come back to you.

Thanks once again.

Regards,

Rashid

On 14 March 2016 at 16:04, Chris Elford <Chris.Elford at metaswitch.com<mailto:Chris.Elford at metaswitch.com>> wrote:
Hi Rashid,

Thanks for raising your issues.

I?ve tried to tackle each of your points in order.

1) Immediately after setup, the Bono Client count is 30 (on average) even before I registered any numbers. When the SIPp stress test node is started, this client count reduces to 0. If my understanding of client count as "active calls" is right, then this doesn't seem right.

That is strange. I think the stat that you are referring to is the number of TCP connections which clients have tried to register over, so I would expect it to start at 0. We should be able to work out what is going on with some more diagnostics.

Firstly, can you send me the output of running snmpwalk to query that statistic, and the command that you ran, to make sure that we are talking about the same one.

Second, can you send me the output of netstat -lp when the extra clients have shown up? That should allow us to check whether the TCP connections really exist.

Thirdly, can you please turn on debug logging<http://clearwater.readthedocs.org/en/latest/Troubleshooting_and_Recovery.html?highlight=debug%20log#bono> on your Bono node, and send the Bono logs from /var/log/bono? This will help us to debug if there is an issue with the code.

2) What is the meaning of bono latency, sprout latency, and sprout PRR ? PRR also reduces when the system is stressed!

The permitted request rate (PRR) is an estimate of how much load the system can handle. As Sprout takes on more load, it is able to build a better estimate of how much more it can handle, and this will cause it to lower the PRR. This is detailed internal information, so it?s likely that you will not need it. You can find details of how our load monitoring and overload control work in two blog posts:

?         http://www.projectclearwater.org/clearwater-performance-and-our-load-monitor/

?         http://www.projectclearwater.org/overload-control-2/

Bono and Sprout both provide statistics covering latency of SIP requests handled by this node over the given period in an SNMP table. The table contains statistics for average latency, variance, highest latency, and lowest latency. Latency is measured in microseconds. Our article on statistics<http://clearwater.readthedocs.org/en/latest/Clearwater_SNMP_Statistics.html#usage> explains how to read these tables.

3) All the Chronos related statistics do not show up.

First, we should make sure that you have all of the necessary packages installed to get these statistics. You can ensure this by running sudo apt-get install clearwater-snmpd on each node, and sudo apt-get install clearwater-snmp-handler-astaire on your Sprout and Ralf nodes.

Second, how are you querying these statistics? Are you using the snmpget and snmptable commands as described in http://clearwater.readthedocs.org/en/latest/Clearwater_SNMP_Statistics.html? If so, can you send the exact commands you ran, and what the output was?

4) Is there a statistics which captures failed registrations/calls?

You can find out the number of failed registrations in each time period by looking in the sproutInitialRegistrationTable. It contains counts of the number of attempts, successes, and failures of initial registrations. There are similar tables for re-registrations and de-registrations.
You can find out the number of failed calls in each time period by looking in the sproutSCSCFIncomingSIPTransactionsTable. It contains the number of attempts, successes, and failures of incoming SIP transactions for the SCSCF. The number of failed INVITE transactions will be the number of failed calls.

I hope that helps.

Yours,

Chris

From: Clearwater [mailto:clearwater-bounces at lists.projectclearwater.org<mailto:clearwater-bounces at lists.projectclearwater.org>] On Behalf Of Rashid Mijumbi
Sent: 14 March 2016 06:18
To: clearwater at lists.projectclearwater.org<mailto:clearwater at lists.projectclearwater.org>
Subject: [Project Clearwater] Meaning of Cacti Graphs

Dear all,

I am seeking guidance on the meaning of project cleawater's SNMP statistics. I have a manual installation with 6 VM nodes one for each of sprout, bono, ellis, homer, homestead and ralf.

I could not find an explanation for the Cacti graphs which show the following:

1) Immediately after setup, the Bono Client count is 30 (on average) even before I registered any numbers. When the SIPp stress test node is started, this client count reduces to 0. If my understanding of client count as "active calls" is right, then this doesn't seem right.

2) What is the meaning of bono latency, sprout latency, and sprout PRR ? PRR also reduces when the system is stressed!

3) All the Chronos related statistics do not show up.

4) Is there a statistic which captures failed registrations/calls ?

Thank you,

Rashid

-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.projectclearwater.org/pipermail/clearwater_lists.projectclearwater.org/attachments/20160315/abd32b1c/attachment.html>

From marstonaustin at gmail.com  Wed Mar 16 06:17:34 2016
From: marstonaustin at gmail.com (Austin Marston)
Date: Wed, 16 Mar 2016 11:17:34 +0100
Subject: [Project Clearwater] Homer XCAP communication
Message-ID: <CAOVZBjCxaY6vwuMgfXiQoJG1J_hQp2K9j9YO5NtS1aL2Uu7f1A@mail.gmail.com>

Hi all,

I was wondering if anyone of you could explain to me to what extent a user
equipment would interact with Homer ? (see online diagram
http://www.projectclearwater.org/technical/clearwater-architecture/)
I do not think there would be such XCAP communication while testing
Clearwater with SIPp am I right?

Thank you in advance for your time.

Yours sincerely,
Austin
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.projectclearwater.org/pipermail/clearwater_lists.projectclearwater.org/attachments/20160316/4aaae5cd/attachment.html>

From chris at projectclearwater.org  Wed Mar 16 12:57:27 2016
From: chris at projectclearwater.org (Chris Elford (projectclearwater.org))
Date: Wed, 16 Mar 2016 16:57:27 +0000
Subject: [Project Clearwater] Homer XCAP communication
In-Reply-To: <CAOVZBjCxaY6vwuMgfXiQoJG1J_hQp2K9j9YO5NtS1aL2Uu7f1A@mail.gmail.com>
References: <CAOVZBjCxaY6vwuMgfXiQoJG1J_hQp2K9j9YO5NtS1aL2Uu7f1A@mail.gmail.com>
Message-ID: <SN1PR0201MB1856D66949C7C631886070B5E18A0@SN1PR0201MB1856.namprd02.prod.outlook.com>

Hi Austin,

I think you are right ? I would not expect SIPp to interact with the Homer.

Homer works with our Ellis service to allow users to configure call services for subscribers in a Project Clearwater deployment. It acts as an XDMS, and Ellis talks to it using XCAP (in the spirit of the VoLTE  Ut interface<http://www.3gpp.org/dynareport/24623.htm>). This allows you to configure any of the services<http://clearwater.readthedocs.org/en/stable/IR.92_Supplementary_Services.html?highlight=MMtel#supported-by-clearwater-s-built-in-mmtel-application-server> provided by the Project Clearwater MMtel TAS using Ellis.

Homer has a public API<https://github.com/Metaswitch/crest/blob/dev/docs/homer_api.md> which you could use to write your own services to change subscriber information.

However, Homer doesn?t currently have all of the pieces needed to authenticate users, so we don?t currently recommend<http://clearwater.readthedocs.org/en/stable/Clearwater_IP_Port_Usage.html#homer> that you expose it to the world (or your UEs). That said, it would be great to be able to expose Homer to the world, and it would be great if you want to help!

I hope that helps,

Yours,

Chris

From: Clearwater [mailto:clearwater-bounces at lists.projectclearwater.org] On Behalf Of Austin Marston
Sent: 16 March 2016 10:18
To: clearwater at lists.projectclearwater.org
Subject: [Project Clearwater] Homer XCAP communication

Hi all,

I was wondering if anyone of you could explain to me to what extent a user equipment would interact with Homer ? (see online diagram http://www.projectclearwater.org/technical/clearwater-architecture/)
I do not think there would be such XCAP communication while testing Clearwater with SIPp am I right?

Thank you in advance for your time.

Yours sincerely,
Austin
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.projectclearwater.org/pipermail/clearwater_lists.projectclearwater.org/attachments/20160316/4e2804d6/attachment.html>

From marstonaustin at gmail.com  Wed Mar 16 13:50:23 2016
From: marstonaustin at gmail.com (Austin Marston)
Date: Wed, 16 Mar 2016 18:50:23 +0100
Subject: [Project Clearwater] Homer XCAP communication
In-Reply-To: <SN1PR0201MB1856D66949C7C631886070B5E18A0@SN1PR0201MB1856.namprd02.prod.outlook.com>
References: <CAOVZBjCxaY6vwuMgfXiQoJG1J_hQp2K9j9YO5NtS1aL2Uu7f1A@mail.gmail.com>
	<SN1PR0201MB1856D66949C7C631886070B5E18A0@SN1PR0201MB1856.namprd02.prod.outlook.com>
Message-ID: <CAOVZBjCP2-R66psGa5bjcf0d+MQQ053wnVsVJd73+g91vXkKcQ@mail.gmail.com>

Hi Chris,

thank you so much for this relevant clarification!
I am currently working on the dependability evaluation of VNF and
Clearwater is my case study. It is great to get insight about Clearwater
and its current developping state thanks to you and the community in
general.

Thanks again,

Austin
Le 16 mars 2016 17:57, "Chris Elford (projectclearwater.org)" <
chris at projectclearwater.org> a ?crit :

> Hi Austin,
>
>
>
> I think you are right ? I would not expect SIPp to interact with the Homer.
>
>
>
> Homer works with our Ellis service to allow users to configure call
> services for subscribers in a Project Clearwater deployment. It acts as an
> XDMS, and Ellis talks to it using XCAP (in the spirit of the VoLTE  Ut
> interface <http://www.3gpp.org/dynareport/24623.htm>). This allows you to
> configure any of the services
> <http://clearwater.readthedocs.org/en/stable/IR.92_Supplementary_Services.html?highlight=MMtel#supported-by-clearwater-s-built-in-mmtel-application-server>
> provided by the Project Clearwater MMtel TAS using Ellis.
>
>
>
> Homer has a public API
> <https://github.com/Metaswitch/crest/blob/dev/docs/homer_api.md> which
> you could use to write your own services to change subscriber information.
>
>
>
> However, Homer doesn?t currently have all of the pieces needed to
> authenticate users, so we don?t currently recommend
> <http://clearwater.readthedocs.org/en/stable/Clearwater_IP_Port_Usage.html#homer>
> that you expose it to the world (or your UEs). That said, it would be great
> to be able to expose Homer to the world, and it would be great if you want
> to help!
>
>
>
> I hope that helps,
>
>
>
> Yours,
>
>
>
> Chris
>
>
>
> *From:* Clearwater [mailto:clearwater-bounces at lists.projectclearwater.org]
> *On Behalf Of *Austin Marston
> *Sent:* 16 March 2016 10:18
> *To:* clearwater at lists.projectclearwater.org
> *Subject:* [Project Clearwater] Homer XCAP communication
>
>
>
> Hi all,
>
>
>
> I was wondering if anyone of you could explain to me to what extent a user
> equipment would interact with Homer ? (see online diagram
> http://www.projectclearwater.org/technical/clearwater-architecture/)
>
> I do not think there would be such XCAP communication while testing
> Clearwater with SIPp am I right?
>
>
>
> Thank you in advance for your time.
>
>
>
> Yours sincerely,
>
> Austin
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.projectclearwater.org/pipermail/clearwater_lists.projectclearwater.org/attachments/20160316/47592dad/attachment.html>

From alienpenguin at gmail.com  Mon Mar 21 03:43:19 2016
From: alienpenguin at gmail.com (Francesco Lamonica)
Date: Mon, 21 Mar 2016 08:43:19 +0100
Subject: [Project Clearwater] configuring specific routes
Message-ID: <CAOkLYJN0MH2S3a_wAfWAWCx_gKpohzqPic_Fbjgo3stwe2ZUuA@mail.gmail.com>

Hi all,
i am totally new with clearwater so please bear with me and my (surely
dumb) questions..,

I am experimenting with an AIO image and what i'd like to know is how to
configure clearwater so that i can make all calls (SIP INVITEs) coming from
an IMPU towards a specific route (i.e an AS?) indipendently of the callee.

thanks a lot for any hints
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.projectclearwater.org/pipermail/clearwater_lists.projectclearwater.org/attachments/20160321/5780bb54/attachment.html>

From Chris.Elford at metaswitch.com  Mon Mar 21 05:50:26 2016
From: Chris.Elford at metaswitch.com (Chris Elford)
Date: Mon, 21 Mar 2016 09:50:26 +0000
Subject: [Project Clearwater] configuring specific routes
In-Reply-To: <CAOkLYJN0MH2S3a_wAfWAWCx_gKpohzqPic_Fbjgo3stwe2ZUuA@mail.gmail.com>
References: <CAOkLYJN0MH2S3a_wAfWAWCx_gKpohzqPic_Fbjgo3stwe2ZUuA@mail.gmail.com>
Message-ID: <SN1PR0201MB185663743CFE1C47684D78C8E18F0@SN1PR0201MB1856.namprd02.prod.outlook.com>

Hi Francesco,

Thank you for getting in touch.

I don?t know how much you know about application servers in IMS, so I?ll start at the beginning. In IMS, each IMPU is configured to use the correct set of AS?s using an XML document, called its initial filter criteria (IFC). The IFC tells Project Clearwater when to send calls to each AS using a set of rules. For example all incoming calls for an IMPU could be sent to a voicemail AS. This article<https://docs.oracle.com/cd/E15438_01/doc.50/e15182/cnf_app_ifc.htm> describes IFCs in more detail, and should help you to create the right XML document.

Once you have the IFCs, you will need to configure your IMPU to use them. In a production IMS deployment, you would configure IFCs on the HSS. However, our all-in-one nodes are designed to run without an HSS, so you will need to upload the IFCs to Project Clearwater. There are two ways to do this: using the Ellis web UI<http://clearwater.readthedocs.org/en/stable/Configuring_an_Application_Server.html#web-ui-configuration-via-ellis>, and direct configuration via cURL<http://clearwater.readthedocs.org/en/stable/Configuring_an_Application_Server.html#direct-configuration-via-curl>. You can find instructions for these in our documentation, at http://clearwater.readthedocs.org/en/stable/Configuring_an_Application_Server.html.

Please get in touch if you have any more issues.

Yours,

Chris

From: Clearwater [mailto:clearwater-bounces at lists.projectclearwater.org] On Behalf Of Francesco Lamonica
Sent: 21 March 2016 07:43
To: clearwater at lists.projectclearwater.org
Subject: [Project Clearwater] configuring specific routes

Hi all,
i am totally new with clearwater so please bear with me and my (surely dumb) questions..,

I am experimenting with an AIO image and what i'd like to know is how to configure clearwater so that i can make all calls (SIP INVITEs) coming from an IMPU towards a specific route (i.e an AS?) indipendently of the callee.

thanks a lot for any hints
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.projectclearwater.org/pipermail/clearwater_lists.projectclearwater.org/attachments/20160321/b663fefb/attachment.html>

From schwartazi at gmail.com  Tue Mar 22 23:04:54 2016
From: schwartazi at gmail.com (Adrian Schwartz)
Date: Wed, 23 Mar 2016 05:04:54 +0200
Subject: [Project Clearwater] newbie all-in-one image hard-start
Message-ID: <CAOAmQy77qxeEVt-cjhRr9+sy5K986xwEoiVOhUTznLt4dWJN7Q@mail.gmail.com>

Hello Everyone
I downloaded the image file and installed it in my machine (kvm not vmware)
I don't have DNS on the loacal machine, but the machine is getting ip
address from the DHCP server and is available from each neighboring
computer (they can ping or ssh to it)
According to what is written here,
http://clearwater.readthedocs.org/en/stable/All_in_one_OVF_Installation.html
I should be able to http to ellis (I guess by typing ip-address on a
web-browser)
When I do so  I get connection refuse error.
Moreover when I do wget ip-address:8080 on the clearwater machine I receive
similar error
When I do wget 127.0.0.1:8080 I recieve a response index file.

Bellow, some error log.

Regards
Adrian

 cat ellis_20160322T190000Z.txt
22-03-2016 19:44:15.351 UTC INFO main.py:115: Process 0 starting up
22-03-2016 19:44:15.449 UTC WARNING homestead.py:309: Passing SIP password
in the clear over http
22-03-2016 19:44:15.473 UTC WARNING iostream.py:507: Connect error on fd 9:
ECONNREFUSED
22-03-2016 19:44:15.474 UTC ERROR homestead.py:68: Failed to ping Homestead
at http://192.168.1.19:8889/ping. Have you configured your HOMESTEAD_URL?
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.projectclearwater.org/pipermail/clearwater_lists.projectclearwater.org/attachments/20160323/db52b10e/attachment.html>

From fmalka at modulo.co.il  Wed Mar 23 01:36:26 2016
From: fmalka at modulo.co.il (Franck Malka)
Date: Wed, 23 Mar 2016 05:36:26 +0000
Subject: [Project Clearwater] newbie all-in-one image hard-start
In-Reply-To: <CAOAmQy77qxeEVt-cjhRr9+sy5K986xwEoiVOhUTznLt4dWJN7Q@mail.gmail.com>
References: <CAOAmQy77qxeEVt-cjhRr9+sy5K986xwEoiVOhUTznLt4dWJN7Q@mail.gmail.com>
Message-ID: <CAKX=ev1N=4_BQOKa4va5OqKEEqg1ymd1w7=3FL8pftj=bSGLxg@mail.gmail.com>

Hi Adi,

did you adjust the configuration file and restarted the services after your
machine got its new ip address?

Franck.

On Wed, Mar 23, 2016, 05:05 Adrian Schwartz <schwartazi at gmail.com> wrote:

> Hello Everyone
> I downloaded the image file and installed it in my machine (kvm not vmware)
> I don't have DNS on the loacal machine, but the machine is getting ip
> address from the DHCP server and is available from each neighboring
> computer (they can ping or ssh to it)
> According to what is written here,
> http://clearwater.readthedocs.org/en/stable/All_in_one_OVF_Installation.html
> I should be able to http to ellis (I guess by typing ip-address on a
> web-browser)
> When I do so  I get connection refuse error.
> Moreover when I do wget ip-address:8080 on the clearwater machine I
> receive similar error
> When I do wget 127.0.0.1:8080 I recieve a response index file.
>
> Bellow, some error log.
>
> Regards
> Adrian
>
>  cat ellis_20160322T190000Z.txt
> 22-03-2016 19:44:15.351 UTC INFO main.py:115: Process 0 starting up
> 22-03-2016 19:44:15.449 UTC WARNING homestead.py:309: Passing SIP password
> in the clear over http
> 22-03-2016 19:44:15.473 UTC WARNING iostream.py:507: Connect error on fd
> 9: ECONNREFUSED
> 22-03-2016 19:44:15.474 UTC ERROR homestead.py:68: Failed to ping
> Homestead at http://192.168.1.19:8889/ping. Have you configured your
> HOMESTEAD_URL?
>
> _______________________________________________
> Clearwater mailing list
> Clearwater at lists.projectclearwater.org
>
> http://lists.projectclearwater.org/mailman/listinfo/clearwater_lists.projectclearwater.org
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.projectclearwater.org/pipermail/clearwater_lists.projectclearwater.org/attachments/20160323/b9056fe0/attachment.html>

From schwartazi at gmail.com  Wed Mar 23 03:45:32 2016
From: schwartazi at gmail.com (Adrian Schwartz)
Date: Wed, 23 Mar 2016 09:45:32 +0200
Subject: [Project Clearwater] newbie all-in-one image hard-start
In-Reply-To: <CAKX=ev1N=4_BQOKa4va5OqKEEqg1ymd1w7=3FL8pftj=bSGLxg@mail.gmail.com>
References: <CAOAmQy77qxeEVt-cjhRr9+sy5K986xwEoiVOhUTznLt4dWJN7Q@mail.gmail.com>
	<CAKX=ev1N=4_BQOKa4va5OqKEEqg1ymd1w7=3FL8pftj=bSGLxg@mail.gmail.com>
Message-ID: <CAOAmQy4O3p3-Tp0Mo_L9fnpD6MeOwCS5XXaJT-tifuCqpr+h_Q@mail.gmail.com>

Hi Franck
If you are refering to the shared_config and local_config
yes
I think that it is done automatic, but they reflect the local ip address
that I have
Adi

On Wed, Mar 23, 2016 at 7:36 AM, Franck Malka <fmalka at modulo.co.il> wrote:

> Hi Adi,
>
> did you adjust the configuration file and restarted the services after
> your machine got its new ip address?
>
> Franck.
>
> On Wed, Mar 23, 2016, 05:05 Adrian Schwartz <schwartazi at gmail.com> wrote:
>
>> Hello Everyone
>> I downloaded the image file and installed it in my machine (kvm not
>> vmware)
>> I don't have DNS on the loacal machine, but the machine is getting ip
>> address from the DHCP server and is available from each neighboring
>> computer (they can ping or ssh to it)
>> According to what is written here,
>> http://clearwater.readthedocs.org/en/stable/All_in_one_OVF_Installation.html
>> I should be able to http to ellis (I guess by typing ip-address on a
>> web-browser)
>> When I do so  I get connection refuse error.
>> Moreover when I do wget ip-address:8080 on the clearwater machine I
>> receive similar error
>> When I do wget 127.0.0.1:8080 I recieve a response index file.
>>
>> Bellow, some error log.
>>
>> Regards
>> Adrian
>>
>>  cat ellis_20160322T190000Z.txt
>> 22-03-2016 19:44:15.351 UTC INFO main.py:115: Process 0 starting up
>> 22-03-2016 19:44:15.449 UTC WARNING homestead.py:309: Passing SIP
>> password in the clear over http
>> 22-03-2016 19:44:15.473 UTC WARNING iostream.py:507: Connect error on fd
>> 9: ECONNREFUSED
>> 22-03-2016 19:44:15.474 UTC ERROR homestead.py:68: Failed to ping
>> Homestead at http://192.168.1.19:8889/ping. Have you configured your
>> HOMESTEAD_URL?
>>
>> _______________________________________________
>> Clearwater mailing list
>> Clearwater at lists.projectclearwater.org
>>
>> http://lists.projectclearwater.org/mailman/listinfo/clearwater_lists.projectclearwater.org
>>
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.projectclearwater.org/pipermail/clearwater_lists.projectclearwater.org/attachments/20160323/e46a1f32/attachment.html>

From fmalka at modulo.co.il  Wed Mar 23 03:55:03 2016
From: fmalka at modulo.co.il (Franck Malka)
Date: Wed, 23 Mar 2016 07:55:03 +0000
Subject: [Project Clearwater] newbie all-in-one image hard-start
In-Reply-To: <CAOAmQy4O3p3-Tp0Mo_L9fnpD6MeOwCS5XXaJT-tifuCqpr+h_Q@mail.gmail.com>
References: <CAOAmQy77qxeEVt-cjhRr9+sy5K986xwEoiVOhUTznLt4dWJN7Q@mail.gmail.com>
	<CAKX=ev1N=4_BQOKa4va5OqKEEqg1ymd1w7=3FL8pftj=bSGLxg@mail.gmail.com>
	<CAOAmQy4O3p3-Tp0Mo_L9fnpD6MeOwCS5XXaJT-tifuCqpr+h_Q@mail.gmail.com>
Message-ID: <CAKX=ev2sCrbMNJqXP6HvEUE-O5YHgKijQJgQOUCA7FuPGDZ=pw@mail.gmail.com>

and did you restart the services?

On Wed, Mar 23, 2016, 09:45 Adrian Schwartz <schwartazi at gmail.com> wrote:

> Hi Franck
> If you are refering to the shared_config and local_config
> yes
> I think that it is done automatic, but they reflect the local ip address
> that I have
> Adi
>
> On Wed, Mar 23, 2016 at 7:36 AM, Franck Malka <fmalka at modulo.co.il> wrote:
>
>> Hi Adi,
>>
>> did you adjust the configuration file and restarted the services after
>> your machine got its new ip address?
>>
>> Franck.
>>
>> On Wed, Mar 23, 2016, 05:05 Adrian Schwartz <schwartazi at gmail.com> wrote:
>>
>>> Hello Everyone
>>> I downloaded the image file and installed it in my machine (kvm not
>>> vmware)
>>> I don't have DNS on the loacal machine, but the machine is getting ip
>>> address from the DHCP server and is available from each neighboring
>>> computer (they can ping or ssh to it)
>>> According to what is written here,
>>> http://clearwater.readthedocs.org/en/stable/All_in_one_OVF_Installation.html
>>> I should be able to http to ellis (I guess by typing ip-address on a
>>> web-browser)
>>> When I do so  I get connection refuse error.
>>> Moreover when I do wget ip-address:8080 on the clearwater machine I
>>> receive similar error
>>> When I do wget 127.0.0.1:8080 I recieve a response index file.
>>>
>>> Bellow, some error log.
>>>
>>> Regards
>>> Adrian
>>>
>>>  cat ellis_20160322T190000Z.txt
>>> 22-03-2016 19:44:15.351 UTC INFO main.py:115: Process 0 starting up
>>> 22-03-2016 19:44:15.449 UTC WARNING homestead.py:309: Passing SIP
>>> password in the clear over http
>>> 22-03-2016 19:44:15.473 UTC WARNING iostream.py:507: Connect error on fd
>>> 9: ECONNREFUSED
>>> 22-03-2016 19:44:15.474 UTC ERROR homestead.py:68: Failed to ping
>>> Homestead at http://192.168.1.19:8889/ping. Have you configured your
>>> HOMESTEAD_URL?
>>>
>>> _______________________________________________
>>> Clearwater mailing list
>>> Clearwater at lists.projectclearwater.org
>>>
>>> http://lists.projectclearwater.org/mailman/listinfo/clearwater_lists.projectclearwater.org
>>>
>>
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.projectclearwater.org/pipermail/clearwater_lists.projectclearwater.org/attachments/20160323/37c52af7/attachment.html>

From schwartazi at gmail.com  Wed Mar 23 04:41:48 2016
From: schwartazi at gmail.com (Adrian Schwartz)
Date: Wed, 23 Mar 2016 10:41:48 +0200
Subject: [Project Clearwater] newbie all-in-one image hard-start
In-Reply-To: <CAKX=ev2sCrbMNJqXP6HvEUE-O5YHgKijQJgQOUCA7FuPGDZ=pw@mail.gmail.com>
References: <CAOAmQy77qxeEVt-cjhRr9+sy5K986xwEoiVOhUTznLt4dWJN7Q@mail.gmail.com>
	<CAKX=ev1N=4_BQOKa4va5OqKEEqg1ymd1w7=3FL8pftj=bSGLxg@mail.gmail.com>
	<CAOAmQy4O3p3-Tp0Mo_L9fnpD6MeOwCS5XXaJT-tifuCqpr+h_Q@mail.gmail.com>
	<CAKX=ev2sCrbMNJqXP6HvEUE-O5YHgKijQJgQOUCA7FuPGDZ=pw@mail.gmail.com>
Message-ID: <CAOAmQy7+YEZUxBbT2iPqs5WkmZzqUc4+Kx16Gn5-iK2cpXXPwA@mail.gmail.com>

I had both
restart the machine ity didnt helped so manually started ellis and homer
and this didn't helped either.
attached monit log.


The Monit daemon 5.8.1 uptime: 16m

Process 'sprout_process'
  status                            Running
  monitoring status                 Monitored
  pid                               1646
  parent pid                        1
  uid                               993
  effective uid                     993
  gid                               993
  uptime                            16m
  children                          0
  memory kilobytes                  64724
  memory kilobytes total            64724
  memory percent                    3.1%
  memory percent total              3.1%
  cpu percent                       0.5%
  cpu percent total                 0.5%
  data collected                    Wed, 23 Mar 2016 08:37:48

Program 'sprout_uptime'
  status                            Waiting
  monitoring status                 Waiting
  last started                      Wed, 23 Mar 2016 08:35:26
  last exit value                   0
  data collected                    Wed, 23 Mar 2016 08:35:26

Program 'poll_sprout_sip'
  status                            Status ok
  monitoring status                 Monitored
  last started                      Wed, 23 Mar 2016 08:37:48
  last exit value                   0
  data collected                    Wed, 23 Mar 2016 08:37:48

Program 'poll_sprout_http'
  status                            Status ok
  monitoring status                 Monitored
  last started                      Wed, 23 Mar 2016 08:37:48
  last exit value                   0
  data collected                    Wed, 23 Mar 2016 08:37:48

Process 'snmpd_process'
  status                            Running
  monitoring status                 Monitored
  pid                               1036
  parent pid                        1
  uid                               108
  effective uid                     108
  gid                               114
  uptime                            16m
  children                          0
  memory kilobytes                  8080
  memory kilobytes total            8080
  memory percent                    0.3%
  memory percent total              0.3%
  cpu percent                       0.1%
  cpu percent total                 0.1%
  data collected                    Wed, 23 Mar 2016 08:37:48

Process 'restund_process'
  status                            Running
  monitoring status                 Monitored
  pid                               1842
  parent pid                        1
  uid                               997
  effective uid                     997
  gid                               997
  uptime                            16m
  children                          0
  memory kilobytes                  2452
  memory kilobytes total            2452
  memory percent                    0.1%
  memory percent total              0.1%
  cpu percent                       0.0%
  cpu percent total                 0.0%
  data collected                    Wed, 23 Mar 2016 08:37:48

Program 'poll_restund'
  status                            Status ok
  monitoring status                 Monitored
  last started                      Wed, 23 Mar 2016 08:37:48
  last exit value                   0
  data collected                    Wed, 23 Mar 2016 08:37:48

Process 'ntp_process'
  status                            Running
  monitoring status                 Monitored
  pid                               2171
  parent pid                        1
  uid                               106
  effective uid                     106
  gid                               112
  uptime                            16m
  children                          0
  memory kilobytes                  4260
  memory kilobytes total            4260
  memory percent                    0.2%
  memory percent total              0.2%
  cpu percent                       0.0%
  cpu percent total                 0.0%
  data collected                    Wed, 23 Mar 2016 08:37:48

System 'node-cw-aio.example.com'
  status                            Running
  monitoring status                 Monitored
  load average                      [0.19] [0.20] [0.13]
  cpu                               13.5%us 2.3%sy 0.1%wa
  memory usage                      1234568 kB [60.2%]
  swap usage                        0 kB [0.0%]
  data collected                    Wed, 23 Mar 2016 08:37:48

Process 'nginx_process'
  status                            Execution failed
  monitoring status                 Monitored
  data collected                    Wed, 23 Mar 2016 08:38:48

Program 'nginx_uptime'
  status                            Initializing
  monitoring status                 Initializing
  data collected                    Wed, 23 Mar 2016 08:22:27

Process 'mysql_process'
  status                            Running
  monitoring status                 Monitored
  pid                               919
  parent pid                        1
  uid                               107
  effective uid                     107
  gid                               113
  uptime                            17m
  children                          0
  memory kilobytes                  53484
  memory kilobytes total            53484
  memory percent                    2.6%
  memory percent total              2.6%
  cpu percent                       0.1%
  cpu percent total                 0.1%
  unix socket response time         0.000s to /var/run/mysqld/mysqld.sock
[DEFAULT]
  data collected                    Wed, 23 Mar 2016 08:38:48

Process 'memcached_process'
  status                            Running
  monitoring status                 Monitored
  pid                               2380
  parent pid                        1
  uid                               109
  effective uid                     109
  gid                               115
  uptime                            16m
  children                          0
  memory kilobytes                  3712
  memory kilobytes total            3712
  memory percent                    0.1%
  memory percent total              0.1%
  cpu percent                       0.0%
  cpu percent total                 0.0%
  data collected                    Wed, 23 Mar 2016 08:38:48

Program 'memcached_uptime'
  status                            Waiting
  monitoring status                 Waiting
  last started                      Wed, 23 Mar 2016 08:36:26
  last exit value                   0
  data collected                    Wed, 23 Mar 2016 08:36:26

Program 'poll_memcached'
  status                            Status ok
  monitoring status                 Monitored
  last started                      Wed, 23 Mar 2016 08:38:48
  last exit value                   0
  data collected                    Wed, 23 Mar 2016 08:38:48

Process 'homestead_process'
  status                            Running
  monitoring status                 Monitored
  pid                               2409
  parent pid                        1
  uid                               995
  effective uid                     995
  gid                               995
  uptime                            16m
  children                          0
  memory kilobytes                  29512
  memory kilobytes total            29512
  memory percent                    1.4%
  memory percent total              1.4%
  cpu percent                       0.0%
  cpu percent total                 0.0%
  data collected                    Wed, 23 Mar 2016 08:38:48

Program 'homestead_uptime'
  status                            Waiting
  monitoring status                 Waiting
  last started                      Wed, 23 Mar 2016 08:36:26
  last exit value                   0
  data collected                    Wed, 23 Mar 2016 08:36:26

Program 'poll_homestead'
  status                            Status ok
  monitoring status                 Monitored
  last started                      Wed, 23 Mar 2016 08:38:48
  last exit value                   0
  data collected                    Wed, 23 Mar 2016 08:38:48

Process 'homestead-prov_process'
  status                            Running
  monitoring status                 Monitored
  pid                               1829
  parent pid                        1
  uid                               0
  effective uid                     0
  gid                               0
  uptime                            17m
  children                          0
  memory kilobytes                  36640
  memory kilobytes total            36640
  memory percent                    1.7%
  memory percent total              1.7%
  cpu percent                       0.0%
  cpu percent total                 0.0%
  data collected                    Wed, 23 Mar 2016 08:38:48

Program 'poll_homestead-prov'
  status                            Status failed
  monitoring status                 Monitored
  last started                      Wed, 23 Mar 2016 08:38:48
  last exit value                   1
  data collected                    Wed, 23 Mar 2016 08:38:48

Process 'homer_process'
  status                            Running
  monitoring status                 Monitored
  pid                               8321
  parent pid                        1
  uid                               0
  effective uid                     0
  gid                               0
  uptime                            1m
  children                          0
  memory kilobytes                  37328
  memory kilobytes total            37328
  memory percent                    1.8%
  memory percent total              1.8%
  cpu percent                       0.0%
  cpu percent total                 0.0%
  data collected                    Wed, 23 Mar 2016 08:38:48

Program 'poll_homer'
  status                            Status ok
  monitoring status                 Monitored
  last started                      Wed, 23 Mar 2016 08:38:48
  last exit value                   1
  data collected                    Wed, 23 Mar 2016 08:38:48

Process 'ellis_process'
  status                            Running
  monitoring status                 Monitored
  pid                               8341
  parent pid                        1
  uid                               994
  effective uid                     994
  gid                               994
  uptime                            1m
  children                          2
  memory kilobytes                  27888
  memory kilobytes total            88752
  memory percent                    1.3%
  memory percent total              4.3%
  cpu percent                       0.0%
  cpu percent total                 0.0%
  data collected                    Wed, 23 Mar 2016 08:38:48

Program 'poll_ellis'
  status                            Status ok
  monitoring status                 Monitored
  last started                      Wed, 23 Mar 2016 08:38:48
  last exit value                   1
  data collected                    Wed, 23 Mar 2016 08:38:48

Program 'poll_ellis_https'
  status                            Status ok
  monitoring status                 Monitored
  last started                      Wed, 23 Mar 2016 08:38:48
  last exit value                   0
  data collected                    Wed, 23 Mar 2016 08:38:48

Process 'clearwater_diags_monitor_process'
  status                            Running
  monitoring status                 Monitored
  pid                               1010
  parent pid                        1
  uid                               0
  effective uid                     0
  gid                               0
  uptime                            17m
  children                          1
  memory kilobytes                  3156
  memory kilobytes total            3848
  memory percent                    0.1%
  memory percent total              0.1%
  cpu percent                       0.1%
  cpu percent total                 0.1%
  data collected                    Wed, 23 Mar 2016 08:38:48

Process 'cassandra_process'
  status                            Running
  monitoring status                 Monitored
  pid                               1612
  parent pid                        1
  uid                               104
  effective uid                     104
  gid                               111
  uptime                            17m
  children                          0
  memory kilobytes                  863304
  memory kilobytes total            863304
  memory percent                    42.1%
  memory percent total              42.1%
  cpu percent                       2.7%
  cpu percent total                 2.7%
  data collected                    Wed, 23 Mar 2016 08:38:48

Program 'cassandra_uptime'
  status                            Waiting
  monitoring status                 Waiting
  last started                      Wed, 23 Mar 2016 08:36:26
  last exit value                   0
  data collected                    Wed, 23 Mar 2016 08:36:26

Program 'poll_cassandra'
  status                            Status ok
  monitoring status                 Monitored
  last started                      Wed, 23 Mar 2016 08:38:48
  last exit value                   0
  data collected                    Wed, 23 Mar 2016 08:38:48

Process 'chronos_process'
  status                            Running
  monitoring status                 Monitored
  pid                               1861
  parent pid                        1
  uid                               0
  effective uid                     0
  gid                               0
  uptime                            17m
  children                          0
  memory kilobytes                  31884
  memory kilobytes total            31884
  memory percent                    1.5%
  memory percent total              1.5%
  cpu percent                       0.5%
  cpu percent total                 0.5%
  data collected                    Wed, 23 Mar 2016 08:38:48

Program 'chronos_uptime'
  status                            Waiting
  monitoring status                 Waiting
  last started                      Wed, 23 Mar 2016 08:36:26
  last exit value                   0
  data collected                    Wed, 23 Mar 2016 08:36:26

Program 'poll_chronos'
  status                            Status ok
  monitoring status                 Monitored
  last started                      Wed, 23 Mar 2016 08:38:48
  last exit value                   0
  data collected                    Wed, 23 Mar 2016 08:38:48

Process 'bono_process'
  status                            Running
  monitoring status                 Monitored
  pid                               1542
  parent pid                        1
  uid                               996
  effective uid                     996
  gid                               996
  uptime                            17m
  children                          0
  memory kilobytes                  59824
  memory kilobytes total            59824
  memory percent                    2.9%
  memory percent total              2.9%
  cpu percent                       0.5%
  cpu percent total                 0.5%
  data collected                    Wed, 23 Mar 2016 08:38:48

Program 'poll_bono'
  status                            Status ok
  monitoring status                 Monitored
  last started                      Wed, 23 Mar 2016 08:38:48
  last exit value                   0
  data collected                    Wed, 23 Mar 2016 08:38:48

Process 'astaire_process'
  status                            Running
  monitoring status                 Monitored
  pid                               1529
  parent pid                        1
  uid                               999
  effective uid                     999
  gid                               999
  uptime                            17m
  children                          0
  memory kilobytes                  5844
  memory kilobytes total            5844
  memory percent                    0.2%
  memory percent total              0.2%
  cpu percent                       0.1%
  cpu percent total                 0.1%
  data collected                    Wed, 23 Mar 2016 08:38:48

Program 'astaire_uptime'
  status                            Waiting
  monitoring status                 Waiting
  last started                      Wed, 23 Mar 2016 08:36:26
  last exit value                   0
  data collected                    Wed, 23 Mar 2016 08:36:26

root at cw-aio:/etc/clearwater#


On Wed, Mar 23, 2016 at 9:55 AM, Franck Malka <fmalka at modulo.co.il> wrote:

> and did you restart the services?
>
>
> On Wed, Mar 23, 2016, 09:45 Adrian Schwartz <schwartazi at gmail.com> wrote:
>
>> Hi Franck
>> If you are refering to the shared_config and local_config
>> yes
>> I think that it is done automatic, but they reflect the local ip address
>> that I have
>> Adi
>>
>> On Wed, Mar 23, 2016 at 7:36 AM, Franck Malka <fmalka at modulo.co.il>
>> wrote:
>>
>>> Hi Adi,
>>>
>>> did you adjust the configuration file and restarted the services after
>>> your machine got its new ip address?
>>>
>>> Franck.
>>>
>>> On Wed, Mar 23, 2016, 05:05 Adrian Schwartz <schwartazi at gmail.com>
>>> wrote:
>>>
>>>> Hello Everyone
>>>> I downloaded the image file and installed it in my machine (kvm not
>>>> vmware)
>>>> I don't have DNS on the loacal machine, but the machine is getting ip
>>>> address from the DHCP server and is available from each neighboring
>>>> computer (they can ping or ssh to it)
>>>> According to what is written here,
>>>> http://clearwater.readthedocs.org/en/stable/All_in_one_OVF_Installation.html
>>>> I should be able to http to ellis (I guess by typing ip-address on a
>>>> web-browser)
>>>> When I do so  I get connection refuse error.
>>>> Moreover when I do wget ip-address:8080 on the clearwater machine I
>>>> receive similar error
>>>> When I do wget 127.0.0.1:8080 I recieve a response index file.
>>>>
>>>> Bellow, some error log.
>>>>
>>>> Regards
>>>> Adrian
>>>>
>>>>  cat ellis_20160322T190000Z.txt
>>>> 22-03-2016 19:44:15.351 UTC INFO main.py:115: Process 0 starting up
>>>> 22-03-2016 19:44:15.449 UTC WARNING homestead.py:309: Passing SIP
>>>> password in the clear over http
>>>> 22-03-2016 19:44:15.473 UTC WARNING iostream.py:507: Connect error on
>>>> fd 9: ECONNREFUSED
>>>> 22-03-2016 19:44:15.474 UTC ERROR homestead.py:68: Failed to ping
>>>> Homestead at http://192.168.1.19:8889/ping. Have you configured your
>>>> HOMESTEAD_URL?
>>>>
>>>> _______________________________________________
>>>> Clearwater mailing list
>>>> Clearwater at lists.projectclearwater.org
>>>>
>>>> http://lists.projectclearwater.org/mailman/listinfo/clearwater_lists.projectclearwater.org
>>>>
>>>
>>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.projectclearwater.org/pipermail/clearwater_lists.projectclearwater.org/attachments/20160323/1fc29bc6/attachment.html>

From marcellino.marchitto at altran.com  Tue Mar 22 19:57:43 2016
From: marcellino.marchitto at altran.com (Marchitto Marcellino)
Date: Tue, 22 Mar 2016 23:57:43 +0000
Subject: [Project Clearwater] HW requirements for clearwater vIMS nodes
	deployed on OpeStack Cloud
Message-ID: <8CB925E42B68A941930F536B2D28DDDA0109B7CC4C@XMB-DCFR-38.europe.corp.altran.com>

Goodmorning clearwater project,

I'm contacting you to have more information about Hardware Requirements of your vIMS Architecture. In order to deploy it in our Lab based on OpenStack Cloud manager I'd like to get an answer for the following items:


*         RAM, CPU, Storage for any Virtual Machines related to IMS nodes on large-scale deployment;

*         Hypervisor type

On website I got something like this: 2GB, 1vCPU (1GHz since Ubuntu), more then 1,75GB HD(since Ubuntu).
No info about Hypervisor compatibility.

Cloud you help me please?

Thank you very much,
Best Regards,
/Marcello

Marcellino Marchitto
Telecommunication & Media
BU Telco&Media
Adv. Consultant
Via Tiburtina, 1232
00131 Roma
Italy
Mob. : +393426959875
marcellino.marchitto at altran.com
www.altran.com<http://www.altran.com/>

Please consider the environment before printing.
"This message and any attachments (the "message") are confidential and intended for the sole use the address(es). Any unauthorised copy or dissemination is strictly prohibited. If you are not the intended recipient, please notify us promptly and delete such message from your inbox."


-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.projectclearwater.org/pipermail/clearwater_lists.projectclearwater.org/attachments/20160322/e258e468/attachment.html>

From chris at projectclearwater.org  Thu Mar 24 05:48:24 2016
From: chris at projectclearwater.org (Chris Elford (projectclearwater.org))
Date: Thu, 24 Mar 2016 09:48:24 +0000
Subject: [Project Clearwater] HW requirements for clearwater vIMS
	nodes	deployed on OpeStack Cloud
In-Reply-To: <8CB925E42B68A941930F536B2D28DDDA0109B7CC4C@XMB-DCFR-38.europe.corp.altran.com>
References: <8CB925E42B68A941930F536B2D28DDDA0109B7CC4C@XMB-DCFR-38.europe.corp.altran.com>
Message-ID: <SN1PR0201MB1856899B52115FF9EC4DC671E1820@SN1PR0201MB1856.namprd02.prod.outlook.com>

Hi Marcello,

Thanks for getting in touch.

As part of Project Clearwater development, we have tested on OpenStack, VMware, and AWS. We have used KVM for our OpenStack testing as it's the default, but other hypervisors should work.

We usually use small VMs. Our chef-created deployments in Amazon EC2 use VMs with 1vCPU, 2GB RAM, and 5GB storage. We have also done some testing on VMware using larger VMs: 2vCPUs, 4GB RAM, and 20GB storage. Project Clearwater scales by adding more nodes to the cluster, not increasing the size of the individual VMs, so these should be a reasonable place to start.

Please let us know if you have any more questions.

Yours,

Chris

From: Clearwater [mailto:clearwater-bounces at lists.projectclearwater.org] On Behalf Of Marchitto Marcellino
Sent: 22 March 2016 23:58
To: clearwater at lists.projectclearwater.org
Subject: [Project Clearwater] HW requirements for clearwater vIMS nodes deployed on OpeStack Cloud

Goodmorning clearwater project,

I'm contacting you to have more information about Hardware Requirements of your vIMS Architecture. In order to deploy it in our Lab based on OpenStack Cloud manager I'd like to get an answer for the following items:


*         RAM, CPU, Storage for any Virtual Machines related to IMS nodes on large-scale deployment;

*         Hypervisor type

On website I got something like this: 2GB, 1vCPU (1GHz since Ubuntu), more then 1,75GB HD(since Ubuntu).
No info about Hypervisor compatibility.

Cloud you help me please?

Thank you very much,
Best Regards,
/Marcello

Marcellino Marchitto
Telecommunication & Media
BU Telco&Media
Adv. Consultant
Via Tiburtina, 1232
00131 Roma
Italy
Mob. : +393426959875
marcellino.marchitto at altran.com<mailto:marcellino.marchitto at altran.com>
www.altran.com<http://www.altran.com/>

Please consider the environment before printing.
"This message and any attachments (the "message") are confidential and intended for the sole use the address(es). Any unauthorised copy or dissemination is strictly prohibited. If you are not the intended recipient, please notify us promptly and delete such message from your inbox."


-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.projectclearwater.org/pipermail/clearwater_lists.projectclearwater.org/attachments/20160324/b9a7c738/attachment.html>

From marcellino.marchitto at altran.com  Thu Mar 24 09:12:46 2016
From: marcellino.marchitto at altran.com (Marchitto Marcellino)
Date: Thu, 24 Mar 2016 13:12:46 +0000
Subject: [Project Clearwater] R: HW requirements for clearwater vIMS
	nodes	deployed on OpeStack Cloud
In-Reply-To: <SN1PR0201MB1856899B52115FF9EC4DC671E1820@SN1PR0201MB1856.namprd02.prod.outlook.com>
References: <8CB925E42B68A941930F536B2D28DDDA0109B7CC4C@XMB-DCFR-38.europe.corp.altran.com>
	<SN1PR0201MB1856899B52115FF9EC4DC671E1820@SN1PR0201MB1856.namprd02.prod.outlook.com>
Message-ID: <8CB925E42B68A941930F536B2D28DDDA0109B7D126@XMB-DCFR-38.europe.corp.altran.com>

Hi Chris,

firstly I want to thank you for quick reply and professionalism. Thank you for the answers.

So I'd want to add a bit about my intents and get more suggestions from you about Clearwater.

I'm an IMS Engineer and, unfortunately, I discovered Clearwater too late :). My idea is to create an environment to test an opensource orchestrator for basic ETSI use cases, scale up/down in/out the Clearwater vIMS VNFs, simple calls and basic IMS services. I'm thinking to implement software OPNFV architecture (Brahmaputra release) for this purpose and my opinion to dimension this TestPlant is to have the following:

Resources:

?         2 x 8 core CPU > 2.00 Ghz (Intel VT-X o AMD-V Capable)

?         64 GB RAM

?         2 x 500GB SAS HD (Raid 1/0)

NFVI will be created with OpenStack as Iaas infrastructure, KVM as hypervisor and Compute node, ONOS, OVS, OpenDaylight and OpenContrail for Network node, Ceph for Storage node. Then DPDK and ODP as Accelerators.

So the following architecture:
[cid:image001.png at 01D185D5.436D2650]

Moreover a MANO open software like cloudify (for example) to manage Onboarding, VNFs lifecycle, scale up/down/in/out, multiple VNFMs and VIMs ecc...

About number of VMs I think:

Virtual Machines:

?         7x2 VMs (Sprout, Bono, Homer, Ellis, Bind9, Homestead, Ralf) in a redundant configuration;

?         1 VMs for Openstck;

?         1 VM for Ceph;

?         1 VM for ONOS, OVS, OpenDaylight and OpenContrail

?         1 VM for OpenMANO or Cloudify

For the moment I'm thinking to get experience only on Openstack cloud, then I'll move to VMWare too.


?         Do you think these Resources and Virtual Machines are enough for my scope? What do you think ?

?         Do you see some limitation by Clearwater vIMS node side?

I'm sorry if I ask you so many things but your product is very interesting as testing purpose on NFV. I'm very grateful if you could answer to these my doubts.

Thank you very much,

I'm looking forward to hearing you.
Best Regards,
/Marcello

Da: Chris Elford (projectclearwater.org) [mailto:chris at projectclearwater.org]
Inviato: gioved? 24 marzo 2016 10:48
A: Marchitto Marcellino; clearwater at lists.projectclearwater.org
Oggetto: RE: [Project Clearwater] HW requirements for clearwater vIMS nodes deployed on OpeStack Cloud

Hi Marcello,

Thanks for getting in touch.

As part of Project Clearwater development, we have tested on OpenStack, VMware, and AWS. We have used KVM for our OpenStack testing as it's the default, but other hypervisors should work.

We usually use small VMs. Our chef-created deployments in Amazon EC2 use VMs with 1vCPU, 2GB RAM, and 5GB storage. We have also done some testing on VMware using larger VMs: 2vCPUs, 4GB RAM, and 20GB storage. Project Clearwater scales by adding more nodes to the cluster, not increasing the size of the individual VMs, so these should be a reasonable place to start.

Please let us know if you have any more questions.

Yours,

Chris

From: Clearwater [mailto:clearwater-bounces at lists.projectclearwater.org] On Behalf Of Marchitto Marcellino
Sent: 22 March 2016 23:58
To: clearwater at lists.projectclearwater.org<mailto:clearwater at lists.projectclearwater.org>
Subject: [Project Clearwater] HW requirements for clearwater vIMS nodes deployed on OpeStack Cloud

Goodmorning clearwater project,

I'm contacting you to have more information about Hardware Requirements of your vIMS Architecture. In order to deploy it in our Lab based on OpenStack Cloud manager I'd like to get an answer for the following items:


*         RAM, CPU, Storage for any Virtual Machines related to IMS nodes on large-scale deployment;

*         Hypervisor type

On website I got something like this: 2GB, 1vCPU (1GHz since Ubuntu), more then 1,75GB HD(since Ubuntu).
No info about Hypervisor compatibility.

Cloud you help me please?

Thank you very much,
Best Regards,
/Marcello

Marcellino Marchitto
Telecommunication & Media
BU Telco&Media
Adv. Consultant
Via Tiburtina, 1232
00131 Roma
Italy
Mob. : +393426959875
marcellino.marchitto at altran.com<mailto:marcellino.marchitto at altran.com>
www.altran.com<http://www.altran.com/>

Please consider the environment before printing.
"This message and any attachments (the "message") are confidential and intended for the sole use the address(es). Any unauthorised copy or dissemination is strictly prohibited. If you are not the intended recipient, please notify us promptly and delete such message from your inbox."


-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.projectclearwater.org/pipermail/clearwater_lists.projectclearwater.org/attachments/20160324/c4924503/attachment.html>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: image001.png
Type: image/png
Size: 42625 bytes
Desc: image001.png
URL: <http://lists.projectclearwater.org/pipermail/clearwater_lists.projectclearwater.org/attachments/20160324/c4924503/attachment.png>

From chris at projectclearwater.org  Tue Mar 29 04:43:41 2016
From: chris at projectclearwater.org (Chris Elford (projectclearwater.org))
Date: Tue, 29 Mar 2016 08:43:41 +0000
Subject: [Project Clearwater] HW requirements for clearwater vIMS
	nodes	deployed on OpeStack Cloud
In-Reply-To: <8CB925E42B68A941930F536B2D28DDDA0109B7D126@XMB-DCFR-38.europe.corp.altran.com>
References: <8CB925E42B68A941930F536B2D28DDDA0109B7CC4C@XMB-DCFR-38.europe.corp.altran.com>
	<SN1PR0201MB1856899B52115FF9EC4DC671E1820@SN1PR0201MB1856.namprd02.prod.outlook.com>
	<8CB925E42B68A941930F536B2D28DDDA0109B7D126@XMB-DCFR-38.europe.corp.altran.com>
Message-ID: <SN1PR0201MB1856243DDC3F867774BC7092E1870@SN1PR0201MB1856.namprd02.prod.outlook.com>

Hi Marcello,

In my experience, your suggested specification should be fine for use in a lab trail, in which you just place occasional calls. However, if you plan to send even low levels of load through the system, I'd recommend using the larger spec with 4GB RAM per node and 2vCPUs. This would require 28vCPUs and 56GB RAM - nearly all of the resources on your planned host. I recommend against over-provisioning resources for virtual telephony applications, as this can lead to unpredictable processing delays, and high latency.

One more suggestion. You are planning on using redundant Project Clearwater nodes in your deployment for resilience. However, you are still vulnerable to hardware failures as your host is a single point of failure. For a fully redundant system, you need at least two hosts, and you will need to set up anti-affinity rules to make sure that each of your pairs of nodes is split between the two hosts.

Given both of these points, I suggest adding a second host to your deployment.

Yours,

Chris

From: Marchitto Marcellino [mailto:marcellino.marchitto at altran.com]
Sent: 24 March 2016 13:13
To: Chris Elford (projectclearwater.org) <chris at projectclearwater.org>; clearwater at lists.projectclearwater.org
Subject: R: [Project Clearwater] HW requirements for clearwater vIMS nodes deployed on OpeStack Cloud

Hi Chris,

firstly I want to thank you for quick reply and professionalism. Thank you for the answers.

So I'd want to add a bit about my intents and get more suggestions from you about Clearwater.

I'm an IMS Engineer and, unfortunately, I discovered Clearwater too late :). My idea is to create an environment to test an opensource orchestrator for basic ETSI use cases, scale up/down in/out the Clearwater vIMS VNFs, simple calls and basic IMS services. I'm thinking to implement software OPNFV architecture (Brahmaputra release) for this purpose and my opinion to dimension this TestPlant is to have the following:

Resources:

?         2 x 8 core CPU > 2.00 Ghz (Intel VT-X o AMD-V Capable)

?         64 GB RAM

?         2 x 500GB SAS HD (Raid 1/0)

NFVI will be created with OpenStack as Iaas infrastructure, KVM as hypervisor and Compute node, ONOS, OVS, OpenDaylight and OpenContrail for Network node, Ceph for Storage node. Then DPDK and ODP as Accelerators.

So the following architecture:
[cid:image001.png at 01D1899E.0509A010]

Moreover a MANO open software like cloudify (for example) to manage Onboarding, VNFs lifecycle, scale up/down/in/out, multiple VNFMs and VIMs ecc...

About number of VMs I think:

Virtual Machines:

?         7x2 VMs (Sprout, Bono, Homer, Ellis, Bind9, Homestead, Ralf) in a redundant configuration;

?         1 VMs for Openstck;

?         1 VM for Ceph;

?         1 VM for ONOS, OVS, OpenDaylight and OpenContrail

?         1 VM for OpenMANO or Cloudify

For the moment I'm thinking to get experience only on Openstack cloud, then I'll move to VMWare too.


?         Do you think these Resources and Virtual Machines are enough for my scope? What do you think ?

?         Do you see some limitation by Clearwater vIMS node side?

I'm sorry if I ask you so many things but your product is very interesting as testing purpose on NFV. I'm very grateful if you could answer to these my doubts.

Thank you very much,

I'm looking forward to hearing you.
Best Regards,
/Marcello

Da: Chris Elford (projectclearwater.org) [mailto:chris at projectclearwater.org]
Inviato: gioved? 24 marzo 2016 10:48
A: Marchitto Marcellino; clearwater at lists.projectclearwater.org<mailto:clearwater at lists.projectclearwater.org>
Oggetto: RE: [Project Clearwater] HW requirements for clearwater vIMS nodes deployed on OpeStack Cloud

Hi Marcello,

Thanks for getting in touch.

As part of Project Clearwater development, we have tested on OpenStack, VMware, and AWS. We have used KVM for our OpenStack testing as it's the default, but other hypervisors should work.

We usually use small VMs. Our chef-created deployments in Amazon EC2 use VMs with 1vCPU, 2GB RAM, and 5GB storage. We have also done some testing on VMware using larger VMs: 2vCPUs, 4GB RAM, and 20GB storage. Project Clearwater scales by adding more nodes to the cluster, not increasing the size of the individual VMs, so these should be a reasonable place to start.

Please let us know if you have any more questions.

Yours,

Chris

From: Clearwater [mailto:clearwater-bounces at lists.projectclearwater.org] On Behalf Of Marchitto Marcellino
Sent: 22 March 2016 23:58
To: clearwater at lists.projectclearwater.org<mailto:clearwater at lists.projectclearwater.org>
Subject: [Project Clearwater] HW requirements for clearwater vIMS nodes deployed on OpeStack Cloud

Goodmorning clearwater project,

I'm contacting you to have more information about Hardware Requirements of your vIMS Architecture. In order to deploy it in our Lab based on OpenStack Cloud manager I'd like to get an answer for the following items:


*         RAM, CPU, Storage for any Virtual Machines related to IMS nodes on large-scale deployment;

*         Hypervisor type

On website I got something like this: 2GB, 1vCPU (1GHz since Ubuntu), more then 1,75GB HD(since Ubuntu).
No info about Hypervisor compatibility.

Cloud you help me please?

Thank you very much,
Best Regards,
/Marcello

Marcellino Marchitto
Telecommunication & Media
BU Telco&Media
Adv. Consultant
Via Tiburtina, 1232
00131 Roma
Italy
Mob. : +393426959875
marcellino.marchitto at altran.com<mailto:marcellino.marchitto at altran.com>
www.altran.com<http://www.altran.com/>

Please consider the environment before printing.
"This message and any attachments (the "message") are confidential and intended for the sole use the address(es). Any unauthorised copy or dissemination is strictly prohibited. If you are not the intended recipient, please notify us promptly and delete such message from your inbox."


-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.projectclearwater.org/pipermail/clearwater_lists.projectclearwater.org/attachments/20160329/a7ebd405/attachment.html>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: image001.png
Type: image/png
Size: 42625 bytes
Desc: image001.png
URL: <http://lists.projectclearwater.org/pipermail/clearwater_lists.projectclearwater.org/attachments/20160329/a7ebd405/attachment.png>

From chris at projectclearwater.org  Tue Mar 29 04:51:11 2016
From: chris at projectclearwater.org (Chris Elford (projectclearwater.org))
Date: Tue, 29 Mar 2016 08:51:11 +0000
Subject: [Project Clearwater] newbie all-in-one image hard-start
In-Reply-To: <CAOAmQy7+YEZUxBbT2iPqs5WkmZzqUc4+Kx16Gn5-iK2cpXXPwA@mail.gmail.com>
References: <CAOAmQy77qxeEVt-cjhRr9+sy5K986xwEoiVOhUTznLt4dWJN7Q@mail.gmail.com>
	<CAKX=ev1N=4_BQOKa4va5OqKEEqg1ymd1w7=3FL8pftj=bSGLxg@mail.gmail.com>
	<CAOAmQy4O3p3-Tp0Mo_L9fnpD6MeOwCS5XXaJT-tifuCqpr+h_Q@mail.gmail.com>
	<CAKX=ev2sCrbMNJqXP6HvEUE-O5YHgKijQJgQOUCA7FuPGDZ=pw@mail.gmail.com>
	<CAOAmQy7+YEZUxBbT2iPqs5WkmZzqUc4+Kx16Gn5-iK2cpXXPwA@mail.gmail.com>
Message-ID: <SN1PR0201MB1856901FE2603D03F202328DE1870@SN1PR0201MB1856.namprd02.prod.outlook.com>

Hi Adrian,

I may be able to help figure out what is going wrong here. Can you tell me a little more about how you installed your system, and what kind of virtualization environment you are running in? You say that you followed the instructions at http://clearwater.readthedocs.org/en/stable/All_in_one_OVF_Installation.html, but these instructions cover install on VMware, not KVM. Did you have to do anything special to get the OVF to install on KVM?

Yours,

Chris

From: Clearwater [mailto:clearwater-bounces at lists.projectclearwater.org] On Behalf Of Adrian Schwartz
Sent: 23 March 2016 08:42
To: Franck Malka <fmalka at modulo.co.il>
Cc: clearwater at lists.projectclearwater.org
Subject: Re: [Project Clearwater] newbie all-in-one image hard-start

I had both
restart the machine ity didnt helped so manually started ellis and homer and this didn't helped either.
attached monit log.


The Monit daemon 5.8.1 uptime: 16m

Process 'sprout_process'
  status                            Running
  monitoring status                 Monitored
  pid                               1646
  parent pid                        1
  uid                               993
  effective uid                     993
  gid                               993
  uptime                            16m
  children                          0
  memory kilobytes                  64724
  memory kilobytes total            64724
  memory percent                    3.1%
  memory percent total              3.1%
  cpu percent                       0.5%
  cpu percent total                 0.5%
  data collected                    Wed, 23 Mar 2016 08:37:48

Program 'sprout_uptime'
  status                            Waiting
  monitoring status                 Waiting
  last started                      Wed, 23 Mar 2016 08:35:26
  last exit value                   0
  data collected                    Wed, 23 Mar 2016 08:35:26

Program 'poll_sprout_sip'
  status                            Status ok
  monitoring status                 Monitored
  last started                      Wed, 23 Mar 2016 08:37:48
  last exit value                   0
  data collected                    Wed, 23 Mar 2016 08:37:48

Program 'poll_sprout_http'
  status                            Status ok
  monitoring status                 Monitored
  last started                      Wed, 23 Mar 2016 08:37:48
  last exit value                   0
  data collected                    Wed, 23 Mar 2016 08:37:48

Process 'snmpd_process'
  status                            Running
  monitoring status                 Monitored
  pid                               1036
  parent pid                        1
  uid                               108
  effective uid                     108
  gid                               114
  uptime                            16m
  children                          0
  memory kilobytes                  8080
  memory kilobytes total            8080
  memory percent                    0.3%
  memory percent total              0.3%
  cpu percent                       0.1%
  cpu percent total                 0.1%
  data collected                    Wed, 23 Mar 2016 08:37:48

Process 'restund_process'
  status                            Running
  monitoring status                 Monitored
  pid                               1842
  parent pid                        1
  uid                               997
  effective uid                     997
  gid                               997
  uptime                            16m
  children                          0
  memory kilobytes                  2452
  memory kilobytes total            2452
  memory percent                    0.1%
  memory percent total              0.1%
  cpu percent                       0.0%
  cpu percent total                 0.0%
  data collected                    Wed, 23 Mar 2016 08:37:48

Program 'poll_restund'
  status                            Status ok
  monitoring status                 Monitored
  last started                      Wed, 23 Mar 2016 08:37:48
  last exit value                   0
  data collected                    Wed, 23 Mar 2016 08:37:48

Process 'ntp_process'
  status                            Running
  monitoring status                 Monitored
  pid                               2171
  parent pid                        1
  uid                               106
  effective uid                     106
  gid                               112
  uptime                            16m
  children                          0
  memory kilobytes                  4260
  memory kilobytes total            4260
  memory percent                    0.2%
  memory percent total              0.2%
  cpu percent                       0.0%
  cpu percent total                 0.0%
  data collected                    Wed, 23 Mar 2016 08:37:48

System 'node-cw-aio.example.com<http://node-cw-aio.example.com>'
  status                            Running
  monitoring status                 Monitored
  load average                      [0.19] [0.20] [0.13]
  cpu                               13.5%us 2.3%sy 0.1%wa
  memory usage                      1234568 kB [60.2%]
  swap usage                        0 kB [0.0%]
  data collected                    Wed, 23 Mar 2016 08:37:48

Process 'nginx_process'
  status                            Execution failed
  monitoring status                 Monitored
  data collected                    Wed, 23 Mar 2016 08:38:48

Program 'nginx_uptime'
  status                            Initializing
  monitoring status                 Initializing
  data collected                    Wed, 23 Mar 2016 08:22:27

Process 'mysql_process'
  status                            Running
  monitoring status                 Monitored
  pid                               919
  parent pid                        1
  uid                               107
  effective uid                     107
  gid                               113
  uptime                            17m
  children                          0
  memory kilobytes                  53484
  memory kilobytes total            53484
  memory percent                    2.6%
  memory percent total              2.6%
  cpu percent                       0.1%
  cpu percent total                 0.1%
  unix socket response time         0.000s to /var/run/mysqld/mysqld.sock [DEFAULT]
  data collected                    Wed, 23 Mar 2016 08:38:48

Process 'memcached_process'
  status                            Running
  monitoring status                 Monitored
  pid                               2380
  parent pid                        1
  uid                               109
  effective uid                     109
  gid                               115
  uptime                            16m
  children                          0
  memory kilobytes                  3712
  memory kilobytes total            3712
  memory percent                    0.1%
  memory percent total              0.1%
  cpu percent                       0.0%
  cpu percent total                 0.0%
  data collected                    Wed, 23 Mar 2016 08:38:48

Program 'memcached_uptime'
  status                            Waiting
  monitoring status                 Waiting
  last started                      Wed, 23 Mar 2016 08:36:26
  last exit value                   0
  data collected                    Wed, 23 Mar 2016 08:36:26

Program 'poll_memcached'
  status                            Status ok
  monitoring status                 Monitored
  last started                      Wed, 23 Mar 2016 08:38:48
  last exit value                   0
  data collected                    Wed, 23 Mar 2016 08:38:48

Process 'homestead_process'
  status                            Running
  monitoring status                 Monitored
  pid                               2409
  parent pid                        1
  uid                               995
  effective uid                     995
  gid                               995
  uptime                            16m
  children                          0
  memory kilobytes                  29512
  memory kilobytes total            29512
  memory percent                    1.4%
  memory percent total              1.4%
  cpu percent                       0.0%
  cpu percent total                 0.0%
  data collected                    Wed, 23 Mar 2016 08:38:48

Program 'homestead_uptime'
  status                            Waiting
  monitoring status                 Waiting
  last started                      Wed, 23 Mar 2016 08:36:26
  last exit value                   0
  data collected                    Wed, 23 Mar 2016 08:36:26

Program 'poll_homestead'
  status                            Status ok
  monitoring status                 Monitored
  last started                      Wed, 23 Mar 2016 08:38:48
  last exit value                   0
  data collected                    Wed, 23 Mar 2016 08:38:48

Process 'homestead-prov_process'
  status                            Running
  monitoring status                 Monitored
  pid                               1829
  parent pid                        1
  uid                               0
  effective uid                     0
  gid                               0
  uptime                            17m
  children                          0
  memory kilobytes                  36640
  memory kilobytes total            36640
  memory percent                    1.7%
  memory percent total              1.7%
  cpu percent                       0.0%
  cpu percent total                 0.0%
  data collected                    Wed, 23 Mar 2016 08:38:48

Program 'poll_homestead-prov'
  status                            Status failed
  monitoring status                 Monitored
  last started                      Wed, 23 Mar 2016 08:38:48
  last exit value                   1
  data collected                    Wed, 23 Mar 2016 08:38:48

Process 'homer_process'
  status                            Running
  monitoring status                 Monitored
  pid                               8321
  parent pid                        1
  uid                               0
  effective uid                     0
  gid                               0
  uptime                            1m
  children                          0
  memory kilobytes                  37328
  memory kilobytes total            37328
  memory percent                    1.8%
  memory percent total              1.8%
  cpu percent                       0.0%
  cpu percent total                 0.0%
  data collected                    Wed, 23 Mar 2016 08:38:48

Program 'poll_homer'
  status                            Status ok
  monitoring status                 Monitored
  last started                      Wed, 23 Mar 2016 08:38:48
  last exit value                   1
  data collected                    Wed, 23 Mar 2016 08:38:48

Process 'ellis_process'
  status                            Running
  monitoring status                 Monitored
  pid                               8341
  parent pid                        1
  uid                               994
  effective uid                     994
  gid                               994
  uptime                            1m
  children                          2
  memory kilobytes                  27888
  memory kilobytes total            88752
  memory percent                    1.3%
  memory percent total              4.3%
  cpu percent                       0.0%
  cpu percent total                 0.0%
  data collected                    Wed, 23 Mar 2016 08:38:48

Program 'poll_ellis'
  status                            Status ok
  monitoring status                 Monitored
  last started                      Wed, 23 Mar 2016 08:38:48
  last exit value                   1
  data collected                    Wed, 23 Mar 2016 08:38:48

Program 'poll_ellis_https'
  status                            Status ok
  monitoring status                 Monitored
  last started                      Wed, 23 Mar 2016 08:38:48
  last exit value                   0
  data collected                    Wed, 23 Mar 2016 08:38:48

Process 'clearwater_diags_monitor_process'
  status                            Running
  monitoring status                 Monitored
  pid                               1010
  parent pid                        1
  uid                               0
  effective uid                     0
  gid                               0
  uptime                            17m
  children                          1
  memory kilobytes                  3156
  memory kilobytes total            3848
  memory percent                    0.1%
  memory percent total              0.1%
  cpu percent                       0.1%
  cpu percent total                 0.1%
  data collected                    Wed, 23 Mar 2016 08:38:48

Process 'cassandra_process'
  status                            Running
  monitoring status                 Monitored
  pid                               1612
  parent pid                        1
  uid                               104
  effective uid                     104
  gid                               111
  uptime                            17m
  children                          0
  memory kilobytes                  863304
  memory kilobytes total            863304
  memory percent                    42.1%
  memory percent total              42.1%
  cpu percent                       2.7%
  cpu percent total                 2.7%
  data collected                    Wed, 23 Mar 2016 08:38:48

Program 'cassandra_uptime'
  status                            Waiting
  monitoring status                 Waiting
  last started                      Wed, 23 Mar 2016 08:36:26
  last exit value                   0
  data collected                    Wed, 23 Mar 2016 08:36:26

Program 'poll_cassandra'
  status                            Status ok
  monitoring status                 Monitored
  last started                      Wed, 23 Mar 2016 08:38:48
  last exit value                   0
  data collected                    Wed, 23 Mar 2016 08:38:48

Process 'chronos_process'
  status                            Running
  monitoring status                 Monitored
  pid                               1861
  parent pid                        1
  uid                               0
  effective uid                     0
  gid                               0
  uptime                            17m
  children                          0
  memory kilobytes                  31884
  memory kilobytes total            31884
  memory percent                    1.5%
  memory percent total              1.5%
  cpu percent                       0.5%
  cpu percent total                 0.5%
  data collected                    Wed, 23 Mar 2016 08:38:48

Program 'chronos_uptime'
  status                            Waiting
  monitoring status                 Waiting
  last started                      Wed, 23 Mar 2016 08:36:26
  last exit value                   0
  data collected                    Wed, 23 Mar 2016 08:36:26

Program 'poll_chronos'
  status                            Status ok
  monitoring status                 Monitored
  last started                      Wed, 23 Mar 2016 08:38:48
  last exit value                   0
  data collected                    Wed, 23 Mar 2016 08:38:48

Process 'bono_process'
  status                            Running
  monitoring status                 Monitored
  pid                               1542
  parent pid                        1
  uid                               996
  effective uid                     996
  gid                               996
  uptime                            17m
  children                          0
  memory kilobytes                  59824
  memory kilobytes total            59824
  memory percent                    2.9%
  memory percent total              2.9%
  cpu percent                       0.5%
  cpu percent total                 0.5%
  data collected                    Wed, 23 Mar 2016 08:38:48

Program 'poll_bono'
  status                            Status ok
  monitoring status                 Monitored
  last started                      Wed, 23 Mar 2016 08:38:48
  last exit value                   0
  data collected                    Wed, 23 Mar 2016 08:38:48

Process 'astaire_process'
  status                            Running
  monitoring status                 Monitored
  pid                               1529
  parent pid                        1
  uid                               999
  effective uid                     999
  gid                               999
  uptime                            17m
  children                          0
  memory kilobytes                  5844
  memory kilobytes total            5844
  memory percent                    0.2%
  memory percent total              0.2%
  cpu percent                       0.1%
  cpu percent total                 0.1%
  data collected                    Wed, 23 Mar 2016 08:38:48

Program 'astaire_uptime'
  status                            Waiting
  monitoring status                 Waiting
  last started                      Wed, 23 Mar 2016 08:36:26
  last exit value                   0
  data collected                    Wed, 23 Mar 2016 08:36:26

root at cw-aio:/etc/clearwater#


On Wed, Mar 23, 2016 at 9:55 AM, Franck Malka <fmalka at modulo.co.il<mailto:fmalka at modulo.co.il>> wrote:
and did you restart the services?

On Wed, Mar 23, 2016, 09:45 Adrian Schwartz <schwartazi at gmail.com<mailto:schwartazi at gmail.com>> wrote:
Hi Franck
If you are refering to the shared_config and local_config
yes
I think that it is done automatic, but they reflect the local ip address that I have
Adi

On Wed, Mar 23, 2016 at 7:36 AM, Franck Malka <fmalka at modulo.co.il<mailto:fmalka at modulo.co.il>> wrote:
Hi Adi,

did you adjust the configuration file and restarted the services after your machine got its new ip address?

Franck.
On Wed, Mar 23, 2016, 05:05 Adrian Schwartz <schwartazi at gmail.com<mailto:schwartazi at gmail.com>> wrote:
Hello Everyone
I downloaded the image file and installed it in my machine (kvm not vmware)
I don't have DNS on the loacal machine, but the machine is getting ip address from the DHCP server and is available from each neighboring computer (they can ping or ssh to it)
According to what is written here, http://clearwater.readthedocs.org/en/stable/All_in_one_OVF_Installation.html
I should be able to http to ellis (I guess by typing ip-address on a web-browser)
When I do so  I get connection refuse error.
Moreover when I do wget ip-address:8080 on the clearwater machine I receive similar error
When I do wget 127.0.0.1:8080<http://127.0.0.1:8080> I recieve a response index file.

Bellow, some error log.

Regards
Adrian

 cat ellis_20160322T190000Z.txt
22-03-2016 19:44:15.351 UTC INFO main.py:115: Process 0 starting up
22-03-2016 19:44:15.449 UTC WARNING homestead.py:309: Passing SIP password in the clear over http
22-03-2016 19:44:15.473 UTC WARNING iostream.py:507: Connect error on fd 9: ECONNREFUSED
22-03-2016 19:44:15.474 UTC ERROR homestead.py:68: Failed to ping Homestead at http://192.168.1.19:8889/ping. Have you configured your HOMESTEAD_URL?

_______________________________________________
Clearwater mailing list
Clearwater at lists.projectclearwater.org<mailto:Clearwater at lists.projectclearwater.org>
http://lists.projectclearwater.org/mailman/listinfo/clearwater_lists.projectclearwater.org


-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.projectclearwater.org/pipermail/clearwater_lists.projectclearwater.org/attachments/20160329/d68ad0f5/attachment.html>

From schwartazi at gmail.com  Tue Mar 29 07:22:35 2016
From: schwartazi at gmail.com (Adrian Schwartz)
Date: Tue, 29 Mar 2016 14:22:35 +0300
Subject: [Project Clearwater] newbie all-in-one image hard-start
In-Reply-To: <SN1PR0201MB1856901FE2603D03F202328DE1870@SN1PR0201MB1856.namprd02.prod.outlook.com>
References: <CAOAmQy77qxeEVt-cjhRr9+sy5K986xwEoiVOhUTznLt4dWJN7Q@mail.gmail.com>
	<CAKX=ev1N=4_BQOKa4va5OqKEEqg1ymd1w7=3FL8pftj=bSGLxg@mail.gmail.com>
	<CAOAmQy4O3p3-Tp0Mo_L9fnpD6MeOwCS5XXaJT-tifuCqpr+h_Q@mail.gmail.com>
	<CAKX=ev2sCrbMNJqXP6HvEUE-O5YHgKijQJgQOUCA7FuPGDZ=pw@mail.gmail.com>
	<CAOAmQy7+YEZUxBbT2iPqs5WkmZzqUc4+Kx16Gn5-iK2cpXXPwA@mail.gmail.com>
	<SN1PR0201MB1856901FE2603D03F202328DE1870@SN1PR0201MB1856.namprd02.prod.outlook.com>
Message-ID: <CAOAmQy5XeRdZ5_c=MEDXTQorWdZ664vwEamWtMFs94Bdv9cbhQ@mail.gmail.com>

Hi Chris,
Thank you for answering.
I had changed the image from ova to qcow2 by extracting the ova file and
converting the vmdx file by using qemu-img convert.
I'm not sure that this is related cause I'm able to ping and ssh to the
machine.
Moreover I installed virtualbox over a laptop and also a installed the
 links2 command line web browserand tried to links2 127.0.0.1:8080.
I don't see anything interesting  there, only server status. So I'm not
sure,what does it means when the manual is writing "HTTP to ellis for
subscriber management "

 Should I change anything in the configuration as franck said  or all the
ip configuration are done automatic after DHCP assign ip address as stated
in the OVF installation guide.

Adrian


On Tue, Mar 29, 2016 at 11:51 AM, Chris Elford (projectclearwater.org) <
chris at projectclearwater.org> wrote:

> Hi Adrian,
>
>
>
> I may be able to help figure out what is going wrong here. Can you tell me
> a little more about how you installed your system, and what kind of
> virtualization environment you are running in? You say that you followed
> the instructions at
> http://clearwater.readthedocs.org/en/stable/All_in_one_OVF_Installation.html,
> but these instructions cover install on VMware, not KVM. Did you have to do
> anything special to get the OVF to install on KVM?
>
>
>
> Yours,
>
>
>
> Chris
>
>
>
> *From:* Clearwater [mailto:clearwater-bounces at lists.projectclearwater.org]
> *On Behalf Of *Adrian Schwartz
> *Sent:* 23 March 2016 08:42
> *To:* Franck Malka <fmalka at modulo.co.il>
> *Cc:* clearwater at lists.projectclearwater.org
> *Subject:* Re: [Project Clearwater] newbie all-in-one image hard-start
>
>
>
> I had both
>
> restart the machine ity didnt helped so manually started ellis and homer
> and this didn't helped either.
>
> attached monit log.
>
>
>
>
>
> The Monit daemon 5.8.1 uptime: 16m
>
>
>
> Process 'sprout_process'
>
>   status                            Running
>
>   monitoring status                 Monitored
>
>   pid                               1646
>
>   parent pid                        1
>
>   uid                               993
>
>   effective uid                     993
>
>   gid                               993
>
>   uptime                            16m
>
>   children                          0
>
>   memory kilobytes                  64724
>
>   memory kilobytes total            64724
>
>   memory percent                    3.1%
>
>   memory percent total              3.1%
>
>   cpu percent                       0.5%
>
>   cpu percent total                 0.5%
>
>   data collected                    Wed, 23 Mar 2016 08:37:48
>
>
>
> Program 'sprout_uptime'
>
>   status                            Waiting
>
>   monitoring status                 Waiting
>
>   last started                      Wed, 23 Mar 2016 08:35:26
>
>   last exit value                   0
>
>   data collected                    Wed, 23 Mar 2016 08:35:26
>
>
>
> Program 'poll_sprout_sip'
>
>   status                            Status ok
>
>   monitoring status                 Monitored
>
>   last started                      Wed, 23 Mar 2016 08:37:48
>
>   last exit value                   0
>
>   data collected                    Wed, 23 Mar 2016 08:37:48
>
>
>
> Program 'poll_sprout_http'
>
>   status                            Status ok
>
>   monitoring status                 Monitored
>
>   last started                      Wed, 23 Mar 2016 08:37:48
>
>   last exit value                   0
>
>   data collected                    Wed, 23 Mar 2016 08:37:48
>
>
>
> Process 'snmpd_process'
>
>   status                            Running
>
>   monitoring status                 Monitored
>
>   pid                               1036
>
>   parent pid                        1
>
>   uid                               108
>
>   effective uid                     108
>
>   gid                               114
>
>   uptime                            16m
>
>   children                          0
>
>   memory kilobytes                  8080
>
>   memory kilobytes total            8080
>
>   memory percent                    0.3%
>
>   memory percent total              0.3%
>
>   cpu percent                       0.1%
>
>   cpu percent total                 0.1%
>
>   data collected                    Wed, 23 Mar 2016 08:37:48
>
>
>
> Process 'restund_process'
>
>   status                            Running
>
>   monitoring status                 Monitored
>
>   pid                               1842
>
>   parent pid                        1
>
>   uid                               997
>
>   effective uid                     997
>
>   gid                               997
>
>   uptime                            16m
>
>   children                          0
>
>   memory kilobytes                  2452
>
>   memory kilobytes total            2452
>
>   memory percent                    0.1%
>
>   memory percent total              0.1%
>
>   cpu percent                       0.0%
>
>   cpu percent total                 0.0%
>
>   data collected                    Wed, 23 Mar 2016 08:37:48
>
>
>
> Program 'poll_restund'
>
>   status                            Status ok
>
>   monitoring status                 Monitored
>
>   last started                      Wed, 23 Mar 2016 08:37:48
>
>   last exit value                   0
>
>   data collected                    Wed, 23 Mar 2016 08:37:48
>
>
>
> Process 'ntp_process'
>
>   status                            Running
>
>   monitoring status                 Monitored
>
>   pid                               2171
>
>   parent pid                        1
>
>   uid                               106
>
>   effective uid                     106
>
>   gid                               112
>
>   uptime                            16m
>
>   children                          0
>
>   memory kilobytes                  4260
>
>   memory kilobytes total            4260
>
>   memory percent                    0.2%
>
>   memory percent total              0.2%
>
>   cpu percent                       0.0%
>
>   cpu percent total                 0.0%
>
>   data collected                    Wed, 23 Mar 2016 08:37:48
>
>
>
> System 'node-cw-aio.example.com'
>
>   status                            Running
>
>   monitoring status                 Monitored
>
>   load average                      [0.19] [0.20] [0.13]
>
>   cpu                               13.5%us 2.3%sy 0.1%wa
>
>   memory usage                      1234568 kB [60.2%]
>
>   swap usage                        0 kB [0.0%]
>
>   data collected                    Wed, 23 Mar 2016 08:37:48
>
>
>
> Process 'nginx_process'
>
>   status                            Execution failed
>
>   monitoring status                 Monitored
>
>   data collected                    Wed, 23 Mar 2016 08:38:48
>
>
>
> Program 'nginx_uptime'
>
>   status                            Initializing
>
>   monitoring status                 Initializing
>
>   data collected                    Wed, 23 Mar 2016 08:22:27
>
>
>
> Process 'mysql_process'
>
>   status                            Running
>
>   monitoring status                 Monitored
>
>   pid                               919
>
>   parent pid                        1
>
>   uid                               107
>
>   effective uid                     107
>
>   gid                               113
>
>   uptime                            17m
>
>   children                          0
>
>   memory kilobytes                  53484
>
>   memory kilobytes total            53484
>
>   memory percent                    2.6%
>
>   memory percent total              2.6%
>
>   cpu percent                       0.1%
>
>   cpu percent total                 0.1%
>
>   unix socket response time         0.000s to /var/run/mysqld/mysqld.sock
> [DEFAULT]
>
>   data collected                    Wed, 23 Mar 2016 08:38:48
>
>
>
> Process 'memcached_process'
>
>   status                            Running
>
>   monitoring status                 Monitored
>
>   pid                               2380
>
>   parent pid                        1
>
>   uid                               109
>
>   effective uid                     109
>
>   gid                               115
>
>   uptime                            16m
>
>   children                          0
>
>   memory kilobytes                  3712
>
>   memory kilobytes total            3712
>
>   memory percent                    0.1%
>
>   memory percent total              0.1%
>
>   cpu percent                       0.0%
>
>   cpu percent total                 0.0%
>
>   data collected                    Wed, 23 Mar 2016 08:38:48
>
>
>
> Program 'memcached_uptime'
>
>   status                            Waiting
>
>   monitoring status                 Waiting
>
>   last started                      Wed, 23 Mar 2016 08:36:26
>
>   last exit value                   0
>
>   data collected                    Wed, 23 Mar 2016 08:36:26
>
>
>
> Program 'poll_memcached'
>
>   status                            Status ok
>
>   monitoring status                 Monitored
>
>   last started                      Wed, 23 Mar 2016 08:38:48
>
>   last exit value                   0
>
>   data collected                    Wed, 23 Mar 2016 08:38:48
>
>
>
> Process 'homestead_process'
>
>   status                            Running
>
>   monitoring status                 Monitored
>
>   pid                               2409
>
>   parent pid                        1
>
>   uid                               995
>
>   effective uid                     995
>
>   gid                               995
>
>   uptime                            16m
>
>   children                          0
>
>   memory kilobytes                  29512
>
>   memory kilobytes total            29512
>
>   memory percent                    1.4%
>
>   memory percent total              1.4%
>
>   cpu percent                       0.0%
>
>   cpu percent total                 0.0%
>
>   data collected                    Wed, 23 Mar 2016 08:38:48
>
>
>
> Program 'homestead_uptime'
>
>   status                            Waiting
>
>   monitoring status                 Waiting
>
>   last started                      Wed, 23 Mar 2016 08:36:26
>
>   last exit value                   0
>
>   data collected                    Wed, 23 Mar 2016 08:36:26
>
>
>
> Program 'poll_homestead'
>
>   status                            Status ok
>
>   monitoring status                 Monitored
>
>   last started                      Wed, 23 Mar 2016 08:38:48
>
>   last exit value                   0
>
>   data collected                    Wed, 23 Mar 2016 08:38:48
>
>
>
> Process 'homestead-prov_process'
>
>   status                            Running
>
>   monitoring status                 Monitored
>
>   pid                               1829
>
>   parent pid                        1
>
>   uid                               0
>
>   effective uid                     0
>
>   gid                               0
>
>   uptime                            17m
>
>   children                          0
>
>   memory kilobytes                  36640
>
>   memory kilobytes total            36640
>
>   memory percent                    1.7%
>
>   memory percent total              1.7%
>
>   cpu percent                       0.0%
>
>   cpu percent total                 0.0%
>
>   data collected                    Wed, 23 Mar 2016 08:38:48
>
>
>
> Program 'poll_homestead-prov'
>
>   status                            Status failed
>
>   monitoring status                 Monitored
>
>   last started                      Wed, 23 Mar 2016 08:38:48
>
>   last exit value                   1
>
>   data collected                    Wed, 23 Mar 2016 08:38:48
>
>
>
> Process 'homer_process'
>
>   status                            Running
>
>   monitoring status                 Monitored
>
>   pid                               8321
>
>   parent pid                        1
>
>   uid                               0
>
>   effective uid                     0
>
>   gid                               0
>
>   uptime                            1m
>
>   children                          0
>
>   memory kilobytes                  37328
>
>   memory kilobytes total            37328
>
>   memory percent                    1.8%
>
>   memory percent total              1.8%
>
>   cpu percent                       0.0%
>
>   cpu percent total                 0.0%
>
>   data collected                    Wed, 23 Mar 2016 08:38:48
>
>
>
> Program 'poll_homer'
>
>   status                            Status ok
>
>   monitoring status                 Monitored
>
>   last started                      Wed, 23 Mar 2016 08:38:48
>
>   last exit value                   1
>
>   data collected                    Wed, 23 Mar 2016 08:38:48
>
>
>
> Process 'ellis_process'
>
>   status                            Running
>
>   monitoring status                 Monitored
>
>   pid                               8341
>
>   parent pid                        1
>
>   uid                               994
>
>   effective uid                     994
>
>   gid                               994
>
>   uptime                            1m
>
>   children                          2
>
>   memory kilobytes                  27888
>
>   memory kilobytes total            88752
>
>   memory percent                    1.3%
>
>   memory percent total              4.3%
>
>   cpu percent                       0.0%
>
>   cpu percent total                 0.0%
>
>   data collected                    Wed, 23 Mar 2016 08:38:48
>
>
>
> Program 'poll_ellis'
>
>   status                            Status ok
>
>   monitoring status                 Monitored
>
>   last started                      Wed, 23 Mar 2016 08:38:48
>
>   last exit value                   1
>
>   data collected                    Wed, 23 Mar 2016 08:38:48
>
>
>
> Program 'poll_ellis_https'
>
>   status                            Status ok
>
>   monitoring status                 Monitored
>
>   last started                      Wed, 23 Mar 2016 08:38:48
>
>   last exit value                   0
>
>   data collected                    Wed, 23 Mar 2016 08:38:48
>
>
>
> Process 'clearwater_diags_monitor_process'
>
>   status                            Running
>
>   monitoring status                 Monitored
>
>   pid                               1010
>
>   parent pid                        1
>
>   uid                               0
>
>   effective uid                     0
>
>   gid                               0
>
>   uptime                            17m
>
>   children                          1
>
>   memory kilobytes                  3156
>
>   memory kilobytes total            3848
>
>   memory percent                    0.1%
>
>   memory percent total              0.1%
>
>   cpu percent                       0.1%
>
>   cpu percent total                 0.1%
>
>   data collected                    Wed, 23 Mar 2016 08:38:48
>
>
>
> Process 'cassandra_process'
>
>   status                            Running
>
>   monitoring status                 Monitored
>
>   pid                               1612
>
>   parent pid                        1
>
>   uid                               104
>
>   effective uid                     104
>
>   gid                               111
>
>   uptime                            17m
>
>   children                          0
>
>   memory kilobytes                  863304
>
>   memory kilobytes total            863304
>
>   memory percent                    42.1%
>
>   memory percent total              42.1%
>
>   cpu percent                       2.7%
>
>   cpu percent total                 2.7%
>
>   data collected                    Wed, 23 Mar 2016 08:38:48
>
>
>
> Program 'cassandra_uptime'
>
>   status                            Waiting
>
>   monitoring status                 Waiting
>
>   last started                      Wed, 23 Mar 2016 08:36:26
>
>   last exit value                   0
>
>   data collected                    Wed, 23 Mar 2016 08:36:26
>
>
>
> Program 'poll_cassandra'
>
>   status                            Status ok
>
>   monitoring status                 Monitored
>
>   last started                      Wed, 23 Mar 2016 08:38:48
>
>   last exit value                   0
>
>   data collected                    Wed, 23 Mar 2016 08:38:48
>
>
>
> Process 'chronos_process'
>
>   status                            Running
>
>   monitoring status                 Monitored
>
>   pid                               1861
>
>   parent pid                        1
>
>   uid                               0
>
>   effective uid                     0
>
>   gid                               0
>
>   uptime                            17m
>
>   children                          0
>
>   memory kilobytes                  31884
>
>   memory kilobytes total            31884
>
>   memory percent                    1.5%
>
>   memory percent total              1.5%
>
>   cpu percent                       0.5%
>
>   cpu percent total                 0.5%
>
>   data collected                    Wed, 23 Mar 2016 08:38:48
>
>
>
> Program 'chronos_uptime'
>
>   status                            Waiting
>
>   monitoring status                 Waiting
>
>   last started                      Wed, 23 Mar 2016 08:36:26
>
>   last exit value                   0
>
>   data collected                    Wed, 23 Mar 2016 08:36:26
>
>
>
> Program 'poll_chronos'
>
>   status                            Status ok
>
>   monitoring status                 Monitored
>
>   last started                      Wed, 23 Mar 2016 08:38:48
>
>   last exit value                   0
>
>   data collected                    Wed, 23 Mar 2016 08:38:48
>
>
>
> Process 'bono_process'
>
>   status                            Running
>
>   monitoring status                 Monitored
>
>   pid                               1542
>
>   parent pid                        1
>
>   uid                               996
>
>   effective uid                     996
>
>   gid                               996
>
>   uptime                            17m
>
>   children                          0
>
>   memory kilobytes                  59824
>
>   memory kilobytes total            59824
>
>   memory percent                    2.9%
>
>   memory percent total              2.9%
>
>   cpu percent                       0.5%
>
>   cpu percent total                 0.5%
>
>   data collected                    Wed, 23 Mar 2016 08:38:48
>
>
>
> Program 'poll_bono'
>
>   status                            Status ok
>
>   monitoring status                 Monitored
>
>   last started                      Wed, 23 Mar 2016 08:38:48
>
>   last exit value                   0
>
>   data collected                    Wed, 23 Mar 2016 08:38:48
>
>
>
> Process 'astaire_process'
>
>   status                            Running
>
>   monitoring status                 Monitored
>
>   pid                               1529
>
>   parent pid                        1
>
>   uid                               999
>
>   effective uid                     999
>
>   gid                               999
>
>   uptime                            17m
>
>   children                          0
>
>   memory kilobytes                  5844
>
>   memory kilobytes total            5844
>
>   memory percent                    0.2%
>
>   memory percent total              0.2%
>
>   cpu percent                       0.1%
>
>   cpu percent total                 0.1%
>
>   data collected                    Wed, 23 Mar 2016 08:38:48
>
>
>
> Program 'astaire_uptime'
>
>   status                            Waiting
>
>   monitoring status                 Waiting
>
>   last started                      Wed, 23 Mar 2016 08:36:26
>
>   last exit value                   0
>
>   data collected                    Wed, 23 Mar 2016 08:36:26
>
>
>
> root at cw-aio:/etc/clearwater#
>
>
>
>
>
> On Wed, Mar 23, 2016 at 9:55 AM, Franck Malka <fmalka at modulo.co.il> wrote:
>
> and did you restart the services?
>
>
>
> On Wed, Mar 23, 2016, 09:45 Adrian Schwartz <schwartazi at gmail.com> wrote:
>
> Hi Franck
>
> If you are refering to the shared_config and local_config
>
> yes
>
> I think that it is done automatic, but they reflect the local ip address
> that I have
>
> Adi
>
>
>
> On Wed, Mar 23, 2016 at 7:36 AM, Franck Malka <fmalka at modulo.co.il> wrote:
>
> Hi Adi,
>
>
>
> did you adjust the configuration file and restarted the services after
> your machine got its new ip address?
>
>
>
> Franck.
>
> On Wed, Mar 23, 2016, 05:05 Adrian Schwartz <schwartazi at gmail.com> wrote:
>
> Hello Everyone
>
> I downloaded the image file and installed it in my machine (kvm not vmware)
>
> I don't have DNS on the loacal machine, but the machine is getting ip
> address from the DHCP server and is available from each neighboring
> computer (they can ping or ssh to it)
>
> According to what is written here,
> http://clearwater.readthedocs.org/en/stable/All_in_one_OVF_Installation.html
>
> I should be able to http to ellis (I guess by typing ip-address on a
> web-browser)
>
> When I do so  I get connection refuse error.
>
> Moreover when I do wget ip-address:8080 on the clearwater machine I
> receive similar error
>
> When I do wget 127.0.0.1:8080 I recieve a response index file.
>
>
>
> Bellow, some error log.
>
>
>
> Regards
>
> Adrian
>
>
>
>  cat ellis_20160322T190000Z.txt
>
> 22-03-2016 19:44:15.351 UTC INFO main.py:115: Process 0 starting up
>
> 22-03-2016 19:44:15.449 UTC WARNING homestead.py:309: Passing SIP password
> in the clear over http
>
> 22-03-2016 19:44:15.473 UTC WARNING iostream.py:507: Connect error on fd
> 9: ECONNREFUSED
>
> 22-03-2016 19:44:15.474 UTC ERROR homestead.py:68: Failed to ping
> Homestead at http://192.168.1.19:8889/ping. Have you configured your
> HOMESTEAD_URL?
>
>
>
> _______________________________________________
> Clearwater mailing list
> Clearwater at lists.projectclearwater.org
>
> http://lists.projectclearwater.org/mailman/listinfo/clearwater_lists.projectclearwater.org
>
>
>
>
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.projectclearwater.org/pipermail/clearwater_lists.projectclearwater.org/attachments/20160329/8dd9e8a0/attachment.html>

From chris at projectclearwater.org  Tue Mar 29 08:37:00 2016
From: chris at projectclearwater.org (Chris Elford (projectclearwater.org))
Date: Tue, 29 Mar 2016 12:37:00 +0000
Subject: [Project Clearwater] newbie all-in-one image hard-start
In-Reply-To: <CAOAmQy5XeRdZ5_c=MEDXTQorWdZ664vwEamWtMFs94Bdv9cbhQ@mail.gmail.com>
References: <CAOAmQy77qxeEVt-cjhRr9+sy5K986xwEoiVOhUTznLt4dWJN7Q@mail.gmail.com>
	<CAKX=ev1N=4_BQOKa4va5OqKEEqg1ymd1w7=3FL8pftj=bSGLxg@mail.gmail.com>
	<CAOAmQy4O3p3-Tp0Mo_L9fnpD6MeOwCS5XXaJT-tifuCqpr+h_Q@mail.gmail.com>
	<CAKX=ev2sCrbMNJqXP6HvEUE-O5YHgKijQJgQOUCA7FuPGDZ=pw@mail.gmail.com>
	<CAOAmQy7+YEZUxBbT2iPqs5WkmZzqUc4+Kx16Gn5-iK2cpXXPwA@mail.gmail.com>
	<SN1PR0201MB1856901FE2603D03F202328DE1870@SN1PR0201MB1856.namprd02.prod.outlook.com>
	<CAOAmQy5XeRdZ5_c=MEDXTQorWdZ664vwEamWtMFs94Bdv9cbhQ@mail.gmail.com>
Message-ID: <SN1PR0201MB185619D00CE8416A7A541A95E1870@SN1PR0201MB1856.namprd02.prod.outlook.com>

Hi Adrian,

You have the hostname of your AIO node. Have you tried using the web browser on your laptop to connect to http://<hostname<http://%3chostname>>? For example if your AIO node has IP address 192.168.0.3, you would type http://192.168.0.3 into the address bar of your browser?

Ellis normally runs on port 80, not 8080, so that may be the issue.

If that doesn?t work, can I check that I have the right picture of your setup? I think you have:

?         Project Clearwater AIO node running as a VM on KVM as part of e.g. an OpenStack deployment.

?         Another VM which you are using to run Linux with the links2 browser.

Yours,

Chris

From: Adrian Schwartz [mailto:schwartazi at gmail.com]
Sent: 29 March 2016 12:23
To: Chris Elford (projectclearwater.org) <chris at projectclearwater.org>
Cc: clearwater at lists.projectclearwater.org
Subject: Re: [Project Clearwater] newbie all-in-one image hard-start

Hi Chris,
Thank you for answering.
I had changed the image from ova to qcow2 by extracting the ova file and converting the vmdx file by using qemu-img convert.
I'm not sure that this is related cause I'm able to ping and ssh to the machine.
Moreover I installed virtualbox over a laptop and also a installed the  links2 command line web browserand tried to links2 127.0.0.1:8080<http://127.0.0.1:8080>.
I don't see anything interesting  there, only server status. So I'm not sure,what does it means when the manual is writing "HTTP to ellis for subscriber management "

 Should I change anything in the configuration as franck said  or all the ip configuration are done automatic after DHCP assign ip address as stated in the OVF installation guide.

Adrian


On Tue, Mar 29, 2016 at 11:51 AM, Chris Elford (projectclearwater.org<http://projectclearwater.org>) <chris at projectclearwater.org<mailto:chris at projectclearwater.org>> wrote:
Hi Adrian,

I may be able to help figure out what is going wrong here. Can you tell me a little more about how you installed your system, and what kind of virtualization environment you are running in? You say that you followed the instructions at http://clearwater.readthedocs.org/en/stable/All_in_one_OVF_Installation.html, but these instructions cover install on VMware, not KVM. Did you have to do anything special to get the OVF to install on KVM?

Yours,

Chris

From: Clearwater [mailto:clearwater-bounces at lists.projectclearwater.org<mailto:clearwater-bounces at lists.projectclearwater.org>] On Behalf Of Adrian Schwartz
Sent: 23 March 2016 08:42
To: Franck Malka <fmalka at modulo.co.il<mailto:fmalka at modulo.co.il>>
Cc: clearwater at lists.projectclearwater.org<mailto:clearwater at lists.projectclearwater.org>
Subject: Re: [Project Clearwater] newbie all-in-one image hard-start

I had both
restart the machine ity didnt helped so manually started ellis and homer and this didn't helped either.
attached monit log.


The Monit daemon 5.8.1 uptime: 16m

Process 'sprout_process'
  status                            Running
  monitoring status                 Monitored
  pid                               1646
  parent pid                        1
  uid                               993
  effective uid                     993
  gid                               993
  uptime                            16m
  children                          0
  memory kilobytes                  64724
  memory kilobytes total            64724
  memory percent                    3.1%
  memory percent total              3.1%
  cpu percent                       0.5%
  cpu percent total                 0.5%
  data collected                    Wed, 23 Mar 2016 08:37:48

Program 'sprout_uptime'
  status                            Waiting
  monitoring status                 Waiting
  last started                      Wed, 23 Mar 2016 08:35:26
  last exit value                   0
  data collected                    Wed, 23 Mar 2016 08:35:26

Program 'poll_sprout_sip'
  status                            Status ok
  monitoring status                 Monitored
  last started                      Wed, 23 Mar 2016 08:37:48
  last exit value                   0
  data collected                    Wed, 23 Mar 2016 08:37:48

Program 'poll_sprout_http'
  status                            Status ok
  monitoring status                 Monitored
  last started                      Wed, 23 Mar 2016 08:37:48
  last exit value                   0
  data collected                    Wed, 23 Mar 2016 08:37:48

Process 'snmpd_process'
  status                            Running
  monitoring status                 Monitored
  pid                               1036
  parent pid                        1
  uid                               108
  effective uid                     108
  gid                               114
  uptime                            16m
  children                          0
  memory kilobytes                  8080
  memory kilobytes total            8080
  memory percent                    0.3%
  memory percent total              0.3%
  cpu percent                       0.1%
  cpu percent total                 0.1%
  data collected                    Wed, 23 Mar 2016 08:37:48

Process 'restund_process'
  status                            Running
  monitoring status                 Monitored
  pid                               1842
  parent pid                        1
  uid                               997
  effective uid                     997
  gid                               997
  uptime                            16m
  children                          0
  memory kilobytes                  2452
  memory kilobytes total            2452
  memory percent                    0.1%
  memory percent total              0.1%
  cpu percent                       0.0%
  cpu percent total                 0.0%
  data collected                    Wed, 23 Mar 2016 08:37:48

Program 'poll_restund'
  status                            Status ok
  monitoring status                 Monitored
  last started                      Wed, 23 Mar 2016 08:37:48
  last exit value                   0
  data collected                    Wed, 23 Mar 2016 08:37:48

Process 'ntp_process'
  status                            Running
  monitoring status                 Monitored
  pid                               2171
  parent pid                        1
  uid                               106
  effective uid                     106
  gid                               112
  uptime                            16m
  children                          0
  memory kilobytes                  4260
  memory kilobytes total            4260
  memory percent                    0.2%
  memory percent total              0.2%
  cpu percent                       0.0%
  cpu percent total                 0.0%
  data collected                    Wed, 23 Mar 2016 08:37:48

System 'node-cw-aio.example.com<http://node-cw-aio.example.com>'
  status                            Running
  monitoring status                 Monitored
  load average                      [0.19] [0.20] [0.13]
  cpu                               13.5%us 2.3%sy 0.1%wa
  memory usage                      1234568 kB [60.2%]
  swap usage                        0 kB [0.0%]
  data collected                    Wed, 23 Mar 2016 08:37:48

Process 'nginx_process'
  status                            Execution failed
  monitoring status                 Monitored
  data collected                    Wed, 23 Mar 2016 08:38:48

Program 'nginx_uptime'
  status                            Initializing
  monitoring status                 Initializing
  data collected                    Wed, 23 Mar 2016 08:22:27

Process 'mysql_process'
  status                            Running
  monitoring status                 Monitored
  pid                               919
  parent pid                        1
  uid                               107
  effective uid                     107
  gid                               113
  uptime                            17m
  children                          0
  memory kilobytes                  53484
  memory kilobytes total            53484
  memory percent                    2.6%
  memory percent total              2.6%
  cpu percent                       0.1%
  cpu percent total                 0.1%
  unix socket response time         0.000s to /var/run/mysqld/mysqld.sock [DEFAULT]
  data collected                    Wed, 23 Mar 2016 08:38:48

Process 'memcached_process'
  status                            Running
  monitoring status                 Monitored
  pid                               2380
  parent pid                        1
  uid                               109
  effective uid                     109
  gid                               115
  uptime                            16m
  children                          0
  memory kilobytes                  3712
  memory kilobytes total            3712
  memory percent                    0.1%
  memory percent total              0.1%
  cpu percent                       0.0%
  cpu percent total                 0.0%
  data collected                    Wed, 23 Mar 2016 08:38:48

Program 'memcached_uptime'
  status                            Waiting
  monitoring status                 Waiting
  last started                      Wed, 23 Mar 2016 08:36:26
  last exit value                   0
  data collected                    Wed, 23 Mar 2016 08:36:26

Program 'poll_memcached'
  status                            Status ok
  monitoring status                 Monitored
  last started                      Wed, 23 Mar 2016 08:38:48
  last exit value                   0
  data collected                    Wed, 23 Mar 2016 08:38:48

Process 'homestead_process'
  status                            Running
  monitoring status                 Monitored
  pid                               2409
  parent pid                        1
  uid                               995
  effective uid                     995
  gid                               995
  uptime                            16m
  children                          0
  memory kilobytes                  29512
  memory kilobytes total            29512
  memory percent                    1.4%
  memory percent total              1.4%
  cpu percent                       0.0%
  cpu percent total                 0.0%
  data collected                    Wed, 23 Mar 2016 08:38:48

Program 'homestead_uptime'
  status                            Waiting
  monitoring status                 Waiting
  last started                      Wed, 23 Mar 2016 08:36:26
  last exit value                   0
  data collected                    Wed, 23 Mar 2016 08:36:26

Program 'poll_homestead'
  status                            Status ok
  monitoring status                 Monitored
  last started                      Wed, 23 Mar 2016 08:38:48
  last exit value                   0
  data collected                    Wed, 23 Mar 2016 08:38:48

Process 'homestead-prov_process'
  status                            Running
  monitoring status                 Monitored
  pid                               1829
  parent pid                        1
  uid                               0
  effective uid                     0
  gid                               0
  uptime                            17m
  children                          0
  memory kilobytes                  36640
  memory kilobytes total            36640
  memory percent                    1.7%
  memory percent total              1.7%
  cpu percent                       0.0%
  cpu percent total                 0.0%
  data collected                    Wed, 23 Mar 2016 08:38:48

Program 'poll_homestead-prov'
  status                            Status failed
  monitoring status                 Monitored
  last started                      Wed, 23 Mar 2016 08:38:48
  last exit value                   1
  data collected                    Wed, 23 Mar 2016 08:38:48

Process 'homer_process'
  status                            Running
  monitoring status                 Monitored
  pid                               8321
  parent pid                        1
  uid                               0
  effective uid                     0
  gid                               0
  uptime                            1m
  children                          0
  memory kilobytes                  37328
  memory kilobytes total            37328
  memory percent                    1.8%
  memory percent total              1.8%
  cpu percent                       0.0%
  cpu percent total                 0.0%
  data collected                    Wed, 23 Mar 2016 08:38:48

Program 'poll_homer'
  status                            Status ok
  monitoring status                 Monitored
  last started                      Wed, 23 Mar 2016 08:38:48
  last exit value                   1
  data collected                    Wed, 23 Mar 2016 08:38:48

Process 'ellis_process'
  status                            Running
  monitoring status                 Monitored
  pid                               8341
  parent pid                        1
  uid                               994
  effective uid                     994
  gid                               994
  uptime                            1m
  children                          2
  memory kilobytes                  27888
  memory kilobytes total            88752
  memory percent                    1.3%
  memory percent total              4.3%
  cpu percent                       0.0%
  cpu percent total                 0.0%
  data collected                    Wed, 23 Mar 2016 08:38:48

Program 'poll_ellis'
  status                            Status ok
  monitoring status                 Monitored
  last started                      Wed, 23 Mar 2016 08:38:48
  last exit value                   1
  data collected                    Wed, 23 Mar 2016 08:38:48

Program 'poll_ellis_https'
  status                            Status ok
  monitoring status                 Monitored
  last started                      Wed, 23 Mar 2016 08:38:48
  last exit value                   0
  data collected                    Wed, 23 Mar 2016 08:38:48

Process 'clearwater_diags_monitor_process'
  status                            Running
  monitoring status                 Monitored
  pid                               1010
  parent pid                        1
  uid                               0
  effective uid                     0
  gid                               0
  uptime                            17m
  children                          1
  memory kilobytes                  3156
  memory kilobytes total            3848
  memory percent                    0.1%
  memory percent total              0.1%
  cpu percent                       0.1%
  cpu percent total                 0.1%
  data collected                    Wed, 23 Mar 2016 08:38:48

Process 'cassandra_process'
  status                            Running
  monitoring status                 Monitored
  pid                               1612
  parent pid                        1
  uid                               104
  effective uid                     104
  gid                               111
  uptime                            17m
  children                          0
  memory kilobytes                  863304
  memory kilobytes total            863304
  memory percent                    42.1%
  memory percent total              42.1%
  cpu percent                       2.7%
  cpu percent total                 2.7%
  data collected                    Wed, 23 Mar 2016 08:38:48

Program 'cassandra_uptime'
  status                            Waiting
  monitoring status                 Waiting
  last started                      Wed, 23 Mar 2016 08:36:26
  last exit value                   0
  data collected                    Wed, 23 Mar 2016 08:36:26

Program 'poll_cassandra'
  status                            Status ok
  monitoring status                 Monitored
  last started                      Wed, 23 Mar 2016 08:38:48
  last exit value                   0
  data collected                    Wed, 23 Mar 2016 08:38:48

Process 'chronos_process'
  status                            Running
  monitoring status                 Monitored
  pid                               1861
  parent pid                        1
  uid                               0
  effective uid                     0
  gid                               0
  uptime                            17m
  children                          0
  memory kilobytes                  31884
  memory kilobytes total            31884
  memory percent                    1.5%
  memory percent total              1.5%
  cpu percent                       0.5%
  cpu percent total                 0.5%
  data collected                    Wed, 23 Mar 2016 08:38:48

Program 'chronos_uptime'
  status                            Waiting
  monitoring status                 Waiting
  last started                      Wed, 23 Mar 2016 08:36:26
  last exit value                   0
  data collected                    Wed, 23 Mar 2016 08:36:26

Program 'poll_chronos'
  status                            Status ok
  monitoring status                 Monitored
  last started                      Wed, 23 Mar 2016 08:38:48
  last exit value                   0
  data collected                    Wed, 23 Mar 2016 08:38:48

Process 'bono_process'
  status                            Running
  monitoring status                 Monitored
  pid                               1542
  parent pid                        1
  uid                               996
  effective uid                     996
  gid                               996
  uptime                            17m
  children                          0
  memory kilobytes                  59824
  memory kilobytes total            59824
  memory percent                    2.9%
  memory percent total              2.9%
  cpu percent                       0.5%
  cpu percent total                 0.5%
  data collected                    Wed, 23 Mar 2016 08:38:48

Program 'poll_bono'
  status                            Status ok
  monitoring status                 Monitored
  last started                      Wed, 23 Mar 2016 08:38:48
  last exit value                   0
  data collected                    Wed, 23 Mar 2016 08:38:48

Process 'astaire_process'
  status                            Running
  monitoring status                 Monitored
  pid                               1529
  parent pid                        1
  uid                               999
  effective uid                     999
  gid                               999
  uptime                            17m
  children                          0
  memory kilobytes                  5844
  memory kilobytes total            5844
  memory percent                    0.2%
  memory percent total              0.2%
  cpu percent                       0.1%
  cpu percent total                 0.1%
  data collected                    Wed, 23 Mar 2016 08:38:48

Program 'astaire_uptime'
  status                            Waiting
  monitoring status                 Waiting
  last started                      Wed, 23 Mar 2016 08:36:26
  last exit value                   0
  data collected                    Wed, 23 Mar 2016 08:36:26

root at cw-aio:/etc/clearwater#


On Wed, Mar 23, 2016 at 9:55 AM, Franck Malka <fmalka at modulo.co.il<mailto:fmalka at modulo.co.il>> wrote:
and did you restart the services?

On Wed, Mar 23, 2016, 09:45 Adrian Schwartz <schwartazi at gmail.com<mailto:schwartazi at gmail.com>> wrote:
Hi Franck
If you are refering to the shared_config and local_config
yes
I think that it is done automatic, but they reflect the local ip address that I have
Adi

On Wed, Mar 23, 2016 at 7:36 AM, Franck Malka <fmalka at modulo.co.il<mailto:fmalka at modulo.co.il>> wrote:
Hi Adi,

did you adjust the configuration file and restarted the services after your machine got its new ip address?

Franck.
On Wed, Mar 23, 2016, 05:05 Adrian Schwartz <schwartazi at gmail.com<mailto:schwartazi at gmail.com>> wrote:
Hello Everyone
I downloaded the image file and installed it in my machine (kvm not vmware)
I don't have DNS on the loacal machine, but the machine is getting ip address from the DHCP server and is available from each neighboring computer (they can ping or ssh to it)
According to what is written here, http://clearwater.readthedocs.org/en/stable/All_in_one_OVF_Installation.html
I should be able to http to ellis (I guess by typing ip-address on a web-browser)
When I do so  I get connection refuse error.
Moreover when I do wget ip-address:8080 on the clearwater machine I receive similar error
When I do wget 127.0.0.1:8080<http://127.0.0.1:8080> I recieve a response index file.

Bellow, some error log.

Regards
Adrian

 cat ellis_20160322T190000Z.txt
22-03-2016 19:44:15.351 UTC INFO main.py:115: Process 0 starting up
22-03-2016 19:44:15.449 UTC WARNING homestead.py:309: Passing SIP password in the clear over http
22-03-2016 19:44:15.473 UTC WARNING iostream.py:507: Connect error on fd 9: ECONNREFUSED
22-03-2016 19:44:15.474 UTC ERROR homestead.py:68: Failed to ping Homestead at http://192.168.1.19:8889/ping. Have you configured your HOMESTEAD_URL?

_______________________________________________
Clearwater mailing list
Clearwater at lists.projectclearwater.org<mailto:Clearwater at lists.projectclearwater.org>
http://lists.projectclearwater.org/mailman/listinfo/clearwater_lists.projectclearwater.org



-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.projectclearwater.org/pipermail/clearwater_lists.projectclearwater.org/attachments/20160329/d5c96af2/attachment.html>

From budasterisk at gmail.com  Tue Mar 29 09:07:50 2016
From: budasterisk at gmail.com (Bud Asterisk)
Date: Tue, 29 Mar 2016 09:07:50 -0400
Subject: [Project Clearwater] New install failure:unable to locate packages
Message-ID: <CAGCNiJ+6rexOsLc-FCzXJCxSiO4J9j0hdNAqdX5vBkbdXFiQnw@mail.gmail.com>

Hi gang,


Saw the prior thread on this and have issues


XXX at Bono:~$ sudo DEBIAN_FRONTEND=noninteractive apt-get install bono
restund --yes
[sudo] password for XXX:
Reading package lists... Done
Building dependency tree
Reading state information... Done
E: Unable to locate package bono
E: Unable to locate package restund
XXX at Bono:~$


XXX at Bono:~$ uname -a
Linux Bono 3.19.0-25-generic #26~14.04.1-Ubuntu SMP Fri Jul 24 21:18:00 UTC
2015 i686 i686 i686 GNU/Linux
XXX at Bono:~$


Thoughts?
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.projectclearwater.org/pipermail/clearwater_lists.projectclearwater.org/attachments/20160329/286384d7/attachment.html>

From Chris.Elford at metaswitch.com  Tue Mar 29 09:22:50 2016
From: Chris.Elford at metaswitch.com (Chris Elford)
Date: Tue, 29 Mar 2016 13:22:50 +0000
Subject: [Project Clearwater] New install failure:unable to locate
 packages
In-Reply-To: <CAGCNiJ+6rexOsLc-FCzXJCxSiO4J9j0hdNAqdX5vBkbdXFiQnw@mail.gmail.com>
References: <CAGCNiJ+6rexOsLc-FCzXJCxSiO4J9j0hdNAqdX5vBkbdXFiQnw@mail.gmail.com>
Message-ID: <SN1PR0201MB185610B1FE00E2F9F0621038E1870@SN1PR0201MB1856.namprd02.prod.outlook.com>

Hi,

Are you following our manual install instructions at http://clearwater.readthedocs.org/en/stable/Manual_Install.html#manual-install-instructions? It looks like you don?t have the right APT software sources installed. You should be able to get them by following the instructions at http://clearwater.readthedocs.org/en/stable/Manual_Install.html#configure-the-apt-software-sources.

It?s also worth taking a quick read through http://clearwater.readthedocs.org/en/stable/Installation_Instructions.html to make sure that installing by hand is the best option for you. We recommend the all-in-one image for trying Project Clearwater out for the first time. This comes as an AMI for EC2, or an OVF image, so should be simple to set up.

Yours,

Chris

From: Clearwater [mailto:clearwater-bounces at lists.projectclearwater.org] On Behalf Of Bud Asterisk
Sent: 29 March 2016 14:08
To: clearwater at lists.projectclearwater.org
Subject: [Project Clearwater] New install failure:unable to locate packages

Hi gang,

Saw the prior thread on this and have issues


XXX at Bono:~$ sudo DEBIAN_FRONTEND=noninteractive apt-get install bono restund --yes
[sudo] password for XXX:
Reading package lists... Done
Building dependency tree
Reading state information... Done
E: Unable to locate package bono
E: Unable to locate package restund
XXX at Bono:~$


XXX at Bono:~$ uname -a
Linux Bono 3.19.0-25-generic #26~14.04.1-Ubuntu SMP Fri Jul 24 21:18:00 UTC 2015 i686 i686 i686 GNU/Linux
XXX at Bono:~$

Thoughts?
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.projectclearwater.org/pipermail/clearwater_lists.projectclearwater.org/attachments/20160329/2a0b9b0f/attachment.html>

From budasterisk at gmail.com  Tue Mar 29 09:53:11 2016
From: budasterisk at gmail.com (Bud Asterisk)
Date: Tue, 29 Mar 2016 09:53:11 -0400
Subject: [Project Clearwater] Fwd: New install failure:unable to locate
	packages
In-Reply-To: <CAGCNiJ+ivh7yo_KXb1y+Vfcy0NTUYSJQjQB974LcxJjSm3-j9Q@mail.gmail.com>
References: <CAGCNiJ+6rexOsLc-FCzXJCxSiO4J9j0hdNAqdX5vBkbdXFiQnw@mail.gmail.com>
	<SN1PR0201MB185610B1FE00E2F9F0621038E1870@SN1PR0201MB1856.namprd02.prod.outlook.com>
	<CAGCNiJ+ivh7yo_KXb1y+Vfcy0NTUYSJQjQB974LcxJjSm3-j9Q@mail.gmail.com>
Message-ID: <CAGCNiJ+RudiSFbTa92U+CxUFTd7BSvz2e_OtnrRPunnaV_1N3g@mail.gmail.com>

Chris:


deb http://repo.cw-ngv.com/stable binary/
/etc/apt/sources.list.d/clearwater.list (END)

Yes am following the instructions, should have posted this in my original
email. I would have gone the OVF route but I need Ralf functionality which
I read was not included.

If I stick  http://repo.cw-ngv.com/stable binary/ in my browser it comes
back 404 so either it does not exists or I suspect the space in the url is
causing me grief for some reason.






On Tue, Mar 29, 2016 at 9:22 AM, Chris Elford <Chris.Elford at metaswitch.com>
wrote:

> Hi,
>
>
>
> Are you following our manual install instructions at
> http://clearwater.readthedocs.org/en/stable/Manual_Install.html#manual-install-instructions?
> It looks like you don?t have the right APT software sources installed. You
> should be able to get them by following the instructions at
> http://clearwater.readthedocs.org/en/stable/Manual_Install.html#configure-the-apt-software-sources
> .
>
>
>
> It?s also worth taking a quick read through
> http://clearwater.readthedocs.org/en/stable/Installation_Instructions.html
> to make sure that installing by hand is the best option for you. We
> recommend the all-in-one image for trying Project Clearwater out for the
> first time. This comes as an AMI for EC2, or an OVF image, so should be
> simple to set up.
>
>
>
> Yours,
>
>
>
> Chris
>
>
>
> *From:* Clearwater [mailto:clearwater-bounces at lists.projectclearwater.org]
> *On Behalf Of *Bud Asterisk
> *Sent:* 29 March 2016 14:08
> *To:* clearwater at lists.projectclearwater.org
> *Subject:* [Project Clearwater] New install failure:unable to locate
> packages
>
>
>
> Hi gang,
>
> Saw the prior thread on this and have issues
>
>
> XXX at Bono:~$ sudo DEBIAN_FRONTEND=noninteractive apt-get install bono
> restund --yes
> [sudo] password for XXX:
> Reading package lists... Done
> Building dependency tree
> Reading state information... Done
> E: Unable to locate package bono
> E: Unable to locate package restund
> XXX at Bono:~$
>
>
> XXX at Bono:~$ uname -a
> Linux Bono 3.19.0-25-generic #26~14.04.1-Ubuntu SMP Fri Jul 24 21:18:00
> UTC 2015 i686 i686 i686 GNU/Linux
> XXX at Bono:~$
>
> Thoughts?
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.projectclearwater.org/pipermail/clearwater_lists.projectclearwater.org/attachments/20160329/7e91923d/attachment.html>

From budasterisk at gmail.com  Tue Mar 29 15:21:13 2016
From: budasterisk at gmail.com (Bud Asterisk)
Date: Tue, 29 Mar 2016 15:21:13 -0400
Subject: [Project Clearwater] New install failure:unable to locate
	packages
In-Reply-To: <CAGCNiJL1gFB0dwEno3u1RQ+fxzT1c1jNVgPB=F4WMvd+bP_azw@mail.gmail.com>
References: <CAGCNiJ+6rexOsLc-FCzXJCxSiO4J9j0hdNAqdX5vBkbdXFiQnw@mail.gmail.com>
	<SN1PR0201MB185610B1FE00E2F9F0621038E1870@SN1PR0201MB1856.namprd02.prod.outlook.com>
	<CAGCNiJ+ivh7yo_KXb1y+Vfcy0NTUYSJQjQB974LcxJjSm3-j9Q@mail.gmail.com>
	<SN1PR0201MB185692D61AF473CA0A5CD786E1870@SN1PR0201MB1856.namprd02.prod.outlook.com>
	<CAGCNiJL1gFB0dwEno3u1RQ+fxzT1c1jNVgPB=F4WMvd+bP_azw@mail.gmail.com>
Message-ID: <CAGCNiJK3GRSaW0HoD3QW4WY_8DFW6130+d9NcRRPeyo7VSOypg@mail.gmail.com>

shame shame shame on Bud....not sure how I missed that one! am rebuilding
my VMs.

On Tue, Mar 29, 2016 at 12:45 PM, Bud Asterisk <budasterisk at gmail.com>
wrote:

> Oh man I feel dumb now! Thanks :)
>
> Not sure how I misinterpreted the uname output.
>
> On Tue, Mar 29, 2016 at 11:32 AM, Chris Elford <
> Chris.Elford at metaswitch.com> wrote:
>
>> That makes sense.
>>
>>
>>
>> It looks like you are running on a 32-bit system. All of the Project
>> Clearwater binaries are built for 64-bit only, and only run on 64-bit
>> Linux. It may be possible to build a 32-bit version, but it?s probably
>> going to be much quicker to spin up a new VM using a 64-bit version of
>> Ubuntu.
>>
>>
>>
>> Yours,
>>
>>
>>
>> Chris
>>
>>
>>
>> *From:* Bud Asterisk [mailto:budasterisk at gmail.com]
>> *Sent:* 29 March 2016 14:30
>> *To:* Chris Elford <Chris.Elford at metaswitch.com>
>> *Subject:* Re: [Project Clearwater] New install failure:unable to locate
>> packages
>>
>>
>>
>> Chris:
>>
>>
>> deb http://repo.cw-ngv.com/stable binary/
>> /etc/apt/sources.list.d/clearwater.list (END)
>>
>> Yes am following the instructions, should have posted this in my original
>> email. I would have gone the OVF route but I need Ralf functionality which
>> I read was not included.
>>
>> If I stick  http://repo.cw-ngv.com/stable binary/ in my browser it comes
>> back 404 so either it does not exists or I suspect the space in the url is
>> causing me grief for some reason.
>>
>>
>>
>>
>>
>>
>>
>> On Tue, Mar 29, 2016 at 9:22 AM, Chris Elford <
>> Chris.Elford at metaswitch.com> wrote:
>>
>> Hi,
>>
>>
>>
>> Are you following our manual install instructions at
>> http://clearwater.readthedocs.org/en/stable/Manual_Install.html#manual-install-instructions?
>> It looks like you don?t have the right APT software sources installed. You
>> should be able to get them by following the instructions at
>> http://clearwater.readthedocs.org/en/stable/Manual_Install.html#configure-the-apt-software-sources
>> .
>>
>>
>>
>> It?s also worth taking a quick read through
>> http://clearwater.readthedocs.org/en/stable/Installation_Instructions.html
>> to make sure that installing by hand is the best option for you. We
>> recommend the all-in-one image for trying Project Clearwater out for the
>> first time. This comes as an AMI for EC2, or an OVF image, so should be
>> simple to set up.
>>
>>
>>
>> Yours,
>>
>>
>>
>> Chris
>>
>>
>>
>> *From:* Clearwater [mailto:clearwater-bounces at lists.projectclearwater.org]
>> *On Behalf Of *Bud Asterisk
>> *Sent:* 29 March 2016 14:08
>> *To:* clearwater at lists.projectclearwater.org
>> *Subject:* [Project Clearwater] New install failure:unable to locate
>> packages
>>
>>
>>
>> Hi gang,
>>
>> Saw the prior thread on this and have issues
>>
>>
>> XXX at Bono:~$ sudo DEBIAN_FRONTEND=noninteractive apt-get install bono
>> restund --yes
>> [sudo] password for XXX:
>> Reading package lists... Done
>> Building dependency tree
>> Reading state information... Done
>> E: Unable to locate package bono
>> E: Unable to locate package restund
>> XXX at Bono:~$
>>
>>
>> XXX at Bono:~$ uname -a
>> Linux Bono 3.19.0-25-generic #26~14.04.1-Ubuntu SMP Fri Jul 24 21:18:00
>> UTC 2015 i686 i686 i686 GNU/Linux
>> XXX at Bono:~$
>>
>> Thoughts?
>>
>>
>>
>
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.projectclearwater.org/pipermail/clearwater_lists.projectclearwater.org/attachments/20160329/62ddbd71/attachment.html>

From schwartazi at gmail.com  Wed Mar 30 08:39:08 2016
From: schwartazi at gmail.com (Adrian Schwartz)
Date: Wed, 30 Mar 2016 15:39:08 +0300
Subject: [Project Clearwater] newbie all-in-one image hard-start
In-Reply-To: <SN1PR0201MB185619D00CE8416A7A541A95E1870@SN1PR0201MB1856.namprd02.prod.outlook.com>
References: <CAOAmQy77qxeEVt-cjhRr9+sy5K986xwEoiVOhUTznLt4dWJN7Q@mail.gmail.com>
	<CAKX=ev1N=4_BQOKa4va5OqKEEqg1ymd1w7=3FL8pftj=bSGLxg@mail.gmail.com>
	<CAOAmQy4O3p3-Tp0Mo_L9fnpD6MeOwCS5XXaJT-tifuCqpr+h_Q@mail.gmail.com>
	<CAKX=ev2sCrbMNJqXP6HvEUE-O5YHgKijQJgQOUCA7FuPGDZ=pw@mail.gmail.com>
	<CAOAmQy7+YEZUxBbT2iPqs5WkmZzqUc4+Kx16Gn5-iK2cpXXPwA@mail.gmail.com>
	<SN1PR0201MB1856901FE2603D03F202328DE1870@SN1PR0201MB1856.namprd02.prod.outlook.com>
	<CAOAmQy5XeRdZ5_c=MEDXTQorWdZ664vwEamWtMFs94Bdv9cbhQ@mail.gmail.com>
	<SN1PR0201MB185619D00CE8416A7A541A95E1870@SN1PR0201MB1856.namprd02.prod.outlook.com>
Message-ID: <CAOAmQy4u_sjp5cjuo30UFtSC6Qwm40qLYL80_5ry7ZR1vtvkVg@mail.gmail.com>

Hi Chris
I installed the VM image in a virtual box in a laptop. This seems to be ok,
I can access the site over web interface in my host.
I still need to understand how to configure this on the other system but
this is a start.
Thanks
Adrian

On Tue, Mar 29, 2016 at 3:37 PM, Chris Elford (projectclearwater.org) <
chris at projectclearwater.org> wrote:

> Hi Adrian,
>
>
>
> You have the hostname of your AIO node. Have you tried using the web
> browser on your laptop to connect to http://<hostname>? For example if
> your AIO node has IP address 192.168.0.3, you would type
> http://192.168.0.3 into the address bar of your browser?
>
>
>
> Ellis normally runs on port 80, not 8080, so that may be the issue.
>
>
>
> If that doesn?t work, can I check that I have the right picture of your
> setup? I think you have:
>
> ?         Project Clearwater AIO node running as a VM on KVM as part of
> e.g. an OpenStack deployment.
>
> ?         Another VM which you are using to run Linux with the links2
> browser.
>
>
>
> Yours,
>
>
>
> Chris
>
>
>
> *From:* Adrian Schwartz [mailto:schwartazi at gmail.com]
> *Sent:* 29 March 2016 12:23
> *To:* Chris Elford (projectclearwater.org) <chris at projectclearwater.org>
> *Cc:* clearwater at lists.projectclearwater.org
> *Subject:* Re: [Project Clearwater] newbie all-in-one image hard-start
>
>
>
> Hi Chris,
>
> Thank you for answering.
>
> I had changed the image from ova to qcow2 by extracting the ova file and
> converting the vmdx file by using qemu-img convert.
>
> I'm not sure that this is related cause I'm able to ping and ssh to the
> machine.
>
> Moreover I installed virtualbox over a laptop and also a installed the
>  links2 command line web browserand tried to links2 127.0.0.1:8080.
>
> I don't see anything interesting  there, only server status. So I'm not
> sure,what does it means when the manual is writing "HTTP to ellis for
> subscriber management "
>
>
>
>  Should I change anything in the configuration as franck said  or all the
> ip configuration are done automatic after DHCP assign ip address as stated
> in the OVF installation guide.
>
>
>
> Adrian
>
>
>
>
>
> On Tue, Mar 29, 2016 at 11:51 AM, Chris Elford (projectclearwater.org) <
> chris at projectclearwater.org> wrote:
>
> Hi Adrian,
>
>
>
> I may be able to help figure out what is going wrong here. Can you tell me
> a little more about how you installed your system, and what kind of
> virtualization environment you are running in? You say that you followed
> the instructions at
> http://clearwater.readthedocs.org/en/stable/All_in_one_OVF_Installation.html,
> but these instructions cover install on VMware, not KVM. Did you have to do
> anything special to get the OVF to install on KVM?
>
>
>
> Yours,
>
>
>
> Chris
>
>
>
> *From:* Clearwater [mailto:clearwater-bounces at lists.projectclearwater.org]
> *On Behalf Of *Adrian Schwartz
> *Sent:* 23 March 2016 08:42
> *To:* Franck Malka <fmalka at modulo.co.il>
> *Cc:* clearwater at lists.projectclearwater.org
> *Subject:* Re: [Project Clearwater] newbie all-in-one image hard-start
>
>
>
> I had both
>
> restart the machine ity didnt helped so manually started ellis and homer
> and this didn't helped either.
>
> attached monit log.
>
>
>
>
>
> The Monit daemon 5.8.1 uptime: 16m
>
>
>
> Process 'sprout_process'
>
>   status                            Running
>
>   monitoring status                 Monitored
>
>   pid                               1646
>
>   parent pid                        1
>
>   uid                               993
>
>   effective uid                     993
>
>   gid                               993
>
>   uptime                            16m
>
>   children                          0
>
>   memory kilobytes                  64724
>
>   memory kilobytes total            64724
>
>   memory percent                    3.1%
>
>   memory percent total              3.1%
>
>   cpu percent                       0.5%
>
>   cpu percent total                 0.5%
>
>   data collected                    Wed, 23 Mar 2016 08:37:48
>
>
>
> Program 'sprout_uptime'
>
>   status                            Waiting
>
>   monitoring status                 Waiting
>
>   last started                      Wed, 23 Mar 2016 08:35:26
>
>   last exit value                   0
>
>   data collected                    Wed, 23 Mar 2016 08:35:26
>
>
>
> Program 'poll_sprout_sip'
>
>   status                            Status ok
>
>   monitoring status                 Monitored
>
>   last started                      Wed, 23 Mar 2016 08:37:48
>
>   last exit value                   0
>
>   data collected                    Wed, 23 Mar 2016 08:37:48
>
>
>
> Program 'poll_sprout_http'
>
>   status                            Status ok
>
>   monitoring status                 Monitored
>
>   last started                      Wed, 23 Mar 2016 08:37:48
>
>   last exit value                   0
>
>   data collected                    Wed, 23 Mar 2016 08:37:48
>
>
>
> Process 'snmpd_process'
>
>   status                            Running
>
>   monitoring status                 Monitored
>
>   pid                               1036
>
>   parent pid                        1
>
>   uid                               108
>
>   effective uid                     108
>
>   gid                               114
>
>   uptime                            16m
>
>   children                          0
>
>   memory kilobytes                  8080
>
>   memory kilobytes total            8080
>
>   memory percent                    0.3%
>
>   memory percent total              0.3%
>
>   cpu percent                       0.1%
>
>   cpu percent total                 0.1%
>
>   data collected                    Wed, 23 Mar 2016 08:37:48
>
>
>
> Process 'restund_process'
>
>   status                            Running
>
>   monitoring status                 Monitored
>
>   pid                               1842
>
>   parent pid                        1
>
>   uid                               997
>
>   effective uid                     997
>
>   gid                               997
>
>   uptime                            16m
>
>   children                          0
>
>   memory kilobytes                  2452
>
>   memory kilobytes total            2452
>
>   memory percent                    0.1%
>
>   memory percent total              0.1%
>
>   cpu percent                       0.0%
>
>   cpu percent total                 0.0%
>
>   data collected                    Wed, 23 Mar 2016 08:37:48
>
>
>
> Program 'poll_restund'
>
>   status                            Status ok
>
>   monitoring status                 Monitored
>
>   last started                      Wed, 23 Mar 2016 08:37:48
>
>   last exit value                   0
>
>   data collected                    Wed, 23 Mar 2016 08:37:48
>
>
>
> Process 'ntp_process'
>
>   status                            Running
>
>   monitoring status                 Monitored
>
>   pid                               2171
>
>   parent pid                        1
>
>   uid                               106
>
>   effective uid                     106
>
>   gid                               112
>
>   uptime                            16m
>
>   children                          0
>
>   memory kilobytes                  4260
>
>   memory kilobytes total            4260
>
>   memory percent                    0.2%
>
>   memory percent total              0.2%
>
>   cpu percent                       0.0%
>
>   cpu percent total                 0.0%
>
>   data collected                    Wed, 23 Mar 2016 08:37:48
>
>
>
> System 'node-cw-aio.example.com'
>
>   status                            Running
>
>   monitoring status                 Monitored
>
>   load average                      [0.19] [0.20] [0.13]
>
>   cpu                               13.5%us 2.3%sy 0.1%wa
>
>   memory usage                      1234568 kB [60.2%]
>
>   swap usage                        0 kB [0.0%]
>
>   data collected                    Wed, 23 Mar 2016 08:37:48
>
>
>
> Process 'nginx_process'
>
>   status                            Execution failed
>
>   monitoring status                 Monitored
>
>   data collected                    Wed, 23 Mar 2016 08:38:48
>
>
>
> Program 'nginx_uptime'
>
>   status                            Initializing
>
>   monitoring status                 Initializing
>
>   data collected                    Wed, 23 Mar 2016 08:22:27
>
>
>
> Process 'mysql_process'
>
>   status                            Running
>
>   monitoring status                 Monitored
>
>   pid                               919
>
>   parent pid                        1
>
>   uid                               107
>
>   effective uid                     107
>
>   gid                               113
>
>   uptime                            17m
>
>   children                          0
>
>   memory kilobytes                  53484
>
>   memory kilobytes total            53484
>
>   memory percent                    2.6%
>
>   memory percent total              2.6%
>
>   cpu percent                       0.1%
>
>   cpu percent total                 0.1%
>
>   unix socket response time         0.000s to /var/run/mysqld/mysqld.sock
> [DEFAULT]
>
>   data collected                    Wed, 23 Mar 2016 08:38:48
>
>
>
> Process 'memcached_process'
>
>   status                            Running
>
>   monitoring status                 Monitored
>
>   pid                               2380
>
>   parent pid                        1
>
>   uid                               109
>
>   effective uid                     109
>
>   gid                               115
>
>   uptime                            16m
>
>   children                          0
>
>   memory kilobytes                  3712
>
>   memory kilobytes total            3712
>
>   memory percent                    0.1%
>
>   memory percent total              0.1%
>
>   cpu percent                       0.0%
>
>   cpu percent total                 0.0%
>
>   data collected                    Wed, 23 Mar 2016 08:38:48
>
>
>
> Program 'memcached_uptime'
>
>   status                            Waiting
>
>   monitoring status                 Waiting
>
>   last started                      Wed, 23 Mar 2016 08:36:26
>
>   last exit value                   0
>
>   data collected                    Wed, 23 Mar 2016 08:36:26
>
>
>
> Program 'poll_memcached'
>
>   status                            Status ok
>
>   monitoring status                 Monitored
>
>   last started                      Wed, 23 Mar 2016 08:38:48
>
>   last exit value                   0
>
>   data collected                    Wed, 23 Mar 2016 08:38:48
>
>
>
> Process 'homestead_process'
>
>   status                            Running
>
>   monitoring status                 Monitored
>
>   pid                               2409
>
>   parent pid                        1
>
>   uid                               995
>
>   effective uid                     995
>
>   gid                               995
>
>   uptime                            16m
>
>   children                          0
>
>   memory kilobytes                  29512
>
>   memory kilobytes total            29512
>
>   memory percent                    1.4%
>
>   memory percent total              1.4%
>
>   cpu percent                       0.0%
>
>   cpu percent total                 0.0%
>
>   data collected                    Wed, 23 Mar 2016 08:38:48
>
>
>
> Program 'homestead_uptime'
>
>   status                            Waiting
>
>   monitoring status                 Waiting
>
>   last started                      Wed, 23 Mar 2016 08:36:26
>
>   last exit value                   0
>
>   data collected                    Wed, 23 Mar 2016 08:36:26
>
>
>
> Program 'poll_homestead'
>
>   status                            Status ok
>
>   monitoring status                 Monitored
>
>   last started                      Wed, 23 Mar 2016 08:38:48
>
>   last exit value                   0
>
>   data collected                    Wed, 23 Mar 2016 08:38:48
>
>
>
> Process 'homestead-prov_process'
>
>   status                            Running
>
>   monitoring status                 Monitored
>
>   pid                               1829
>
>   parent pid                        1
>
>   uid                               0
>
>   effective uid                     0
>
>   gid                               0
>
>   uptime                            17m
>
>   children                          0
>
>   memory kilobytes                  36640
>
>   memory kilobytes total            36640
>
>   memory percent                    1.7%
>
>   memory percent total              1.7%
>
>   cpu percent                       0.0%
>
>   cpu percent total                 0.0%
>
>   data collected                    Wed, 23 Mar 2016 08:38:48
>
>
>
> Program 'poll_homestead-prov'
>
>   status                            Status failed
>
>   monitoring status                 Monitored
>
>   last started                      Wed, 23 Mar 2016 08:38:48
>
>   last exit value                   1
>
>   data collected                    Wed, 23 Mar 2016 08:38:48
>
>
>
> Process 'homer_process'
>
>   status                            Running
>
>   monitoring status                 Monitored
>
>   pid                               8321
>
>   parent pid                        1
>
>   uid                               0
>
>   effective uid                     0
>
>   gid                               0
>
>   uptime                            1m
>
>   children                          0
>
>   memory kilobytes                  37328
>
>   memory kilobytes total            37328
>
>   memory percent                    1.8%
>
>   memory percent total              1.8%
>
>   cpu percent                       0.0%
>
>   cpu percent total                 0.0%
>
>   data collected                    Wed, 23 Mar 2016 08:38:48
>
>
>
> Program 'poll_homer'
>
>   status                            Status ok
>
>   monitoring status                 Monitored
>
>   last started                      Wed, 23 Mar 2016 08:38:48
>
>   last exit value                   1
>
>   data collected                    Wed, 23 Mar 2016 08:38:48
>
>
>
> Process 'ellis_process'
>
>   status                            Running
>
>   monitoring status                 Monitored
>
>   pid                               8341
>
>   parent pid                        1
>
>   uid                               994
>
>   effective uid                     994
>
>   gid                               994
>
>   uptime                            1m
>
>   children                          2
>
>   memory kilobytes                  27888
>
>   memory kilobytes total            88752
>
>   memory percent                    1.3%
>
>   memory percent total              4.3%
>
>   cpu percent                       0.0%
>
>   cpu percent total                 0.0%
>
>   data collected                    Wed, 23 Mar 2016 08:38:48
>
>
>
> Program 'poll_ellis'
>
>   status                            Status ok
>
>   monitoring status                 Monitored
>
>   last started                      Wed, 23 Mar 2016 08:38:48
>
>   last exit value                   1
>
>   data collected                    Wed, 23 Mar 2016 08:38:48
>
>
>
> Program 'poll_ellis_https'
>
>   status                            Status ok
>
>   monitoring status                 Monitored
>
>   last started                      Wed, 23 Mar 2016 08:38:48
>
>   last exit value                   0
>
>   data collected                    Wed, 23 Mar 2016 08:38:48
>
>
>
> Process 'clearwater_diags_monitor_process'
>
>   status                            Running
>
>   monitoring status                 Monitored
>
>   pid                               1010
>
>   parent pid                        1
>
>   uid                               0
>
>   effective uid                     0
>
>   gid                               0
>
>   uptime                            17m
>
>   children                          1
>
>   memory kilobytes                  3156
>
>   memory kilobytes total            3848
>
>   memory percent                    0.1%
>
>   memory percent total              0.1%
>
>   cpu percent                       0.1%
>
>   cpu percent total                 0.1%
>
>   data collected                    Wed, 23 Mar 2016 08:38:48
>
>
>
> Process 'cassandra_process'
>
>   status                            Running
>
>   monitoring status                 Monitored
>
>   pid                               1612
>
>   parent pid                        1
>
>   uid                               104
>
>   effective uid                     104
>
>   gid                               111
>
>   uptime                            17m
>
>   children                          0
>
>   memory kilobytes                  863304
>
>   memory kilobytes total            863304
>
>   memory percent                    42.1%
>
>   memory percent total              42.1%
>
>   cpu percent                       2.7%
>
>   cpu percent total                 2.7%
>
>   data collected                    Wed, 23 Mar 2016 08:38:48
>
>
>
> Program 'cassandra_uptime'
>
>   status                            Waiting
>
>   monitoring status                 Waiting
>
>   last started                      Wed, 23 Mar 2016 08:36:26
>
>   last exit value                   0
>
>   data collected                    Wed, 23 Mar 2016 08:36:26
>
>
>
> Program 'poll_cassandra'
>
>   status                            Status ok
>
>   monitoring status                 Monitored
>
>   last started                      Wed, 23 Mar 2016 08:38:48
>
>   last exit value                   0
>
>   data collected                    Wed, 23 Mar 2016 08:38:48
>
>
>
> Process 'chronos_process'
>
>   status                            Running
>
>   monitoring status                 Monitored
>
>   pid                               1861
>
>   parent pid                        1
>
>   uid                               0
>
>   effective uid                     0
>
>   gid                               0
>
>   uptime                            17m
>
>   children                          0
>
>   memory kilobytes                  31884
>
>   memory kilobytes total            31884
>
>   memory percent                    1.5%
>
>   memory percent total              1.5%
>
>   cpu percent                       0.5%
>
>   cpu percent total                 0.5%
>
>   data collected                    Wed, 23 Mar 2016 08:38:48
>
>
>
> Program 'chronos_uptime'
>
>   status                            Waiting
>
>   monitoring status                 Waiting
>
>   last started                      Wed, 23 Mar 2016 08:36:26
>
>   last exit value                   0
>
>   data collected                    Wed, 23 Mar 2016 08:36:26
>
>
>
> Program 'poll_chronos'
>
>   status                            Status ok
>
>   monitoring status                 Monitored
>
>   last started                      Wed, 23 Mar 2016 08:38:48
>
>   last exit value                   0
>
>   data collected                    Wed, 23 Mar 2016 08:38:48
>
>
>
> Process 'bono_process'
>
>   status                            Running
>
>   monitoring status                 Monitored
>
>   pid                               1542
>
>   parent pid                        1
>
>   uid                               996
>
>   effective uid                     996
>
>   gid                               996
>
>   uptime                            17m
>
>   children                          0
>
>   memory kilobytes                  59824
>
>   memory kilobytes total            59824
>
>   memory percent                    2.9%
>
>   memory percent total              2.9%
>
>   cpu percent                       0.5%
>
>   cpu percent total                 0.5%
>
>   data collected                    Wed, 23 Mar 2016 08:38:48
>
>
>
> Program 'poll_bono'
>
>   status                            Status ok
>
>   monitoring status                 Monitored
>
>   last started                      Wed, 23 Mar 2016 08:38:48
>
>   last exit value                   0
>
>   data collected                    Wed, 23 Mar 2016 08:38:48
>
>
>
> Process 'astaire_process'
>
>   status                            Running
>
>   monitoring status                 Monitored
>
>   pid                               1529
>
>   parent pid                        1
>
>   uid                               999
>
>   effective uid                     999
>
>   gid                               999
>
>   uptime                            17m
>
>   children                          0
>
>   memory kilobytes                  5844
>
>   memory kilobytes total            5844
>
>   memory percent                    0.2%
>
>   memory percent total              0.2%
>
>   cpu percent                       0.1%
>
>   cpu percent total                 0.1%
>
>   data collected                    Wed, 23 Mar 2016 08:38:48
>
>
>
> Program 'astaire_uptime'
>
>   status                            Waiting
>
>   monitoring status                 Waiting
>
>   last started                      Wed, 23 Mar 2016 08:36:26
>
>   last exit value                   0
>
>   data collected                    Wed, 23 Mar 2016 08:36:26
>
>
>
> root at cw-aio:/etc/clearwater#
>
>
>
>
>
> On Wed, Mar 23, 2016 at 9:55 AM, Franck Malka <fmalka at modulo.co.il> wrote:
>
> and did you restart the services?
>
>
>
> On Wed, Mar 23, 2016, 09:45 Adrian Schwartz <schwartazi at gmail.com> wrote:
>
> Hi Franck
>
> If you are refering to the shared_config and local_config
>
> yes
>
> I think that it is done automatic, but they reflect the local ip address
> that I have
>
> Adi
>
>
>
> On Wed, Mar 23, 2016 at 7:36 AM, Franck Malka <fmalka at modulo.co.il> wrote:
>
> Hi Adi,
>
>
>
> did you adjust the configuration file and restarted the services after
> your machine got its new ip address?
>
>
>
> Franck.
>
> On Wed, Mar 23, 2016, 05:05 Adrian Schwartz <schwartazi at gmail.com> wrote:
>
> Hello Everyone
>
> I downloaded the image file and installed it in my machine (kvm not vmware)
>
> I don't have DNS on the loacal machine, but the machine is getting ip
> address from the DHCP server and is available from each neighboring
> computer (they can ping or ssh to it)
>
> According to what is written here,
> http://clearwater.readthedocs.org/en/stable/All_in_one_OVF_Installation.html
>
> I should be able to http to ellis (I guess by typing ip-address on a
> web-browser)
>
> When I do so  I get connection refuse error.
>
> Moreover when I do wget ip-address:8080 on the clearwater machine I
> receive similar error
>
> When I do wget 127.0.0.1:8080 I recieve a response index file.
>
>
>
> Bellow, some error log.
>
>
>
> Regards
>
> Adrian
>
>
>
>  cat ellis_20160322T190000Z.txt
>
> 22-03-2016 19:44:15.351 UTC INFO main.py:115: Process 0 starting up
>
> 22-03-2016 19:44:15.449 UTC WARNING homestead.py:309: Passing SIP password
> in the clear over http
>
> 22-03-2016 19:44:15.473 UTC WARNING iostream.py:507: Connect error on fd
> 9: ECONNREFUSED
>
> 22-03-2016 19:44:15.474 UTC ERROR homestead.py:68: Failed to ping
> Homestead at http://192.168.1.19:8889/ping. Have you configured your
> HOMESTEAD_URL?
>
>
>
> _______________________________________________
> Clearwater mailing list
> Clearwater at lists.projectclearwater.org
>
> http://lists.projectclearwater.org/mailman/listinfo/clearwater_lists.projectclearwater.org
>
>
>
>
>
>
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.projectclearwater.org/pipermail/clearwater_lists.projectclearwater.org/attachments/20160330/f0ce99d1/attachment.html>

From gvinita98 at gmail.com  Wed Mar 30 15:50:08 2016
From: gvinita98 at gmail.com (vinita gupta)
Date: Wed, 30 Mar 2016 12:50:08 -0700
Subject: [Project Clearwater] How to create all-in-one OVF image from
	sources.
Message-ID: <CAEv+pgD9cA6QpNxso5fNT6tr2ggR7+5=3OOmsA=uM+sUJmOO7A@mail.gmail.com>

Hi All,
I have downloaded and build all sprout/bono, ellis and homer/homestead
components. Is there a way to build and test those separate components
using the same procedure of "All-in-one OVF installation". I would like to
avoid manual installation procedure if possible, for basic testing. How do
I create OVF image comprising of components I just built?

Thanks,
Vinita
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.projectclearwater.org/pipermail/clearwater_lists.projectclearwater.org/attachments/20160330/585ba5fd/attachment.html>

From schwartazi at gmail.com  Wed Mar 30 17:31:32 2016
From: schwartazi at gmail.com (Adrian Schwartz)
Date: Thu, 31 Mar 2016 00:31:32 +0300
Subject: [Project Clearwater] registration using local sip client in android
Message-ID: <CAOAmQy5qVsMjEvwAc6U0pJ8ornj_2dNqnGu2Bd4RCG_wxMhv8Q@mail.gmail.com>

Hi All
I'm trying to setup the loca sip dialer of my Android phone using the
All-In-One OVF image.
I'm havimg S5 kernel 4.2.2 so maybe this is the reason things are not going
straight forward
Any how, I went to call settings and add an Account.
username 6505550162
password <Ellis-password>
server: <hostname ip address>
authentication-user-name: 6505550162@<hostname ip address>

When I try to login, I get login error 403 failed to get authentication
vector for 6505550162@<hostname ip address> in the sprout_current log file
I had tried also authentication-user-name: 6505550162 at example.com
The result was similar

Any Idea?
Thanks
Adrian
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.projectclearwater.org/pipermail/clearwater_lists.projectclearwater.org/attachments/20160331/7d25c843/attachment.html>

From chris at projectclearwater.org  Thu Mar 31 12:41:06 2016
From: chris at projectclearwater.org (Chris Elford (projectclearwater.org))
Date: Thu, 31 Mar 2016 16:41:06 +0000
Subject: [Project Clearwater] How to create all-in-one OVF image
	from	sources.
In-Reply-To: <CAEv+pgD9cA6QpNxso5fNT6tr2ggR7+5=3OOmsA=uM+sUJmOO7A@mail.gmail.com>
References: <CAEv+pgD9cA6QpNxso5fNT6tr2ggR7+5=3OOmsA=uM+sUJmOO7A@mail.gmail.com>
Message-ID: <SN1PR0201MB1856E86E935E11314876EE13E1990@SN1PR0201MB1856.namprd02.prod.outlook.com>

Hi Vinita,

You may be able to use our Chef installation procedure to install a complete deployment, as described at http://clearwater.readthedocs.org/en/stable/Installation_Instructions.html#what-are-my-choices.

Chef isn?t suitable for everyone. You may be able to build OVF images by tweaking our OVF generation code. The code to generate the All-in-one OVF is available on GitHub at https://github.com/Metaswitch/clearwater-vm-images/tree/master/ubuntu-ovf. I think it is possible to create an updated install script and edit line 106 to download and run it.

If that sounds too technical, I should be able to help if you hit any problems during the manual install.

Yours,

Chris

From: Clearwater [mailto:clearwater-bounces at lists.projectclearwater.org] On Behalf Of vinita gupta
Sent: 30 March 2016 20:50
To: clearwater at lists.projectclearwater.org
Subject: [Project Clearwater] How to create all-in-one OVF image from sources.

Hi All,
I have downloaded and build all sprout/bono, ellis and homer/homestead components. Is there a way to build and test those separate components using the same procedure of "All-in-one OVF installation". I would like to avoid manual installation procedure if possible, for basic testing. How do I create OVF image comprising of components I just built?
Thanks,
Vinita
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.projectclearwater.org/pipermail/clearwater_lists.projectclearwater.org/attachments/20160331/3dc0c94b/attachment.html>

From chris at projectclearwater.org  Thu Mar 31 12:53:36 2016
From: chris at projectclearwater.org (Chris Elford (projectclearwater.org))
Date: Thu, 31 Mar 2016 16:53:36 +0000
Subject: [Project Clearwater] registration using local sip client in
 android
In-Reply-To: <CAOAmQy5qVsMjEvwAc6U0pJ8ornj_2dNqnGu2Bd4RCG_wxMhv8Q@mail.gmail.com>
References: <CAOAmQy5qVsMjEvwAc6U0pJ8ornj_2dNqnGu2Bd4RCG_wxMhv8Q@mail.gmail.com>
Message-ID: <SN1PR0201MB1856DCDAF48EECF7C6EBDFBBE1990@SN1PR0201MB1856.namprd02.prod.outlook.com>

Hi Adrian,

We should double-check the settings that you have entered, just in case. I would expect you to need to set:

?         The password field to the Password shown under the private identity for your subscriber in Ellis.

?         The server field to the part of the public identity after the @ as the private identity appears in Ellis.

?         The authentication-user-name to the whole of the private identity.

For example, I have subscriber:

Private Identity:
5505550014 at example.com
Reset
Password: xyz

Associated Public Identities:
sip:5505550014 at example.com
New Public Identity


I would enter:

?         username: 5505550014

?         password: xyz

?         server: cw-ngv.com

?         authentication-user-name: 5505550014 at cw-ngv.com

If that doesn?t work, then I suggest you send us debug logs from your node.

?         Turn on debug logs as described in http://clearwater.readthedocs.org/en/stable/Troubleshooting_and_Recovery.html?highlight=debug%20logs#sprout

?         Restart the node.

?         Try registering your phone again.

?         Send us the latest logs from /var/log/bono and /var/log/sprout.

Yours,

Chris

From: Clearwater [mailto:clearwater-bounces at lists.projectclearwater.org] On Behalf Of Adrian Schwartz
Sent: 30 March 2016 22:32
To: clearwater at lists.projectclearwater.org
Subject: [Project Clearwater] registration using local sip client in android

Hi All
I'm trying to setup the loca sip dialer of my Android phone using the All-In-One OVF image.
I'm havimg S5 kernel 4.2.2 so maybe this is the reason things are not going straight forward
Any how, I went to call settings and add an Account.
username 6505550162
password <Ellis-password>
server: <hostname ip address>
authentication-user-name: 6505550162@<hostname ip address>

When I try to login, I get login error 403 failed to get authentication vector for 6505550162@<hostname ip address> in the sprout_current log file
I had tried also authentication-user-name: 6505550162 at example.com<mailto:6505550162 at example.com>
The result was similar

Any Idea?
Thanks
Adrian


-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.projectclearwater.org/pipermail/clearwater_lists.projectclearwater.org/attachments/20160331/ca62b280/attachment.html>

From budasterisk at gmail.com  Thu Mar 31 23:39:18 2016
From: budasterisk at gmail.com (Bud Asterisk)
Date: Thu, 31 Mar 2016 23:39:18 -0400
Subject: [Project Clearwater] Ellis Web Login failure
Message-ID: <CAGCNiJJBtOy-Zeri4QriUNFuqW0_W3_4E_wkES8oEisy06GGyg@mail.gmail.com>

I have all of my nodes up and running with DNS as well.

When I type in my IP address into my browser into my Ellis node I simply
get the

Apache2 Ubuntu Default Page

Any thoughts on where to start debugging what is wrong?

The Monit daemon 5.8.1 uptime: 0m

Process 'ntp_process'
  status                            Running
  monitoring status                 Monitored
  pid                               1504
  parent pid                        1
  uid                               106
  effective uid                     106
  gid                               114
  uptime                            0m
  children                          0
  memory kilobytes                  4396
  memory kilobytes total            4396
  memory percent                    0.2%
  memory percent total              0.2%
  cpu percent                       0.0%
  cpu percent total                 0.0%
  data collected                    Thu, 31 Mar 2016 23:35:47

System 'node-ellis'
  status                            Running
  monitoring status                 Monitored
  load average                      [0.42] [0.20] [0.07]
  cpu                               4.9%us 4.3%sy 1.6%wa
  memory usage                      215868 kB [10.5%]
  swap usage                        0 kB [0.0%]
  data collected                    Thu, 31 Mar 2016 23:35:47

Process 'nginx_process'
  status                            Running
  monitoring status                 Monitored
  pid                               1059
  parent pid                        1
  uid                               0
  effective uid                     0
  gid                               0
  uptime                            1m
  children                          4
  memory kilobytes                  2840
  memory kilobytes total            16952
  memory percent                    0.1%
  memory percent total              0.8%
  cpu percent                       0.0%
  cpu percent total                 0.0%
  port response time                0.000s to 127.0.0.1:80/ping [HTTP via
TCP]
  data collected                    Thu, 31 Mar 2016 23:35:47

Program 'nginx_uptime'
  status                            Waiting
  monitoring status                 Waiting
  last started                      Thu, 31 Mar 2016 23:35:37
  last exit value                   0
  data collected                    Thu, 31 Mar 2016 23:35:37

Process 'mysql_process'
  status                            Running
  monitoring status                 Monitored
  pid                               996
  parent pid                        1
  uid                               102
  effective uid                     102
  gid                               106
  uptime                            1m
  children                          0
  memory kilobytes                  51316
  memory kilobytes total            51316
  memory percent                    2.5%
  memory percent total              2.5%
  cpu percent                       0.0%
  cpu percent total                 0.0%
  unix socket response time         0.000s to /var/run/mysqld/mysqld.sock
[DEFAULT]
  data collected                    Thu, 31 Mar 2016 23:35:47

Program 'monit_uptime'
  status                            Waiting
  monitoring status                 Waiting
  last started                      Thu, 31 Mar 2016 23:35:37
  last exit value                   0
  data collected                    Thu, 31 Mar 2016 23:35:37

Process 'ellis_process'
  status                            Running
  monitoring status                 Monitored
  pid                               1256
  parent pid                        1
  uid                               999
  effective uid                     999
  gid                               999
  uptime                            0m
  children                          2
  memory kilobytes                  30320
  memory kilobytes total            96584
  memory percent                    1.4%
  memory percent total              4.7%
  cpu percent                       0.0%
  cpu percent total                 0.0%
  data collected                    Thu, 31 Mar 2016 23:35:47

Program 'poll_ellis'
  status                            Status ok
  monitoring status                 Monitored
  last started                      Thu, 31 Mar 2016 23:35:47
  last exit value                   0
  data collected                    Thu, 31 Mar 2016 23:35:47

Program 'poll_ellis_https'
  status                            Status ok
  monitoring status                 Monitored
  last started                      Thu, 31 Mar 2016 23:35:47
  last exit value                   0
  data collected                    Thu, 31 Mar 2016 23:35:47

Process 'clearwater_queue_manager_process'
  status                            Running
  monitoring status                 Monitored
  pid                               1312
  parent pid                        1
  uid                               0
  effective uid                     0
  gid                               0
  uptime                            0m
  children                          0
  memory kilobytes                  19504
  memory kilobytes total            19504
  memory percent                    0.9%
  memory percent total              0.9%
  cpu percent                       0.0%
  cpu percent total                 0.0%
  data collected                    Thu, 31 Mar 2016 23:35:47

Program 'clearwater_queue_manager_uptime'
  status                            Waiting
  monitoring status                 Waiting
  last started                      Thu, 31 Mar 2016 23:35:37
  last exit value                   0
  data collected                    Thu, 31 Mar 2016 23:35:37

Process 'etcd_process'
  status                            Running
  monitoring status                 Monitored
  pid                               1343
  parent pid                        1
  uid                               998
  effective uid                     998
  gid                               998
  uptime                            0m
  children                          0
  memory kilobytes                  22896
  memory kilobytes total            22896
  memory percent                    1.1%
  memory percent total              1.1%
  cpu percent                       0.9%
  cpu percent total                 0.9%
  data collected                    Thu, 31 Mar 2016 23:35:47

Program 'etcd_uptime'
  status                            Waiting
  monitoring status                 Waiting
  last started                      Thu, 31 Mar 2016 23:35:37
  last exit value                   0
  data collected                    Thu, 31 Mar 2016 23:35:37

Program 'poll_etcd_cluster'
  status                            Waiting
  monitoring status                 Waiting
  data collected                    Thu, 31 Mar 2016 23:35:17

Program 'poll_etcd'
  status                            Status ok
  monitoring status                 Monitored
  last started                      Thu, 31 Mar 2016 23:35:47
  last exit value                   0
  data collected                    Thu, 31 Mar 2016 23:35:47

Process 'clearwater_diags_monitor_process'
  status                            Running
  monitoring status                 Monitored
  pid                               1022
  parent pid                        1
  uid                               0
  effective uid                     0
  gid                               0
  uptime                            1m
  children                          1
  memory kilobytes                  3136
  memory kilobytes total            3832
  memory percent                    0.1%
  memory percent total              0.1%
  cpu percent                       0.0%
  cpu percent total                 0.0%
  data collected                    Thu, 31 Mar 2016 23:35:47

Process 'clearwater_config_manager'
  status                            Running
  monitoring status                 Monitored
  pid                               1367
  parent pid                        1
  uid                               0
  effective uid                     0
  gid                               0
  uptime                            0m
  children                          0
  memory kilobytes                  18924
  memory kilobytes total            18924
  memory percent                    0.9%
  memory percent total              0.9%
  cpu percent                       0.0%
  cpu percent total                 0.0%
  data collected                    Thu, 31 Mar 2016 23:35:47

Process 'clearwater_cluster_manager'
  status                            Running
  monitoring status                 Monitored
  pid                               1433
  parent pid                        1
  uid                               0
  effective uid                     0
  gid                               0
  uptime                            0m
  children                          0
  memory kilobytes                  15720
  memory kilobytes total            15720
  memory percent                    0.7%
  memory percent total              0.7%
  cpu percent                       0.0%
  cpu percent total                 0.0%
  data collected                    Thu, 31 Mar 2016 23:35:47
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.projectclearwater.org/pipermail/clearwater_lists.projectclearwater.org/attachments/20160331/91b66eb3/attachment.html>

From peter.skrzynski at nec.co.nz  Thu Mar 31 23:52:58 2016
From: peter.skrzynski at nec.co.nz (Peter Skrzynski)
Date: Fri, 1 Apr 2016 03:52:58 +0000
Subject: [Project Clearwater] Bono rejects calls with 403 Forbidden
Message-ID: <e9010f5c24b74f939f9dafdd7d10ff66@ex15p.necnz.internal>

Hi,
Running release 89 on a manual build with bono/sprout/homestead/ibcf/dns.
When I register subs with udp, and then make a call with tcp, the Bono node rejects the invite with a 403 Forbidden.
When I use udp for both, or tcp for both, then calls are OK.
Looking at the bono log (image attached), the bono is doing a ?find flow?? when it fails.
Is it allowable to register by udp and make calls by tcp?
Could you explain why or why not?
Many thanks,
Peter

[cid:image001.png at 01D18C36.32692810]



Peter Skrzynski

Technical Lead
NEC New Zealand Limited
NEC House, Level 6, 40 Taranaki Street, PO Box 1936, Wellington 6011, New Zealand
T: 043816257, M: 0274849530, F: +6443811110
peter.skrzynski at nec.co.nz<mailto:peter.skrzynski at nec.co.nz>
nz.nec.com<http://nz.nec.com>

[cid:image00b5e2.JPG at 5000e18c.419edfd0]

Please consider the environment before printing this email

Attention:
The information contained in this message and or attachments is intended only for the person or entity to which it is addressed and may contain confidential and/or privileged material.  Any review, retransmission, dissemination, copying or other use of, or taking of any action in reliance upon, this information by persons or entities other than the intended recipient is prohibited. If you received this in error, please contact the sender and delete the material from any system and destroy any copies. NEC has no liability for any act or omission in reliance on the email or any attachment.  Before opening this email or any attachment(s), please check them for viruses. NEC is not responsible for any viruses in this email or any attachment(s); any changes made to this  email or any attachment(s) after they are sent; or any effects this email or any attachment(s) have on your network or computer system.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.projectclearwater.org/pipermail/clearwater_lists.projectclearwater.org/attachments/20160401/3cef4ffa/attachment.html>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: image001.png
Type: image/png
Size: 236048 bytes
Desc: image001.png
URL: <http://lists.projectclearwater.org/pipermail/clearwater_lists.projectclearwater.org/attachments/20160401/3cef4ffa/attachment.png>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: image00b5e2.JPG
Type: image/jpeg
Size: 59501 bytes
Desc: image00b5e2.JPG
URL: <http://lists.projectclearwater.org/pipermail/clearwater_lists.projectclearwater.org/attachments/20160401/3cef4ffa/attachment.jpe>

