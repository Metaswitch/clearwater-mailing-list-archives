From chris at projectclearwater.org  Mon Aug  1 05:36:04 2016
From: chris at projectclearwater.org (Chris Elford (projectclearwater.org))
Date: Mon, 1 Aug 2016 09:36:04 +0000
Subject: [Project Clearwater] Memento Application Server Standalone
In-Reply-To: <CAM_v+eSYHoe9eoneexouOs8HWeA_Vq2vc6TwZAwArA8hB0mF-g@mail.gmail.com>
References: <CAM_v+eTvRsZJ4u1R7+dLvGzg5X-hxb96ZC4UZd84ho-rrprr0Q@mail.gmail.com>
	<CY1PR02MB1181D82B09E288AD22A49E95E10F0@CY1PR02MB1181.namprd02.prod.outlook.com>
	<CAM_v+eSYHoe9eoneexouOs8HWeA_Vq2vc6TwZAwArA8hB0mF-g@mail.gmail.com>
Message-ID: <CY1PR02MB118199DDEF0E7377515F4D44E1040@CY1PR02MB1181.namprd02.prod.outlook.com>

Hi Morris,

It looks like Sprout is not routing your calls to Memento correctly. This section of logs is the important one:

29-07-2016 03:46:21.500 UTC Debug sproutletproxy.cpp:119: Find target Sproutlet for request
29-07-2016 03:46:21.500 UTC Debug sproutletproxy.cpp:158: Found next routable URI: sip:memento at 140.123.103.144;lr
29-07-2016 03:46:21.500 UTC Debug sproutletproxy.cpp:309: Found user - memento
29-07-2016 03:46:21.500 UTC Debug sproutletproxy.cpp:329: Possible service name - 140
29-07-2016 03:46:21.500 UTC Debug sproutletproxy.cpp:335: Hostname - 123.103.144
29-07-2016 03:46:21.500 UTC Debug sproutletproxy.cpp:309: Found user - memento
29-07-2016 03:46:21.500 UTC Debug sproutletproxy.cpp:329: Possible service name - 140
29-07-2016 03:46:21.500 UTC Debug sproutletproxy.cpp:335: Hostname - 123.103.144
29-07-2016 03:46:21.500 UTC Debug sproutletproxy.cpp:309: Found user - memento
29-07-2016 03:46:21.500 UTC Debug sproutletproxy.cpp:329: Possible service name - 140
29-07-2016 03:46:21.500 UTC Debug sproutletproxy.cpp:335: Hostname - 123.103.144
29-07-2016 03:46:21.500 UTC Debug sproutletproxy.cpp:309: Found user - memento
29-07-2016 03:46:21.500 UTC Debug sproutletproxy.cpp:329: Possible service name - 140
29-07-2016 03:46:21.500 UTC Debug sproutletproxy.cpp:335: Hostname - 123.103.144
29-07-2016 03:46:21.500 UTC Debug sproutletproxy.cpp:874: No local sproutlet matches request

Here, Sprout looks at the URI sip:memento at 140.123.103.144;lr and tries to match it to one of its Sproutlet plugins. At this point, we expect it to match Memento, but it looks like that has failed.

The main way that can go wrong is if Sprout does not think that 140.123.103.143 is its local hostname. We can find that out by looking in /etc/clearwater/local_config ? check<http://clearwater.readthedocs.io/en/stable/Clearwater_Configuration_Options_Reference.html> that `local_ip`, `public_ip`, and `public_hostname` are set to the right values. I?m happy to take a look if it?s not obvious.

If that doesn?t help, it would be good to see the Sprout logs covering startup of the system.

Yours,

Chris

From: yan morris [mailto:morrisyan123 at gmail.com]
Sent: 29 July 2016 05:06
To: Chris Elford (projectclearwater.org) <chris at projectclearwater.org>
Subject: Re: [Project Clearwater] Memento Application Server Standalone

Hi, Chris

Thank for your mail.

After mailing you , I have tried re-install memento application server again.

But , there is another situation happened . Now , my memento application server doesn't store call list.

All of user's record is "<call-list><calls></calls></call-list>"

I looked at log , iFC works and it transfer call to memento , but somehow it doesn't work.


I also look at memento's log , when I try to get call list

, it give the message "UTC Warning call_list_store.cpp:326: Failed to get call list fragments for IMPU sip:6505550420 at ccu because 'Row sip:6505550420 at ccu not present in column_family call_lists' (RC = 2)"

Anything I should do to fix this problem?


Could you help me to resolve the problem? Below is my sprout's log (part of log , starting after iFC matches)

(140.123.103.144 is memento server's IP and sprout IP is 140.123.103.105)

Sprout log :

https://docs.google.com/document/d/1QFjDetJ3nateskQUAEEE7Ag9JgTQzPE6_e4Tl3zaNCs/edit?usp=sharing

If you need more information , please let me know .

Thank you very much.

Morris


2016-07-28 0:03 GMT+08:00 Chris Elford (projectclearwater.org<http://projectclearwater.org>) <chris at projectclearwater.org<mailto:chris at projectclearwater.org>>:
Hi Morris,

From what you tell me, it sounds like Memento is getting involved with your calls, but Sprout is not managing to route them to the correct place.

In order to work out where this is going wrong, it would be helpful to see a set of Sprout debug logs<http://clearwater.readthedocs.io/en/stable/Troubleshooting_and_Recovery.html#sprout> (log level 5) covering the failed call.

Yours,

Chris

From: Clearwater [mailto:clearwater-bounces at lists.projectclearwater.org<mailto:clearwater-bounces at lists.projectclearwater.org>] On Behalf Of yan morris
Sent: 21 July 2016 15:51
To: clearwater at lists.projectclearwater.org<mailto:clearwater at lists.projectclearwater.org>
Subject: [Project Clearwater] Memento Application Server Standalone

Hi ,

I encounter a problem when I install memento-as standalone .

I cannot make a call , it would give the message "Early Media started" .

But when I curl the call-list , I can see the records though it never rings .

Could you give me some tips about this ?

Below is my configuration about Memento.


Shared_config for Clearwater except the node contains Memento
# Deployment definitions
home_domain=ccu
sprout_hostname=sprout.ccu
memento_hostname=memento.ccu
hs_hostname=hs.ccu:8888
hs_provisioning_hostname=hs.ccu:8889
ralf_hostname=ralf.ccu:10888
xdms_hostname=homer.ccu:7888

# Email server configuration
smtp_smarthost=smtpserver
smtp_username=user
smtp_password=secret
email_recovery_sender=clearwater at example.org<mailto:clearwater at example.org>

# Keys
signup_key=secret
turn_workaround=secret
ellis_api_key=secret
ellis_cookie_key=secret

memento_enabled='Y'
memento=12345


Shared_config for the node of Memento Application Server
# Deployment definitions
home_domain=ccu
sprout_hostname=memento.ccu
memento_hostname=memento.ccu
hs_hostname=hs.ccu:8888
hs_provisioning_hostname=hs.ccu:8889
ralf_hostname=ralf.ccu:10888
xdms_hostname=homer.ccu:7888

# Email server configuration
smtp_smarthost=smtpserver
smtp_username=user
smtp_password=secret
email_recovery_sender=clearwater at example.org<mailto:clearwater at example.org>

# Keys
signup_key=secret
turn_workaround=secret
ellis_api_key=secret
ellis_cookie_key=secret

memento_enabled='Y'
memento=12345


My IFC configuration :
<InitialFilterCriteria>
<TriggerPoint>
<ConditionTypeCNF>0</ConditionTypeCNF>
<SPT>
<ConditionNegated>0</ConditionNegated>
<Group>0</Group>
<Method>INVITE</Method>
<Extension></Extension>
</SPT>
</TriggerPoint>
<ApplicationServer>
<ServerName>sip:memento@<memento<sip:memento@%3cmemento> node's IP>12345</ServerName>
<DefaultHandling>0</DefaultHandling>
</ApplicationServer>
</InitialFilterCriteria>


I have tried use memento IP or memento.zone as the ServerName , but it didn't work.
Did I configure incorrectly ? Or there are something that I forgot to set.

BTW , I checked the version of each node , they are in the newest version.


Thank you .

Morris Yan

-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.projectclearwater.org/pipermail/clearwater_lists.projectclearwater.org/attachments/20160801/2b280a3f/attachment.html>

From morrisyan123 at gmail.com  Mon Aug  1 09:18:46 2016
From: morrisyan123 at gmail.com (yan morris)
Date: Mon, 1 Aug 2016 21:18:46 +0800
Subject: [Project Clearwater] WebRTC support
Message-ID: <CAM_v+eThBm+S__eGn++1Jf9Vs4cSWakK0EaCUYqWis3CENxv0Q@mail.gmail.com>

Hi,

I am trying to use sipml5 to make a call.

In the expert mode , If I set SIP outbound Proxy URL as "udp://my bono
ip:5060",

it can make a call properly. However , I tried to make a call directly
through

Websocket's port (Bono's 5062) , Bono didn't response .

My Bono's 5062 is listened , and log of Bono is empty.

It seems that Bono didn't process the request.

Do you have any ideal about the situation ?

Why I cannot make a call through WebSocket?


Thank you.

Morris Yan
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.projectclearwater.org/pipermail/clearwater_lists.projectclearwater.org/attachments/20160801/598247a3/attachment.html>

From peter.skrzynski at nec.co.nz  Tue Aug  2 21:46:51 2016
From: peter.skrzynski at nec.co.nz (Peter Skrzynski)
Date: Wed, 3 Aug 2016 01:46:51 +0000
Subject: [Project Clearwater] Homestead not starting due to cassandra problem
Message-ID: <c9005bb3f7cf46a4ae03627c38b4a894@ex15w.necnz.internal>

Hi,
I am running a Release-89 bono/sprout/homestead/ibcf/dns configuration.
After my virtual machines had been turned off for a while (few days), then restarted, the homestead node was not running up correctly, due to homestead and cassandra not running up.
Doing various monit and service commands could not get it going.
Looking in /var/log/cassandra/system.log, I see that it failed due to?

-          reading saved cache /var/lib/cassandra/saved_caches/system-sstable_activity-KeyCache-b.db

-          exception encountered during startup

-          java.lang.OutOfMemoryError: Java heap space
Changing the HEAP size in /etc/Cassandra/Cassandra-env.sh did not fix the problem.
But?
After deleting the file /var/lib/cassandra/saved_caches/system-sstable_activity-KeyCache-b.db, then everything ran up OK.
So, my question is?
Is it acceptable to simply delete the file /var/lib/cassandra/saved_caches/system-sstable_activity-KeyCache-b.db?
Or do I need to rebuild that db file somehow, how would I do that?
Many thanks for any assistance,
Regards,
Peter




Peter Skrzynski

Technical Lead
NEC New Zealand Limited
NEC House, Level 6, 40 Taranaki Street, PO Box: 1936, Wellington 6011, New Zealand
T: 043816257, M: 0274849530, F: +6443811110
peter.skrzynski at nec.co.nz<mailto:peter.skrzynski at nec.co.nz>
nz.nec.com<http://nz.nec.com>

[cid:imaged2232c.JPG at 51ecf379.4a80f781]

Please consider the environment before printing this email

Attention:
The information contained in this message and or attachments is intended only for the person or entity to which it is addressed and may contain confidential and/or privileged material.  Any review, retransmission, dissemination, copying or other use of, or taking of any action in reliance upon, this information by persons or entities other than the intended recipient is prohibited. If you received this in error, please contact the sender and delete the material from any system and destroy any copies. NEC has no liability for any act or omission in reliance on the email or any attachment.  Before opening this email or any attachment(s), please check them for viruses. NEC is not responsible for any viruses in this email or any attachment(s); any changes made to this  email or any attachment(s) after they are sent; or any effects this email or any attachment(s) have on your network or computer system.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.projectclearwater.org/pipermail/clearwater_lists.projectclearwater.org/attachments/20160803/1d0126ef/attachment.html>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: imaged2232c.JPG
Type: image/jpeg
Size: 59501 bytes
Desc: imaged2232c.JPG
URL: <http://lists.projectclearwater.org/pipermail/clearwater_lists.projectclearwater.org/attachments/20160803/1d0126ef/attachment.jpe>

From kosalayb at gmail.com  Wed Aug  3 04:21:47 2016
From: kosalayb at gmail.com (Kosala)
Date: Wed, 3 Aug 2016 09:21:47 +0100
Subject: [Project Clearwater] Signal 6 caught
Message-ID: <CAGEe17aOu5wP4gw20r5w8ezbBMKEC1KkDGzidn2w-81fMA4qyw@mail.gmail.com>

Hi team,

I got homestead following url
https://github.com/Metaswitch/homestead/blob/dev/docs/development.md. Then
I made a deb package following isntructions.

Then I installed deb packages on all in one clearwater image. The I
registered two clients Zoiper and Jitsi. I can make calls between them.

Issue is, when i check log files in /var/log/homestead, I can see

"Signal 6 caught"

Basic stack dump:
/usr/share/clearwater/bin/homestead[0x49336d]
/usr/share/clearwater/bin/homestead[0x49452d]
/usr/share/clearwater/bin/homestead[0x4aa47c]
/lib/x86_64-linux-gnu/libc.so.6(+0x36cb0)[0x7ff647b1acb0]
/lib/x86_64-linux-gnu/libpthread.so.0(sem_wait+0x2e)[0x7ff64909a66e]
/usr/share/clearwater/bin/homestead[0x41cdcf]
/lib/x86_64-linux-gnu/libc.so.6(__libc_start_main+0xf5)[0x7ff647b05f45]
/usr/share/clearwater/bin/homestead[0x41dc6c]

I am just wondering if this can be solved?

Many Thanks,
Kosala
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.projectclearwater.org/pipermail/clearwater_lists.projectclearwater.org/attachments/20160803/40f2f9ed/attachment.html>

From chris at projectclearwater.org  Wed Aug  3 04:27:34 2016
From: chris at projectclearwater.org (Chris Elford (projectclearwater.org))
Date: Wed, 3 Aug 2016 08:27:34 +0000
Subject: [Project Clearwater] About Clearwater webRTC
In-Reply-To: <CAMC9rE=mo1M+akaCo_KBjUJdz_pHrd8=NN6E5SOKv+=Rpba=Dg@mail.gmail.com>
References: <CAMC9rEkJnYHhz+SbPJubZUnejdCpbq=v+Q9hVHnxd2=sWtimFg@mail.gmail.com>
	<CY1PR02MB1181E91B1E1D9D69C0F2F1E6E10F0@CY1PR02MB1181.namprd02.prod.outlook.com>
	<CAMC9rE=mo1M+akaCo_KBjUJdz_pHrd8=NN6E5SOKv+=Rpba=Dg@mail.gmail.com>
Message-ID: <CY1PR02MB11811D046D79E3914B730227E1060@CY1PR02MB1181.namprd02.prod.outlook.com>

Hmm,

I would be able to tell you more with access to all of your Bono log. From the snippet that you have pasted below, it looks like Bono is struggling to connect over TCP to something, but I would need more context to see exactly what. My suspicion is that your Bono is unable to talk to Sprout.

Are you able to send over the whole bono log so that I can take a look?

Chris

From: Ya Sheng Liu [mailto:anderson08121995 at gmail.com]
Sent: 28 July 2016 07:53
To: Chris Elford (projectclearwater.org) <chris at projectclearwater.org>
Subject: Re: [Project Clearwater] About Clearwater webRTC

Hi Chris,

I use the latest version of Firefox, and I use the Wireshark to and tcpdump to capture packet on my bono port 5062 with filter tcp.port==5062 || http(I consider it as websocket handshake packets), then only gets the tcp ack packets. I didn't get any request or response packets before the ack packets.(The below photo is my Wireshark result, red are public ip from web client, blue are public ip to my bono)
<removed>
?
Below is part of my bono logo(set to log_level=5, green is my sprout ip). I saw many connection to my sprout, but I cannot find the bono.5062 pattern by using vim search /. Is it normal?
<removed>

On the sipml5 expert setting, I only set the WebSocket Server URL to my bono. I didn't set the turn server(because I use the public ip. But I also try it, it doesn't work).

Only the ack packets were be capture on bono port 5062 is normal?(I guess I will capture the handshake packets)

Thanks!

?

2016-07-28 0:23 GMT+08:00 Chris Elford (projectclearwater.org<http://projectclearwater.org>) <chris at projectclearwater.org<mailto:chris at projectclearwater.org>>:
Hi,

We test Project Clearwater with WebRTC at the start of every sprint (every 2 weeks) to make sure that it continues to work. My colleague, Rob, made a successful call over websockets on Tuesday, using the sipml5 demo site. It sounds like there is some difference between your setup and ours that is causing the problem.

The first thing to check is that you are using a browser that supports the sipml5 demo using websockets. We have found that calls do not work when we use Chrome, but they do work with recent versions of Firefox.

The second thing that I would look at is whether the websocket request is reaching Bono. I suggest running a packet capture on Bono e.g. using tcpdump, then checking to see whether the packets are making it through your network. You should be able to filter on port 5062. If nothing shows up, then it is worth checking that your firewall is configured correctly.

If that does not identify the problem, can you send us debug logs from Bono showing a call? You can find instructions for setting the log level to 5 at http://clearwater.readthedocs.io/en/stable/Troubleshooting_and_Recovery.html#bono.

I hope that helps.

Yours,

Chris

From: Clearwater [mailto:clearwater-bounces at lists.projectclearwater.org<mailto:clearwater-bounces at lists.projectclearwater.org>] On Behalf Of ???
Sent: 27 July 2016 08:15
To: clearwater at lists.projectclearwater.org<mailto:clearwater at lists.projectclearwater.org>
Subject: [Project Clearwater] About Clearwater webRTC

Hi,

I am testing Clearwater webRTC. I try the sipml5 from http://clearwater.readthedocs.io/en/stable/WebRTC_support_in_Clearwater.html page.
I have installed  clearwater to six VMware respectively and used six public ip, and follw the page
instructions with above page, but it seems not work to establish websocket connect to my bono
ip. Then, I try to set SIP outbound proxy options instead of setting websocket options.
It now work and can make a sipnl5-sipml5 call. I use Wireshark to capture sip packets, it seems
sipml5 make a websockets-sip transform through there(sipml5) server with webrtc2sip.

So, I have a question that is clearwater a websockets support or clearwater just dependent on sipml5 server to transform websockets to sip packets then sent to bono!

Is clearwater use websocket with all stages(from register to make a call to speak with other)?

I also try the JSSIP demo, it also cannot make a websocket to the bono 5062 port!!

Looking forward to your reply! Thanks!

-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.projectclearwater.org/pipermail/clearwater_lists.projectclearwater.org/attachments/20160803/493fa05b/attachment.html>

From chris at projectclearwater.org  Wed Aug  3 04:36:10 2016
From: chris at projectclearwater.org (Chris Elford (projectclearwater.org))
Date: Wed, 3 Aug 2016 08:36:10 +0000
Subject: [Project Clearwater] sprout docker - sprout failing to start
In-Reply-To: <E16261C1-248A-4E42-8974-BA502623009D@yahoo.com>
References: <1007758877.6400809.1469822792460.JavaMail.yahoo.ref@mail.yahoo.com>
	<E16261C1-248A-4E42-8974-BA502623009D@yahoo.com>
Message-ID: <CY1PR02MB11815B918F35754084AD62DDE1060@CY1PR02MB1181.namprd02.prod.outlook.com>

Hi Vijay,

Thank you for letting us know. I haven?t seen this error before.

Let?s focus on the exception ? Sprout isn?t going to be able to bind to port 9888 if it is crashed.

I?ve had a quick look at the code, and it looks like Sprout is failing to set up its HTTP server. It looks like this can happen for a range of reasons:

?         Not enough memory.

?         Hitting the user limit on the number of open files.

?         Trying to set up the HTTP stack with 0 threads.

I think the most likely of these is that Sprout is trying to set up the HTTP stack with 0 threads. Sprout decides how many threads to use based on the number of CPUs on your system ? it used 50 threads per CPU. We can confirm whether this is the problem by trying out a workaround. Create a file called /etc/clearwater/user_settings, and add the line:

num_http_threads=50

Save the file, then restart the Sprout process by running

sudo service sprout stop

If you have monit installed, Sprout will restart shortly. If not, you will need to run sudo service sprout start.

Please let me know if that doesn?t fix the issue.

Yours,

Chris

From: Clearwater [mailto:clearwater-bounces at lists.projectclearwater.org] On Behalf Of Vijay
Sent: 29 July 2016 22:04
To: Clearwater at lists.projectclearwater.org
Subject: [Project Clearwater] sprout docker - sprout failing to start

Hello,
I built sprout images 3 weeks ago. Sprout is failing to start. There is httpstack exception that is causing it to go down.. Here is the log...

29-07-2016 18:37:54.083 UTC Status httpstack.cpp:136: Configuring HTTP stack
29-07-2016 18:37:54.083 UTC Status httpstack.cpp:137:   Bind address: 172.16.64.6
29-07-2016 18:37:54.083 UTC Status httpstack.cpp:138:   Bind port:    9888
29-07-2016 18:37:54.083 UTC Status httpstack.cpp:139:   Num threads:  600
29-07-2016 18:37:54.083 UTC Status main.cpp:1982: Initialise S-CSCF authentication module
29-07-2016 18:37:54.083 UTC Status pluginloader.cpp:63: Loading plug-ins from /usr/share/clearwater/sprout/plugins
29-07-2016 18:37:54.083 UTC Status pluginloader.cpp:93: Attempt to load plug-in /usr/share/clearwater/sprout/plugins/sprout_bgcf.so
29-07-2016 18:37:54.085 UTC Status bgcfservice.cpp:68: No BGCF configuration (file ./bgcf.json does not exist)
29-07-2016 18:37:54.085 UTC Status pluginloader.cpp:127: Loaded sproutlet bgcf using API version 1
29-07-2016 18:37:54.085 UTC Status pluginloader.cpp:93: Attempt to load plug-in /usr/share/clearwater/sprout/plugins/sprout_scscf.so
29-07-2016 18:37:54.087 UTC Status pluginloader.cpp:127: Loaded sproutlet scscf using API version 1
29-07-2016 18:37:54.087 UTC Status pluginloader.cpp:93: Attempt to load plug-in /usr/share/clearwater/sprout/plugins/sprout_mmtel_as.so
29-07-2016 18:37:54.089 UTC Status mmtelasplugin.cpp:95: Creating connection to XDMS homer:7888
29-07-2016 18:37:54.089 UTC Status httpconnection.cpp:114: Configuring HTTP Connection
29-07-2016 18:37:54.089 UTC Status httpconnection.cpp:115:   Connection created for server homer:7888
29-07-2016 18:37:54.089 UTC Status httpconnection.cpp:116:   Connection will use a response timeout of 500ms
29-07-2016 18:37:54.089 UTC Status pluginloader.cpp:127: Loaded sproutlet mmtel using API version 1
29-07-2016 18:37:54.089 UTC Status pluginloader.cpp:93: Attempt to load plug-in /usr/share/clearwater/sprout/plugins/sprout_icscf.so
29-07-2016 18:37:54.091 UTC Status scscfselector.cpp:72: No S-CSCF configuration data (file ./s-cscf.json does not exist)
29-07-2016 18:37:54.091 UTC Warning scscfselector.cpp:166: The S-CSCF json file is empty/invalid. Using default values
29-07-2016 18:37:54.091 UTC Status pluginloader.cpp:127: Loaded sproutlet icscf using API version 1
29-07-2016 18:37:54.091 UTC Status pluginloader.cpp:157: Finished loading plug-ins
29-07-2016 18:37:54.151 UTC Error main.cpp:2137: Caught HttpStack::Exception - evhtp_use_threads - -1

netstat -ntlup does not show anything bound to port 9888. Is any configuration missing?


Thanks!
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.projectclearwater.org/pipermail/clearwater_lists.projectclearwater.org/attachments/20160803/27105897/attachment.html>

From Chris.Elford at metaswitch.com  Wed Aug  3 05:05:31 2016
From: Chris.Elford at metaswitch.com (Chris Elford)
Date: Wed, 3 Aug 2016 09:05:31 +0000
Subject: [Project Clearwater] Clearwater SIPp Node Errors 401,
	403 and 503
In-Reply-To: <CABNCMD0nCg0WxXe6UXPWco-gBqnRGfpy0PfgG=0MoDLYfuvj1w@mail.gmail.com>
References: <CABNCMD0nCg0WxXe6UXPWco-gBqnRGfpy0PfgG=0MoDLYfuvj1w@mail.gmail.com>
Message-ID: <CY1PR02MB11817A8BE1AC4FE640F4C0EEE1060@CY1PR02MB1181.namprd02.prod.outlook.com>

Hi Hocine,

Thanks for sending all of those logs. I think we should focus on the 403 errors first as those are the ones covered by these logs.

I?ve had a look, and it seems like what is going wrong is this:

?         Sprout tries to get authentication details from Homestead for a user (e.g. 6505550046 at ims.cl<mailto:6505550046 at ims.cl>)

?         Homestead cannot find authentication detail for that user, and replies to Sprout?s HTTP request with a 404 response.

It looks like the bulk provisioning may have failed to set up the subscribers you are expecting in Homestead?s database. We can check what is in your database by:

?         Logging on to your Homestead node.

?         Running `cqlsh`.

?         Running the following commands:

o   USE homestead_cache;

o   SELECT * from impi LIMIT 10;

This will show you the first 10 entries in your set of IMPIs. It should look similar to the output on our test system, with ims.cl domain instead of cw-ngv.com:

cqlsh:homestead_cache> SELECT * from impi LIMIT 10;

private_id              | digest_ha1                       | digest_qop | digest_realm | known_preferred
-------------------------+----------------------------------+------------+--------------+-----------------
   6505550098 at cw-ngv.com | 291231883fb1baff6a43f6f5c2be72d9 |       auth |   cw-ngv.com |            null
   6505550058 at cw-ngv.com | 7c69a3536ff95155201af5f93b7fb6e9 |       auth |   cw-ngv.com |            null
   6505550083 at cw-ngv.com | b57a2dca513ea5f6fae680153a62beed |       auth |   cw-ngv.com |            null
   6505550030 at cw-ngv.com | 2eb6c7002d557f6eb41a7c6e56842e98 |       auth |   cw-ngv.com |            null
   6505550045 at cw-ngv.com | 1c59e08eeaa0266b96cc1e8e50002c33 |       auth |   cw-ngv.com |            null
   6505550055 at cw-ngv.com | 157490e89ba46685098d8a26483f77da |       auth |   cw-ngv.com |            null
   6505550077 at cw-ngv.com | eaa8c9c2f401cdcd390f61a3c32499a4 |       auth |   cw-ngv.com |            null
   6505550080 at cw-ngv.com | 179a627e9d76f6595325aa90ff87f2b0 |       auth |   cw-ngv.com |            null

(10 rows)

If it looks different, then something has probably gone wrong with bulk provisioning. In that case, I suggest trying again, recording the output from the bulk provisioning script (and sending it over). To do this:

?         Follow the workaround from https://github.com/Metaswitch/ellis/issues/49 to clear out the database.

?         Run the script again.

I hope that helps.

Yours,

Chris

From: Clearwater [mailto:clearwater-bounces at lists.projectclearwater.org] On Behalf Of Bouzidi Hocine
Sent: 30 July 2016 11:48
To: clearwater at lists.projectclearwater.org
Subject: [Project Clearwater] Clearwater SIPp Node Errors 401, 403 and 503

Hello,

I deployed the clearwater system on OpenStack using manual installation, I generated 1000 numbers starting at sip:6505550000 at ims.cl<mailto:sip%3A6505550000 at ims.cl>
sudo bash -c "export PATH=/usr/share/clearwater/ellis/env/bin:$PATH ;
              cd /usr/share/clearwater/ellis/src/metaswitch/ellis/tools/ ;
              python create_numbers.py --start 6505550000 --count 1000"

I have created numbers in bulk, and created the SIPp node following the
instructions at : http://clearwater.readthedocs.io/en/latest/Clearwater_stress_testing.html
However, when I start the SIPp node, all requests are rejected by Bono with either 401, 403 or 503 error code.



I put below my configuration and logs of different machines.

I would be grateful, to help me solve this problem,
Thanks and Regards,
Hocine.

**************************************************************************************************************************

ellis :             192.168.1.30
bono :           192.168.1.31
sprout :         192.168.1.32
homer :         192.168.1.33
hs :                192.168.1.34
ralf :              192.168.1.35
SIPp node : 192.168.1.3

**************************************************************************************************************************

[ellis]root at ellis:/var/log/ellis# lsb_release -a
No LSB modules are available.
Distributor ID:    Ubuntu
Description:    Ubuntu 14.04.4 LTS
Release:    14.04
Codename:    trusty

**************************************************************************************************************************

local_config for : (ellis, bono, sprout, homer, homestead, ralf) :

local_ip=(192.168.1.31)/*for bono*/
public_ip=pub_ip_bono
public_hostname=bono.ims.cl<http://bono.ims.cl/>
etcd_cluster="192.168.1.30,192.168.1.31,192.168.1.32,192.168.1.33,192.168.1.34,192.168.1.35"

**************************************************************************************************************************

shared_config for : (ellis, bono, sprout, homer, homestead, ralf) :

# Deployment definitions
home_domain=ims.cl<http://ims.cl/>
sprout_hostname=sprout.ims.cl<http://sprout.ims.cl/>
hs_hostname=hs.ims.cl:8888<http://hs.ims.cl:8888/>
hs_provisioning_hostname=hs.ims.cl:8889<http://hs.ims.cl:8889/>
ralf_hostname=ralf.ims.cl:10888<http://ralf.ims.cl:10888/>
xdms_hostname=homer.ims.cl:7888<http://homer.ims.cl:7888/>

# Email server configuration
#smtp_smarthost=<smtp server>
#smtp_username=<username>
#smtp_password=<password>
#email_recovery_sender=clearwater at example.org<mailto:clearwater at example.org>

# Keys
signup_key="secret"
turn_workaround="secret"
ellis_api_key="secret"
ellis_cookie_key="secret"

**************************************************************************************************************************

local_config for SIPp node :

home_domain=ims.cl<http://ims.cl/>
local_ip=192.168.1.3
bono_servers=192.168.1.31
stress_target=192.168.1.31
base=6505550000
count=1000

**************************************************************************************************************************

shared_config for SIPp node :

home_domain=ims.cl<http://ims.cl/>

**************************************************************************************************************************

chronos de sprout :

[http]
bind-address = 192.168.1.32
bind-port = 7253
threads = 50

[logging]
folder = /var/log/chronos
level = 2

[alarms]
enabled = true

[exceptions]
max_ttl = 600

**************************************************************************************************************************

chronos de ralf :

[http]
bind-address = 192.168.1.35
bind-port = 7253
threads = 50

[logging]
folder = /var/log/chronos
level = 2

[alarms]
enabled = true

[exceptions]
max_ttl = 600

**************************************************************************************************************************

Dns config :

$TTL 5m ; Default TTL

@                 3600       IN SOA  ns admin ( 2014010800 ; Serial
                                          3600       ; Refresh
                                          3600       ; Retry
                                          3600       ; Expire
                                          300 )      ; Minimum TTL
@                 3600       IN NS   ns
ns                3600       IN A     pub_ip_dns ; IPv4 address of BIND server
bono                            IN A     pub_ip_bono
@                                  IN A     pub_ip_bono
@                                  IN NAPTR 1 1 "S" "SIP+D2T" "" _sip._tcp
@                                  IN NAPTR 2 1 "S" "SIP+D2U" "" _sip._udp
_sip._tcp                    IN SRV   0 0 5060 bono
_sip._udp                   IN SRV   0 0 5060 bono
sprout                          IN A     pub_ip_sprout
scscf.sprout               IN A     pub_ip_sprout
sprout                          IN NAPTR 1 1 "S" "SIP+D2T" "" _sip._tcp.sprout
_sip._tcp.sprout       IN SRV   0 0 5054 sprout
scscf.sprout               IN NAPTR 1 1 "S" "SIP+D2T" "" _sip._tcp.scscf.sprout
_sip._tcp.scscf.sprout IN SRV   0 0 5054 sprout
icscf.sprout               IN A     pub_ip_sprout
icscf.sprout               IN NAPTR 1 1 "S" "SIP+D2T" "" _sip._tcp.icscf.sprout
_sip._tcp.icscf.sprout IN SRV   0 0 5052 sprout
homestead                IN A     pub_ip_hs
hs                                IN A     pub_ip_hs
homer                        IN A     pub_ip_homer
ralf                              IN A     pub_ip_ralf
ellis                            IN A     pub_ip_ellis
benchmark              IN A     pub_ip_sip_stress_testing

**************************************************************************************************************************

Ping results :

64 bytes from ellis.ims.cl<http://ellis.ims.cl/>: icmp_seq=1 ttl=60 time=1.39 ms
64 bytes from bono.ims.cl<http://bono.ims.cl/>: icmp_seq=2 ttl=60 time=0.681 ms
64 bytes from sprout.ims.cl<http://sprout.ims.cl/>: icmp_seq=2 ttl=60 time=0.999 ms
64 bytes from homer.ims.cl<http://homer.ims.cl/>: icmp_seq=3 ttl=60 time=0.754 ms
64 bytes from hs.ims.cl<http://hs.ims.cl/>: icmp_seq=3 ttl=63 time=0.554 ms
64 bytes from ralf.ims.cl<http://ralf.ims.cl/>: icmp_seq=3 ttl=60 time=0.953 ms
64 bytes from scscf.sprout.ims.cl<http://scscf.sprout.ims.cl/>: icmp_seq=3 ttl=60 time=1.17 ms
64 bytes from icscf.sprout.ims.cl<http://icscf.sprout.ims.cl/>: icmp_seq=2 ttl=60 time=1.08 ms

**************************************************************************************************************************

Sip stress testing logs in SIPp node : 192.168.1.3

1 - sip-stress_counts.csv :

CurrentTime;ElapsedTime;1_Pause_Sessions;1_Pause_Unexp;2_REGISTER_Sent;2_REGISTER_Retrans;3_401_Recv;3_401_Retrans;3_401_Timeout;3_401_Unexp;4_REGISTER_Sent;4_REGISTER_Retrans;5_200_Recv;5_200_Retrans;5_200_Timeout;5_200_Unexp;6_REGISTER_Sent;6_REGISTER_Retrans;7_401_Recv;7_401_Retrans;7_401_Timeout;7_401_Unexp;8_REGISTER_Sent;8_REGISTER_Retrans;9_200_Recv;9_200_Retrans;9_200_Timeout;9_200_Unexp;10_Pause_Sessions;10_Pause_Unexp;11_REGISTER_Sent;11_REGISTER_Retrans;12_200_Recv;12_200_Retrans;12_200_Timeout;12_200_Unexp;13_REGISTER_Sent;13_REGISTER_Retrans;14_200_Recv;14_200_Retrans;14_200_Timeout;14_200_Unexp;15_Pause_Sessions;15_Pause_Unexp;17_Pause_Sessions;17_Pause_Unexp;18_INVITE_Sent;18_INVITE_Retrans;19_100_Recv;19_100_Retrans;19_100_Timeout;19_100_Unexp;20_INVITE_Recv;20_INVITE_Retrans;20_INVITE_Timeout;20_INVITE_Unexp;22_100_Recv;22_100_Retrans;22_100_Timeout;22_100_Unexp;23_INVITE_Recv;23_INVITE_Retrans;23_INVITE_Timeout;23_INVITE_Unexp;25_100_Sent;25_100_Retrans;26_180_Sent;26_180_Retrans;27_180_Recv;27_180_Retrans;27_180_Timeout;27_180_Unexp;28_Pause_Sessions;28_Pause_Unexp;29_200_Sent;29_200_Retrans;30_200_Recv;30_200_Retrans;30_200_Timeout;30_200_Unexp;31_ACK_Sent;31_ACK_Retrans;32_ACK_Recv;32_ACK_Retrans;32_ACK_Timeout;32_ACK_Unexp;33_UPDATE_Sent;33_UPDATE_Retrans;34_UPDATE_Recv;34_UPDATE_Retrans;34_UPDATE_Timeout;34_UPDATE_Unexp;35_200_Sent;35_200_Retrans;36_200_Recv;36_200_Retrans;36_200_Timeout;36_200_Unexp;37_Pause_Sessions;37_Pause_Unexp;38_BYE_Sent;38_BYE_Retrans;39_BYE_Recv;39_BYE_Retrans;39_BYE_Timeout;39_BYE_Unexp;40_200_Sent;40_200_Retrans;41_200_Recv;41_200_Retrans;41_200_Timeout;41_200_Unexp;42_Pause_Sessions;42_Pause_Unexp;
2016-07-30      04:48:58:500    1469846938.500563;00:00:00:011;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;
2016-07-30      04:49:58:502    1469846998.502974;00:01:00:014;500;0;42;0;0;0;36;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;
2016-07-30      04:50:58:504    1469847058.504622;00:02:00:015;500;0;92;0;0;0;86;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;
2016-07-30      04:51:58:505    1469847118.505831;00:03:00:017;500;0;141;0;0;0;129;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;
2016-07-30      04:52:58:506    1469847178.506461;00:04:00:017;500;0;198;0;0;0;188;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;
2016-07-30      04:53:58:509    1469847238.509161;00:05:00:020;500;0;245;0;0;0;236;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;

2 - sip-stress_errors.log :

sipp: The following events occured:
2016-07-30      10:37:34:620    1469867854.620808: Aborting call on unexpected message for Call-Id '278-7048 at 192.168.1.3<mailto:278-7048 at 192.168.1.3>': while expecting '401' (index 3), received 'SIP/2.0 403 Forbidden
Via: SIP/2.0/UDP 192.168.1.3:17935;rport=17935;received=192.168.1.3;branch=z9hG4bK-7048-278-2-6505550444-
Call-ID: 6505550444///278-7048 at 192.168.1.3<mailto:278-7048 at 192.168.1.3>
From: <sip:6505550444 at ims.cl<mailto:sip%3A6505550444 at ims.cl>>;tag=7048SIPpTag00278
To: <sip:6505550444 at ims.cl<mailto:sip%3A6505550444 at ims.cl>>;tag=z9hG4bKPjkl8MxPlBeHQfAfafWpFy0dCwc6ddxiuT
CSeq: 1 REGISTER
Content-Length:  0

2016-07-30      10:37:36:507    1469867856.507272: Aborting call on unexpected message for Call-Id '472-7048 at 192.168.1.3<mailto:472-7048 at 192.168.1.3>': while expecting '401' (index 3), received 'SIP/2.0 403 Forbidden
Via: SIP/2.0/UDP 192.168.1.3:29919;rport=29919;received=192.168.1.3;branch=z9hG4bK-7048-472-2-6505550056-
Call-ID: 6505550056///472-7048 at 192.168.1.3<mailto:472-7048 at 192.168.1.3>
From: <sip:6505550056 at ims.cl<mailto:sip%3A6505550056 at ims.cl>>;tag=7048SIPpTag00472
To: <sip:6505550056 at ims.cl<mailto:sip%3A6505550056 at ims.cl>>;tag=z9hG4bKPj.RjEm.RjZAiHN6eVY2B4V0tKa.VdqJtn
CSeq: 1 REGISTER
Content-Length:


3 - cat /usr/share/clearwater/sip-stress/users.csv.1 (SIPp node : 192.168.1.3)

USER
6505550000;[authentication username=6505550000 at ims.cl<mailto:6505550000 at ims.cl>password=7kkzTyGW];6505550001;[authentication username=6505550001 at ims.cl<mailto:6505550001 at ims.cl> password=7kkzTyGW]
6505550002;[authentication username=6505550002 at ims.cl<mailto:6505550002 at ims.cl>password=7kkzTyGW];6505550003;[authentication username=6505550003 at ims.cl<mailto:6505550003 at ims.cl> password=7kkzTyGW]
6505550004;[authentication username=6505550004 at ims.cl<mailto:6505550004 at ims.cl>password=7kkzTyGW];6505550005;[authentication username=6505550005 at ims.cl<mailto:6505550005 at ims.cl> password=7kkzTyGW]
*
*
*


**************************************************************************************************************************

Ellis_log :

[ellis]root at ellis:/var/log/ellis# cat ellis_20160730T100000Z.txt
30-07-2016 08:00:05.890 UTC INFO web.py:1447: 200 GET /ping (0.0.0.0) 0.34ms
30-07-2016 08:00:15.933 UTC INFO web.py:1447: 200 GET /ping (0.0.0.0) 1.07ms
30-07-2016 08:00:25.985 UTC INFO web.py:1447: 200 GET /ping (0.0.0.0) 0.39ms
30-07-2016 08:00:36.030 UTC INFO web.py:1447: 200 GET /ping (0.0.0.0) 0.98ms
30-07-2016 08:00:46.094 UTC INFO web.py:1447: 200 GET /ping (0.0.0.0) 0.35ms
30-07-2016 08:00:56.176 UTC INFO web.py:1447: 200 GET /ping (0.0.0.0) 0.36ms
30-07-2016 08:01:06.208 UTC INFO web.py:1447: 200 GET /ping (0.0.0.0) 0.32ms
30-07-2016 08:01:16.233 UTC INFO web.py:1447: 200 GET /ping (0.0.0.0) 0.53ms
30-07-2016 08:01:26.298 UTC INFO web.py:1447: 200 GET /ping (0.0.0.0) 0.95ms
30-07-2016 08:01:36.345 UTC INFO web.py:1447: 200 GET /ping (0.0.0.0) 0.96ms
30-07-2016 08:01:46.372 UTC INFO web.py:1447: 200 GET /ping (0.0.0.0) 0.40ms
30-07-2016 08:01:56.448 UTC INFO web.py:1447: 200 GET /ping (0.0.0.0) 0.54ms
30-07-2016 08:02:06.476 UTC INFO web.py:1447: 200 GET /ping (0.0.0.0) 2.20ms

**************************************************************************************************************************

Bono_logs :

[bono]root at bono:/var/log/bono# tail -f log_current.txt
30-07-2016 08:23:45.065 UTC Call-Disconnected: CALL_ID=6505550182///409-6675 at 192.168.1.3<mailto:409-6675 at 192.168.1.3> REASON=401
30-07-2016 08:23:45.086 UTC Call-Disconnected: CALL_ID=6505550182///409-6675 at 192.168.1.3<mailto:409-6675 at 192.168.1.3> REASON=403
30-07-2016 08:23:46.255 UTC Call-Disconnected: CALL_ID=6505550210///395-6675 at 192.168.1.3<mailto:395-6675 at 192.168.1.3> REASON=403
30-07-2016 08:23:47.800 UTC Call-Disconnected: CALL_ID=6505550056///472-6675 at 192.168.1.3<mailto:472-6675 at 192.168.1.3> REASON=403
30-07-2016 08:23:51.497 UTC Call-Disconnected: CALL_ID=6505550942///29-6675 at 192.168.1.3<mailto:29-6675 at 192.168.1.3> REASON=403
30-07-2016 08:23:51.610 UTC Call-Disconnected: CALL_ID=6505550956///22-6675 at 192.168.1.3<mailto:22-6675 at 192.168.1.3> REASON=403
30-07-2016 08:23:52.268 UTC Call-Disconnected: CALL_ID=6505550590///205-6675 at 192.168.1.3<mailto:205-6675 at 192.168.1.3> REASON=403
30-07-2016 08:23:55.526 UTC Call-Disconnected: CALL_ID=6505550576///212-6675 at 192.168.1.3<mailto:212-6675 at 192.168.1.3> REASON=403

[bono]root at bono:/var/log/bono# tail -f bono_current.txt
30-07-2016 08:24:00.865 UTC Status load_monitor.cpp:285: Maximum incoming request rate/second unchanged - only handled 20 requests in last 13068ms, minimum threshold for a change is 3909.096191
30-07-2016 08:24:08.866 UTC Warning (Net-SNMP): Warning: Failed to connect to the agentx master agent ([NIL]):
30-07-2016 08:24:10.008 UTC Status connection_pool.cpp:447: Recycle TCP connection slot 5
30-07-2016 08:24:14.019 UTC Status load_monitor.cpp:285: Maximum incoming request rate/second unchanged - only handled 20 requests in last 13155ms, minimum threshold for a change is 3935.121094
30-07-2016 08:24:23.803 UTC Status load_monitor.cpp:285: Maximum incoming request rate/second unchanged - only handled 20 requests in last 9784ms, minimum threshold for a change is 2926.737061
30-07-2016 08:24:23.871 UTC Warning (Net-SNMP): Warning: Failed to connect to the agentx master agent ([NIL]):
30-07-2016 08:24:31.333 UTC Status load_monitor.cpp:285: Maximum incoming request rate/second unchanged - only handled 20 requests in last 7528ms, minimum threshold for a change is 2251.888184
30-07-2016 08:24:38.876 UTC Warning (Net-SNMP): Warning: Failed to connect to the agentx master agent ([NIL]):
30-07-2016 08:24:40.036 UTC Status load_monitor.cpp:285: Maximum incoming request rate/second unchanged - only handled 20 requests in last 8704ms, minimum threshold for a change is 2603.670898
30-07-2016 08:24:47.807 UTC Status load_monitor.cpp:285: Maximum incoming request rate/second unchanged - only handled 20 requests in last 7771ms, minimum threshold for a change is 2324.578369

**************************************************************************************************************************

Sprout_logs :

[sprout]root at sprout:/var/log/sprout# tail -f access_current.txt
30-07-2016 08:24:43.600 UTC 200 GET /ping 0.000000 seconds
30-07-2016 08:24:53.659 UTC 200 GET /ping 0.000000 seconds
30-07-2016 08:25:03.745 UTC 200 GET /ping 0.000000 seconds
30-07-2016 08:25:13.815 UTC 200 GET /ping 0.000000 seconds
30-07-2016 08:25:23.862 UTC 200 GET /ping 0.000000 seconds
30-07-2016 08:25:25.064 UTC 200 POST /authentication-timeout 0.005699 seconds
30-07-2016 08:25:33.927 UTC 200 GET /ping 0.000000 seconds
30-07-2016 08:25:43.975 UTC 200 GET /ping 0.000000 seconds
30-07-2016 08:25:54.090 UTC 200 GET /ping 0.000000 seconds
30-07-2016 08:26:04.234 UTC 200 GET /ping 0.000000 seconds


[sprout]root at sprout:/var/log/sprout# tail -f log_current.txt
30-07-2016 08:22:13.464 UTC Auth-Failure: Private Identity=6505550810 at ims.cl<mailto:6505550810 at ims.cl> Public Identity=sip:6505550810 at ims.cl<mailto:sip%3A6505550810 at ims.cl>
30-07-2016 08:22:23.094 UTC Auth-Failure: Private Identity=6505550914 at ims.cl<mailto:6505550914 at ims.cl> Public Identity=sip:6505550914 at ims.cl<mailto:sip%3A6505550914 at ims.cl>
30-07-2016 08:22:40.326 UTC Auth-Failure: Private Identity=6505550908 at ims.cl<mailto:6505550908 at ims.cl> Public Identity=sip:6505550908 at ims.cl<mailto:sip%3A6505550908 at ims.cl>
30-07-2016 08:22:42.571 UTC Auth-Failure: Private Identity=6505550196 at ims.cl<mailto:6505550196 at ims.cl> Public Identity=sip:6505550196 at ims.cl<mailto:sip%3A6505550196 at ims.cl>
30-07-2016 08:22:49.856 UTC Auth-Failure: Private Identity=6505550272 at ims.cl<mailto:6505550272 at ims.cl> Public Identity=sip:6505550272 at ims.cl<mailto:sip%3A6505550272 at ims.cl>
30-07-2016 08:22:50.968 UTC Auth-Failure: Private Identity=6505550782 at ims.cl<mailto:6505550782 at ims.cl> Public Identity=sip:6505550782 at ims.cl<mailto:sip%3A6505550782 at ims.cl>
30-07-2016 08:23:13.020 UTC Auth-Failure: Private Identity=6505550236 at ims.cl<mailto:6505550236 at ims.cl> Public Identity=sip:6505550236 at ims.cl<mailto:sip%3A6505550236 at ims.cl>
30-07-2016 08:23:45.078 UTC Auth-Failure: Private Identity=6505550182 at ims.cl<mailto:6505550182 at ims.cl> Public Identity=sip:6505550182 at ims.cl<mailto:sip%3A6505550182 at ims.cl>
30-07-2016 08:24:55.072 UTC Auth-Failure: Private Identity=6505550808 at ims.cl<mailto:6505550808 at ims.cl> Public Identity=sip:6505550808 at ims.cl<mailto:sip%3A6505550808 at ims.cl>
30-07-2016 08:26:43.027 UTC Auth-Failure: Private Identity=6505550090 at ims.cl<mailto:6505550090 at ims.cl> Public Identity=sip:6505550090 at ims.cl<mailto:sip%3A6505550090 at ims.cl>

[sprout]root at sprout:/var/log/sprout# tail -f sprout_current.txt
30-07-2016 08:27:51.005 UTC Error httpconnection.cpp:762: cURL failure with cURL error code 0 (see man 3 libcurl-errors) and HTTP error code 404
30-07-2016 08:27:51.005 UTC Error hssconnection.cpp:149: Failed to get Authentication Vector for 6505550046 at ims.cl<mailto:6505550046 at ims.cl>
30-07-2016 08:27:51.105 UTC Error httpconnection.cpp:762: cURL failure with cURL error code 0 (see man 3 libcurl-errors) and HTTP error code 404
30-07-2016 08:27:51.105 UTC Error hssconnection.cpp:149: Failed to get Authentication Vector for 6505550302 at ims.cl<mailto:6505550302 at ims.cl>
30-07-2016 08:27:51.474 UTC Error authentication.cpp:1134: Authentication failed, Invalid authorization digest (PJSIP_EAUTHINVALIDDIGEST)
30-07-2016 08:27:53.358 UTC Error httpconnection.cpp:762: cURL failure with cURL error code 0 (see man 3 libcurl-errors) and HTTP error code 404
30-07-2016 08:27:53.358 UTC Error hssconnection.cpp:149: Failed to get Authentication Vector for 6505550420 at ims.cl<mailto:6505550420 at ims.cl>
30-07-2016 08:27:53.359 UTC Status load_monitor.cpp:285: Maximum incoming request rate/second unchanged - only handled 20 requests in last 5400ms, minimum threshold for a change is 1350.000000
30-07-2016 08:27:55.616 UTC Error httpconnection.cpp:762: cURL failure with cURL error code 0 (see man 3 libcurl-errors) and HTTP error code 404
30-07-2016 08:27:55.616 UTC Error hssconnection.cpp:149: Failed to get Authentication Vector for 6505550186 at ims.cl<mailto:6505550186 at ims.cl>

**************************************************************************************************************************

Homer logs :

[homer]root at homer:/var/log/homer# cat homer_20160729T160000Z.txt
29-07-2016 14:09:08.931 UTC INFO base.py:261: Received request from localhost - PUT http://http_homer/org.etsi.ngn.simservs/users/sip%3A6505550201%40ims.cl/simservs.xml
29-07-2016 14:09:08.933 UTC INFO xsd.py:76: Performing XSD validation
29-07-2016 14:09:09.248 UTC INFO base.py:274: Sending 200 response to localhost for PUT http://http_homer/org.etsi.ngn.simservs/users/sip%3A6505550201%40ims.cl/simservs.xml
29-07-2016 14:09:21.152 UTC INFO base.py:261: Received request from localhost - PUT http://http_homer/org.etsi.ngn.simservs/users/sip%3A6505550639%40ims.cl/simservs.xml
29-07-2016 14:09:21.154 UTC INFO xsd.py:76: Performing XSD validation
29-07-2016 14:09:21.162 UTC INFO base.py:274: Sending 200 response to localhost for PUT http://http_homer/org.etsi.ngn.simservs/users/sip%3A6505550639%40ims.cl/simservs.xml
29-07-2016 14:09:26.452 UTC INFO base.py:261: Received request from localhost - PUT http://http_homer/org.etsi.ngn.simservs/users/sip%3A6505550782%40ims.cl/simservs.xml
29-07-2016 14:09:26.452 UTC INFO xsd.py:76: Performing XSD validation
29-07-2016 14:09:26.458 UTC INFO base.py:274: Sending 200 response to localhost for PUT http://http_homer/org.etsi.ngn.simservs/users/sip%3A6505550782%40ims.cl/simservs.xml
29-07-2016 14:09:31.049 UTC INFO base.py:261: Received request from localhost - PUT http://http_homer/org.etsi.ngn.simservs/users/sip%3A6505550238%40ims.cl/simservs.xml

**************************************************************************************************************************

Homestead logs :

[homestead]root at hs:/var/log/homestead# tail -f access_current.txt
30-07-2016 08:31:39.008 UTC 200 GET /impi/6505550516%40ims.cl/registration-status<http://40ims.cl/registration-status> 0.000078 seconds
30-07-2016 08:31:39.013 UTC 404 GET /impi/6505550516%40ims.cl/av<http://40ims.cl/av>0.001185 seconds
30-07-2016 08:31:39.797 UTC 200 GET /impi/6505550156%40ims.cl/registration-status<http://40ims.cl/registration-status> 0.000063 seconds
30-07-2016 08:31:39.802 UTC 404 GET /impi/6505550156%40ims.cl/av<http://40ims.cl/av>0.001314 seconds
30-07-2016 08:31:43.599 UTC 200 GET /impi/6505550628%40ims.cl/registration-status<http://40ims.cl/registration-status> 0.000092 seconds
30-07-2016 08:31:43.603 UTC 200 GET /impi/6505550628%40ims.cl/av<http://40ims.cl/av>0.001139 seconds
30-07-2016 08:31:43.628 UTC 200 GET /impi/6505550628%40ims.cl/registration-status<http://40ims.cl/registration-status> 0.000056 seconds
30-07-2016 08:31:43.636 UTC 200 PUT /impu/sip%3A6505550628%40ims.cl/reg-data<http://40ims.cl/reg-data> 0.001479 seconds
30-07-2016 08:31:44.481 UTC 200 GET /impi/6505550670%40ims.cl/registration-status<http://40ims.cl/registration-status> 0.000097 seconds
30-07-2016 08:31:44.484 UTC 404 GET /impi/6505550670%40ims.cl/av<http://40ims.cl/av>0.001131 seconds
30-07-2016 08:31:44.656 UTC 200 PUT /impu/sip%3A6505550944%40ims.cl/reg-data<http://40ims.cl/reg-data> 0.001341 seconds
30-07-2016 08:31:45.981 UTC 200 GET /impi/6505550060%40ims.cl/registration-status<http://40ims.cl/registration-status> 0.000096 seconds
30-07-2016 08:31:45.985 UTC 404 GET /impi/6505550060%40ims.cl/av<http://40ims.cl/av>0.001087 seconds

[homestead]root at hs:/var/log/homestead# tail -f homestead_current.txt
30-07-2016 08:31:17.865 UTC Status load_monitor.cpp:285: Maximum incoming request rate/second unchanged - only handled 21 requests in last 6852ms, minimum threshold for a change is 2053.612793
30-07-2016 08:31:27.025 UTC Warning (Net-SNMP): Warning: Failed to connect to the agentx master agent ([NIL]):
30-07-2016 08:31:31.596 UTC Status load_monitor.cpp:285: Maximum incoming request rate/second unchanged - only handled 21 requests in last 13732ms, minimum threshold for a change is 4115.617676
30-07-2016 08:31:36.324 UTC Status alarm.cpp:62: homestead issued 1501.1 alarm
30-07-2016 08:31:39.009 UTC Status load_monitor.cpp:285: Maximum incoming request rate/second unchanged - only handled 21 requests in last 7412ms, minimum threshold for a change is 2221.450439
30-07-2016 08:31:42.039 UTC Warning (Net-SNMP): Warning: Failed to connect to the agentx master agent ([NIL]):
30-07-2016 08:31:49.028 UTC Status load_monitor.cpp:285: Maximum incoming request rate/second unchanged - only handled 21 requests in last 10020ms, minimum threshold for a change is 3003.093994

**************************************************************************************************************************

Ralf  logs :

[ralf]root at ralf:/var/log/ralf# tail -f access_current.txt
30-07-2016 08:33:04.253 UTC 200 POST /call-id/6505550206%2F%2F%2F397-6860%40192.168.1.3 0.000102 seconds
30-07-2016 08:33:06.682 UTC 200 POST /call-id/6505550514%2F%2F%2F243-6860%40192.168.1.3 0.000129 seconds
30-07-2016 08:33:06.786 UTC 200 GET /ping 0.000000 seconds
30-07-2016 08:33:07.288 UTC 200 POST /call-id/6505550878%2F%2F%2F61-6860%40192.168.1.3 0.000097 seconds
30-07-2016 08:33:08.146 UTC 200 POST /call-id/6505550172%2F%2F%2F414-6860%40192.168.1.3 0.000158 seconds
30-07-2016 08:33:08.267 UTC 200 POST /call-id/6505550780%2F%2F%2F110-6860%40192.168.1.3 0.000088 seconds
30-07-2016 08:33:09.995 UTC 200 POST /call-id/6505550862%2F%2F%2F69-6860%40192.168.1.3 0.000136 seconds
30-07-2016 08:33:11.214 UTC 200 POST /call-id/6505550192%2F%2F%2F404-6860%40192.168.1.3 0.000113 seconds
30-07-2016 08:33:12.733 UTC 200 POST /call-id/6505550034%2F%2F%2F483-6860%40192.168.1.3 0.000103 seconds
30-07-2016 08:33:13.037 UTC 200 POST /call-id/6505550854%2F%2F%2F73-6860%40192.168.1.3 0.000123 seconds
30-07-2016 08:33:14.125 UTC 200 POST /call-id/6505550758%2F%2F%2F121-6860%40192.168.1.3 0.000134 seconds
30-07-2016 08:33:14.742 UTC 200 POST /call-id/6505550094%2F%2F%2F453-6860%40192.168.1.3 0.000093 seconds



[ralf]root at ralf:/var/log/ralf# tail -f ralf_current.txt
30-07-2016 08:33:54.508 UTC Error peer_message_sender.cpp:145: Failed to connect to all CCFs, message not sent
30-07-2016 08:33:54.508 UTC Warning session_manager.cpp:414: Session for 6505550928///36-6860 at 192.168.1.3<mailto:36-6860 at 192.168.1.3> received error from CDF
30-07-2016 08:33:55.760 UTC Error diameterstack.cpp:293: Routing error: 'No remaining suitable candidate to route the message to' for message with Command-Code 271, Destination-Host  and Destination-Realm ims.cl<http://ims.cl/>
30-07-2016 08:33:55.761 UTC Warning peer_message_sender.cpp:125: Failed to send ACR to  (number 0)
30-07-2016 08:33:55.761 UTC Error peer_message_sender.cpp:145: Failed to connect to all CCFs, message not sent
30-07-2016 08:33:55.761 UTC Warning session_manager.cpp:414: Session for 6505550162///419-6860 at 192.168.1.3<mailto:419-6860 at 192.168.1.3> received error from CDF
30-07-2016 08:33:56.680 UTC Error diameterstack.cpp:293: Routing error: 'No remaining suitable candidate to route the message to' for message with Command-Code 271, Destination-Host  and Destination-Realm ims.cl<http://ims.cl/>
30-07-2016 08:33:56.681 UTC Warning peer_message_sender.cpp:125: Failed to send ACR to  (number 0)
30-07-2016 08:33:56.681 UTC Error peer_message_sender.cpp:145: Failed to connect to all CCFs, message not sent
30-07-2016 08:33:56.681 UTC Warning session_manager.cpp:414: Session for 6505550954///23-6860 at 192.168.1.3<mailto:23-6860 at 192.168.1.3> received error from CDF
30-07-2016 08:33:57.543 UTC Error diameterstack.cpp:854: No Diameter peers have been found

**************************************************************************************************************************

ELLIS

[ellis]root at ellis:/var/log/ellis# monit summary
Monit 5.18.1 uptime: 21h 36m
 Service Name                      Status                      Type
 node-ellis.ims.cl<http://node-ellis.ims.cl/>                Running                     System
 ntp_process                         Running                     Process
 nginx_process                    Running                     Process
 mysql_process                    Running                     Process
 ellis_process                                           Running                     Process
 clearwater_queue_manager_pro...  Running                     Process
 etcd_process                     Running                     Process
 clearwater_diags_monitor_pro...  Running                     Process
 clearwater_config_manager        Running                     Process
 clearwater_cluster_manager       Running                     Process
 nginx_uptime                     Status ok                   Program
 monit_uptime                     Status ok                   Program
 poll_ellis                       Status ok                   Program
 poll_ellis_https                 Status ok                   Program
 clearwater_queue_manager_uptime  Status ok                   Program
 etcd_uptime                      Status ok                   Program
 poll_etcd_cluster                Status ok                   Program
 poll_etcd                        Status ok                   Program

**************************************************************************************************************************

BONO

[bono]root at bono:/var/log/bono# monit summary
Monit 5.18.1 uptime: 21h 37m
 Service Name                     Status                      Type
 node-bono.ims.cl<http://node-bono.ims.cl/>                 Running                     System
 restund_process                  Running                     Process
 ntp_process                      Running                     Process
 clearwater_queue_manager_pro...  Running                     Process
 etcd_process                     Running                     Process
 clearwater_diags_monitor_pro...  Running                     Process
 clearwater_config_manager        Running                     Process
 clearwater_cluster_manager       Running                     Process
 bono_process                     Running                     Process
 poll_restund                     Status ok                   Program
 monit_uptime                     Status ok                   Program
 clearwater_queue_manager_uptime  Status ok                   Program
 etcd_uptime                      Status ok                   Program
 poll_etcd_cluster                Status ok                   Program
 poll_etcd                        Status ok                   Program
 poll_bono                        Status ok                   Program

**************************************************************************************************************************

SPROUT

[sprout]root at sprout:/var/log/sprout# monit summary
Monit 5.18.1 uptime: 21h 37m
 Service Name                     Status                      Type
 node-sprout.ims.cl<http://node-sprout.ims.cl/>               Running                     System
 sprout_process                   Running                     Process
 snmpd_process                    Running                     Process
 ntp_process                      Running                     Process
 memcached_process                Running                     Process
 clearwater_queue_manager_pro...  Running                     Process
 etcd_process                     Running                     Process
 clearwater_diags_monitor_pro...  Running                     Process
 clearwater_config_manager        Running                     Process
 clearwater_cluster_manager       Running                     Process
 chronos_process                  Running                     Process
 astaire_process                  Running                     Process
 sprout_uptime                    Status ok                   Program
 poll_sprout_sip                  Status ok                   Program
 poll_sprout_http                 Status ok                   Program
 monit_uptime                     Status ok                   Program
 memcached_uptime                 Status ok                   Program
 poll_memcached                   Status ok                   Program
 clearwater_queue_manager_uptime  Status ok                   Program
 etcd_uptime                      Status ok                   Program
 poll_etcd_cluster                Status ok                   Program
 poll_etcd                        Status ok                   Program
 chronos_uptime                   Status ok                   Program
 poll_chronos                     Status ok                   Program
 astaire_uptime                   Status ok                   Program

**************************************************************************************************************************

HOMER

[homer]root at homer:/var/log/homer# monit summary
Monit 5.18.1 uptime: 21h 38m
 Service Name                     Status                      Type
 node-homer.ims.cl<http://node-homer.ims.cl/>                Running                     System
 ntp_process                      Running                     Process
 nginx_process                    Running                     Process
 homer_process                    Running                     Process
 clearwater_queue_manager_pro...  Running                     Process
 etcd_process                     Running                     Process
 clearwater_diags_monitor_pro...  Running                     Process
 clearwater_config_manager        Running                     Process
 clearwater_cluster_manager       Running                     Process
 cassandra_process                Running                     Process
 nginx_uptime                     Status ok                   Program
 monit_uptime                     Status ok                   Program
 poll_homer                       Status ok                   Program
 clearwater_queue_manager_uptime  Status ok                   Program
 etcd_uptime                      Status ok                   Program
 poll_etcd_cluster                Status ok                   Program
 poll_etcd                        Status ok                   Program
 cassandra_uptime                 Status ok                   Program
 poll_cassandra                   Status ok                   Program

**************************************************************************************************************************

HOMESTEAD

[homestead]root at hs:/var/log/homestead# monit summary
Monit 5.18.1 uptime: 21h 38m
 Service Name                     Status                      Type
 node-hs.ims.cl<http://node-hs.ims.cl/>                   Running                     System
 ntp_process                      Running                     Process
 nginx_process                    Running                     Process
 homestead_process                Running                     Process
 homestead-prov_process           Running                     Process
 clearwater_queue_manager_pro...  Running                     Process
 etcd_process                     Running                     Process
 clearwater_diags_monitor_pro...  Running                     Process
 clearwater_config_manager        Running                     Process
 clearwater_cluster_manager       Running                     Process
 cassandra_process                Running                     Process
 nginx_uptime                     Status ok                   Program
 monit_uptime                     Status ok                   Program
 homestead_uptime                 Status ok                   Program
 poll_homestead                   Status ok                   Program
 poll_homestead-prov              Status ok                   Program
 clearwater_queue_manager_uptime  Status ok                   Program
 etcd_uptime                      Status ok                   Program
 poll_etcd_cluster                Status ok                   Program
 poll_etcd                        Status ok                   Program
 cassandra_uptime                 Status ok                   Program
 poll_cassandra                   Status ok                   Program

**************************************************************************************************************************

RALF

[ralf]root at ralf:/var/log/ralf# monit summary
Monit 5.18.1 uptime: 21h 38m
 Service Name                     Status                      Type
 node-ralf.ims.cl<http://node-ralf.ims.cl/>                 Running                     System
 snmpd_process                    Running                     Process
 ralf_process                     Running                     Process
 ntp_process                      Running                     Process
 memcached_process                Running                     Process
 clearwater_queue_manager_pro...  Running                     Process
 etcd_process                     Running                     Process
 clearwater_diags_monitor_pro...  Running                     Process
 clearwater_config_manager        Running                     Process
 clearwater_cluster_manager       Running                     Process
 chronos_process                  Running                     Process
 astaire_process                  Running                     Process
 poll_ralf                        Status ok                   Program
 monit_uptime                     Status ok                   Program
 memcached_uptime                 Status ok                   Program
 poll_memcached                   Status ok                   Program
 clearwater_queue_manager_uptime  Status ok                   Program
 etcd_uptime                      Status ok                   Program
 poll_etcd_cluster                Status ok                   Program
 poll_etcd                        Status ok                   Program
 chronos_uptime                   Status ok                   Program
 poll_chronos                     Status ok                   Program
 astaire_uptime                   Status ok                   Program
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.projectclearwater.org/pipermail/clearwater_lists.projectclearwater.org/attachments/20160803/386db1e2/attachment.html>

From chris at projectclearwater.org  Wed Aug  3 05:14:45 2016
From: chris at projectclearwater.org (Chris Elford (projectclearwater.org))
Date: Wed, 3 Aug 2016 09:14:45 +0000
Subject: [Project Clearwater] Memento Application Server Standalone
In-Reply-To: <CAM_v+eROPdRRLBHO+P4c_qDGffaNJfz_5HLwFqOcVxmW-w8NkQ@mail.gmail.com>
References: <CAM_v+eTvRsZJ4u1R7+dLvGzg5X-hxb96ZC4UZd84ho-rrprr0Q@mail.gmail.com>
	<CY1PR02MB1181D82B09E288AD22A49E95E10F0@CY1PR02MB1181.namprd02.prod.outlook.com>
	<CAM_v+eSYHoe9eoneexouOs8HWeA_Vq2vc6TwZAwArA8hB0mF-g@mail.gmail.com>
	<CY1PR02MB118199DDEF0E7377515F4D44E1040@CY1PR02MB1181.namprd02.prod.outlook.com>
	<CAM_v+eROPdRRLBHO+P4c_qDGffaNJfz_5HLwFqOcVxmW-w8NkQ@mail.gmail.com>
Message-ID: <CY1PR02MB118115A8527211C8D77F7B26E1060@CY1PR02MB1181.namprd02.prod.outlook.com>

Hi Morris,

I suspect that the Memento Sproutlet may not be running on your Sprout system, but to check that, I need to see the debug logs showing when Sprout was started. You can get these by running `sudo service sprout stop`, waiting for Sprout to re-start, then taking the latest log file. The file that you have included below does not include a restart.

Chris

From: yan morris [mailto:morrisyan123 at gmail.com]
Sent: 01 August 2016 14:37
To: Chris Elford (projectclearwater.org) <chris at projectclearwater.org>
Subject: Re: [Project Clearwater] Memento Application Server Standalone

Hi , Chris

Thank for your email.

I check my local_config , it seems set correctly.

Memento still cannot store the call list.

Below is my sprout log(It is lengthy. It may take a while to look it , thank you appreciatively )

https://docs.google.com/document/d/1ogJrfFUcJqGCTQzKUmSVmrmxWEJbPqNqJH00pLR3IkM/edit?usp=sharing


If you need more information , please let me know.


Thank you very much.

Morris Yan


2016-08-01 17:36 GMT+08:00 Chris Elford (projectclearwater.org<http://projectclearwater.org>) <chris at projectclearwater.org<mailto:chris at projectclearwater.org>>:
Hi Morris,

It looks like Sprout is not routing your calls to Memento correctly. This section of logs is the important one:

29-07-2016 03:46:21.500 UTC Debug sproutletproxy.cpp:119: Find target Sproutlet for request
29-07-2016 03:46:21.500 UTC Debug sproutletproxy.cpp:158: Found next routable URI: sip:memento at 140.123.103.144<mailto:sip%3Amemento at 140.123.103.144>;lr
29-07-2016 03:46:21.500 UTC Debug sproutletproxy.cpp:309: Found user - memento
29-07-2016 03:46:21.500 UTC Debug sproutletproxy.cpp:329: Possible service name - 140
29-07-2016 03:46:21.500 UTC Debug sproutletproxy.cpp:335: Hostname - 123.103.144
29-07-2016 03:46:21.500 UTC Debug sproutletproxy.cpp:309: Found user - memento
29-07-2016 03:46:21.500 UTC Debug sproutletproxy.cpp:329: Possible service name - 140
29-07-2016 03:46:21.500 UTC Debug sproutletproxy.cpp:335: Hostname - 123.103.144
29-07-2016 03:46:21.500 UTC Debug sproutletproxy.cpp:309: Found user - memento
29-07-2016 03:46:21.500 UTC Debug sproutletproxy.cpp:329: Possible service name - 140
29-07-2016 03:46:21.500 UTC Debug sproutletproxy.cpp:335: Hostname - 123.103.144
29-07-2016 03:46:21.500 UTC Debug sproutletproxy.cpp:309: Found user - memento
29-07-2016 03:46:21.500 UTC Debug sproutletproxy.cpp:329: Possible service name - 140
29-07-2016 03:46:21.500 UTC Debug sproutletproxy.cpp:335: Hostname - 123.103.144
29-07-2016 03:46:21.500 UTC Debug sproutletproxy.cpp:874: No local sproutlet matches request

Here, Sprout looks at the URI sip:memento at 140.123.103.144;lr and tries to match it to one of its Sproutlet plugins. At this point, we expect it to match Memento, but it looks like that has failed.

The main way that can go wrong is if Sprout does not think that 140.123.103.143 is its local hostname. We can find that out by looking in /etc/clearwater/local_config ? check<http://clearwater.readthedocs.io/en/stable/Clearwater_Configuration_Options_Reference.html> that `local_ip`, `public_ip`, and `public_hostname` are set to the right values. I?m happy to take a look if it?s not obvious.

If that doesn?t help, it would be good to see the Sprout logs covering startup of the system.

Yours,

Chris

From: yan morris [mailto:morrisyan123 at gmail.com<mailto:morrisyan123 at gmail.com>]
Sent: 29 July 2016 05:06
To: Chris Elford (projectclearwater.org<http://projectclearwater.org>) <chris at projectclearwater.org<mailto:chris at projectclearwater.org>>
Subject: Re: [Project Clearwater] Memento Application Server Standalone

Hi, Chris

Thank for your mail.

After mailing you , I have tried re-install memento application server again.

But , there is another situation happened . Now , my memento application server doesn't store call list.

All of user's record is "<call-list><calls></calls></call-list>"

I looked at log , iFC works and it transfer call to memento , but somehow it doesn't work.


I also look at memento's log , when I try to get call list

, it give the message "UTC Warning call_list_store.cpp:326: Failed to get call list fragments for IMPU sip:6505550420 at ccu because 'Row sip:6505550420 at ccu not present in column_family call_lists' (RC = 2)"

Anything I should do to fix this problem?


Could you help me to resolve the problem? Below is my sprout's log (part of log , starting after iFC matches)

(140.123.103.144 is memento server's IP and sprout IP is 140.123.103.105)

Sprout log :

https://docs.google.com/document/d/1QFjDetJ3nateskQUAEEE7Ag9JgTQzPE6_e4Tl3zaNCs/edit?usp=sharing

If you need more information , please let me know .

Thank you very much.

Morris

2016-07-28 0:03 GMT+08:00 Chris Elford (projectclearwater.org<http://projectclearwater.org>) <chris at projectclearwater.org<mailto:chris at projectclearwater.org>>:
Hi Morris,

From what you tell me, it sounds like Memento is getting involved with your calls, but Sprout is not managing to route them to the correct place.

In order to work out where this is going wrong, it would be helpful to see a set of Sprout debug logs<http://clearwater.readthedocs.io/en/stable/Troubleshooting_and_Recovery.html#sprout> (log level 5) covering the failed call.

Yours,

Chris

From: Clearwater [mailto:clearwater-bounces at lists.projectclearwater.org<mailto:clearwater-bounces at lists.projectclearwater.org>] On Behalf Of yan morris
Sent: 21 July 2016 15:51
To: clearwater at lists.projectclearwater.org<mailto:clearwater at lists.projectclearwater.org>
Subject: [Project Clearwater] Memento Application Server Standalone

Hi ,

I encounter a problem when I install memento-as standalone .

I cannot make a call , it would give the message "Early Media started" .

But when I curl the call-list , I can see the records though it never rings .

Could you give me some tips about this ?

Below is my configuration about Memento.


Shared_config for Clearwater except the node contains Memento
# Deployment definitions
home_domain=ccu
sprout_hostname=sprout.ccu
memento_hostname=memento.ccu
hs_hostname=hs.ccu:8888
hs_provisioning_hostname=hs.ccu:8889
ralf_hostname=ralf.ccu:10888
xdms_hostname=homer.ccu:7888

# Email server configuration
smtp_smarthost=smtpserver
smtp_username=user
smtp_password=secret
email_recovery_sender=clearwater at example.org<mailto:clearwater at example.org>

# Keys
signup_key=secret
turn_workaround=secret
ellis_api_key=secret
ellis_cookie_key=secret

memento_enabled='Y'
memento=12345


Shared_config for the node of Memento Application Server
# Deployment definitions
home_domain=ccu
sprout_hostname=memento.ccu
memento_hostname=memento.ccu
hs_hostname=hs.ccu:8888
hs_provisioning_hostname=hs.ccu:8889
ralf_hostname=ralf.ccu:10888
xdms_hostname=homer.ccu:7888

# Email server configuration
smtp_smarthost=smtpserver
smtp_username=user
smtp_password=secret
email_recovery_sender=clearwater at example.org<mailto:clearwater at example.org>

# Keys
signup_key=secret
turn_workaround=secret
ellis_api_key=secret
ellis_cookie_key=secret

memento_enabled='Y'
memento=12345


My IFC configuration :
<InitialFilterCriteria>
<TriggerPoint>
<ConditionTypeCNF>0</ConditionTypeCNF>
<SPT>
<ConditionNegated>0</ConditionNegated>
<Group>0</Group>
<Method>INVITE</Method>
<Extension></Extension>
</SPT>
</TriggerPoint>
<ApplicationServer>
<ServerName>sip:memento@<memento<sip:memento@%3cmemento> node's IP>12345</ServerName>
<DefaultHandling>0</DefaultHandling>
</ApplicationServer>
</InitialFilterCriteria>


I have tried use memento IP or memento.zone as the ServerName , but it didn't work.
Did I configure incorrectly ? Or there are something that I forgot to set.

BTW , I checked the version of each node , they are in the newest version.


Thank you .

Morris Yan


-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.projectclearwater.org/pipermail/clearwater_lists.projectclearwater.org/attachments/20160803/0c42b027/attachment.html>

From Chris.Elford at metaswitch.com  Wed Aug  3 05:18:12 2016
From: Chris.Elford at metaswitch.com (Chris Elford)
Date: Wed, 3 Aug 2016 09:18:12 +0000
Subject: [Project Clearwater] WebRTC support
In-Reply-To: <CAM_v+eThBm+S__eGn++1Jf9Vs4cSWakK0EaCUYqWis3CENxv0Q@mail.gmail.com>
References: <CAM_v+eThBm+S__eGn++1Jf9Vs4cSWakK0EaCUYqWis3CENxv0Q@mail.gmail.com>
Message-ID: <CY1PR02MB11810DF2F093AAEE2F706CF3E1060@CY1PR02MB1181.namprd02.prod.outlook.com>

Hi Morris,

When you say that Bono?s log is empty, what do you mean? Are you looking at the bono_current.txt, or log_current.txt? Is it completely empty, or is there just no record of the current call?

If there is nothing showing up in Bono, my first step would be to check that your network is set up properly. Are there any firewall rules blocking websockets (TCP) traffic to your bono on port 5062?

Yours,

Chris

From: Clearwater [mailto:clearwater-bounces at lists.projectclearwater.org] On Behalf Of yan morris
Sent: 01 August 2016 14:19
To: clearwater at lists.projectclearwater.org
Subject: [Project Clearwater] WebRTC support

Hi,

I am trying to use sipml5 to make a call.

In the expert mode , If I set SIP outbound Proxy URL as "udp://my bono ip:5060",

it can make a call properly. However , I tried to make a call directly through

Websocket's port (Bono's 5062) , Bono didn't response .

My Bono's 5062 is listened , and log of Bono is empty.

It seems that Bono didn't process the request.

Do you have any ideal about the situation ?

Why I cannot make a call through WebSocket?


Thank you.

Morris Yan
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.projectclearwater.org/pipermail/clearwater_lists.projectclearwater.org/attachments/20160803/4a97d3e5/attachment.html>

From shivacharanms at gmail.com  Thu Aug  4 07:01:52 2016
From: shivacharanms at gmail.com (Shiva Charan)
Date: Thu, 4 Aug 2016 16:31:52 +0530
Subject: [Project Clearwater] Manual install on HPLinux os (debian version)
Message-ID: <CAJAf6Nzd-Gm2eqSOnSpB3=mkDNUezmxFdjCTe9njo9OCRe1QNA@mail.gmail.com>

Hi All,

I am trying to install a manual setup of clearwater on a HPLinux os, but
facing the following issues.

1. Srpout, Bono, Ralf, homestead, and chronos processes are
down.showing execution failed in monit command.
2. No logs are being generated even with the log_level 5 in user_setting
file.

The clearwater-cluster-manager logs shows

InvalidRequestException "Keyspace 'homestead_provisioning' does not exist
--> for homestead

sprout scscf etcd json does not exist --> for sprout


Also while homestead installation got the following error:

/etc/init.d/clearwater-infrastructure: 76:
/etc/init.d/clearwater-infrastructure:
/usr/share/clearwater/infrastructure/scripts/logging.bash: Permission denied

[....] Restarting clearwater-infrastructure:
clearwater-infrastructurezmq_msg_recv: Resource temporarily unavailable


Is there anything extra we need to do for OS other than ubuntu?


Thanks and reagrds,

Shiva charan
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.projectclearwater.org/pipermail/clearwater_lists.projectclearwater.org/attachments/20160804/82f3ca49/attachment.html>

From michaelkatsoulis88 at gmail.com  Thu Aug  4 08:40:54 2016
From: michaelkatsoulis88 at gmail.com (=?UTF-8?B?zpzOuc+HzqzOu863z4IgzprOsc+Ez4POv8+NzrvOt8+C?=)
Date: Thu, 4 Aug 2016 15:40:54 +0300
Subject: [Project Clearwater] SIP Client cannot connect after Clearwater
	manual installation
Message-ID: <CAJG3f9OtD-_LpTYgbOk1LAAU7-vHD5ytnqeB9XxL_+8XzM=Fog@mail.gmail.com>

Hi All,

i have just performed the *manual installation *of project Clearwater using *6
nodes *(1x ellis, 1x bono, 1x sprout, 1x homer, 1x homestead, 1x ralf)

Now I am trying to connect a SIP client (tried both with Zoiper and Ekiga).
The VM in which Zoiper/Ekiga is installed has ping connectivity with the
Clearwater nodes.


The *system configuration* is the following:

*Shared Config*:

 # Deployment definitions
home_domain=ims
sprout_hostname=sprout.ims
hs_hostname=hs.ims:8888
hs_provisioning_hostname=hs.ims:8889
ralf_hostname=ralf.ims:10888
xdms_hostname=homer.ims:7888


# Keys
signup_key=<secret>
turn_workaround=<secret>
ellis_api_key=<secret>
ellis_cookie_key=<secret>


*local config *: (for example in Bono node)

local_ip=192.168.99.131
public_ip=172.28.40.181
public_hostname=bono-1
etcd_cluster="192.168.99.130,192.168.99.131,192.168.88.132,192.168.99.133,192.168.99.134,192.168.99.135"


-----------------------------------------------------------------------------------
The process I follow to create the account is the following:

- Produce a number in Ellis dashboard:

Private Identity:

6505550731 at ims
Password: *******
only shown once


- Fill the required fields in the client:

  a) Ekiga
    name: Clearwater
    Registrar: ims (or bono_IP:port)
    User: 6505550731
    Authentication user: 6505550731 at ims
    Password: ********

   b) Zoiper:
      user/user at host : 6505550731
      Password: *********
      Domain / Outbound Proxy: ims (or bono_IP:port)

Both clients take a long time trying to connect but nothing (relative to
the registration) seems to be written in the log files in any node.

The whole setup is behind a *corporate proxy *and I have configured the
http[s]_proxy, no_proxy environment variables.

Can anyone help ?


Thanks,
Michael Katsoulis
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.projectclearwater.org/pipermail/clearwater_lists.projectclearwater.org/attachments/20160804/6a76863d/attachment.html>

From chris at projectclearwater.org  Thu Aug  4 08:52:49 2016
From: chris at projectclearwater.org (Chris Elford (projectclearwater.org))
Date: Thu, 4 Aug 2016 12:52:49 +0000
Subject: [Project Clearwater] Signal 6 caught
In-Reply-To: <CAGEe17aOu5wP4gw20r5w8ezbBMKEC1KkDGzidn2w-81fMA4qyw@mail.gmail.com>
References: <CAGEe17aOu5wP4gw20r5w8ezbBMKEC1KkDGzidn2w-81fMA4qyw@mail.gmail.com>
Message-ID: <CY1PR02MB1181C5A193C4CC9A03CCAC8BE1070@CY1PR02MB1181.namprd02.prod.outlook.com>

Hi Kosala,

The most common time that Homestead hits a signal 6 (SIGABRT) is when Monit detects that it is not responding to polls, and attempts to stop it.

The first thing to check is whether that is what we are seeing here. You can check that by looking in /var/log/monit.log at the time when you saw the signal 6.

If Monit is not the culprit, then we should figure out where the application hit the signal. You can do that by installing debug symbols (installing the homestead-dbg package) that you will have built at the same time as your homestead package. That will include more information in the crash dump.

If Monit is the culprit, hopefully the logs will explain why. If not, I?m happy to help.

Yours,

Chris


From: Clearwater [mailto:clearwater-bounces at lists.projectclearwater.org] On Behalf Of Kosala
Sent: 03 August 2016 09:22
To: clearwater at lists.projectclearwater.org
Subject: [Project Clearwater] Signal 6 caught

Hi team,
I got homestead following url https://github.com/Metaswitch/homestead/blob/dev/docs/development.md. Then I made a deb package following isntructions.
Then I installed deb packages on all in one clearwater image. The I registered two clients Zoiper and Jitsi. I can make calls between them.
Issue is, when i check log files in /var/log/homestead, I can see

"Signal 6 caught"

Basic stack dump:
/usr/share/clearwater/bin/homestead[0x49336d]
/usr/share/clearwater/bin/homestead[0x49452d]
/usr/share/clearwater/bin/homestead[0x4aa47c]
/lib/x86_64-linux-gnu/libc.so.6(+0x36cb0)[0x7ff647b1acb0]
/lib/x86_64-linux-gnu/libpthread.so.0(sem_wait+0x2e)[0x7ff64909a66e]
/usr/share/clearwater/bin/homestead[0x41cdcf]
/lib/x86_64-linux-gnu/libc.so.6(__libc_start_main+0xf5)[0x7ff647b05f45]
/usr/share/clearwater/bin/homestead[0x41dc6c]
I am just wondering if this can be solved?
Many Thanks,
Kosala

-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.projectclearwater.org/pipermail/clearwater_lists.projectclearwater.org/attachments/20160804/54107b67/attachment.html>

From chris at projectclearwater.org  Thu Aug  4 09:10:16 2016
From: chris at projectclearwater.org (Chris Elford (projectclearwater.org))
Date: Thu, 4 Aug 2016 13:10:16 +0000
Subject: [Project Clearwater] SIP Client cannot connect after
	Clearwater	manual installation
In-Reply-To: <CAJG3f9OtD-_LpTYgbOk1LAAU7-vHD5ytnqeB9XxL_+8XzM=Fog@mail.gmail.com>
References: <CAJG3f9OtD-_LpTYgbOk1LAAU7-vHD5ytnqeB9XxL_+8XzM=Fog@mail.gmail.com>
Message-ID: <CY1PR02MB1181AF7F33A9643A4ED32E45E1070@CY1PR02MB1181.namprd02.prod.outlook.com>

Hi Michael,

Thank you for getting in touch.

You say below that Zoiper and Ekiga are taking a long time to connect. From the fact that nothing is showing up in Bono?s logs, it sounds like the phones are never registering. Is that correct?

If the registrations are failing, and nothing is showing up in the Bono logs, it sounds like there may be something in your network stopping the registrations from getting through. This is possible even if the two machines can ping each other, as SIP traffic runs on a different port to pings. I would suggest using tcpdump to carry out a packet capture on Bono and check that all of the expected messages in the registration flow are getting through.

Yours,

Chris

From: Clearwater [mailto:clearwater-bounces at lists.projectclearwater.org] On Behalf Of ??????? ?ats?????
Sent: 04 August 2016 13:41
To: Clearwater at lists.projectclearwater.org
Subject: [Project Clearwater] SIP Client cannot connect after Clearwater manual installation

Hi All,

i have just performed the manual installation of project Clearwater using 6 nodes (1x ellis, 1x bono, 1x sprout, 1x homer, 1x homestead, 1x ralf)

Now I am trying to connect a SIP client (tried both with Zoiper and Ekiga). The VM in which Zoiper/Ekiga is installed has ping connectivity with the Clearwater nodes.


The system configuration is the following:

Shared Config:

 # Deployment definitions
home_domain=ims
sprout_hostname=sprout.ims
hs_hostname=hs.ims:8888
hs_provisioning_hostname=hs.ims:8889
ralf_hostname=ralf.ims:10888
xdms_hostname=homer.ims:7888


# Keys
signup_key=<secret>
turn_workaround=<secret>
ellis_api_key=<secret>
ellis_cookie_key=<secret>


local config : (for example in Bono node)

local_ip=192.168.99.131
public_ip=172.28.40.181
public_hostname=bono-1
etcd_cluster="192.168.99.130,192.168.99.131,192.168.88.132,192.168.99.133,192.168.99.134,192.168.99.135"


-----------------------------------------------------------------------------------
The process I follow to create the account is the following:

- Produce a number in Ellis dashboard:

Private Identity:

6505550731 at ims
Password: *******
only shown once


- Fill the required fields in the client:

  a) Ekiga
    name: Clearwater
    Registrar: ims (or bono_IP:port)
    User: 6505550731
    Authentication user: 6505550731 at ims
    Password: ********

   b) Zoiper:
      user/user at host : 6505550731
      Password: *********
      Domain / Outbound Proxy: ims (or bono_IP:port)

Both clients take a long time trying to connect but nothing (relative to the registration) seems to be written in the log files in any node.

The whole setup is behind a corporate proxy and I have configured the http[s]_proxy, no_proxy environment variables.

Can anyone help ?


Thanks,
Michael Katsoulis






-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.projectclearwater.org/pipermail/clearwater_lists.projectclearwater.org/attachments/20160804/aca48a81/attachment.html>

From chris at projectclearwater.org  Thu Aug  4 09:52:41 2016
From: chris at projectclearwater.org (Chris Elford (projectclearwater.org))
Date: Thu, 4 Aug 2016 13:52:41 +0000
Subject: [Project Clearwater] Homestead not starting due to cassandra
	problem
In-Reply-To: <c9005bb3f7cf46a4ae03627c38b4a894@ex15w.necnz.internal>
References: <c9005bb3f7cf46a4ae03627c38b4a894@ex15w.necnz.internal>
Message-ID: <CY1PR02MB118118A0985BCFC19B1DED6EE1070@CY1PR02MB1181.namprd02.prod.outlook.com>

Hi Peter,

It sounds like Cassandra was failing to start while reading the saved-off copy of its key cache. This can happen if the file has become corrupt, although it sounds here like you are hitting an out-of-memory issue. Deleting the cache file is quite safe, and may be the only option here. The impact will be that Cassandra will start up without anything pre-populated in its key cache. As the node receives load, it will automatically repopulate the cache. Until it has done so, you might see reduced Cassandra performance.

It sounds like this was a sensible thing to do, and that no further action is required.

This isn?t something that we?ve seen before. Do you know of anything strange that you may have done before turning off your VM? Did you turn it off, or suspend it? It would be great to get a reliable reproduction scenario so that we can fix this issue once and for all.

Yours,

Chris

From: Clearwater [mailto:clearwater-bounces at lists.projectclearwater.org] On Behalf Of Peter Skrzynski
Sent: 03 August 2016 02:47
To: clearwater at lists.projectclearwater.org
Subject: [Project Clearwater] Homestead not starting due to cassandra problem

Hi,
I am running a Release-89 bono/sprout/homestead/ibcf/dns configuration.
After my virtual machines had been turned off for a while (few days), then restarted, the homestead node was not running up correctly, due to homestead and cassandra not running up.
Doing various monit and service commands could not get it going.
Looking in /var/log/cassandra/system.log, I see that it failed due to?

-          reading saved cache /var/lib/cassandra/saved_caches/system-sstable_activity-KeyCache-b.db

-          exception encountered during startup

-          java.lang.OutOfMemoryError: Java heap space
Changing the HEAP size in /etc/Cassandra/Cassandra-env.sh did not fix the problem.
But?
After deleting the file /var/lib/cassandra/saved_caches/system-sstable_activity-KeyCache-b.db, then everything ran up OK.
So, my question is?
Is it acceptable to simply delete the file /var/lib/cassandra/saved_caches/system-sstable_activity-KeyCache-b.db?
Or do I need to rebuild that db file somehow, how would I do that?
Many thanks for any assistance,
Regards,
Peter




Peter Skrzynski
Technical Lead
NEC New Zealand Limited
NEC House, Level 6, 40 Taranaki Street, PO Box: 1936, Wellington 6011, New Zealand
T: 043816257, M: 0274849530, F: +6443811110
peter.skrzynski at nec.co.nz<mailto:peter.skrzynski at nec.co.nz>
nz.nec.com<http://nz.nec.com>

[cid:image003.jpg at 01D1EE5F.55BC90A0]

Please consider the environment before printing this email

Attention:
The information contained in this message and or attachments is intended only for the person or entity to which it is addressed and may contain confidential and/or privileged material.  Any review, retransmission, dissemination, copying or other use of, or taking of any action in reliance upon, this information by persons or entities other than the intended recipient is prohibited. If you received this in error, please contact the sender and delete the material from any system and destroy any copies. NEC has no liability for any act or omission in reliance on the email or any attachment.  Before opening this email or any attachment(s), please check them for viruses. NEC is not responsible for any viruses in this email or any attachment(s); any changes made to this  email or any attachment(s) after they are sent; or any effects this email or any attachment(s) have on your network or computer system.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.projectclearwater.org/pipermail/clearwater_lists.projectclearwater.org/attachments/20160804/c4d52ca5/attachment.html>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: image003.jpg
Type: image/jpeg
Size: 8505 bytes
Desc: image003.jpg
URL: <http://lists.projectclearwater.org/pipermail/clearwater_lists.projectclearwater.org/attachments/20160804/c4d52ca5/attachment.jpg>

From shivacharanms at gmail.com  Thu Aug  4 10:04:15 2016
From: shivacharanms at gmail.com (Shiva Charan)
Date: Thu, 4 Aug 2016 19:34:15 +0530
Subject: [Project Clearwater] Manual install on HPLinux os (debian
	version)
In-Reply-To: <CAJAf6Nzd-Gm2eqSOnSpB3=mkDNUezmxFdjCTe9njo9OCRe1QNA@mail.gmail.com>
References: <CAJAf6Nzd-Gm2eqSOnSpB3=mkDNUezmxFdjCTe9njo9OCRe1QNA@mail.gmail.com>
Message-ID: <CAJAf6NyqBoUAopkUyJ_L7eyg0ibUbr5g8MhDmzoeLzRDOZ6Pzw@mail.gmail.com>

Hi,

An update for the same, some of the services are in running state now,
which was due to few packages issue.
Homestead is still failing when I do an infrastructure restart i get the
following error.

[homestead]root at homestead:/tmp# service clearwater-infrastructure restart

[....] Restarting clearwater-infrastructure:
clearwater-infrastructurezmq_msg_recv: Resource temporarily unavailable

zmq_msg_recv: Resource temporarily unavailable

No process matching value from pidfile: 30888

zmq_msg_recv: Resource temporarily unavailable

zmq_msg_recv: Resource temporarily unavailable

zmq_msg_recv: Resource temporarily unavailable

TCP poll failed to 127.0.0.1 9160

localhost [127.0.0.1] 9160 (?) open

TCP poll failed to 127.0.0.1 9160

localhost [127.0.0.1] 9160 (?) open

TCP poll failed to 127.0.0.1 9160

localhost [127.0.0.1] 9160 (?) open

TCP poll failed to 127.0.0.1 9160

localhost [127.0.0.1] 9160 (?) open

TCP poll failed to 127.0.0.1 9160

localhost [127.0.0.1] 9160 (?) open



Please suggest.


Thanks,

Shiva



On Thu, Aug 4, 2016 at 4:31 PM, Shiva Charan <shivacharanms at gmail.com>
wrote:

> Hi All,
>
> I am trying to install a manual setup of clearwater on a HPLinux os, but
> facing the following issues.
>
> 1. Srpout, Bono, Ralf, homestead, and chronos processes are
> down.showing execution failed in monit command.
> 2. No logs are being generated even with the log_level 5 in user_setting
> file.
>
> The clearwater-cluster-manager logs shows
>
> InvalidRequestException "Keyspace 'homestead_provisioning' does not exist
> --> for homestead
>
> sprout scscf etcd json does not exist --> for sprout
>
>
> Also while homestead installation got the following error:
>
> /etc/init.d/clearwater-infrastructure: 76:
> /etc/init.d/clearwater-infrastructure:
> /usr/share/clearwater/infrastructure/scripts/logging.bash: Permission denied
>
> [....] Restarting clearwater-infrastructure:
> clearwater-infrastructurezmq_msg_recv: Resource temporarily unavailable
>
>
> Is there anything extra we need to do for OS other than ubuntu?
>
>
> Thanks and reagrds,
>
> Shiva charan
>
>
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.projectclearwater.org/pipermail/clearwater_lists.projectclearwater.org/attachments/20160804/953b22df/attachment.html>

From chris at projectclearwater.org  Fri Aug  5 05:26:53 2016
From: chris at projectclearwater.org (Chris Elford (projectclearwater.org))
Date: Fri, 5 Aug 2016 09:26:53 +0000
Subject: [Project Clearwater] About Clearwater webRTC
In-Reply-To: <CAMC9rEk+kD-NU=Hw+ggvHE6fnNkjFmWtfz=pGNPAyyg4t7TDDg@mail.gmail.com>
References: <CAMC9rEkJnYHhz+SbPJubZUnejdCpbq=v+Q9hVHnxd2=sWtimFg@mail.gmail.com>
	<CY1PR02MB1181E91B1E1D9D69C0F2F1E6E10F0@CY1PR02MB1181.namprd02.prod.outlook.com>
	<CAMC9rE=mo1M+akaCo_KBjUJdz_pHrd8=NN6E5SOKv+=Rpba=Dg@mail.gmail.com>
	<CY1PR02MB11811D046D79E3914B730227E1060@CY1PR02MB1181.namprd02.prod.outlook.com>
	<CAMC9rEk+kD-NU=Hw+ggvHE6fnNkjFmWtfz=pGNPAyyg4t7TDDg@mail.gmail.com>
Message-ID: <CY1PR02MB1181323EBCBEFE0D9F5D9426E1180@CY1PR02MB1181.namprd02.prod.outlook.com>

Hi,

Thank you for sending over the log. I searched through the log for attempted websocket connections, but could not find any.

When a websocket connection is created, I would expect to see a log from websocket.cpp with the text ?Incoming connection from?.

I think the first thing to investigate is why your websocket requests are not reaching your server. Do you have DNS records set up to allow the demo to route the requests to your Bono node? Is your Bono node accessible to the public internet over TCP?

Yours,

Chris

From: Ya Sheng Liu [mailto:anderson08121995 at gmail.com]
Sent: 04 August 2016 07:07
To: Chris Elford (projectclearwater.org) <chris at projectclearwater.org>
Subject: Re: [Project Clearwater] About Clearwater webRTC

Hello,

Thanks for your reply,

I read the RFC7118 documents(The WebSocket Protocol as a Transport for the Session Initiation Protocol) that can let us to send the sip through websocket(to my bono directly),

I try to use sipml5 to assign my bono as websocket sever, but it failed to connect through wss.

Is any other options that I should set except this  http://clearwater.readthedocs.io/en/stable/WebRTC_support_in_Clearwater.html page.

Please give me some help.

Attachment is my whole bono log!

Thanks you!



2016-08-03 16:27 GMT+08:00 Chris Elford (projectclearwater.org<http://projectclearwater.org>) <chris at projectclearwater.org<mailto:chris at projectclearwater.org>>:
Hmm,

I would be able to tell you more with access to all of your Bono log. From the snippet that you have pasted below, it looks like Bono is struggling to connect over TCP to something, but I would need more context to see exactly what. My suspicion is that your Bono is unable to talk to Sprout.

Are you able to send over the whole bono log so that I can take a look?

Chris

From: Ya Sheng Liu [mailto:anderson08121995 at gmail.com<mailto:anderson08121995 at gmail.com>]
Sent: 28 July 2016 07:53
To: Chris Elford (projectclearwater.org<http://projectclearwater.org>) <chris at projectclearwater.org<mailto:chris at projectclearwater.org>>
Subject: Re: [Project Clearwater] About Clearwater webRTC

Hi Chris,

I use the latest version of Firefox, and I use the Wireshark to and tcpdump to capture packet on my bono port 5062 with filter tcp.port==5062 || http(I consider it as websocket handshake packets), then only gets the tcp ack packets. I didn't get any request or response packets before the ack packets.(The below photo is my Wireshark result, red are public ip from web client, blue are public ip to my bono)
<removed>
?
Below is part of my bono logo(set to log_level=5, green is my sprout ip). I saw many connection to my sprout, but I cannot find the bono.5062 pattern by using vim search /. Is it normal?
<removed>

On the sipml5 expert setting, I only set the WebSocket Server URL to my bono. I didn't set the turn server(because I use the public ip. But I also try it, it doesn't work).

Only the ack packets were be capture on bono port 5062 is normal?(I guess I will capture the handshake packets)

Thanks!

?

2016-07-28 0:23 GMT+08:00 Chris Elford (projectclearwater.org<http://projectclearwater.org>) <chris at projectclearwater.org<mailto:chris at projectclearwater.org>>:
Hi,

We test Project Clearwater with WebRTC at the start of every sprint (every 2 weeks) to make sure that it continues to work. My colleague, Rob, made a successful call over websockets on Tuesday, using the sipml5 demo site. It sounds like there is some difference between your setup and ours that is causing the problem.

The first thing to check is that you are using a browser that supports the sipml5 demo using websockets. We have found that calls do not work when we use Chrome, but they do work with recent versions of Firefox.

The second thing that I would look at is whether the websocket request is reaching Bono. I suggest running a packet capture on Bono e.g. using tcpdump, then checking to see whether the packets are making it through your network. You should be able to filter on port 5062. If nothing shows up, then it is worth checking that your firewall is configured correctly.

If that does not identify the problem, can you send us debug logs from Bono showing a call? You can find instructions for setting the log level to 5 at http://clearwater.readthedocs.io/en/stable/Troubleshooting_and_Recovery.html#bono.

I hope that helps.

Yours,

Chris

From: Clearwater [mailto:clearwater-bounces at lists.projectclearwater.org<mailto:clearwater-bounces at lists.projectclearwater.org>] On Behalf Of ???
Sent: 27 July 2016 08:15
To: clearwater at lists.projectclearwater.org<mailto:clearwater at lists.projectclearwater.org>
Subject: [Project Clearwater] About Clearwater webRTC

Hi,

I am testing Clearwater webRTC. I try the sipml5 from http://clearwater.readthedocs.io/en/stable/WebRTC_support_in_Clearwater.html page.
I have installed  clearwater to six VMware respectively and used six public ip, and follw the page
instructions with above page, but it seems not work to establish websocket connect to my bono
ip. Then, I try to set SIP outbound proxy options instead of setting websocket options.
It now work and can make a sipnl5-sipml5 call. I use Wireshark to capture sip packets, it seems
sipml5 make a websockets-sip transform through there(sipml5) server with webrtc2sip.

So, I have a question that is clearwater a websockets support or clearwater just dependent on sipml5 server to transform websockets to sip packets then sent to bono!

Is clearwater use websocket with all stages(from register to make a call to speak with other)?

I also try the JSSIP demo, it also cannot make a websocket to the bono 5062 port!!

Looking forward to your reply! Thanks!


-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.projectclearwater.org/pipermail/clearwater_lists.projectclearwater.org/attachments/20160805/9578f71f/attachment.html>

From chris at projectclearwater.org  Fri Aug  5 06:12:05 2016
From: chris at projectclearwater.org (Chris Elford (projectclearwater.org))
Date: Fri, 5 Aug 2016 10:12:05 +0000
Subject: [Project Clearwater] Manual install on HPLinux os
	(debian	version)
In-Reply-To: <CAJAf6NyqBoUAopkUyJ_L7eyg0ibUbr5g8MhDmzoeLzRDOZ6Pzw@mail.gmail.com>
References: <CAJAf6Nzd-Gm2eqSOnSpB3=mkDNUezmxFdjCTe9njo9OCRe1QNA@mail.gmail.com>
	<CAJAf6NyqBoUAopkUyJ_L7eyg0ibUbr5g8MhDmzoeLzRDOZ6Pzw@mail.gmail.com>
Message-ID: <CY1PR02MB11816370DC31DAC143904B99E1180@CY1PR02MB1181.namprd02.prod.outlook.com>

Hi Shiva,

I?ve asked around the Project Clearwater team, and we don?t have any experience with HPLinux. Running Project Clearwater on a new OS always turns up new challenges, but we usually find that we can work through them.

It looks from your output below that Cassandra is not up and running. You can confirm this by running sudo monit summary, and checking the status of Cassandra. If Cassandra is failing, I suggest looking at the Cassandra logs in /var/log/cassandra to find out why.

If you manage to solve any Cassandra issues and Homestead is still failing before it gets a chance to write out any logs, I would try running it manually to see what errors it prints out. You can do this by running:

LD_LIBRARY_PATH=/usr/share/clearwater/homestead/lib /usr/share/clearwater/bin/homestead

If the process doesn?t crash, you can stop it with CTRL-C.

Yours,

Chris

From: Clearwater [mailto:clearwater-bounces at lists.projectclearwater.org] On Behalf Of Shiva Charan
Sent: 04 August 2016 15:04
To: clearwater at lists.projectclearwater.org
Subject: Re: [Project Clearwater] Manual install on HPLinux os (debian version)

Hi,

An update for the same, some of the services are in running state now, which was due to few packages issue.
Homestead is still failing when I do an infrastructure restart i get the following error.

[homestead]root at homestead:/tmp# service clearwater-infrastructure restart
[....] Restarting clearwater-infrastructure: clearwater-infrastructurezmq_msg_recv: Resource temporarily unavailable
zmq_msg_recv: Resource temporarily unavailable
No process matching value from pidfile: 30888
zmq_msg_recv: Resource temporarily unavailable
zmq_msg_recv: Resource temporarily unavailable
zmq_msg_recv: Resource temporarily unavailable
TCP poll failed to 127.0.0.1 9160
localhost [127.0.0.1] 9160 (?) open
TCP poll failed to 127.0.0.1 9160
localhost [127.0.0.1] 9160 (?) open
TCP poll failed to 127.0.0.1 9160
localhost [127.0.0.1] 9160 (?) open
TCP poll failed to 127.0.0.1 9160
localhost [127.0.0.1] 9160 (?) open
TCP poll failed to 127.0.0.1 9160
localhost [127.0.0.1] 9160 (?) open


Please suggest.

Thanks,
Shiva


On Thu, Aug 4, 2016 at 4:31 PM, Shiva Charan <shivacharanms at gmail.com<mailto:shivacharanms at gmail.com>> wrote:
Hi All,

I am trying to install a manual setup of clearwater on a HPLinux os, but facing the following issues.

1. Srpout, Bono, Ralf, homestead, and chronos processes are down.showing execution failed in monit command.
2. No logs are being generated even with the log_level 5 in user_setting file.

The clearwater-cluster-manager logs shows
InvalidRequestException "Keyspace 'homestead_provisioning' does not exist --> for homestead
sprout scscf etcd json does not exist --> for sprout

Also while homestead installation got the following error:
/etc/init.d/clearwater-infrastructure: 76: /etc/init.d/clearwater-infrastructure: /usr/share/clearwater/infrastructure/scripts/logging.bash: Permission denied
[....] Restarting clearwater-infrastructure: clearwater-infrastructurezmq_msg_recv: Resource temporarily unavailable

Is there anything extra we need to do for OS other than ubuntu?

Thanks and reagrds,
Shiva charan


-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.projectclearwater.org/pipermail/clearwater_lists.projectclearwater.org/attachments/20160805/69db4cdf/attachment.html>

From surya.nayani at gmail.com  Fri Aug  5 08:37:02 2016
From: surya.nayani at gmail.com (surya)
Date: Fri, 5 Aug 2016 18:07:02 +0530
Subject: [Project Clearwater] Clearwater installation on Hlinux
Message-ID: <CANivR2gMd2+8wKgULn6rCmVvHvMJFoLR4D4xN54qvzvV32Dh+w@mail.gmail.com>

HI all,

I'm trying to install clearwater on Hlinux( HP version of linux)

I have installed all required packages

Bono,Ellis,Homer services are installed and configure properly. but I'm
facing issues with homestead service


[homestead]root at homestead:~# monit summary
Monit 5.18.1 uptime: 51m
 Service Name                     Status                      Type
 node-homestead                   Running                     System
 ntp_process                      Running                     Process
 nginx_process                    Running                     Process
* homestead_process                Execution failed | Does...  Process*
 clearwater_queue_manager_pro...  Running                     Process
 etcd_process                     Running                     Process
 clearwater_diags_monitor_pro...  Running                     Process
 clearwater_config_manager        Running                     Process
 clearwater_cluster_manager       Running                     Process
 cassandra_process                Running                     Process
 nginx_uptime                     Status ok                   Program
 monit_uptime                     Status ok                   Program
 homestead_uptime                 Not monitored               Program
 poll_homestead                   Not monitored               Program
 clearwater_queue_manager_uptime  Status ok                   Program
 etcd_uptime                      Status ok                   Program
 poll_etcd_cluster                Status ok                   Program
 poll_etcd                        Status ok                   Program
 cassandra_uptime                 Status ok                   Program
 poll_cassandra                   Status ok                   Program


[homestead]root at homestead:~#
LD_LIBRARY_PATH=/usr/share/clearwater/homestead/lib
/usr/share/clearwater/bin/homestead
Thrift: Fri Aug  5 07:58:11 2016 TSocket::open() connect() <Host: localhost
Port: 9160>Connection refused
05-08-2016 11:58:11.407 UTC Error cassandra_store.cpp:189: Store caught
InvalidRequestException: Keyspace 'homestead_cache' does not exist
05-08-2016 11:58:11.408 UTC Error main.cpp:720: Failed to initialize the
Cassandra cache with error code 1.


And this is the issue I have seenin homestead log


5-08-2016 12:32:02.163 UTC Error cassandra_store.cpp:189: Store caught
InvalidRequestException: Keyspace 'homestead_cache' does not exist
05-08-2016 12:32:02.163 UTC Error main.cpp:720: Failed to initialize the
Cassandra cache with error code 1.
05-08-2016 12:32:02.163 UTC Status main.cpp:721: Homestead is shutting down




Please let me know if I'm missing any configuration here



Thanks & Regards,
Surya

-- 
surya
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.projectclearwater.org/pipermail/clearwater_lists.projectclearwater.org/attachments/20160805/55a9a961/attachment.html>

From surya.nayani at gmail.com  Mon Aug  8 02:14:42 2016
From: surya.nayani at gmail.com (surya)
Date: Mon, 8 Aug 2016 11:44:42 +0530
Subject: [Project Clearwater] Clearwater installation on Hlinux
In-Reply-To: <CANivR2gMd2+8wKgULn6rCmVvHvMJFoLR4D4xN54qvzvV32Dh+w@mail.gmail.com>
References: <CANivR2gMd2+8wKgULn6rCmVvHvMJFoLR4D4xN54qvzvV32Dh+w@mail.gmail.com>
Message-ID: <CANivR2i9fmXd-j8HoQEzDcgycD_+d2cJioMpo_mEodhDcMvoGg@mail.gmail.com>

Hello All,


Any clue on this issue??

Please let me know if you require any log files

Thanks & regards,
Surya

On Fri, Aug 5, 2016 at 6:07 PM, surya <surya.nayani at gmail.com> wrote:

> HI all,
>
> I'm trying to install clearwater on Hlinux( HP version of linux)
>
> I have installed all required packages
>
> Bono,Ellis,Homer services are installed and configure properly. but I'm
> facing issues with homestead service
>
>
> [homestead]root at homestead:~# monit summary
> Monit 5.18.1 uptime: 51m
>  Service Name                     Status                      Type
>  node-homestead                   Running                     System
>  ntp_process                      Running                     Process
>  nginx_process                    Running                     Process
> * homestead_process                Execution failed | Does...  Process*
>  clearwater_queue_manager_pro...  Running                     Process
>  etcd_process                     Running                     Process
>  clearwater_diags_monitor_pro...  Running                     Process
>  clearwater_config_manager        Running                     Process
>  clearwater_cluster_manager       Running                     Process
>  cassandra_process                Running                     Process
>  nginx_uptime                     Status ok                   Program
>  monit_uptime                     Status ok                   Program
>  homestead_uptime                 Not monitored               Program
>  poll_homestead                   Not monitored               Program
>  clearwater_queue_manager_uptime  Status ok                   Program
>  etcd_uptime                      Status ok                   Program
>  poll_etcd_cluster                Status ok                   Program
>  poll_etcd                        Status ok                   Program
>  cassandra_uptime                 Status ok                   Program
>  poll_cassandra                   Status ok                   Program
>
>
> [homestead]root at homestead:~# LD_LIBRARY_PATH=/usr/share/clearwater/homestead/lib
> /usr/share/clearwater/bin/homestead
> Thrift: Fri Aug  5 07:58:11 2016 TSocket::open() connect() <Host:
> localhost Port: 9160>Connection refused
> 05-08-2016 11:58:11.407 UTC Error cassandra_store.cpp:189: Store caught
> InvalidRequestException: Keyspace 'homestead_cache' does not exist
> 05-08-2016 11:58:11.408 UTC Error main.cpp:720: Failed to initialize the
> Cassandra cache with error code 1.
>
>
> And this is the issue I have seenin homestead log
>
>
> 5-08-2016 12:32:02.163 UTC Error cassandra_store.cpp:189: Store caught
> InvalidRequestException: Keyspace 'homestead_cache' does not exist
> 05-08-2016 12:32:02.163 UTC Error main.cpp:720: Failed to initialize the
> Cassandra cache with error code 1.
> 05-08-2016 12:32:02.163 UTC Status main.cpp:721: Homestead is shutting down
>
>
>
>
> Please let me know if I'm missing any configuration here
>
>
>
> Thanks & Regards,
> Surya
>
> --
> surya
>



-- 
surya
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.projectclearwater.org/pipermail/clearwater_lists.projectclearwater.org/attachments/20160808/411f005f/attachment.html>

From Chris.Elford at metaswitch.com  Wed Aug 10 05:44:52 2016
From: Chris.Elford at metaswitch.com (Chris Elford)
Date: Wed, 10 Aug 2016 09:44:52 +0000
Subject: [Project Clearwater] About Clearwater webRTC
In-Reply-To: <CAMC9rEmb-kkg3rNYMs2hYMYS2SC1NP8Ar6DuJiM7GZhN1=ngEw@mail.gmail.com>
References: <CAMC9rEkJnYHhz+SbPJubZUnejdCpbq=v+Q9hVHnxd2=sWtimFg@mail.gmail.com>
	<CY1PR02MB1181E91B1E1D9D69C0F2F1E6E10F0@CY1PR02MB1181.namprd02.prod.outlook.com>
	<CAMC9rE=mo1M+akaCo_KBjUJdz_pHrd8=NN6E5SOKv+=Rpba=Dg@mail.gmail.com>
	<CY1PR02MB11811D046D79E3914B730227E1060@CY1PR02MB1181.namprd02.prod.outlook.com>
	<CAMC9rEk+kD-NU=Hw+ggvHE6fnNkjFmWtfz=pGNPAyyg4t7TDDg@mail.gmail.com>
	<CY1PR02MB1181323EBCBEFE0D9F5D9426E1180@CY1PR02MB1181.namprd02.prod.outlook.com>
	<CAMC9rEmb-kkg3rNYMs2hYMYS2SC1NP8Ar6DuJiM7GZhN1=ngEw@mail.gmail.com>
Message-ID: <CY1PR02MB118192AFAB9E0C545BC54672E11D0@CY1PR02MB1181.namprd02.prod.outlook.com>

That?s a good test. I think I understand the problem now.

Bono does not support secure websockets over SSL/TLS. That would explain why sipML5 was not connecting to your Bono server.

However, it is possible to use plain websockets with the sipML5 demo. In the address bar at the top of the screen, you will see the address https://www.doubango.org/sipml5/call.htm. If you change this to http://www.doubango.org/sipml5/call.htm, you should be able to open insecure websocket connections.

Yours,

Chris


From: Ya Sheng Liu [mailto:anderson08121995 at gmail.com]
Sent: 08 August 2016 07:32
To: Chris Elford (projectclearwater.org) <chris at projectclearwater.org>
Subject: Re: [Project Clearwater] About Clearwater webRTC

Hi Chris,

I write a simple websocket javascript clients using nodejs. It can connect to my bono with plain websocket connection( our bono is accessible to the public internet), and it can send message to bono.

But I try to connect to bono with wss(secure websocket connection), It didn't work, and it didn't have anything about websocket.cpp on bono as you said !

So, Is the bono a websocket server supported SSL/TLS on 5062 port? The sipml5 is forced to use wss now, so I cannot use plain websocket on his demo pages.

Thanks!

2016-08-05 17:26 GMT+08:00 Chris Elford (projectclearwater.org<http://projectclearwater.org>) <chris at projectclearwater.org<mailto:chris at projectclearwater.org>>:
Hi,

Thank you for sending over the log. I searched through the log for attempted websocket connections, but could not find any.

When a websocket connection is created, I would expect to see a log from websocket.cpp with the text ?Incoming connection from?.

I think the first thing to investigate is why your websocket requests are not reaching your server. Do you have DNS records set up to allow the demo to route the requests to your Bono node? Is your Bono node accessible to the public internet over TCP?

Yours,

Chris

From: Ya Sheng Liu [mailto:anderson08121995 at gmail.com<mailto:anderson08121995 at gmail.com>]
Sent: 04 August 2016 07:07

To: Chris Elford (projectclearwater.org<http://projectclearwater.org>) <chris at projectclearwater.org<mailto:chris at projectclearwater.org>>
Subject: Re: [Project Clearwater] About Clearwater webRTC

Hello,

Thanks for your reply,

I read the RFC7118 documents(The WebSocket Protocol as a Transport for the Session Initiation Protocol) that can let us to send the sip through websocket(to my bono directly),

I try to use sipml5 to assign my bono as websocket sever, but it failed to connect through wss.

Is any other options that I should set except this  http://clearwater.readthedocs.io/en/stable/WebRTC_support_in_Clearwater.html page.

Please give me some help.

Attachment is my whole bono log!

Thanks you!



2016-08-03 16:27 GMT+08:00 Chris Elford (projectclearwater.org<http://projectclearwater.org>) <chris at projectclearwater.org<mailto:chris at projectclearwater.org>>:
Hmm,

I would be able to tell you more with access to all of your Bono log. From the snippet that you have pasted below, it looks like Bono is struggling to connect over TCP to something, but I would need more context to see exactly what. My suspicion is that your Bono is unable to talk to Sprout.

Are you able to send over the whole bono log so that I can take a look?

Chris

From: Ya Sheng Liu [mailto:anderson08121995 at gmail.com<mailto:anderson08121995 at gmail.com>]
Sent: 28 July 2016 07:53
To: Chris Elford (projectclearwater.org<http://projectclearwater.org>) <chris at projectclearwater.org<mailto:chris at projectclearwater.org>>
Subject: Re: [Project Clearwater] About Clearwater webRTC

Hi Chris,

I use the latest version of Firefox, and I use the Wireshark to and tcpdump to capture packet on my bono port 5062 with filter tcp.port==5062 || http(I consider it as websocket handshake packets), then only gets the tcp ack packets. I didn't get any request or response packets before the ack packets.(The below photo is my Wireshark result, red are public ip from web client, blue are public ip to my bono)
<removed>
?
Below is part of my bono logo(set to log_level=5, green is my sprout ip). I saw many connection to my sprout, but I cannot find the bono.5062 pattern by using vim search /. Is it normal?
<removed>

On the sipml5 expert setting, I only set the WebSocket Server URL to my bono. I didn't set the turn server(because I use the public ip. But I also try it, it doesn't work).

Only the ack packets were be capture on bono port 5062 is normal?(I guess I will capture the handshake packets)

Thanks!

?

2016-07-28 0:23 GMT+08:00 Chris Elford (projectclearwater.org<http://projectclearwater.org>) <chris at projectclearwater.org<mailto:chris at projectclearwater.org>>:
Hi,

We test Project Clearwater with WebRTC at the start of every sprint (every 2 weeks) to make sure that it continues to work. My colleague, Rob, made a successful call over websockets on Tuesday, using the sipml5 demo site. It sounds like there is some difference between your setup and ours that is causing the problem.

The first thing to check is that you are using a browser that supports the sipml5 demo using websockets. We have found that calls do not work when we use Chrome, but they do work with recent versions of Firefox.

The second thing that I would look at is whether the websocket request is reaching Bono. I suggest running a packet capture on Bono e.g. using tcpdump, then checking to see whether the packets are making it through your network. You should be able to filter on port 5062. If nothing shows up, then it is worth checking that your firewall is configured correctly.

If that does not identify the problem, can you send us debug logs from Bono showing a call? You can find instructions for setting the log level to 5 at http://clearwater.readthedocs.io/en/stable/Troubleshooting_and_Recovery.html#bono.

I hope that helps.

Yours,

Chris

From: Clearwater [mailto:clearwater-bounces at lists.projectclearwater.org<mailto:clearwater-bounces at lists.projectclearwater.org>] On Behalf Of ???
Sent: 27 July 2016 08:15
To: clearwater at lists.projectclearwater.org<mailto:clearwater at lists.projectclearwater.org>
Subject: [Project Clearwater] About Clearwater webRTC

Hi,

I am testing Clearwater webRTC. I try the sipml5 from http://clearwater.readthedocs.io/en/stable/WebRTC_support_in_Clearwater.html page.
I have installed  clearwater to six VMware respectively and used six public ip, and follw the page
instructions with above page, but it seems not work to establish websocket connect to my bono
ip. Then, I try to set SIP outbound proxy options instead of setting websocket options.
It now work and can make a sipnl5-sipml5 call. I use Wireshark to capture sip packets, it seems
sipml5 make a websockets-sip transform through there(sipml5) server with webrtc2sip.

So, I have a question that is clearwater a websockets support or clearwater just dependent on sipml5 server to transform websockets to sip packets then sent to bono!

Is clearwater use websocket with all stages(from register to make a call to speak with other)?

I also try the JSSIP demo, it also cannot make a websocket to the bono 5062 port!!

Looking forward to your reply! Thanks!



-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.projectclearwater.org/pipermail/clearwater_lists.projectclearwater.org/attachments/20160810/c05520d8/attachment.html>

From chris at projectclearwater.org  Wed Aug 10 06:04:53 2016
From: chris at projectclearwater.org (Chris Elford (projectclearwater.org))
Date: Wed, 10 Aug 2016 10:04:53 +0000
Subject: [Project Clearwater] Clearwater installation on Hlinux
In-Reply-To: <CANivR2gMd2+8wKgULn6rCmVvHvMJFoLR4D4xN54qvzvV32Dh+w@mail.gmail.com>
References: <CANivR2gMd2+8wKgULn6rCmVvHvMJFoLR4D4xN54qvzvV32Dh+w@mail.gmail.com>
Message-ID: <CY1PR02MB1181DA8B1DE66EFF30CF3D4EE11D0@CY1PR02MB1181.namprd02.prod.outlook.com>

Hi Surya,

The log below shows that Homestead was trying to connect to Cassandra on port 9160, but that this failed. We have seen this in the past, for a couple of different reasons.

The first possibility is that Cassandra is just not up and running yet. If you wait 10min, does the issue clear?

The second possibility is that something has gone wrong with Cassandra. From the monit output, it looks like it is running, but we should check that:

?         Run `sudo monit status` and check the Cassandra process? uptime.

?         Look for errors in the logs in /var/log/Cassandra.

Otherwise, there are a few places that setting up Cassandra might have gone wrong. If you send me over a diagnostics bundle I may be able to help track down what has gone wrong. If you do, please send this it me directly ? it will not send through the mailing list. You can find instructions for gathering a diagnostics bundle here<https://github.com/Metaswitch/clearwater-infrastructure/blob/master/clearwater-diags-monitor.md>.  It would be great if there is a bundle from Friday.

Yours,

Chris

From: Clearwater [mailto:clearwater-bounces at lists.projectclearwater.org] On Behalf Of surya
Sent: 05 August 2016 13:37
To: clearwater at lists.projectclearwater.org
Subject: [Project Clearwater] Clearwater installation on Hlinux

HI all,

I'm trying to install clearwater on Hlinux( HP version of linux)

I have installed all required packages

Bono,Ellis,Homer services are installed and configure properly. but I'm facing issues with homestead service


[homestead]root at homestead:~# monit summary
Monit 5.18.1 uptime: 51m
 Service Name                     Status                      Type
 node-homestead                   Running                     System
 ntp_process                      Running                     Process
 nginx_process                    Running                     Process
 homestead_process                Execution failed | Does...  Process
 clearwater_queue_manager_pro...  Running                     Process
 etcd_process                     Running                     Process
 clearwater_diags_monitor_pro...  Running                     Process
 clearwater_config_manager        Running                     Process
 clearwater_cluster_manager       Running                     Process
 cassandra_process                Running                     Process
 nginx_uptime                     Status ok                   Program
 monit_uptime                     Status ok                   Program
 homestead_uptime                 Not monitored               Program
 poll_homestead                   Not monitored               Program
 clearwater_queue_manager_uptime  Status ok                   Program
 etcd_uptime                      Status ok                   Program
 poll_etcd_cluster                Status ok                   Program
 poll_etcd                        Status ok                   Program
 cassandra_uptime                 Status ok                   Program
 poll_cassandra                   Status ok                   Program


[homestead]root at homestead:~# LD_LIBRARY_PATH=/usr/share/clearwater/homestead/lib /usr/share/clearwater/bin/homestead
Thrift: Fri Aug  5 07:58:11 2016 TSocket::open() connect() <Host: localhost Port: 9160>Connection refused
05-08-2016 11:58:11.407 UTC Error cassandra_store.cpp:189: Store caught InvalidRequestException: Keyspace 'homestead_cache' does not exist
05-08-2016 11:58:11.408 UTC Error main.cpp:720: Failed to initialize the Cassandra cache with error code 1.


And this is the issue I have seenin homestead log


5-08-2016 12:32:02.163 UTC Error cassandra_store.cpp:189: Store caught InvalidRequestException: Keyspace 'homestead_cache' does not exist
05-08-2016 12:32:02.163 UTC Error main.cpp:720: Failed to initialize the Cassandra cache with error code 1.
05-08-2016 12:32:02.163 UTC Status main.cpp:721: Homestead is shutting down




Please let me know if I'm missing any configuration here



Thanks & Regards,
Surya

--
surya
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.projectclearwater.org/pipermail/clearwater_lists.projectclearwater.org/attachments/20160810/ec0417f5/attachment.html>

From vijayrg at yahoo.com  Wed Aug 10 14:54:32 2016
From: vijayrg at yahoo.com (Vijay)
Date: Wed, 10 Aug 2016 18:54:32 +0000 (UTC)
Subject: [Project Clearwater] bono not able to reach scscf
References: <2030546758.12528516.1470855272189.JavaMail.yahoo.ref@mail.yahoo.com>
Message-ID: <2030546758.12528516.1470855272189.JavaMail.yahoo@mail.yahoo.com>

?Hello,Running all the clearwater docker containers using kubernetes. ?Bono is not able to resolve the ip address for scscf.sprout. I am able to ping scscf.sprout from within bono container but bono does not seem to resolve it. Here is the log?
10-08-2016 18:43:50.083 UTC Status httpconnection.cpp:115: ? Connection created for server ralf:1088810-08-2016 18:43:50.083 UTC Status httpconnection.cpp:116: ? Connection will use a response timeout of 500ms10-08-2016 18:43:50.083 UTC Verbose pjsip: sip_endpoint.c Module "mod-options" registered10-08-2016 18:43:50.083 UTC Status main.cpp:1814: Creating connection to Chronos localhost:7253 using 127.0.0.1:9888 as the callback URI10-08-2016 18:43:50.083 UTC Status httpconnection.cpp:146: Configuring HTTP Connection10-08-2016 18:43:50.083 UTC Status httpconnection.cpp:147: ? Connection created for server localhost:725310-08-2016 18:43:50.083 UTC Status httpconnection.cpp:148: ? Connection will use a response timeout of 500ms10-08-2016 18:43:50.083 UTC Debug acr.cpp:1750: Created RalfACR factory for node type P-CSCF10-08-2016 18:43:50.083 UTC Debug flowtable.cpp:232: Reporting current flow count: 010-08-2016 18:43:50.083 UTC Info snmp_table.h:87: Registering SNMP table bono_connected_sprouts10-08-2016 18:43:50.083 UTC Status connection_pool.cpp:72: Creating connection pool to scscf.sprout:505210-08-2016 18:43:50.083 UTC Status connection_pool.cpp:73: ? connections = 50, recycle time = 600 +/- 120 seconds10-08-2016 18:43:50.083 UTC Debug sipresolver.cpp:86: SIPResolver::resolve for name scscf.sprout, port 5052, transport 6, family 210-08-2016 18:43:50.083 UTC Debug baseresolver.cpp:514: Attempt to parse scscf.sprout as IP address10-08-2016 18:43:50.083 UTC Debug sipresolver.cpp:128: Port is specified10-08-2016 18:43:50.083 UTC Debug sipresolver.cpp:296: Perform A/AAAA record lookup only, name = scscf.sprout10-08-2016 18:43:50.083 UTC Verbose dnscachedresolver.cpp:245: Check cache for scscf.sprout type 110-08-2016 18:43:50.083 UTC Debug dnscachedresolver.cpp:251: No entry found in cache10-08-2016 18:43:50.083 UTC Debug dnscachedresolver.cpp:254: Create cache entry pending query10-08-2016 18:43:50.084 UTC Debug dnscachedresolver.cpp:302: Create and execute DNS query transaction10-08-2016 18:43:50.084 UTC Debug dnscachedresolver.cpp:315: Wait for query responses10-08-2016 18:43:50.085 UTC Debug dnscachedresolver.cpp:465: Received DNS response for scscf.sprout type A10-08-2016 18:43:50.085 UTC Error dnscachedresolver.cpp:607: Failed to retrieve record for scscf.sprout: Domain name not found10-08-2016 18:43:50.085 UTC Debug dnscachedresolver.cpp:707: Adding scscf.sprout to cache expiry list with deletion time of 147085523010-08-2016 18:43:50.085 UTC Debug dnscachedresolver.cpp:319: Received all query responses10-08-2016 18:43:50.085 UTC Debug dnscachedresolver.cpp:347: Pulling 0 records from cache for scscf.sprout A10-08-2016 18:43:50.085 UTC Debug baseresolver.cpp:362: Found 0 A/AAAA records, randomizing10-08-2016 18:43:50.085 UTC Debug baseresolver.cpp:421: Adding 0 servers from blacklist10-08-2016 18:43:50.085 UTC Error connection_pool.cpp:214: Failed to resolve scscf.sprout to an IP address - Not found (PJ_ENOTFOUND)

Also, is there a way to change the domain name (I changed the home_domain and restarted bono service. But, it did not take the change)?
Thanks!
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.projectclearwater.org/pipermail/clearwater_lists.projectclearwater.org/attachments/20160810/2af2f616/attachment.html>

From vijayrg at yahoo.com  Wed Aug 10 15:09:04 2016
From: vijayrg at yahoo.com (Vijay)
Date: Wed, 10 Aug 2016 19:09:04 +0000 (UTC)
Subject: [Project Clearwater] bono not able to reach scscf
In-Reply-To: <2030546758.12528516.1470855272189.JavaMail.yahoo@mail.yahoo.com>
References: <2030546758.12528516.1470855272189.JavaMail.yahoo.ref@mail.yahoo.com>
	<2030546758.12528516.1470855272189.JavaMail.yahoo@mail.yahoo.com>
Message-ID: <2103470613.12155817.1470856144461.JavaMail.yahoo@mail.yahoo.com>

??Hello,


Running all the clearwater docker containers using kubernetes. ?Bono is not able to resolve the ip address for scscf.sprout. I am able to ping scscf.sprout from within bono container but bono does not seem to resolve it. Here is the log?
10-08-2016 18:43:50.083 UTC Status httpconnection.cpp:115: ? Connection created for server ralf:1088810-08-2016 18:43:50.083 UTC Status httpconnection.cpp:116: ? Connection will use a response timeout of 500ms10-08-2016 18:43:50.083 UTC Verbose pjsip: sip_endpoint.c Module "mod-options" registered10-08-2016 18:43:50.083 UTC Status main.cpp:1814: Creating connection to Chronos localhost:7253 using 127.0.0.1:9888 as the callback URI10-08-2016 18:43:50.083 UTC Status httpconnection.cpp:146: Configuring HTTP Connection10-08-2016 18:43:50.083 UTC Status httpconnection.cpp:147: ? Connection created for server localhost:725310-08-2016 18:43:50.083 UTC Status httpconnection.cpp:148: ? Connection will use a response timeout of 500ms10-08-2016 18:43:50.083 UTC Debug acr.cpp:1750: Created RalfACR factory for node type P-CSCF10-08-2016 18:43:50.083 UTC Debug flowtable.cpp:232: Reporting current flow count: 010-08-2016 18:43:50.083 UTC Info snmp_table.h:87: Registering SNMP table bono_connected_sprouts10-08-2016 18:43:50.083 UTC Status connection_pool.cpp:72: Creating connection pool to scscf.sprout:505210-08-2016 18:43:50.083 UTC Status connection_pool.cpp:73: ? connections = 50, recycle time = 600 +/- 120 seconds10-08-2016 18:43:50.083 UTC Debug sipresolver.cpp:86: SIPResolver::resolve for name scscf.sprout, port 5052, transport 6, family 210-08-2016 18:43:50.083 UTC Debug baseresolver.cpp:514: Attempt to parse scscf.sprout as IP address10-08-2016 18:43:50.083 UTC Debug sipresolver.cpp:128: Port is specified10-08-2016 18:43:50.083 UTC Debug sipresolver.cpp:296: Perform A/AAAA record lookup only, name = scscf.sprout10-08-2016 18:43:50.083 UTC Verbose dnscachedresolver.cpp:245: Check cache for scscf.sprout type 110-08-2016 18:43:50.083 UTC Debug dnscachedresolver.cpp:251: No entry found in cache10-08-2016 18:43:50.083 UTC Debug dnscachedresolver.cpp:254: Create cache entry pending query10-08-2016 18:43:50.084 UTC Debug dnscachedresolver.cpp:302: Create and execute DNS query transaction10-08-2016 18:43:50.084 UTC Debug dnscachedresolver.cpp:315: Wait for query responses10-08-2016 18:43:50.085 UTC Debug dnscachedresolver.cpp:465: Received DNS response for scscf.sprout type A10-08-2016 18:43:50.085 UTC Error dnscachedresolver.cpp:607: Failed to retrieve record for scscf.sprout: Domain name not found10-08-2016 18:43:50.085 UTC Debug dnscachedresolver.cpp:707: Adding scscf.sprout to cache expiry list with deletion time of 147085523010-08-2016 18:43:50.085 UTC Debug dnscachedresolver.cpp:319: Received all query responses10-08-2016 18:43:50.085 UTC Debug dnscachedresolver.cpp:347: Pulling 0 records from cache for scscf.sprout A10-08-2016 18:43:50.085 UTC Debug baseresolver.cpp:362: Found 0 A/AAAA records, randomizing10-08-2016 18:43:50.085 UTC Debug baseresolver.cpp:421: Adding 0 servers from blacklist10-08-2016 18:43:50.085 UTC Error connection_pool.cpp:214: Failed to resolve scscf.sprout to an IP address - Not found (PJ_ENOTFOUND)

Also, is there a way to change the domain name (I changed the home_domain and restarted bono service. But, it did not take the change)?
Thanks!

  
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.projectclearwater.org/pipermail/clearwater_lists.projectclearwater.org/attachments/20160810/3d5d38f8/attachment.html>

From vijayrg at yahoo.com  Wed Aug 10 15:12:42 2016
From: vijayrg at yahoo.com (Vijay)
Date: Wed, 10 Aug 2016 19:12:42 +0000 (UTC)
Subject: [Project Clearwater] bono not able to reach scscf
In-Reply-To: <2103470613.12155817.1470856144461.JavaMail.yahoo@mail.yahoo.com>
References: <2030546758.12528516.1470855272189.JavaMail.yahoo.ref@mail.yahoo.com>
	<2030546758.12528516.1470855272189.JavaMail.yahoo@mail.yahoo.com>
	<2103470613.12155817.1470856144461.JavaMail.yahoo@mail.yahoo.com>
Message-ID: <1612379333.2249374.1470856362249.JavaMail.yahoo@mail.yahoo.com>

??


?Hello,


Running all the clearwater docker containers using kubernetes. ?Bono is not able to resolve the ip address for scscf.sprout. I am able to ping scscf.sprout from within bono container but bono does not seem to resolve it. Here is the log?
10-08-2016 18:43:50.083 UTC Status httpconnection.cpp:115: ? Connection created for server ralf:1088810-08-2016 18:43:50.083 UTC Status httpconnection.cpp:116: ? Connection will use a response timeout of 500ms10-08-2016 18:43:50.083 UTC Verbose pjsip: sip_endpoint.c Module "mod-options" registered10-08-2016 18:43:50.083 UTC Status main.cpp:1814: Creating connection to Chronos localhost:7253 using 127.0.0.1:9888 as the callback URI10-08-2016 18:43:50.083 UTC Status httpconnection.cpp:146: Configuring HTTP Connection10-08-2016 18:43:50.083 UTC Status httpconnection.cpp:147: ? Connection created for server localhost:725310-08-2016 18:43:50.083 UTC Status httpconnection.cpp:148: ? Connection will use a response timeout of 500ms10-08-2016 18:43:50.083 UTC Debug acr.cpp:1750: Created RalfACR factory for node type P-CSCF10-08-2016 18:43:50.083 UTC Debug flowtable.cpp:232: Reporting current flow count: 010-08-2016 18:43:50.083 UTC Info snmp_table.h:87: Registering SNMP table bono_connected_sprouts10-08-2016 18:43:50.083 UTC Status connection_pool.cpp:72: Creating connection pool to scscf.sprout:505210-08-2016 18:43:50.083 UTC Status connection_pool.cpp:73: ? connections = 50, recycle time = 600 +/- 120 seconds10-08-2016 18:43:50.083 UTC Debug sipresolver.cpp:86: SIPResolver::resolve for name scscf.sprout, port 5052, transport 6, family 210-08-2016 18:43:50.083 UTC Debug baseresolver.cpp:514: Attempt to parse scscf.sprout as IP address10-08-2016 18:43:50.083 UTC Debug sipresolver.cpp:128: Port is specified10-08-2016 18:43:50.083 UTC Debug sipresolver.cpp:296: Perform A/AAAA record lookup only, name = scscf.sprout10-08-2016 18:43:50.083 UTC Verbose dnscachedresolver.cpp:245: Check cache for scscf.sprout type 110-08-2016 18:43:50.083 UTC Debug dnscachedresolver.cpp:251: No entry found in cache10-08-2016 18:43:50.083 UTC Debug dnscachedresolver.cpp:254: Create cache entry pending query10-08-2016 18:43:50.084 UTC Debug dnscachedresolver.cpp:302: Create and execute DNS query transaction10-08-2016 18:43:50.084 UTC Debug dnscachedresolver.cpp:315: Wait for query responses10-08-2016 18:43:50.085 UTC Debug dnscachedresolver.cpp:465: Received DNS response for scscf.sprout type A10-08-2016 18:43:50.085 UTC Error dnscachedresolver.cpp:607: Failed to retrieve record for scscf.sprout: Domain name not found10-08-2016 18:43:50.085 UTC Debug dnscachedresolver.cpp:707: Adding scscf.sprout to cache expiry list with deletion time of 147010-08-2016 18:43:50.085 UTC Debug dnscachedresolver.cpp:319: Received all query responses10-08-2016 18:43:50.085 UTC Debug dnscachedresolver.cpp:347: Pulling 0 records from cache for scscf.sprout A10-08-2016 18:43:50.085 UTC Debug baseresolver.cpp:362: Found 0 A/AAAA records, randomizing10-08-2016 18:43:50.085 UTC Debug baseresolver.cpp:421: Adding 0 servers from blacklist10-08-2016 18:43:50.085 UTC Error connection_pool.cpp:214: Failed to resolve scscf.sprout to an IP address - Not found (PJ_ENOTFOUND)

Also, is there a way to change the domain name (I changed the home_domain and restarted bono service. But, it did not take the change)?
Thanks!

   

  
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.projectclearwater.org/pipermail/clearwater_lists.projectclearwater.org/attachments/20160810/bb5c7d5e/attachment.html>

From vijayrg at yahoo.com  Wed Aug 10 15:21:08 2016
From: vijayrg at yahoo.com (Vijay)
Date: Wed, 10 Aug 2016 12:21:08 -0700
Subject: [Project Clearwater] bono not able to reach scscf
In-Reply-To: <2103470613.12155817.1470856144461.JavaMail.yahoo@mail.yahoo.com>
References: <2030546758.12528516.1470855272189.JavaMail.yahoo.ref@mail.yahoo.com>
	<2030546758.12528516.1470855272189.JavaMail.yahoo@mail.yahoo.com>
	<2103470613.12155817.1470856144461.JavaMail.yahoo@mail.yahoo.com>
Message-ID: <413B6645-1EFA-4E0C-A0DD-9482261CD1FD@yahoo.com>

 
 


 Hello,


Running all the clearwater docker containers using kubernetes.  Bono is not able to resolve the ip address for scscf.sprout. I am able to ping scscf.sprout from within bono container but bono does not seem to resolve it. Here is the log 

10-08-2016 18:43:50.083 UTC Status httpconnection.cpp:115:   Connection created for server ralf:10888
10-08-2016 18:43:50.083 UTC Status httpconnection.cpp:116:   Connection will use a response timeout of 500ms
10-08-2016 18:43:50.083 UTC Verbose pjsip: sip_endpoint.c Module "mod-options" registered
10-08-2016 18:43:50.083 UTC Status main.cpp:1814: Creating connection to Chronos localhost:7253 using 127.0.0.1:9888 as the callback UR
I
10-08-2016 18:43:50.083 UTC Status httpconnection.cpp:146: Configuring HTTP Connection
10-08-2016 18:43:50.083 UTC Status httpconnection.cpp:147:   Connection created for server localhost:7253
10-08-2016 18:43:50.083 UTC Status httpconnection.cpp:148:   Connection will use a response timeout of 500ms
10-08-2016 18:43:50.083 UTC Debug acr.cpp:1750: Created RalfACR factory for node type P-CSCF
10-08-2016 18:43:50.083 UTC Debug flowtable.cpp:232: Reporting current flow count: 0
10-08-2016 18:43:50.083 UTC Info snmp_table.h:87: Registering SNMP table bono_connected_sprouts
10-08-2016 18:43:50.083 UTC Status connection_pool.cpp:72: Creating connection pool to scscf.sprout:5052
10-08-2016 18:43:50.083 UTC Status connection_pool.cpp:73:   connections = 50, recycle time = 600 +/- 120 seconds
10-08-2016 18:43:50.083 UTC Debug sipresolver.cpp:86: SIPResolver::resolve for name scscf.sprout, port 5052, transport 6, family 2
10-08-2016 18:43:50.083 UTC Debug baseresolver.cpp:514: Attempt to parse scscf.sprout as IP address
10-08-2016 18:43:50.083 UTC Debug sipresolver.cpp:128: Port is specified
10-08-2016 18:43:50.083 UTC Debug sipresolver.cpp:296: Perform A/AAAA record lookup only, name = scscf.sprout
10-08-2016 18:43:50.083 UTC Verbose dnscachedresolver.cpp:245: Check cache for scscf.sprout type 1
10-08-2016 18:43:50.083 UTC Debug dnscachedresolver.cpp:251: No entry found in cache
10-08-2016 18:43:50.083 UTC Debug dnscachedresolver.cpp:254: Create cache entry pending query
10-08-2016 18:43:50.084 UTC Debug dnscachedresolver.cpp:302: Create and execute DNS query transaction
10-08-2016 18:43:50.084 UTC Debug dnscachedresolver.cpp:315: Wait for query responses
10-08-2016 18:43:50.085 UTC Debug dnscachedresolver.cpp:465: Received DNS response for scscf.sprout type A
10-08-2016 18:43:50.085 UTC Error dnscachedresolver.cpp:607: Failed to retrieve record for scscf.sprout: Domain name not found
10-08-2016 18:43:50.085 UTC Debug dnscachedresolver.cpp:707: Adding scscf.sprout to cache expiry list with deletion time of 1470
10-08-2016 18:43:50.085 UTC Debug dnscachedresolver.cpp:319: Received all query responses
10-08-2016 18:43:50.085 UTC Debug dnscachedresolver.cpp:347: Pulling 0 records from cache for scscf.sprout A
10-08-2016 18:43:50.085 UTC Debug baseresolver.cpp:362: Found 0 A/AAAA records, randomizing
10-08-2016 18:43:50.085 UTC Debug baseresolver.cpp:421: Adding 0 servers from blacklist
10-08-2016 18:43:50.085 UTC Error connection_pool.cpp:214: Failed to resolve scscf.sprout to an IP address - Not found (PJ_ENOTFOUND)


Also, is there a way to change the domain name (I changed the home_domain and restarted bono service. But, it did not take the change)?

Thanks!




-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.projectclearwater.org/pipermail/clearwater_lists.projectclearwater.org/attachments/20160810/6734621c/attachment.html>

From vijayrg at yahoo.com  Wed Aug 10 18:55:06 2016
From: vijayrg at yahoo.com (Vijay)
Date: Wed, 10 Aug 2016 15:55:06 -0700
Subject: [Project Clearwater] bono not able to reach scscf
In-Reply-To: <413B6645-1EFA-4E0C-A0DD-9482261CD1FD@yahoo.com>
References: <2030546758.12528516.1470855272189.JavaMail.yahoo.ref@mail.yahoo.com>
	<2030546758.12528516.1470855272189.JavaMail.yahoo@mail.yahoo.com>
	<2103470613.12155817.1470856144461.JavaMail.yahoo@mail.yahoo.com>
	<413B6645-1EFA-4E0C-A0DD-9482261CD1FD@yahoo.com>
Message-ID: <5B1E032C-2B99-4D58-AE73-70786C6A0BD3@yahoo.com>



Fixed the domain not found problem by setting the upstream_hostname correctly. But, now bono continuously  creating chunk of 50 tcp slot connections and because of the bombardment, later pjsip tcp connections are timing out. Is there a specific configuration to throttle this?
Thanks!

> On Aug 10, 2016, at 12:21 PM, Vijay <vijayrg at yahoo.com> wrote:
> 
>  
>  
> 
> 
>  Hello,
> 
> 
> Running all the clearwater docker containers using kubernetes.  Bono is not able to resolve the ip address for scscf.sprout. I am able to ping scscf.sprout from within bono container but bono does not seem to resolve it. Here is the log 
> 
> 10-08-2016 18:43:50.083 UTC Status httpconnection.cpp:115:   Connection created for server ralf:10888
> 10-08-2016 18:43:50.083 UTC Status httpconnection.cpp:116:   Connection will use a response timeout of 500ms
> 10-08-2016 18:43:50.083 UTC Verbose pjsip: sip_endpoint.c Module "mod-options" registered
> 10-08-2016 18:43:50.083 UTC Status main.cpp:1814: Creating connection to Chronos localhost:7253 using 127.0.0.1:9888 as the callback UR
> I
> 10-08-2016 18:43:50.083 UTC Status httpconnection.cpp:146: Configuring HTTP Connection
> 10-08-2016 18:43:50.083 UTC Status httpconnection.cpp:147:   Connection created for server localhost:7253
> 10-08-2016 18:43:50.083 UTC Status httpconnection.cpp:148:   Connection will use a response timeout of 500ms
> 10-08-2016 18:43:50.083 UTC Debug acr.cpp:1750: Created RalfACR factory for node type P-CSCF
> 10-08-2016 18:43:50.083 UTC Debug flowtable.cpp:232: Reporting current flow count: 0
> 10-08-2016 18:43:50.083 UTC Info snmp_table.h:87: Registering SNMP table bono_connected_sprouts
> 10-08-2016 18:43:50.083 UTC Status connection_pool.cpp:72: Creating connection pool to scscf.sprout:5052
> 10-08-2016 18:43:50.083 UTC Status connection_pool.cpp:73:   connections = 50, recycle time = 600 +/- 120 seconds
> 10-08-2016 18:43:50.083 UTC Debug sipresolver.cpp:86: SIPResolver::resolve for name scscf.sprout, port 5052, transport 6, family 2
> 10-08-2016 18:43:50.083 UTC Debug baseresolver.cpp:514: Attempt to parse scscf.sprout as IP address
> 10-08-2016 18:43:50.083 UTC Debug sipresolver.cpp:128: Port is specified
> 10-08-2016 18:43:50.083 UTC Debug sipresolver.cpp:296: Perform A/AAAA record lookup only, name = scscf.sprout
> 10-08-2016 18:43:50.083 UTC Verbose dnscachedresolver.cpp:245: Check cache for scscf.sprout type 1
> 10-08-2016 18:43:50.083 UTC Debug dnscachedresolver.cpp:251: No entry found in cache
> 10-08-2016 18:43:50.083 UTC Debug dnscachedresolver.cpp:254: Create cache entry pending query
> 10-08-2016 18:43:50.084 UTC Debug dnscachedresolver.cpp:302: Create and execute DNS query transaction
> 10-08-2016 18:43:50.084 UTC Debug dnscachedresolver.cpp:315: Wait for query responses
> 10-08-2016 18:43:50.085 UTC Debug dnscachedresolver.cpp:465: Received DNS response for scscf.sprout type A
> 10-08-2016 18:43:50.085 UTC Error dnscachedresolver.cpp:607: Failed to retrieve record for scscf.sprout: Domain name not found
> 10-08-2016 18:43:50.085 UTC Debug dnscachedresolver.cpp:707: Adding scscf.sprout to cache expiry list with deletion time of 1470
> 10-08-2016 18:43:50.085 UTC Debug dnscachedresolver.cpp:319: Received all query responses
> 10-08-2016 18:43:50.085 UTC Debug dnscachedresolver.cpp:347: Pulling 0 records from cache for scscf.sprout A
> 10-08-2016 18:43:50.085 UTC Debug baseresolver.cpp:362: Found 0 A/AAAA records, randomizing
> 10-08-2016 18:43:50.085 UTC Debug baseresolver.cpp:421: Adding 0 servers from blacklist
> 10-08-2016 18:43:50.085 UTC Error connection_pool.cpp:214: Failed to resolve scscf.sprout to an IP address - Not found (PJ_ENOTFOUND)
> 
> 
> Also, is there a way to change the domain name (I changed the home_domain and restarted bono service. But, it did not take the change)?
> 
> Thanks!
> 
> 
> 
> 
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.projectclearwater.org/pipermail/clearwater_lists.projectclearwater.org/attachments/20160810/5786cac6/attachment.html>

From crbertoldo at gmail.com  Wed Aug 10 21:45:03 2016
From: crbertoldo at gmail.com (Claudio Bertoldo)
Date: Wed, 10 Aug 2016 22:45:03 -0300
Subject: [Project Clearwater] Doubt about querying SIP registered subscribers
Message-ID: <CAC6=c0fpfr9-C_QEaKEzbYoW9sbQ2VWNiHpFcFt6DHzh8xzA6w@mail.gmail.com>

Hi,

I'd like to know if it's possible to query the current registered
subscribers, their expiration time (remaining time preferably) and their IP
address. I could not find this info in this list neither in the official
documentation, so if that is there, sorry in advance.

Best regards,

Claudio Bertoldo
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.projectclearwater.org/pipermail/clearwater_lists.projectclearwater.org/attachments/20160810/5dfcc2cf/attachment.html>

From chris at projectclearwater.org  Fri Aug 12 05:58:29 2016
From: chris at projectclearwater.org (Chris Elford (projectclearwater.org))
Date: Fri, 12 Aug 2016 09:58:29 +0000
Subject: [Project Clearwater] Clearwater installation on Hlinux
In-Reply-To: <CANivR2hmBCiLmAK6dqJ8BRvEcy5Qbv_oF2v3Vq1hXdrkdwR9Dw@mail.gmail.com>
References: <CANivR2gMd2+8wKgULn6rCmVvHvMJFoLR4D4xN54qvzvV32Dh+w@mail.gmail.com>
	<CY1PR02MB1181DA8B1DE66EFF30CF3D4EE11D0@CY1PR02MB1181.namprd02.prod.outlook.com>
	<CANivR2jdXxKApA5u4cm+jYdCN4Oig5aj8wERjxvDBN+GCg34aA@mail.gmail.com>
	<CANivR2hmBCiLmAK6dqJ8BRvEcy5Qbv_oF2v3Vq1hXdrkdwR9Dw@mail.gmail.com>
Message-ID: <CY1PR02MB11815AA2C377482E6FAA1D02E11F0@CY1PR02MB1181.namprd02.prod.outlook.com>

Hi Surya,

Thank you for sending over the details. It looks like Cassandra is starting up, but that Homestead is failing to connect to it.

You can see that Cassandra is listening on 0.0.0.0:9160 from netstat.txt, and from /var/log/cassandra/system.log:

INFO [main] 2016-08-10 11:45:21,948 TServerCustomFactory.java (line 47) Using synchronous/threadpool thrift server on 0.0.0.0 : 9160
INFO [Thread-8] 2016-08-10 11:45:21,948 ThriftServer.java (line 135) Listening for thrift clients...

After this, Homestead still fails to connect. From /var/log/homestead/homestead_err.log:

Thrift: Wed Aug 10 11:45:51 2016 TSocket::open() connect() <Host: localhost Port: 9160>Connection refused
Thrift: Wed Aug 10 11:46:32 2016 TSocket::open() connect() <Host: localhost Port: 9160>Connection refused

Our current best theory is that localhost on your system is resolving to the IPv6 address ::0 rather than the IP address 127.0.0.1. As Cassandra is listening on IPv4 only, that would stop Homestead connecting.

You can confirm that by running nslookup localhost on your system.

If that is the issue, then we can work out how to fix it.

I?m on vacation from tomorrow, so I won?t be able to respond to any emails on this issue. I suggest mailing the list for help while I?m gone.

Chris

From: surya [mailto:surya.nayani at gmail.com]
Sent: 10 August 2016 16:57
To: Chris Elford (projectclearwater.org) <chris at projectclearwater.org>
Subject: Re: [Project Clearwater] Clearwater installation on Hlinux

Hello Chris,

I have reinstalled the clearwater VM's.  This time I got the dump file

Please find the attached log file


Please let me know if you need any other logs

Thanks & regards,
Surya

On Wed, Aug 10, 2016 at 3:44 PM, surya <surya.nayani at gmail.com<mailto:surya.nayani at gmail.com>> wrote:
Hello Chris,

Thanks a lot for responding

I could not find any dumps in homestead node

This is the output on my node

[homestead]root at homestead:/var/clearwater-diags-monitor# cd dumps/
[homestead]root at homestead:/var/clearwater-diags-monitor/dumps# ls
[homestead]root at homestead:/var/clearwater-diags-monitor/dumps# cd ../tmp/
[homestead]root at homestead:/var/clearwater-diags-monitor/tmp# ls
[homestead]root at homestead:/var/clearwater-diags-monitor/tmp# cd ..
[homestead]root at homestead:/var/clearwater-diags-monitor# /usr/share/clearwater/bin/gather_diags
gather_diags:
This script triggers diagnostics collection.

The packaged diagnostics are created in /var/clearwater-diags-monitor/dumps/*.tar.gz
[homestead]root at homestead:/var/clearwater-diags-monitor# cd dumps/
[homestead]root at homestead:/var/clearwater-diags-monitor/dumps# ls
[homestead]root at homestead:/var/clearwater-diags-monitor/dumps# ls -a
.  ..




Please let me know if you need any other logs

Thanks & Regards,
Surya

On Wed, Aug 10, 2016 at 3:34 PM, Chris Elford (projectclearwater.org<http://projectclearwater.org>) <chris at projectclearwater.org<mailto:chris at projectclearwater.org>> wrote:
Hi Surya,

The log below shows that Homestead was trying to connect to Cassandra on port 9160, but that this failed. We have seen this in the past, for a couple of different reasons.

The first possibility is that Cassandra is just not up and running yet. If you wait 10min, does the issue clear?

The second possibility is that something has gone wrong with Cassandra. From the monit output, it looks like it is running, but we should check that:

?         Run `sudo monit status` and check the Cassandra process? uptime.

?         Look for errors in the logs in /var/log/Cassandra.

Otherwise, there are a few places that setting up Cassandra might have gone wrong. If you send me over a diagnostics bundle I may be able to help track down what has gone wrong. If you do, please send this it me directly ? it will not send through the mailing list. You can find instructions for gathering a diagnostics bundle here<https://github.com/Metaswitch/clearwater-infrastructure/blob/master/clearwater-diags-monitor.md>.  It would be great if there is a bundle from Friday.

Yours,

Chris

From: Clearwater [mailto:clearwater-bounces at lists.projectclearwater.org<mailto:clearwater-bounces at lists.projectclearwater.org>] On Behalf Of surya
Sent: 05 August 2016 13:37
To: clearwater at lists.projectclearwater.org<mailto:clearwater at lists.projectclearwater.org>
Subject: [Project Clearwater] Clearwater installation on Hlinux

HI all,

I'm trying to install clearwater on Hlinux( HP version of linux)

I have installed all required packages

Bono,Ellis,Homer services are installed and configure properly. but I'm facing issues with homestead service


[homestead]root at homestead:~# monit summary
Monit 5.18.1 uptime: 51m
 Service Name                     Status                      Type
 node-homestead                   Running                     System
 ntp_process                      Running                     Process
 nginx_process                    Running                     Process
 homestead_process                Execution failed | Does...  Process
 clearwater_queue_manager_pro...  Running                     Process
 etcd_process                     Running                     Process
 clearwater_diags_monitor_pro...  Running                     Process
 clearwater_config_manager        Running                     Process
 clearwater_cluster_manager       Running                     Process
 cassandra_process                Running                     Process
 nginx_uptime                     Status ok                   Program
 monit_uptime                     Status ok                   Program
 homestead_uptime                 Not monitored               Program
 poll_homestead                   Not monitored               Program
 clearwater_queue_manager_uptime  Status ok                   Program
 etcd_uptime                      Status ok                   Program
 poll_etcd_cluster                Status ok                   Program
 poll_etcd                        Status ok                   Program
 cassandra_uptime                 Status ok                   Program
 poll_cassandra                   Status ok                   Program


[homestead]root at homestead:~# LD_LIBRARY_PATH=/usr/share/clearwater/homestead/lib /usr/share/clearwater/bin/homestead
Thrift: Fri Aug  5 07:58:11 2016 TSocket::open() connect() <Host: localhost Port: 9160>Connection refused
05-08-2016 11:58:11.407 UTC Error cassandra_store.cpp:189: Store caught InvalidRequestException: Keyspace 'homestead_cache' does not exist
05-08-2016 11:58:11.408 UTC Error main.cpp:720: Failed to initialize the Cassandra cache with error code 1.


And this is the issue I have seenin homestead log


5-08-2016 12:32:02.163 UTC Error cassandra_store.cpp:189: Store caught InvalidRequestException: Keyspace 'homestead_cache' does not exist
05-08-2016 12:32:02.163 UTC Error main.cpp:720: Failed to initialize the Cassandra cache with error code 1.
05-08-2016 12:32:02.163 UTC Status main.cpp:721: Homestead is shutting down




Please let me know if I'm missing any configuration here



Thanks & Regards,
Surya

--
surya



--
surya



--
surya
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.projectclearwater.org/pipermail/clearwater_lists.projectclearwater.org/attachments/20160812/7de3057e/attachment.html>

From eleanor at projectclearwater.org  Fri Aug 12 13:00:39 2016
From: eleanor at projectclearwater.org (Eleanor Merry (projectclearwater.org))
Date: Fri, 12 Aug 2016 17:00:39 +0000
Subject: [Project Clearwater] bono not able to reach scscf
In-Reply-To: <CY1PR02MB11812BF901E050A0BFD5D062E11E0@CY1PR02MB1181.namprd02.prod.outlook.com>
References: <2030546758.12528516.1470855272189.JavaMail.yahoo.ref@mail.yahoo.com>
	<2030546758.12528516.1470855272189.JavaMail.yahoo@mail.yahoo.com>
	<2103470613.12155817.1470856144461.JavaMail.yahoo@mail.yahoo.com>
	<413B6645-1EFA-4E0C-A0DD-9482261CD1FD@yahoo.com>
	<5B1E032C-2B99-4D58-AE73-70786C6A0BD3@yahoo.com>
	<CY1PR02MB11812BF901E050A0BFD5D062E11E0@CY1PR02MB1181.namprd02.prod.outlook.com>
Message-ID: <BL2PR02MB208411A83D32EC17E3E7438C9B1F0@BL2PR02MB2084.namprd02.prod.outlook.com>

Hi,

I?m not sure what you mean when you say Bono is continuously creating 50 TCP connections. Bono creates 50 TCP connections to the Sprout cluster when it starts up, and these connections are regularly recycled (so there?s frequent ?Recycle TCP connection slot? entries in the log file).

Can you explain further the problem you?re having? Also, can you send over the debug logs for Bono?

Ellie

From: Clearwater [mailto:clearwater-bounces at lists.projectclearwater.org] On Behalf Of Vijay
Sent: 10 August 2016 23:55
To: clearwater at lists.projectclearwater.org<mailto:clearwater at lists.projectclearwater.org>
Subject: Re: [Project Clearwater] bono not able to reach scscf



Fixed the domain not found problem by setting the upstream_hostname correctly. But, now bono continuously  creating chunk of 50 tcp slot connections and because of the bombardment, later pjsip tcp connections are timing out. Is there a specific configuration to throttle this?
Thanks!

On Aug 10, 2016, at 12:21 PM, Vijay <vijayrg at yahoo.com<mailto:vijayrg at yahoo.com>> wrote:



 Hello,

Running all the clearwater docker containers using kubernetes.  Bono is not able to resolve the ip address for scscf.sprout. I am able to ping scscf.sprout from within bono container but bono does not seem to resolve it. Here is the log

10-08-2016 18:43:50.083 UTC Status httpconnection.cpp:115:   Connection created for server ralf:10888
10-08-2016 18:43:50.083 UTC Status httpconnection.cpp:116:   Connection will use a response timeout of 500ms
10-08-2016 18:43:50.083 UTC Verbose pjsip: sip_endpoint.c Module "mod-options" registered
10-08-2016 18:43:50.083 UTC Status main.cpp:1814: Creating connection to Chronos localhost:7253 using 127.0.0.1:9888 as the callback UR
I
10-08-2016 18:43:50.083 UTC Status httpconnection.cpp:146: Configuring HTTP Connection
10-08-2016 18:43:50.083 UTC Status httpconnection.cpp:147:   Connection created for server localhost:7253
10-08-2016 18:43:50.083 UTC Status httpconnection.cpp:148:   Connection will use a response timeout of 500ms
10-08-2016 18:43:50.083 UTC Debug acr.cpp:1750: Created RalfACR factory for node type P-CSCF
10-08-2016 18:43:50.083 UTC Debug flowtable.cpp:232: Reporting current flow count: 0
10-08-2016 18:43:50.083 UTC Info snmp_table.h:87: Registering SNMP table bono_connected_sprouts
10-08-2016 18:43:50.083 UTC Status connection_pool.cpp:72: Creating connection pool to scscf.sprout:5052
10-08-2016 18:43:50.083 UTC Status connection_pool.cpp:73:   connections = 50, recycle time = 600 +/- 120 seconds
10-08-2016 18:43:50.083 UTC Debug sipresolver.cpp:86: SIPResolver::resolve for name scscf.sprout, port 5052, transport 6, family 2
10-08-2016 18:43:50.083 UTC Debug baseresolver.cpp:514: Attempt to parse scscf.sprout as IP address
10-08-2016 18:43:50.083 UTC Debug sipresolver.cpp:128: Port is specified
10-08-2016 18:43:50.083 UTC Debug sipresolver.cpp:296: Perform A/AAAA record lookup only, name = scscf.sprout
10-08-2016 18:43:50.083 UTC Verbose dnscachedresolver.cpp:245: Check cache for scscf.sprout type 1
10-08-2016 18:43:50.083 UTC Debug dnscachedresolver.cpp:251: No entry found in cache
10-08-2016 18:43:50.083 UTC Debug dnscachedresolver.cpp:254: Create cache entry pending query
10-08-2016 18:43:50.084 UTC Debug dnscachedresolver.cpp:302: Create and execute DNS query transaction
10-08-2016 18:43:50.084 UTC Debug dnscachedresolver.cpp:315: Wait for query responses
10-08-2016 18:43:50.085 UTC Debug dnscachedresolver.cpp:465: Received DNS response for scscf.sprout type A
10-08-2016 18:43:50.085 UTC Error dnscachedresolver.cpp:607: Failed to retrieve record for scscf.sprout: Domain name not found
10-08-2016 18:43:50.085 UTC Debug dnscachedresolver.cpp:707: Adding scscf.sprout to cache expiry list with deletion time of 1470
10-08-2016 18:43:50.085 UTC Debug dnscachedresolver.cpp:319: Received all query responses
10-08-2016 18:43:50.085 UTC Debug dnscachedresolver.cpp:347: Pulling 0 records from cache for scscf.sprout A
10-08-2016 18:43:50.085 UTC Debug baseresolver.cpp:362: Found 0 A/AAAA records, randomizing
10-08-2016 18:43:50.085 UTC Debug baseresolver.cpp:421: Adding 0 servers from blacklist
10-08-2016 18:43:50.085 UTC Error connection_pool.cpp:214: Failed to resolve scscf.sprout to an IP address - Not found (PJ_ENOTFOUND)


Also, is there a way to change the domain name (I changed the home_domain and restarted bono service. But, it did not take the change)?

Thanks!


-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.projectclearwater.org/pipermail/clearwater_lists.projectclearwater.org/attachments/20160812/9460b1d3/attachment.html>

From eleanor at projectclearwater.org  Fri Aug 12 13:38:49 2016
From: eleanor at projectclearwater.org (Eleanor Merry (projectclearwater.org))
Date: Fri, 12 Aug 2016 17:38:49 +0000
Subject: [Project Clearwater] Doubt about querying SIP registered
 subscribers
In-Reply-To: <CAC6=c0fpfr9-C_QEaKEzbYoW9sbQ2VWNiHpFcFt6DHzh8xzA6w@mail.gmail.com>
References: <CAC6=c0fpfr9-C_QEaKEzbYoW9sbQ2VWNiHpFcFt6DHzh8xzA6w@mail.gmail.com>
Message-ID: <BL2PR02MB208471FDBF223CB10666DD3E9B1F0@BL2PR02MB2084.namprd02.prod.outlook.com>

Hi Claudio,

There?s no official way of getting this information I?m afraid.

The information you want is stored in our memcached database. I?ve had a look around for supported methods of pulling all the values out of memcached, but I?ve not had much luck.

There?s ?memcached-tool? (/usr/share/memcached/scripts/memcached-tool <local ip>:11211 dump) which should report all the keys and values stored in memcached, but I?ve found this just hangs on my machine.

There?s also using the output of ?stats cachedump?, but I?ve found that this gives me the output ?SERVER_ERROR out of memory writing stats? (and it doesn?t appear to be an officially supported debug tool from memcached).

You may have more luck with these methods!

Ellie

From: Clearwater [mailto:clearwater-bounces at lists.projectclearwater.org] On Behalf Of Claudio Bertoldo
Sent: 11 August 2016 02:45
To: clearwater at lists.projectclearwater.org
Subject: [Project Clearwater] Doubt about querying SIP registered subscribers

Hi,

I'd like to know if it's possible to query the current registered subscribers, their expiration time (remaining time preferably) and their IP address. I could not find this info in this list neither in the official documentation, so if that is there, sorry in advance.

Best regards,

Claudio Bertoldo
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.projectclearwater.org/pipermail/clearwater_lists.projectclearwater.org/attachments/20160812/e2df99e4/attachment.html>

From vijayrg at yahoo.com  Fri Aug 12 16:12:06 2016
From: vijayrg at yahoo.com (Vijay)
Date: Fri, 12 Aug 2016 20:12:06 +0000 (UTC)
Subject: [Project Clearwater] Too many hops error
References: <44984089.13384646.1471032726071.JavaMail.yahoo.ref@mail.yahoo.com>
Message-ID: <44984089.13384646.1471032726071.JavaMail.yahoo@mail.yahoo.com>

?Hello,I am using Kubernetes to deploy clearwater. I have scscf.sprout kubernetes service created. In bono and sprout /etc/clearwater/shared_config, for upstream_hostname, ?if I use the full address of the service, I get "too many Hop"s error when the clients try to register. I had to replace that by ip address of the container (which may change if it crashes or restarts). Is there a way to set the hop count or any other configuration settings?Thanks!
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.projectclearwater.org/pipermail/clearwater_lists.projectclearwater.org/attachments/20160812/9e4fccb1/attachment.html>

From kosalayb at gmail.com  Mon Aug 15 05:38:57 2016
From: kosalayb at gmail.com (Kosala)
Date: Mon, 15 Aug 2016 10:38:57 +0100
Subject: [Project Clearwater] Stress Testing
Message-ID: <CAGEe17an2B_bGj8NfKFwms+nU=vJURyhT5CE+mcY1pjcm4YF+A@mail.gmail.com>

Hi Team,

I installed clearwater "all-in-one" image on Oracle Virtual Box.
1. Can I do stress testing ?
2. How to do that?

I am trying to follow Stress Testing on
http://clearwater.readthedocs.io/en/stable/Clearwater_stress_testing.html#configuring-udp-stress
.

Using chef - > It seems chef/knife install only supports in the Cloud
approach (The automated install is only supported for deployments running
in Amazon?s EC2 cloud).

Manual approach, It looks not supporting all in one image.

Many Thanks
Kosala
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.projectclearwater.org/pipermail/clearwater_lists.projectclearwater.org/attachments/20160815/15fc3b07/attachment.html>

From matt at projectclearwater.org  Mon Aug 15 05:54:02 2016
From: matt at projectclearwater.org (Matt Williams (projectclearwater.org))
Date: Mon, 15 Aug 2016 09:54:02 +0000
Subject: [Project Clearwater] Stress Testing
In-Reply-To: <CAGEe17an2B_bGj8NfKFwms+nU=vJURyhT5CE+mcY1pjcm4YF+A@mail.gmail.com>
References: <CAGEe17an2B_bGj8NfKFwms+nU=vJURyhT5CE+mcY1pjcm4YF+A@mail.gmail.com>
Message-ID: <CY1PR0201MB15636F1F20EB91BB180F053390120@CY1PR0201MB1563.namprd02.prod.outlook.com>

Kosala,

While it's theoretically possible to do stress testing against an all-in-one image, I'd recommend against it - the all-in-one image has been squeezed down a lot to fit on a single VM and we'd expect very low performance out of it, and I could believe that overload behavior might be suboptimal.  If you're looking to stress test for performance reasons, I'd strongly recommend running a full deployment as this will give you much more reliable numbers.  If you're looking to stress test for other reasons, please can you share a bit more about what you're trying to achieve, and we can have a think about what would work best?

If you do really want to run stress testing against an all-in-one image, it should probably work, even though http://clearwater.readthedocs.io/en/latest/Clearwater_stress_testing.html#manual-i-e-non-chef-stress-runs only talks about Chef and manual installs.  You'd need to set the "bono_servers" option in /etc/clearwater/shared_config to point to your all-in-one node, and I suspect you'd need to reduce the "count" option to something a lot lower - I'd start around 5000 and see how that goes.

I hope that helps.  Please let me know how you get on.

Thanks,

Matt

From: Clearwater [mailto:clearwater-bounces at lists.projectclearwater.org] On Behalf Of Kosala
Sent: 15 August 2016 10:39
To: clearwater at lists.projectclearwater.org
Subject: [Project Clearwater] Stress Testing

Hi Team,
I installed clearwater "all-in-one" image on Oracle Virtual Box.
1. Can I do stress testing ?
2. How to do that?
I am trying to follow Stress Testing on http://clearwater.readthedocs.io/en/stable/Clearwater_stress_testing.html#configuring-udp-stress.
Using chef - > It seems chef/knife install only supports in the Cloud approach (The automated install is only supported for deployments running in Amazon?s EC2 cloud).
Manual approach, It looks not supporting all in one image.
Many Thanks
Kosala

-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.projectclearwater.org/pipermail/clearwater_lists.projectclearwater.org/attachments/20160815/29d6328d/attachment.html>

From matt at projectclearwater.org  Mon Aug 15 09:16:47 2016
From: matt at projectclearwater.org (Matt Williams (projectclearwater.org))
Date: Mon, 15 Aug 2016 13:16:47 +0000
Subject: [Project Clearwater] Stress Testing
In-Reply-To: <CAGEe17Zrx7xXmzETcfoATXT==ynwVE=BZ8scB+ROByPpkbtz4w@mail.gmail.com>
References: <CAGEe17an2B_bGj8NfKFwms+nU=vJURyhT5CE+mcY1pjcm4YF+A@mail.gmail.com>
	<CY1PR0201MB15636F1F20EB91BB180F053390120@CY1PR0201MB1563.namprd02.prod.outlook.com>
	<CAGEe17Zrx7xXmzETcfoATXT==ynwVE=BZ8scB+ROByPpkbtz4w@mail.gmail.com>
Message-ID: <CY1PR0201MB156372246DC5A77B11839F9D90120@CY1PR0201MB1563.namprd02.prod.outlook.com>

Kosala,

You'll need to follow all the steps in http://clearwater.readthedocs.io/en/latest/Clearwater_stress_testing.html#manual-i-e-non-chef-stress-runs, i.e. bulk provisioning subscribers and installing clearwater-sip-stress, but that should be it.

Just to be clear, though, you'll need to set the configuration and install the clearwater-sip-stress package on a separate VM, not on the all-in-one image itself - the all-in-one image almost certainly opens up ports that conflict with those that clearwater-sip-stress tries to use.

This isn't a very well-trodden path, though, so you may hit further issues - let me know if so, and we can try to work through them.

Cheers,

Matt

From: Kosala [mailto:kosalayb at gmail.com]
Sent: 15 August 2016 13:41
To: Matt Williams (projectclearwater.org) <matt at projectclearwater.org>
Subject: Re: [Project Clearwater] Stress Testing

Hi Matt,
Thanks. I set the bono_servers option. Should I add count =5000 to /etc/clearwater/shared_config ?

Do I need other changes to run stress tests on all-in-one image?
Thanks
Kosala



On Mon, Aug 15, 2016 at 10:54 AM, Matt Williams (projectclearwater.org<http://projectclearwater.org>) <matt at projectclearwater.org<mailto:matt at projectclearwater.org>> wrote:
Kosala,

While it's theoretically possible to do stress testing against an all-in-one image, I'd recommend against it - the all-in-one image has been squeezed down a lot to fit on a single VM and we'd expect very low performance out of it, and I could believe that overload behavior might be suboptimal.  If you're looking to stress test for performance reasons, I'd strongly recommend running a full deployment as this will give you much more reliable numbers.  If you're looking to stress test for other reasons, please can you share a bit more about what you're trying to achieve, and we can have a think about what would work best?

If you do really want to run stress testing against an all-in-one image, it should probably work, even though http://clearwater.readthedocs.io/en/latest/Clearwater_stress_testing.html#manual-i-e-non-chef-stress-runs only talks about Chef and manual installs.  You'd need to set the "bono_servers" option in /etc/clearwater/shared_config to point to your all-in-one node, and I suspect you'd need to reduce the "count" option to something a lot lower - I'd start around 5000 and see how that goes.

I hope that helps.  Please let me know how you get on.

Thanks,

Matt

From: Clearwater [mailto:clearwater-bounces at lists.projectclearwater.org<mailto:clearwater-bounces at lists.projectclearwater.org>] On Behalf Of Kosala
Sent: 15 August 2016 10:39
To: clearwater at lists.projectclearwater.org<mailto:clearwater at lists.projectclearwater.org>
Subject: [Project Clearwater] Stress Testing

Hi Team,
I installed clearwater "all-in-one" image on Oracle Virtual Box.
1. Can I do stress testing ?
2. How to do that?
I am trying to follow Stress Testing on http://clearwater.readthedocs.io/en/stable/Clearwater_stress_testing.html#configuring-udp-stress.
Using chef - > It seems chef/knife install only supports in the Cloud approach (The automated install is only supported for deployments running in Amazon?s EC2 cloud).
Manual approach, It looks not supporting all in one image.
Many Thanks
Kosala


-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.projectclearwater.org/pipermail/clearwater_lists.projectclearwater.org/attachments/20160815/11781755/attachment.html>

From kosalayb at gmail.com  Mon Aug 15 11:57:34 2016
From: kosalayb at gmail.com (Kosala)
Date: Mon, 15 Aug 2016 16:57:34 +0100
Subject: [Project Clearwater] Clearwater Digest, Vol 40, Issue 24
In-Reply-To: <mailman.20.1471267072.11502.clearwater_lists.projectclearwater.org@lists.projectclearwater.org>
References: <mailman.20.1471267072.11502.clearwater_lists.projectclearwater.org@lists.projectclearwater.org>
Message-ID: <CAGEe17ZLnypQfbzxEwxj9EaB20MUBVpY+YdN-Obv=gHpZmG0KA@mail.gmail.com>

HI Matt,

Thanks.

I am trying to follow
https://github.com/Metaswitch/crest/blob/dev/src/metaswitch/crest/tools/sstable_provisioning/README.md
for bulk provisioning.

When I am trying to execute sudo ./BulkProvision homer 21000 29999
example.com 7kkzTyGW in all-in-one image,
I am getting an error  java.lang.UnsupportedClassVersionError:
ClearwaterBulkProvisioner : Unsupported major.minor version 52.0

Java version info in all-in-one image:
[cw-aio]ubuntu at cwaio:/usr/share/clearwater/crest/tools/sstable_provisioning$
java -version
java version "1.7.0_101"
OpenJDK Runtime Environment (IcedTea 2.6.6) (7u101-2.6.6-0ubuntu0.14.04.1)
OpenJDK 64-Bit Server VM (build 24.95-b01, mixed mode)


Thanks
Kosala




On Mon, Aug 15, 2016 at 2:17 PM, <
clearwater-request at lists.projectclearwater.org> wrote:

> Send Clearwater mailing list submissions to
>         clearwater at lists.projectclearwater.org
>
> To subscribe or unsubscribe via the World Wide Web, visit
>         http://lists.projectclearwater.org/mailman/
> listinfo/clearwater_lists.projectclearwater.org
>
> or, via email, send a message with subject or body 'help' to
>         clearwater-request at lists.projectclearwater.org
>
> You can reach the person managing the list at
>         clearwater-owner at lists.projectclearwater.org
>
> When replying, please edit your Subject line so it is more specific
> than "Re: Contents of Clearwater digest..."
>
>
> Today's Topics:
>
>    1. Stress Testing (Kosala)
>    2. Re: Stress Testing (Matt Williams (projectclearwater.org))
>    3. Re: Stress Testing (Matt Williams (projectclearwater.org))
>
>
> ----------------------------------------------------------------------
>
> Message: 1
> Date: Mon, 15 Aug 2016 10:38:57 +0100
> From: Kosala <kosalayb at gmail.com>
> To: clearwater at lists.projectclearwater.org
> Subject: [Project Clearwater] Stress Testing
> Message-ID:
>         <CAGEe17an2B_bGj8NfKFwms+nU=vJURyhT5CE+mcY1pjcm4YF+A at mail.
> gmail.com>
> Content-Type: text/plain; charset="utf-8"
>
> Hi Team,
>
> I installed clearwater "all-in-one" image on Oracle Virtual Box.
> 1. Can I do stress testing ?
> 2. How to do that?
>
> I am trying to follow Stress Testing on
> http://clearwater.readthedocs.io/en/stable/Clearwater_stress_testing.html#
> configuring-udp-stress
> .
>
> Using chef - > It seems chef/knife install only supports in the Cloud
> approach (The automated install is only supported for deployments running
> in Amazon?s EC2 cloud).
>
> Manual approach, It looks not supporting all in one image.
>
> Many Thanks
> Kosala
> -------------- next part --------------
> An HTML attachment was scrubbed...
> URL: <http://lists.projectclearwater.org/pipermail/clearwater_lists.
> projectclearwater.org/attachments/20160815/15fc3b07/attachment-0001.html>
>
> ------------------------------
>
> Message: 2
> Date: Mon, 15 Aug 2016 09:54:02 +0000
> From: "Matt Williams (projectclearwater.org)"
>         <matt at projectclearwater.org>
> To: Kosala <kosalayb at gmail.com>
> Cc: "clearwater at lists.projectclearwater.org"
>         <clearwater at lists.projectclearwater.org>
> Subject: Re: [Project Clearwater] Stress Testing
> Message-ID:
>         <CY1PR0201MB15636F1F20EB91BB180F053390120 at CY1PR0201MB1563.
> namprd02.prod.outlook.com>
>
> Content-Type: text/plain; charset="utf-8"
>
> Kosala,
>
> While it's theoretically possible to do stress testing against an
> all-in-one image, I'd recommend against it - the all-in-one image has been
> squeezed down a lot to fit on a single VM and we'd expect very low
> performance out of it, and I could believe that overload behavior might be
> suboptimal.  If you're looking to stress test for performance reasons, I'd
> strongly recommend running a full deployment as this will give you much
> more reliable numbers.  If you're looking to stress test for other reasons,
> please can you share a bit more about what you're trying to achieve, and we
> can have a think about what would work best?
>
> If you do really want to run stress testing against an all-in-one image,
> it should probably work, even though http://clearwater.readthedocs.
> io/en/latest/Clearwater_stress_testing.html#manual-i-
> e-non-chef-stress-runs only talks about Chef and manual installs.  You'd
> need to set the "bono_servers" option in /etc/clearwater/shared_config to
> point to your all-in-one node, and I suspect you'd need to reduce the
> "count" option to something a lot lower - I'd start around 5000 and see how
> that goes.
>
> I hope that helps.  Please let me know how you get on.
>
> Thanks,
>
> Matt
>
> From: Clearwater [mailto:clearwater-bounces at lists.projectclearwater.org]
> On Behalf Of Kosala
> Sent: 15 August 2016 10:39
> To: clearwater at lists.projectclearwater.org
> Subject: [Project Clearwater] Stress Testing
>
> Hi Team,
> I installed clearwater "all-in-one" image on Oracle Virtual Box.
> 1. Can I do stress testing ?
> 2. How to do that?
> I am trying to follow Stress Testing on http://clearwater.readthedocs.
> io/en/stable/Clearwater_stress_testing.html#configuring-udp-stress.
> Using chef - > It seems chef/knife install only supports in the Cloud
> approach (The automated install is only supported for deployments running
> in Amazon?s EC2 cloud).
> Manual approach, It looks not supporting all in one image.
> Many Thanks
> Kosala
>
> -------------- next part --------------
> An HTML attachment was scrubbed...
> URL: <http://lists.projectclearwater.org/pipermail/clearwater_lists.
> projectclearwater.org/attachments/20160815/29d6328d/attachment-0001.html>
>
> ------------------------------
>
> Message: 3
> Date: Mon, 15 Aug 2016 13:16:47 +0000
> From: "Matt Williams (projectclearwater.org)"
>         <matt at projectclearwater.org>
> To: "clearwater at lists.projectclearwater.org"
>         <clearwater at lists.projectclearwater.org>
> Subject: Re: [Project Clearwater] Stress Testing
> Message-ID:
>         <CY1PR0201MB156372246DC5A77B11839F9D90120 at CY1PR0201MB1563.
> namprd02.prod.outlook.com>
>
> Content-Type: text/plain; charset="utf-8"
>
> Kosala,
>
> You'll need to follow all the steps in http://clearwater.readthedocs.
> io/en/latest/Clearwater_stress_testing.html#manual-i-
> e-non-chef-stress-runs, i.e. bulk provisioning subscribers and installing
> clearwater-sip-stress, but that should be it.
>
> Just to be clear, though, you'll need to set the configuration and install
> the clearwater-sip-stress package on a separate VM, not on the all-in-one
> image itself - the all-in-one image almost certainly opens up ports that
> conflict with those that clearwater-sip-stress tries to use.
>
> This isn't a very well-trodden path, though, so you may hit further issues
> - let me know if so, and we can try to work through them.
>
> Cheers,
>
> Matt
>
> From: Kosala [mailto:kosalayb at gmail.com]
> Sent: 15 August 2016 13:41
> To: Matt Williams (projectclearwater.org) <matt at projectclearwater.org>
> Subject: Re: [Project Clearwater] Stress Testing
>
> Hi Matt,
> Thanks. I set the bono_servers option. Should I add count =5000 to
> /etc/clearwater/shared_config ?
>
> Do I need other changes to run stress tests on all-in-one image?
> Thanks
> Kosala
>
>
>
> On Mon, Aug 15, 2016 at 10:54 AM, Matt Williams (projectclearwater.org<
> http://projectclearwater.org>) <matt at projectclearwater.org<mailto:
> matt at projectclearwater.org>> wrote:
> Kosala,
>
> While it's theoretically possible to do stress testing against an
> all-in-one image, I'd recommend against it - the all-in-one image has been
> squeezed down a lot to fit on a single VM and we'd expect very low
> performance out of it, and I could believe that overload behavior might be
> suboptimal.  If you're looking to stress test for performance reasons, I'd
> strongly recommend running a full deployment as this will give you much
> more reliable numbers.  If you're looking to stress test for other reasons,
> please can you share a bit more about what you're trying to achieve, and we
> can have a think about what would work best?
>
> If you do really want to run stress testing against an all-in-one image,
> it should probably work, even though http://clearwater.readthedocs.
> io/en/latest/Clearwater_stress_testing.html#manual-i-
> e-non-chef-stress-runs only talks about Chef and manual installs.  You'd
> need to set the "bono_servers" option in /etc/clearwater/shared_config to
> point to your all-in-one node, and I suspect you'd need to reduce the
> "count" option to something a lot lower - I'd start around 5000 and see how
> that goes.
>
> I hope that helps.  Please let me know how you get on.
>
> Thanks,
>
> Matt
>
> From: Clearwater [mailto:clearwater-bounces at lists.projectclearwater.org<
> mailto:clearwater-bounces at lists.projectclearwater.org>] On Behalf Of
> Kosala
> Sent: 15 August 2016 10:39
> To: clearwater at lists.projectclearwater.org<mailto:clearwater at lists.
> projectclearwater.org>
> Subject: [Project Clearwater] Stress Testing
>
> Hi Team,
> I installed clearwater "all-in-one" image on Oracle Virtual Box.
> 1. Can I do stress testing ?
> 2. How to do that?
> I am trying to follow Stress Testing on http://clearwater.readthedocs.
> io/en/stable/Clearwater_stress_testing.html#configuring-udp-stress.
> Using chef - > It seems chef/knife install only supports in the Cloud
> approach (The automated install is only supported for deployments running
> in Amazon?s EC2 cloud).
> Manual approach, It looks not supporting all in one image.
> Many Thanks
> Kosala
>
>
> -------------- next part --------------
> An HTML attachment was scrubbed...
> URL: <http://lists.projectclearwater.org/pipermail/clearwater_lists.
> projectclearwater.org/attachments/20160815/11781755/attachment.html>
>
> ------------------------------
>
> Subject: Digest Footer
>
> _______________________________________________
> Clearwater mailing list
> Clearwater at lists.projectclearwater.org
> http://lists.projectclearwater.org/mailman/listinfo/clearwater_lists.
> projectclearwater.org
>
>
> ------------------------------
>
> End of Clearwater Digest, Vol 40, Issue 24
> ******************************************
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.projectclearwater.org/pipermail/clearwater_lists.projectclearwater.org/attachments/20160815/d12a4fd7/attachment.html>

From Andrew.Edmonds at metaswitch.com  Mon Aug 15 12:17:30 2016
From: Andrew.Edmonds at metaswitch.com (Andrew Edmonds)
Date: Mon, 15 Aug 2016 16:17:30 +0000
Subject: [Project Clearwater] Kangaskhan release note
Message-ID: <BLUPR02MB437A5721432ABA01EE03835E5120@BLUPR02MB437.namprd02.prod.outlook.com>

The release for Project Clearwater sprint "Kangaskhan" has been cut. The code for this release is tagged as release-104 in github.

This release includes the following bug fixes:



*         Sprout will challenge registrations repeatedly if memcached is down, rather than returning a 5xx error (https://github.com/Metaswitch/sprout/issues/1404)

*         Homestead crash on missing required parameter in MAA (https://github.com/Metaswitch/homestead/issues/362)

*         Homestead can't be configured to send a Server-Assignment-Request on every re-registration (https://github.com/Metaswitch/homestead/issues/360)

*         Crash in AlarmReqAgent (https://github.com/Metaswitch/cpp-common/issues/519)

*         Can't build Crest with latest setuptools (https://github.com/Metaswitch/crest/issues/292)

*         Homer doesn't start properly on all-in-one images (https://github.com/Metaswitch/crest/issues/283)

*         Multiple knife machines step on each other's toes (https://github.com/Metaswitch/chef/issues/148)

*         Clearwater-infrastructure gives benign error about logging.bash permissions (https://github.com/Metaswitch/clearwater-infrastructure/issues/355)

*         First UDP call fails every 10min in live tests (https://github.com/Metaswitch/clearwater-live-test/issues/117)

*         Memento - Cancelled Call (UDP) spuriously (?) fails (https://github.com/Metaswitch/clearwater-live-test/issues/108)

*         Over aggressive filtering of alarms in the Alarm Trap Sender (https://github.com/Metaswitch/clearwater-snmp-handlers/issues/128)

*         Memento sometimes doesn't return call data (https://github.com/Metaswitch/memento/issues/136)

*         Monit fails to start the ralf process (https://github.com/Metaswitch/clearwater-monit/issues/41)



To upgrade to this release, follow the instructions at http://docs.projectclearwater.org/en/stable/Upgrading_a_Clearwater_deployment.html. If you are deploying an all-in-one node, the standard image (http://vm-images.cw-ngv.com/cw-aio.ova) has been updated for this release.

-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.projectclearwater.org/pipermail/clearwater_lists.projectclearwater.org/attachments/20160815/1cb31d64/attachment.html>

From matt at projectclearwater.org  Mon Aug 15 12:56:53 2016
From: matt at projectclearwater.org (Matt Williams (projectclearwater.org))
Date: Mon, 15 Aug 2016 16:56:53 +0000
Subject: [Project Clearwater] Clearwater Digest, Vol 40, Issue 24
In-Reply-To: <CAGEe17ZLnypQfbzxEwxj9EaB20MUBVpY+YdN-Obv=gHpZmG0KA@mail.gmail.com>
References: <mailman.20.1471267072.11502.clearwater_lists.projectclearwater.org@lists.projectclearwater.org>
	<CAGEe17ZLnypQfbzxEwxj9EaB20MUBVpY+YdN-Obv=gHpZmG0KA@mail.gmail.com>
Message-ID: <CY1PR0201MB1563F9A706F3EC7BE7F9C11590120@CY1PR0201MB1563.namprd02.prod.outlook.com>

Kosala,

That's odd - I don't see that failure on my all-in-one image (spun up just now from the latest image) - which version of all-in-one-image are you running, and which version of crest does it include ("sudo dpkg-query -s crest")?

You may be able to work-around this either by taking the latest all-in-one image or by following the simpler bulk-provisioning process at https://github.com/Metaswitch/crest/blob/dev/docs/Bulk-Provisioning%20Numbers.md (when this doc talks about using the sstables_provisioning process for very large sets of numbers, we mean 1M+ numbers - the 9000 you're provisioning are well within the capabilities of this process).

I hope that helps - please let me know how you get on.

Cheers,

Matt


From: Clearwater [mailto:clearwater-bounces at lists.projectclearwater.org] On Behalf Of Kosala
Sent: 15 August 2016 16:58
To: clearwater at lists.projectclearwater.org
Subject: Re: [Project Clearwater] Clearwater Digest, Vol 40, Issue 24

HI Matt,
Thanks.

I am trying to follow https://github.com/Metaswitch/crest/blob/dev/src/metaswitch/crest/tools/sstable_provisioning/README.md for bulk provisioning.

When I am trying to execute sudo ./BulkProvision homer 21000 29999 example.com<http://example.com> 7kkzTyGW in all-in-one image,
I am getting an error  java.lang.UnsupportedClassVersionError: ClearwaterBulkProvisioner : Unsupported major.minor version 52.0
Java version info in all-in-one image:
[cw-aio]ubuntu at cwaio:/usr/share/clearwater/crest/tools/sstable_provisioning$ java -version
java version "1.7.0_101"
OpenJDK Runtime Environment (IcedTea 2.6.6) (7u101-2.6.6-0ubuntu0.14.04.1)
OpenJDK 64-Bit Server VM (build 24.95-b01, mixed mode)

Thanks
Kosala



On Mon, Aug 15, 2016 at 2:17 PM, <clearwater-request at lists.projectclearwater.org<mailto:clearwater-request at lists.projectclearwater.org>> wrote:
Send Clearwater mailing list submissions to
        clearwater at lists.projectclearwater.org<mailto:clearwater at lists.projectclearwater.org>

To subscribe or unsubscribe via the World Wide Web, visit
        http://lists.projectclearwater.org/mailman/listinfo/clearwater_lists.projectclearwater.org

or, via email, send a message with subject or body 'help' to
        clearwater-request at lists.projectclearwater.org<mailto:clearwater-request at lists.projectclearwater.org>

You can reach the person managing the list at
        clearwater-owner at lists.projectclearwater.org<mailto:clearwater-owner at lists.projectclearwater.org>

When replying, please edit your Subject line so it is more specific
than "Re: Contents of Clearwater digest..."


Today's Topics:

   1. Stress Testing (Kosala)
   2. Re: Stress Testing (Matt Williams (projectclearwater.org<http://projectclearwater.org>))
   3. Re: Stress Testing (Matt Williams (projectclearwater.org<http://projectclearwater.org>))


----------------------------------------------------------------------

Message: 1
Date: Mon, 15 Aug 2016 10:38:57 +0100
From: Kosala <kosalayb at gmail.com<mailto:kosalayb at gmail.com>>
To: clearwater at lists.projectclearwater.org<mailto:clearwater at lists.projectclearwater.org>
Subject: [Project Clearwater] Stress Testing
Message-ID:
        <CAGEe17an2B_bGj8NfKFwms+nU=vJURyhT5CE+mcY1pjcm4YF+A at mail.gmail.com<mailto:vJURyhT5CE%2BmcY1pjcm4YF%2BA at mail.gmail.com>>
Content-Type: text/plain; charset="utf-8"

Hi Team,

I installed clearwater "all-in-one" image on Oracle Virtual Box.
1. Can I do stress testing ?
2. How to do that?

I am trying to follow Stress Testing on
http://clearwater.readthedocs.io/en/stable/Clearwater_stress_testing.html#configuring-udp-stress
.

Using chef - > It seems chef/knife install only supports in the Cloud
approach (The automated install is only supported for deployments running
in Amazon?s EC2 cloud).

Manual approach, It looks not supporting all in one image.

Many Thanks
Kosala
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.projectclearwater.org/pipermail/clearwater_lists.projectclearwater.org/attachments/20160815/15fc3b07/attachment-0001.html>

------------------------------

Message: 2
Date: Mon, 15 Aug 2016 09:54:02 +0000
From: "Matt Williams (projectclearwater.org<http://projectclearwater.org>)"
        <matt at projectclearwater.org<mailto:matt at projectclearwater.org>>
To: Kosala <kosalayb at gmail.com<mailto:kosalayb at gmail.com>>
Cc: "clearwater at lists.projectclearwater.org<mailto:clearwater at lists.projectclearwater.org>"
        <clearwater at lists.projectclearwater.org<mailto:clearwater at lists.projectclearwater.org>>
Subject: Re: [Project Clearwater] Stress Testing
Message-ID:
        <CY1PR0201MB15636F1F20EB91BB180F053390120 at CY1PR0201MB1563.namprd02.prod.outlook.com<mailto:CY1PR0201MB15636F1F20EB91BB180F053390120 at CY1PR0201MB1563.namprd02.prod.outlook.com>>

Content-Type: text/plain; charset="utf-8"

Kosala,

While it's theoretically possible to do stress testing against an all-in-one image, I'd recommend against it - the all-in-one image has been squeezed down a lot to fit on a single VM and we'd expect very low performance out of it, and I could believe that overload behavior might be suboptimal.  If you're looking to stress test for performance reasons, I'd strongly recommend running a full deployment as this will give you much more reliable numbers.  If you're looking to stress test for other reasons, please can you share a bit more about what you're trying to achieve, and we can have a think about what would work best?

If you do really want to run stress testing against an all-in-one image, it should probably work, even though http://clearwater.readthedocs.io/en/latest/Clearwater_stress_testing.html#manual-i-e-non-chef-stress-runs only talks about Chef and manual installs.  You'd need to set the "bono_servers" option in /etc/clearwater/shared_config to point to your all-in-one node, and I suspect you'd need to reduce the "count" option to something a lot lower - I'd start around 5000 and see how that goes.

I hope that helps.  Please let me know how you get on.

Thanks,

Matt

From: Clearwater [mailto:clearwater-bounces at lists.projectclearwater.org<mailto:clearwater-bounces at lists.projectclearwater.org>] On Behalf Of Kosala
Sent: 15 August 2016 10:39
To: clearwater at lists.projectclearwater.org<mailto:clearwater at lists.projectclearwater.org>
Subject: [Project Clearwater] Stress Testing

Hi Team,
I installed clearwater "all-in-one" image on Oracle Virtual Box.
1. Can I do stress testing ?
2. How to do that?
I am trying to follow Stress Testing on http://clearwater.readthedocs.io/en/stable/Clearwater_stress_testing.html#configuring-udp-stress.
Using chef - > It seems chef/knife install only supports in the Cloud approach (The automated install is only supported for deployments running in Amazon?s EC2 cloud).
Manual approach, It looks not supporting all in one image.
Many Thanks
Kosala

-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.projectclearwater.org/pipermail/clearwater_lists.projectclearwater.org/attachments/20160815/29d6328d/attachment-0001.html>

------------------------------

Message: 3
Date: Mon, 15 Aug 2016 13:16:47 +0000
From: "Matt Williams (projectclearwater.org<http://projectclearwater.org>)"
        <matt at projectclearwater.org<mailto:matt at projectclearwater.org>>
To: "clearwater at lists.projectclearwater.org<mailto:clearwater at lists.projectclearwater.org>"
        <clearwater at lists.projectclearwater.org<mailto:clearwater at lists.projectclearwater.org>>
Subject: Re: [Project Clearwater] Stress Testing
Message-ID:
        <CY1PR0201MB156372246DC5A77B11839F9D90120 at CY1PR0201MB1563.namprd02.prod.outlook.com<mailto:CY1PR0201MB156372246DC5A77B11839F9D90120 at CY1PR0201MB1563.namprd02.prod.outlook.com>>

Content-Type: text/plain; charset="utf-8"

Kosala,

You'll need to follow all the steps in http://clearwater.readthedocs.io/en/latest/Clearwater_stress_testing.html#manual-i-e-non-chef-stress-runs, i.e. bulk provisioning subscribers and installing clearwater-sip-stress, but that should be it.

Just to be clear, though, you'll need to set the configuration and install the clearwater-sip-stress package on a separate VM, not on the all-in-one image itself - the all-in-one image almost certainly opens up ports that conflict with those that clearwater-sip-stress tries to use.

This isn't a very well-trodden path, though, so you may hit further issues - let me know if so, and we can try to work through them.

Cheers,

Matt

From: Kosala [mailto:kosalayb at gmail.com<mailto:kosalayb at gmail.com>]
Sent: 15 August 2016 13:41
To: Matt Williams (projectclearwater.org<http://projectclearwater.org>) <matt at projectclearwater.org<mailto:matt at projectclearwater.org>>
Subject: Re: [Project Clearwater] Stress Testing

Hi Matt,
Thanks. I set the bono_servers option. Should I add count =5000 to /etc/clearwater/shared_config ?

Do I need other changes to run stress tests on all-in-one image?
Thanks
Kosala



On Mon, Aug 15, 2016 at 10:54 AM, Matt Williams (projectclearwater.org<http://projectclearwater.org><http://projectclearwater.org>) <matt at projectclearwater.org<mailto:matt at projectclearwater.org><mailto:matt at projectclearwater.org<mailto:matt at projectclearwater.org>>> wrote:
Kosala,

While it's theoretically possible to do stress testing against an all-in-one image, I'd recommend against it - the all-in-one image has been squeezed down a lot to fit on a single VM and we'd expect very low performance out of it, and I could believe that overload behavior might be suboptimal.  If you're looking to stress test for performance reasons, I'd strongly recommend running a full deployment as this will give you much more reliable numbers.  If you're looking to stress test for other reasons, please can you share a bit more about what you're trying to achieve, and we can have a think about what would work best?

If you do really want to run stress testing against an all-in-one image, it should probably work, even though http://clearwater.readthedocs.io/en/latest/Clearwater_stress_testing.html#manual-i-e-non-chef-stress-runs only talks about Chef and manual installs.  You'd need to set the "bono_servers" option in /etc/clearwater/shared_config to point to your all-in-one node, and I suspect you'd need to reduce the "count" option to something a lot lower - I'd start around 5000 and see how that goes.

I hope that helps.  Please let me know how you get on.

Thanks,

Matt

From: Clearwater [mailto:clearwater-bounces at lists.projectclearwater.org<mailto:clearwater-bounces at lists.projectclearwater.org><mailto:clearwater-bounces at lists.projectclearwater.org<mailto:clearwater-bounces at lists.projectclearwater.org>>] On Behalf Of Kosala
Sent: 15 August 2016 10:39
To: clearwater at lists.projectclearwater.org<mailto:clearwater at lists.projectclearwater.org><mailto:clearwater at lists.projectclearwater.org<mailto:clearwater at lists.projectclearwater.org>>
Subject: [Project Clearwater] Stress Testing

Hi Team,
I installed clearwater "all-in-one" image on Oracle Virtual Box.
1. Can I do stress testing ?
2. How to do that?
I am trying to follow Stress Testing on http://clearwater.readthedocs.io/en/stable/Clearwater_stress_testing.html#configuring-udp-stress.
Using chef - > It seems chef/knife install only supports in the Cloud approach (The automated install is only supported for deployments running in Amazon?s EC2 cloud).
Manual approach, It looks not supporting all in one image.
Many Thanks
Kosala


-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.projectclearwater.org/pipermail/clearwater_lists.projectclearwater.org/attachments/20160815/11781755/attachment.html>

------------------------------

Subject: Digest Footer

_______________________________________________
Clearwater mailing list
Clearwater at lists.projectclearwater.org<mailto:Clearwater at lists.projectclearwater.org>
http://lists.projectclearwater.org/mailman/listinfo/clearwater_lists.projectclearwater.org


------------------------------

End of Clearwater Digest, Vol 40, Issue 24
******************************************

-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.projectclearwater.org/pipermail/clearwater_lists.projectclearwater.org/attachments/20160815/caa1bd0f/attachment.html>

From crbertoldo at gmail.com  Mon Aug 15 15:11:31 2016
From: crbertoldo at gmail.com (Claudio Bertoldo)
Date: Mon, 15 Aug 2016 16:11:31 -0300
Subject: [Project Clearwater] Doubt about querying SIP registered
	subscribers
In-Reply-To: <BL2PR02MB208471FDBF223CB10666DD3E9B1F0@BL2PR02MB2084.namprd02.prod.outlook.com>
References: <CAC6=c0fpfr9-C_QEaKEzbYoW9sbQ2VWNiHpFcFt6DHzh8xzA6w@mail.gmail.com>
	<BL2PR02MB208471FDBF223CB10666DD3E9B1F0@BL2PR02MB2084.namprd02.prod.outlook.com>
Message-ID: <CAC6=c0f6qNz-HUr7ur9kxyWKjwszpMH8rzYLz3w+0iheAwGg_w@mail.gmail.com>

Hi Ellie,

Thanks a lot.

Besides of other applications, I'd like to know why registered users with
desired lifespan of 1s ('Expires: 1') take more than it to expire. I think
there's a minimum time, is that right?

Anyway, if/when a best way to query it arise, please let me know.

Thanks in advance.

Best,

Claudio


On Fri, Aug 12, 2016 at 2:38 PM, Eleanor Merry (projectclearwater.org) <
eleanor at projectclearwater.org> wrote:

> Hi Claudio,
>
>
>
> There?s no official way of getting this information I?m afraid.
>
>
>
> The information you want is stored in our memcached database. I?ve had a
> look around for supported methods of pulling all the values out of
> memcached, but I?ve not had much luck.
>
>
>
> There?s ?memcached-tool? (/usr/share/memcached/scripts/memcached-tool
> <local ip>:11211 dump) which should report all the keys and values stored
> in memcached, but I?ve found this just hangs on my machine.
>
>
>
> There?s also using the output of ?stats cachedump?, but I?ve found that
> this gives me the output ?SERVER_ERROR out of memory writing stats? (and it
> doesn?t appear to be an officially supported debug tool from memcached).
>
>
>
> You may have more luck with these methods!
>
>
>
> Ellie
>
>
>
> *From:* Clearwater [mailto:clearwater-bounces at lists.projectclearwater.org]
> *On Behalf Of *Claudio Bertoldo
> *Sent:* 11 August 2016 02:45
> *To:* clearwater at lists.projectclearwater.org
> *Subject:* [Project Clearwater] Doubt about querying SIP registered
> subscribers
>
>
>
> Hi,
>
>
>
> I'd like to know if it's possible to query the current registered
> subscribers, their expiration time (remaining time preferably) and their IP
> address. I could not find this info in this list neither in the official
> documentation, so if that is there, sorry in advance.
>
>
>
> Best regards,
>
>
>
> Claudio Bertoldo
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.projectclearwater.org/pipermail/clearwater_lists.projectclearwater.org/attachments/20160815/09e5e89e/attachment.html>

From peter.skrzynski at nec.co.nz  Mon Aug 15 19:17:13 2016
From: peter.skrzynski at nec.co.nz (Peter Skrzynski)
Date: Mon, 15 Aug 2016 23:17:13 +0000
Subject: [Project Clearwater] Doubt about querying SIP
	registered	subscribers
In-Reply-To: <CAC6=c0f6qNz-HUr7ur9kxyWKjwszpMH8rzYLz3w+0iheAwGg_w@mail.gmail.com>
References: <CAC6=c0fpfr9-C_QEaKEzbYoW9sbQ2VWNiHpFcFt6DHzh8xzA6w@mail.gmail.com>
	<BL2PR02MB208471FDBF223CB10666DD3E9B1F0@BL2PR02MB2084.namprd02.prod.outlook.com>
	<CAC6=c0f6qNz-HUr7ur9kxyWKjwszpMH8rzYLz3w+0iheAwGg_w@mail.gmail.com>
Message-ID: <ae0797bb46e64dfdb61ae6ce4dffd2cc@ex15w.necnz.internal>

Hi Claudio,
I remember finding this info from Clearwater last year sometime.
(sorry I can?t find the link)
You can obtain the registration data on sprout, by using?
     telnet <sprout IP address> 11211
     get reg\\sip:<user>@<domain name>
     quit
This has the expiration time (in epoch seconds) and user IP address.


From: Clearwater [mailto:clearwater-bounces at lists.projectclearwater.org] On Behalf Of Claudio Bertoldo
Sent: Tuesday, 16 August 2016 7:12 a.m.
To: Eleanor Merry (projectclearwater.org)
Cc: clearwater at lists.projectclearwater.org
Subject: Re: [Project Clearwater] Doubt about querying SIP registered subscribers

Hi Ellie,

Thanks a lot.

Besides of other applications, I'd like to know why registered users with desired lifespan of 1s ('Expires: 1') take more than it to expire. I think there's a minimum time, is that right?

Anyway, if/when a best way to query it arise, please let me know.

Thanks in advance.

Best,

Claudio


On Fri, Aug 12, 2016 at 2:38 PM, Eleanor Merry (projectclearwater.org<http://projectclearwater.org>) <eleanor at projectclearwater.org<mailto:eleanor at projectclearwater.org>> wrote:
Hi Claudio,

There?s no official way of getting this information I?m afraid.

The information you want is stored in our memcached database. I?ve had a look around for supported methods of pulling all the values out of memcached, but I?ve not had much luck.

There?s ?memcached-tool? (/usr/share/memcached/scripts/memcached-tool <local ip>:11211 dump) which should report all the keys and values stored in memcached, but I?ve found this just hangs on my machine.

There?s also using the output of ?stats cachedump?, but I?ve found that this gives me the output ?SERVER_ERROR out of memory writing stats? (and it doesn?t appear to be an officially supported debug tool from memcached).

You may have more luck with these methods!

Ellie

From: Clearwater [mailto:clearwater-bounces at lists.projectclearwater.org<mailto:clearwater-bounces at lists.projectclearwater.org>] On Behalf Of Claudio Bertoldo
Sent: 11 August 2016 02:45
To: clearwater at lists.projectclearwater.org<mailto:clearwater at lists.projectclearwater.org>
Subject: [Project Clearwater] Doubt about querying SIP registered subscribers

Hi,

I'd like to know if it's possible to query the current registered subscribers, their expiration time (remaining time preferably) and their IP address. I could not find this info in this list neither in the official documentation, so if that is there, sorry in advance.

Best regards,

Claudio Bertoldo




Peter Skrzynski

Technical Lead
NEC New Zealand Limited
NEC House, Level 6, 40 Taranaki Street, PO Box: 1936, Wellington 6011, New Zealand
T: 043816257, M: 0274849530, F: +6443811110
peter.skrzynski at nec.co.nz<mailto:peter.skrzynski at nec.co.nz>
nz.nec.com<http://nz.nec.com>

[cid:imagea0f1d9.JPG at 128e55f2.45930209]

Please consider the environment before printing this email

Attention:
The information contained in this message and or attachments is intended only for the person or entity to which it is addressed and may contain confidential and/or privileged material.  Any review, retransmission, dissemination, copying or other use of, or taking of any action in reliance upon, this information by persons or entities other than the intended recipient is prohibited. If you received this in error, please contact the sender and delete the material from any system and destroy any copies. NEC has no liability for any act or omission in reliance on the email or any attachment.  Before opening this email or any attachment(s), please check them for viruses. NEC is not responsible for any viruses in this email or any attachment(s); any changes made to this  email or any attachment(s) after they are sent; or any effects this email or any attachment(s) have on your network or computer system.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.projectclearwater.org/pipermail/clearwater_lists.projectclearwater.org/attachments/20160815/16a72546/attachment.html>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: imagea0f1d9.JPG
Type: image/jpeg
Size: 59501 bytes
Desc: imagea0f1d9.JPG
URL: <http://lists.projectclearwater.org/pipermail/clearwater_lists.projectclearwater.org/attachments/20160815/16a72546/attachment.jpe>

From morrisyan123 at gmail.com  Tue Aug 16 05:37:12 2016
From: morrisyan123 at gmail.com (yan morris)
Date: Tue, 16 Aug 2016 17:37:12 +0800
Subject: [Project Clearwater] Deploy Clearwater on OpenStack
Message-ID: <CAM_v+eS_NJqX+O_NM+46xo+8swDBHdpAvAFM1PHkTw19Xxd1tw@mail.gmail.com>

Hi ,

I am trying deploy Clearwater on openstack with six private IPs.

There is a problem .

I cannot start clearwater-etcd , while I restarted clearwater-etcd

It gave messages:

etcd cluster has no published client endpoints.
Try '--no-sync' if you want to access non-published client endpoints(http://
,http://192.168.1.21:4000,http://192.168.1.22:4000,http://192.168.1.20:4000,
http://192.168.1.19:4000,http://192.168.1.24:4000).
Error:  client: no endpoints available

Besides , I didn't encounter this problem when I deploy on Vmware.

Therefore , I have some questions want to ask.

1.
   What Ubuntu image should use on OpenStack ,
   Ubuntu Cloud image or Ubuntu manual ?
2.
   I want to know how to set Security Group correctly on OpenStack .

Could you give me some tips about these questions and how to fix the
problem I

encounter?


Thank you very much .

Morris
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.projectclearwater.org/pipermail/clearwater_lists.projectclearwater.org/attachments/20160816/70b3cda0/attachment.html>

From matt at projectclearwater.org  Tue Aug 16 09:01:24 2016
From: matt at projectclearwater.org (Matt Williams (projectclearwater.org))
Date: Tue, 16 Aug 2016 13:01:24 +0000
Subject: [Project Clearwater] Clearwater Digest, Vol 40, Issue 24
In-Reply-To: <CAGEe17ZeNPPy7AmMz=LCWnHqLm=v9Q7CuLT+AOVKWJTdg8m7Eg@mail.gmail.com>
References: <mailman.20.1471267072.11502.clearwater_lists.projectclearwater.org@lists.projectclearwater.org>
	<CAGEe17ZLnypQfbzxEwxj9EaB20MUBVpY+YdN-Obv=gHpZmG0KA@mail.gmail.com>
	<CY1PR0201MB1563F9A706F3EC7BE7F9C11590120@CY1PR0201MB1563.namprd02.prod.outlook.com>
	<CAGEe17bfTu1Kpwx=ipqtEbShvWtP+C6pJEEGHi0GSwBR5Dqw8w@mail.gmail.com>
	<CAGEe17aY077tLtotRe1X8k1qU_4otBdHDMJjqDH_g02Zs676Jg@mail.gmail.com>
	<CAGEe17ZeNPPy7AmMz=LCWnHqLm=v9Q7CuLT+AOVKWJTdg8m7Eg@mail.gmail.com>
Message-ID: <CY1PR0201MB1563CE17983225B985B19D7390130@CY1PR0201MB1563.namprd02.prod.outlook.com>

Kosala,

I'm glad you've made progress on this.

I had a look at the crest package version, but it seems to be later than the most recent all-in-one image uses (1.0-160811.103635).  When did you download the all-in-one image, and did you apply any patches to it?

Regarding making calls for stress testing, this is where http://clearwater.readthedocs.io/en/latest/Clearwater_stress_testing.html#manual-i-e-non-chef-stress-runs comes in - you need to

?         create a separate VM

?         set the bono_hostname and count parameters in /etc/clearwater/shared_config

?         install the clearwater-sip-stress package.
I hope that helps.

BTW, please remember to copy in clearwater at lists.projectclearwater.org<mailto:clearwater at lists.projectclearwater.org> - that means that other people can see and comment on your posts.

Thanks,

Matt


From: Kosala [mailto:kosalayb at gmail.com]
Sent: 16 August 2016 10:48
To: Matt Williams (projectclearwater.org) <matt at projectclearwater.org>
Subject: Re: [Project Clearwater] Clearwater Digest, Vol 40, Issue 24

Hi Matt,
Bulk provisioning for all in one image is done using https://github.com/Metaswitch/crest/blob/dev/docs/Bulk-Provisioning%20Numbers.md.
I have records in tables in homestead_cache and homer.
Now How to make calls for stress testing?
Is there any guideline?
Many Thanks,
Kosala




On Tue, Aug 16, 2016 at 9:04 AM, Kosala <kosalayb at gmail.com<mailto:kosalayb at gmail.com>> wrote:
Hi Matt,
TBH, The document in https://github.com/Metaswitch/crest/blob/dev/docs/Bulk-Provisioning%20Numbers.md is not clear to me.
Step 1. Homestead node in deployment. I do not know where is that node in all in one image. It will be helpful the location of that folder from the root.
Step 2. A simple example will be helpful.
Thanks
Kosala


On Tue, Aug 16, 2016 at 8:50 AM, Kosala <kosalayb at gmail.com<mailto:kosalayb at gmail.com>> wrote:
Hi Matt,
I downloaded the all in one package from http://clearwater.readthedocs.io/en/stable/All_in_one_OVF_Installation.html
and imported using oracle virtual box on ubuntu 14.04,
Crest version
[cw-aio]ubuntu at cwaio:~$ sudo dpkg-query -s crest
Package: crest
Status: install ok installed
Priority: optional
Section: network
Installed-Size: 40098
Maintainer: Project Clearwater Maintainers <maintainers at projectclearwater.org<mailto:maintainers at projectclearwater.org>>
Architecture: amd64
Version: 1.0-160815.145007
Thanks
Kosala


On Mon, Aug 15, 2016 at 5:56 PM, Matt Williams (projectclearwater.org<http://projectclearwater.org>) <matt at projectclearwater.org<mailto:matt at projectclearwater.org>> wrote:
Kosala,

That's odd - I don't see that failure on my all-in-one image (spun up just now from the latest image) - which version of all-in-one-image are you running, and which version of crest does it include ("sudo dpkg-query -s crest")?

You may be able to work-around this either by taking the latest all-in-one image or by following the simpler bulk-provisioning process at https://github.com/Metaswitch/crest/blob/dev/docs/Bulk-Provisioning%20Numbers.md (when this doc talks about using the sstables_provisioning process for very large sets of numbers, we mean 1M+ numbers - the 9000 you're provisioning are well within the capabilities of this process).

I hope that helps - please let me know how you get on.

Cheers,

Matt


From: Clearwater [mailto:clearwater-bounces at lists.projectclearwater.org<mailto:clearwater-bounces at lists.projectclearwater.org>] On Behalf Of Kosala
Sent: 15 August 2016 16:58
To: clearwater at lists.projectclearwater.org<mailto:clearwater at lists.projectclearwater.org>
Subject: Re: [Project Clearwater] Clearwater Digest, Vol 40, Issue 24

HI Matt,
Thanks.

I am trying to follow https://github.com/Metaswitch/crest/blob/dev/src/metaswitch/crest/tools/sstable_provisioning/README.md for bulk provisioning.

When I am trying to execute sudo ./BulkProvision homer 21000 29999 example.com<http://example.com> 7kkzTyGW in all-in-one image,
I am getting an error  java.lang.UnsupportedClassVersionError: ClearwaterBulkProvisioner : Unsupported major.minor version 52.0
Java version info in all-in-one image:
[cw-aio]ubuntu at cwaio:/usr/share/clearwater/crest/tools/sstable_provisioning$ java -version
java version "1.7.0_101"
OpenJDK Runtime Environment (IcedTea 2.6.6) (7u101-2.6.6-0ubuntu0.14.04.1)
OpenJDK 64-Bit Server VM (build 24.95-b01, mixed mode)
Thanks
Kosala



On Mon, Aug 15, 2016 at 2:17 PM, <clearwater-request at lists.projectclearwater.org<mailto:clearwater-request at lists.projectclearwater.org>> wrote:
Send Clearwater mailing list submissions to
        clearwater at lists.projectclearwater.org<mailto:clearwater at lists.projectclearwater.org>

To subscribe or unsubscribe via the World Wide Web, visit
        http://lists.projectclearwater.org/mailman/listinfo/clearwater_lists.projectclearwater.org

or, via email, send a message with subject or body 'help' to
        clearwater-request at lists.projectclearwater.org<mailto:clearwater-request at lists.projectclearwater.org>

You can reach the person managing the list at
        clearwater-owner at lists.projectclearwater.org<mailto:clearwater-owner at lists.projectclearwater.org>

When replying, please edit your Subject line so it is more specific
than "Re: Contents of Clearwater digest..."


Today's Topics:

   1. Stress Testing (Kosala)
   2. Re: Stress Testing (Matt Williams (projectclearwater.org<http://projectclearwater.org>))
   3. Re: Stress Testing (Matt Williams (projectclearwater.org<http://projectclearwater.org>))


----------------------------------------------------------------------

Message: 1
Date: Mon, 15 Aug 2016 10:38:57 +0100
From: Kosala <kosalayb at gmail.com<mailto:kosalayb at gmail.com>>
To: clearwater at lists.projectclearwater.org<mailto:clearwater at lists.projectclearwater.org>
Subject: [Project Clearwater] Stress Testing
Message-ID:
        <CAGEe17an2B_bGj8NfKFwms+nU=vJURyhT5CE+mcY1pjcm4YF+A at mail.gmail.com<mailto:vJURyhT5CE%2BmcY1pjcm4YF%2BA at mail.gmail.com>>
Content-Type: text/plain; charset="utf-8"

Hi Team,

I installed clearwater "all-in-one" image on Oracle Virtual Box.
1. Can I do stress testing ?
2. How to do that?

I am trying to follow Stress Testing on
http://clearwater.readthedocs.io/en/stable/Clearwater_stress_testing.html#configuring-udp-stress
.

Using chef - > It seems chef/knife install only supports in the Cloud
approach (The automated install is only supported for deployments running
in Amazon?s EC2 cloud).

Manual approach, It looks not supporting all in one image.

Many Thanks
Kosala
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.projectclearwater.org/pipermail/clearwater_lists.projectclearwater.org/attachments/20160815/15fc3b07/attachment-0001.html>

------------------------------

Message: 2
Date: Mon, 15 Aug 2016 09:54:02 +0000
From: "Matt Williams (projectclearwater.org<http://projectclearwater.org>)"
        <matt at projectclearwater.org<mailto:matt at projectclearwater.org>>
To: Kosala <kosalayb at gmail.com<mailto:kosalayb at gmail.com>>
Cc: "clearwater at lists.projectclearwater.org<mailto:clearwater at lists.projectclearwater.org>"
        <clearwater at lists.projectclearwater.org<mailto:clearwater at lists.projectclearwater.org>>
Subject: Re: [Project Clearwater] Stress Testing
Message-ID:
        <CY1PR0201MB15636F1F20EB91BB180F053390120 at CY1PR0201MB1563.namprd02.prod.outlook.com<mailto:CY1PR0201MB15636F1F20EB91BB180F053390120 at CY1PR0201MB1563.namprd02.prod.outlook.com>>

Content-Type: text/plain; charset="utf-8"

Kosala,

While it's theoretically possible to do stress testing against an all-in-one image, I'd recommend against it - the all-in-one image has been squeezed down a lot to fit on a single VM and we'd expect very low performance out of it, and I could believe that overload behavior might be suboptimal.  If you're looking to stress test for performance reasons, I'd strongly recommend running a full deployment as this will give you much more reliable numbers.  If you're looking to stress test for other reasons, please can you share a bit more about what you're trying to achieve, and we can have a think about what would work best?

If you do really want to run stress testing against an all-in-one image, it should probably work, even though http://clearwater.readthedocs.io/en/latest/Clearwater_stress_testing.html#manual-i-e-non-chef-stress-runs only talks about Chef and manual installs.  You'd need to set the "bono_servers" option in /etc/clearwater/shared_config to point to your all-in-one node, and I suspect you'd need to reduce the "count" option to something a lot lower - I'd start around 5000 and see how that goes.

I hope that helps.  Please let me know how you get on.

Thanks,

Matt

From: Clearwater [mailto:clearwater-bounces at lists.projectclearwater.org<mailto:clearwater-bounces at lists.projectclearwater.org>] On Behalf Of Kosala
Sent: 15 August 2016 10:39
To: clearwater at lists.projectclearwater.org<mailto:clearwater at lists.projectclearwater.org>
Subject: [Project Clearwater] Stress Testing

Hi Team,
I installed clearwater "all-in-one" image on Oracle Virtual Box.
1. Can I do stress testing ?
2. How to do that?
I am trying to follow Stress Testing on http://clearwater.readthedocs.io/en/stable/Clearwater_stress_testing.html#configuring-udp-stress.
Using chef - > It seems chef/knife install only supports in the Cloud approach (The automated install is only supported for deployments running in Amazon?s EC2 cloud).
Manual approach, It looks not supporting all in one image.
Many Thanks
Kosala

-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.projectclearwater.org/pipermail/clearwater_lists.projectclearwater.org/attachments/20160815/29d6328d/attachment-0001.html>

------------------------------

Message: 3
Date: Mon, 15 Aug 2016 13:16:47 +0000
From: "Matt Williams (projectclearwater.org<http://projectclearwater.org>)"
        <matt at projectclearwater.org<mailto:matt at projectclearwater.org>>
To: "clearwater at lists.projectclearwater.org<mailto:clearwater at lists.projectclearwater.org>"
        <clearwater at lists.projectclearwater.org<mailto:clearwater at lists.projectclearwater.org>>
Subject: Re: [Project Clearwater] Stress Testing
Message-ID:
        <CY1PR0201MB156372246DC5A77B11839F9D90120 at CY1PR0201MB1563.namprd02.prod.outlook.com<mailto:CY1PR0201MB156372246DC5A77B11839F9D90120 at CY1PR0201MB1563.namprd02.prod.outlook.com>>

Content-Type: text/plain; charset="utf-8"

Kosala,

You'll need to follow all the steps in http://clearwater.readthedocs.io/en/latest/Clearwater_stress_testing.html#manual-i-e-non-chef-stress-runs, i.e. bulk provisioning subscribers and installing clearwater-sip-stress, but that should be it.

Just to be clear, though, you'll need to set the configuration and install the clearwater-sip-stress package on a separate VM, not on the all-in-one image itself - the all-in-one image almost certainly opens up ports that conflict with those that clearwater-sip-stress tries to use.

This isn't a very well-trodden path, though, so you may hit further issues - let me know if so, and we can try to work through them.

Cheers,

Matt

From: Kosala [mailto:kosalayb at gmail.com<mailto:kosalayb at gmail.com>]
Sent: 15 August 2016 13:41
To: Matt Williams (projectclearwater.org<http://projectclearwater.org>) <matt at projectclearwater.org<mailto:matt at projectclearwater.org>>
Subject: Re: [Project Clearwater] Stress Testing

Hi Matt,
Thanks. I set the bono_servers option. Should I add count =5000 to /etc/clearwater/shared_config ?

Do I need other changes to run stress tests on all-in-one image?
Thanks
Kosala



On Mon, Aug 15, 2016 at 10:54 AM, Matt Williams (projectclearwater.org<http://projectclearwater.org><http://projectclearwater.org>) <matt at projectclearwater.org<mailto:matt at projectclearwater.org><mailto:matt at projectclearwater.org<mailto:matt at projectclearwater.org>>> wrote:
Kosala,

While it's theoretically possible to do stress testing against an all-in-one image, I'd recommend against it - the all-in-one image has been squeezed down a lot to fit on a single VM and we'd expect very low performance out of it, and I could believe that overload behavior might be suboptimal.  If you're looking to stress test for performance reasons, I'd strongly recommend running a full deployment as this will give you much more reliable numbers.  If you're looking to stress test for other reasons, please can you share a bit more about what you're trying to achieve, and we can have a think about what would work best?

If you do really want to run stress testing against an all-in-one image, it should probably work, even though http://clearwater.readthedocs.io/en/latest/Clearwater_stress_testing.html#manual-i-e-non-chef-stress-runs only talks about Chef and manual installs.  You'd need to set the "bono_servers" option in /etc/clearwater/shared_config to point to your all-in-one node, and I suspect you'd need to reduce the "count" option to something a lot lower - I'd start around 5000 and see how that goes.

I hope that helps.  Please let me know how you get on.

Thanks,

Matt

From: Clearwater [mailto:clearwater-bounces at lists.projectclearwater.org<mailto:clearwater-bounces at lists.projectclearwater.org><mailto:clearwater-bounces at lists.projectclearwater.org<mailto:clearwater-bounces at lists.projectclearwater.org>>] On Behalf Of Kosala
Sent: 15 August 2016 10:39
To: clearwater at lists.projectclearwater.org<mailto:clearwater at lists.projectclearwater.org><mailto:clearwater at lists.projectclearwater.org<mailto:clearwater at lists.projectclearwater.org>>
Subject: [Project Clearwater] Stress Testing

Hi Team,
I installed clearwater "all-in-one" image on Oracle Virtual Box.
1. Can I do stress testing ?
2. How to do that?
I am trying to follow Stress Testing on http://clearwater.readthedocs.io/en/stable/Clearwater_stress_testing.html#configuring-udp-stress.
Using chef - > It seems chef/knife install only supports in the Cloud approach (The automated install is only supported for deployments running in Amazon?s EC2 cloud).
Manual approach, It looks not supporting all in one image.
Many Thanks
Kosala


-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.projectclearwater.org/pipermail/clearwater_lists.projectclearwater.org/attachments/20160815/11781755/attachment.html>

------------------------------

Subject: Digest Footer

_______________________________________________
Clearwater mailing list
Clearwater at lists.projectclearwater.org<mailto:Clearwater at lists.projectclearwater.org>
http://lists.projectclearwater.org/mailman/listinfo/clearwater_lists.projectclearwater.org


------------------------------

End of Clearwater Digest, Vol 40, Issue 24
******************************************




-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.projectclearwater.org/pipermail/clearwater_lists.projectclearwater.org/attachments/20160816/1b938c73/attachment.html>

From eleanor at projectclearwater.org  Tue Aug 16 12:42:33 2016
From: eleanor at projectclearwater.org (Eleanor Merry (projectclearwater.org))
Date: Tue, 16 Aug 2016 16:42:33 +0000
Subject: [Project Clearwater] Doubt about querying SIP registered
 subscribers
In-Reply-To: <CAC6=c0f6qNz-HUr7ur9kxyWKjwszpMH8rzYLz3w+0iheAwGg_w@mail.gmail.com>
References: <CAC6=c0fpfr9-C_QEaKEzbYoW9sbQ2VWNiHpFcFt6DHzh8xzA6w@mail.gmail.com>
	<BL2PR02MB208471FDBF223CB10666DD3E9B1F0@BL2PR02MB2084.namprd02.prod.outlook.com>
	<CAC6=c0f6qNz-HUr7ur9kxyWKjwszpMH8rzYLz3w+0iheAwGg_w@mail.gmail.com>
Message-ID: <BL2PR02MB2084A62A1F223E76C664CE6B9B130@BL2PR02MB2084.namprd02.prod.outlook.com>

Hi Claudio,

There?s no minimum expiry time setting within Project Clearwater. Your SIP client may impose a minimum expiry time, as might the P-CSCF if you?re not using Bono.

If you don?t think anything should be setting a minimum expiry time, can you please send debug logs over for a register for Sprout and Bono? You can see how to turn on debug logs at: http://clearwater.readthedocs.io/en/stable/Troubleshooting_and_Recovery.html#sprout.

Thanks,

Ellie

From: Claudio Bertoldo [mailto:crbertoldo at gmail.com]
Sent: 15 August 2016 20:12
To: Eleanor Merry (projectclearwater.org)
Cc: clearwater at lists.projectclearwater.org
Subject: Re: [Project Clearwater] Doubt about querying SIP registered subscribers

Hi Ellie,

Thanks a lot.

Besides of other applications, I'd like to know why registered users with desired lifespan of 1s ('Expires: 1') take more than it to expire. I think there's a minimum time, is that right?

Anyway, if/when a best way to query it arise, please let me know.

Thanks in advance.

Best,

Claudio


On Fri, Aug 12, 2016 at 2:38 PM, Eleanor Merry (projectclearwater.org<http://projectclearwater.org>) <eleanor at projectclearwater.org<mailto:eleanor at projectclearwater.org>> wrote:
Hi Claudio,

There?s no official way of getting this information I?m afraid.

The information you want is stored in our memcached database. I?ve had a look around for supported methods of pulling all the values out of memcached, but I?ve not had much luck.

There?s ?memcached-tool? (/usr/share/memcached/scripts/memcached-tool <local ip>:11211 dump) which should report all the keys and values stored in memcached, but I?ve found this just hangs on my machine.

There?s also using the output of ?stats cachedump?, but I?ve found that this gives me the output ?SERVER_ERROR out of memory writing stats? (and it doesn?t appear to be an officially supported debug tool from memcached).

You may have more luck with these methods!

Ellie

From: Clearwater [mailto:clearwater-bounces at lists.projectclearwater.org<mailto:clearwater-bounces at lists.projectclearwater.org>] On Behalf Of Claudio Bertoldo
Sent: 11 August 2016 02:45
To: clearwater at lists.projectclearwater.org<mailto:clearwater at lists.projectclearwater.org>
Subject: [Project Clearwater] Doubt about querying SIP registered subscribers

Hi,

I'd like to know if it's possible to query the current registered subscribers, their expiration time (remaining time preferably) and their IP address. I could not find this info in this list neither in the official documentation, so if that is there, sorry in advance.

Best regards,

Claudio Bertoldo

-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.projectclearwater.org/pipermail/clearwater_lists.projectclearwater.org/attachments/20160816/73d26e86/attachment.html>

From kosalayb at gmail.com  Wed Aug 17 07:32:48 2016
From: kosalayb at gmail.com (Kosala)
Date: Wed, 17 Aug 2016 12:32:48 +0100
Subject: [Project Clearwater] Clearwater Digest, Vol 40, Issue 24
In-Reply-To: <CY1PR0201MB1563CE17983225B985B19D7390130@CY1PR0201MB1563.namprd02.prod.outlook.com>
References: <mailman.20.1471267072.11502.clearwater_lists.projectclearwater.org@lists.projectclearwater.org>
	<CAGEe17ZLnypQfbzxEwxj9EaB20MUBVpY+YdN-Obv=gHpZmG0KA@mail.gmail.com>
	<CY1PR0201MB1563F9A706F3EC7BE7F9C11590120@CY1PR0201MB1563.namprd02.prod.outlook.com>
	<CAGEe17bfTu1Kpwx=ipqtEbShvWtP+C6pJEEGHi0GSwBR5Dqw8w@mail.gmail.com>
	<CAGEe17aY077tLtotRe1X8k1qU_4otBdHDMJjqDH_g02Zs676Jg@mail.gmail.com>
	<CAGEe17ZeNPPy7AmMz=LCWnHqLm=v9Q7CuLT+AOVKWJTdg8m7Eg@mail.gmail.com>
	<CY1PR0201MB1563CE17983225B985B19D7390130@CY1PR0201MB1563.namprd02.prod.outlook.com>
Message-ID: <CAGEe17b2M2uqvbOuqH7t4xM41FbfBYk0xR3zWqiFh+EkSfUzUQ@mail.gmail.com>

Hi Matt,

I followed above steps and run sudo apt-get install clearwater-sip-stress.
How do I know stress tests are running? Is is said, stress tests start
automatically but I cannot see it.

Thanks
Kosala




On Tue, Aug 16, 2016 at 2:01 PM, Matt Williams (projectclearwater.org) <
matt at projectclearwater.org> wrote:

> Kosala,
>
>
>
> I'm glad you've made progress on this.
>
>
>
> I had a look at the crest package version, but it seems to be later than
> the most recent all-in-one image uses (1.0-160811.103635).  When did you
> download the all-in-one image, and did you apply any patches to it?
>
>
>
> Regarding making calls for stress testing, this is where
> http://clearwater.readthedocs.io/en/latest/Clearwater_
> stress_testing.html#manual-i-e-non-chef-stress-runs comes in - you need to
>
> ?         create a separate VM
>
> ?         set the bono_hostname and count parameters in
> /etc/clearwater/shared_config
>
> ?         install the clearwater-sip-stress package.
>
> I hope that helps.
>
>
>
> BTW, please remember to copy in clearwater at lists.projectclearwater.org -
> that means that other people can see and comment on your posts.
>
>
>
> Thanks,
>
>
>
> Matt
>
>
>
>
>
> *From:* Kosala [mailto:kosalayb at gmail.com]
> *Sent:* 16 August 2016 10:48
> *To:* Matt Williams (projectclearwater.org) <matt at projectclearwater.org>
> *Subject:* Re: [Project Clearwater] Clearwater Digest, Vol 40, Issue 24
>
>
>
> Hi Matt,
>
> Bulk provisioning for all in one image is done using
> https://github.com/Metaswitch/crest/blob/dev/docs/Bulk-
> Provisioning%20Numbers.md.
>
> I have records in tables in homestead_cache and homer.
>
> Now How to make calls for stress testing?
>
> Is there any guideline?
>
> Many Thanks,
>
> Kosala
>
>
>
>
>
>
>
>
>
> On Tue, Aug 16, 2016 at 9:04 AM, Kosala <kosalayb at gmail.com> wrote:
>
> Hi Matt,
>
> TBH, The document in https://github.com/Metaswitch/
> crest/blob/dev/docs/Bulk-Provisioning%20Numbers.md is not clear to me.
>
> Step 1. Homestead node in deployment. I do not know where is that node in
> all in one image. It will be helpful the location of that folder from the
> root.
>
> Step 2. A simple example will be helpful.
>
> Thanks
>
> Kosala
>
>
>
>
>
> On Tue, Aug 16, 2016 at 8:50 AM, Kosala <kosalayb at gmail.com> wrote:
>
> Hi Matt,
>
> I downloaded the all in one package from http://clearwater.readthedocs.
> io/en/stable/All_in_one_OVF_Installation.html
>
> and imported using oracle virtual box on ubuntu 14.04,
>
> Crest version
>
> [cw-aio]ubuntu at cwaio:~$ sudo dpkg-query -s crest
> Package: crest
> Status: install ok installed
> Priority: optional
> Section: network
> Installed-Size: 40098
> Maintainer: Project Clearwater Maintainers <maintainers@
> projectclearwater.org>
> Architecture: amd64
> Version: 1.0-160815.145007
>
> Thanks
>
> Kosala
>
>
>
>
>
> On Mon, Aug 15, 2016 at 5:56 PM, Matt Williams (projectclearwater.org) <
> matt at projectclearwater.org> wrote:
>
> Kosala,
>
>
>
> That's odd - I don't see that failure on my all-in-one image (spun up just
> now from the latest image) - which version of all-in-one-image are you
> running, and which version of crest does it include ("sudo dpkg-query -s
> crest")?
>
>
>
> You may be able to work-around this either by taking the latest all-in-one
> image or by following the simpler bulk-provisioning process at
> https://github.com/Metaswitch/crest/blob/dev/docs/Bulk-
> Provisioning%20Numbers.md (when this doc talks about using the
> sstables_provisioning process for very large sets of numbers, we mean 1M+
> numbers - the 9000 you're provisioning are well within the capabilities of
> this process).
>
>
>
> I hope that helps - please let me know how you get on.
>
>
>
> Cheers,
>
>
>
> Matt
>
>
>
>
>
> *From:* Clearwater [mailto:clearwater-bounces at lists.projectclearwater.org]
> *On Behalf Of *Kosala
> *Sent:* 15 August 2016 16:58
> *To:* clearwater at lists.projectclearwater.org
> *Subject:* Re: [Project Clearwater] Clearwater Digest, Vol 40, Issue 24
>
>
>
> HI Matt,
>
> Thanks.
>
>
> I am trying to follow https://github.com/Metaswitch/
> crest/blob/dev/src/metaswitch/crest/tools/sstable_provisioning/README.md
> for bulk provisioning.
>
>
> When I am trying to execute sudo ./BulkProvision homer 21000 29999
> example.com 7kkzTyGW in all-in-one image,
> I am getting an error  java.lang.UnsupportedClassVersionError:
> ClearwaterBulkProvisioner : Unsupported major.minor version 52.0
>
> Java version info in all-in-one image:
> [cw-aio]ubuntu at cwaio:/usr/share/clearwater/crest/tools/sstable_provisioning$
> java -version
> java version "1.7.0_101"
> OpenJDK Runtime Environment (IcedTea 2.6.6) (7u101-2.6.6-0ubuntu0.14.04.1)
> OpenJDK 64-Bit Server VM (build 24.95-b01, mixed mode)
>
> Thanks
>
> Kosala
>
>
>
>
>
>
> On Mon, Aug 15, 2016 at 2:17 PM, <clearwater-request at lists.
> projectclearwater.org> wrote:
>
> Send Clearwater mailing list submissions to
>         clearwater at lists.projectclearwater.org
>
> To subscribe or unsubscribe via the World Wide Web, visit
>         http://lists.projectclearwater.org/mailman/
> listinfo/clearwater_lists.projectclearwater.org
>
> or, via email, send a message with subject or body 'help' to
>         clearwater-request at lists.projectclearwater.org
>
> You can reach the person managing the list at
>         clearwater-owner at lists.projectclearwater.org
>
> When replying, please edit your Subject line so it is more specific
> than "Re: Contents of Clearwater digest..."
>
>
> Today's Topics:
>
>    1. Stress Testing (Kosala)
>    2. Re: Stress Testing (Matt Williams (projectclearwater.org))
>    3. Re: Stress Testing (Matt Williams (projectclearwater.org))
>
>
> ----------------------------------------------------------------------
>
> Message: 1
> Date: Mon, 15 Aug 2016 10:38:57 +0100
> From: Kosala <kosalayb at gmail.com>
> To: clearwater at lists.projectclearwater.org
> Subject: [Project Clearwater] Stress Testing
> Message-ID:
>         <CAGEe17an2B_bGj8NfKFwms+nU=vJURyhT5CE+mcY1pjcm4YF+A at mail.
> gmail.com>
> Content-Type: text/plain; charset="utf-8"
>
> Hi Team,
>
> I installed clearwater "all-in-one" image on Oracle Virtual Box.
> 1. Can I do stress testing ?
> 2. How to do that?
>
> I am trying to follow Stress Testing on
> http://clearwater.readthedocs.io/en/stable/Clearwater_stress_testing.html#
> configuring-udp-stress
> .
>
> Using chef - > It seems chef/knife install only supports in the Cloud
> approach (The automated install is only supported for deployments running
> in Amazon?s EC2 cloud).
>
> Manual approach, It looks not supporting all in one image.
>
> Many Thanks
> Kosala
> -------------- next part --------------
> An HTML attachment was scrubbed...
> URL: <http://lists.projectclearwater.org/pipermail/clearwater_lists.
> projectclearwater.org/attachments/20160815/15fc3b07/attachment-0001.html>
>
> ------------------------------
>
> Message: 2
> Date: Mon, 15 Aug 2016 09:54:02 +0000
> From: "Matt Williams (projectclearwater.org)"
>         <matt at projectclearwater.org>
> To: Kosala <kosalayb at gmail.com>
> Cc: "clearwater at lists.projectclearwater.org"
>         <clearwater at lists.projectclearwater.org>
> Subject: Re: [Project Clearwater] Stress Testing
> Message-ID:
>         <CY1PR0201MB15636F1F20EB91BB180F053390120 at CY1PR0201MB1563.
> namprd02.prod.outlook.com>
>
> Content-Type: text/plain; charset="utf-8"
>
> Kosala,
>
> While it's theoretically possible to do stress testing against an
> all-in-one image, I'd recommend against it - the all-in-one image has been
> squeezed down a lot to fit on a single VM and we'd expect very low
> performance out of it, and I could believe that overload behavior might be
> suboptimal.  If you're looking to stress test for performance reasons, I'd
> strongly recommend running a full deployment as this will give you much
> more reliable numbers.  If you're looking to stress test for other reasons,
> please can you share a bit more about what you're trying to achieve, and we
> can have a think about what would work best?
>
> If you do really want to run stress testing against an all-in-one image,
> it should probably work, even though http://clearwater.readthedocs.
> io/en/latest/Clearwater_stress_testing.html#manual-i-
> e-non-chef-stress-runs only talks about Chef and manual installs.  You'd
> need to set the "bono_servers" option in /etc/clearwater/shared_config to
> point to your all-in-one node, and I suspect you'd need to reduce the
> "count" option to something a lot lower - I'd start around 5000 and see how
> that goes.
>
> I hope that helps.  Please let me know how you get on.
>
> Thanks,
>
> Matt
>
> From: Clearwater [mailto:clearwater-bounces at lists.projectclearwater.org]
> On Behalf Of Kosala
> Sent: 15 August 2016 10:39
> To: clearwater at lists.projectclearwater.org
> Subject: [Project Clearwater] Stress Testing
>
> Hi Team,
> I installed clearwater "all-in-one" image on Oracle Virtual Box.
> 1. Can I do stress testing ?
> 2. How to do that?
> I am trying to follow Stress Testing on http://clearwater.readthedocs.
> io/en/stable/Clearwater_stress_testing.html#configuring-udp-stress.
> Using chef - > It seems chef/knife install only supports in the Cloud
> approach (The automated install is only supported for deployments running
> in Amazon?s EC2 cloud).
> Manual approach, It looks not supporting all in one image.
> Many Thanks
> Kosala
>
> -------------- next part --------------
> An HTML attachment was scrubbed...
> URL: <http://lists.projectclearwater.org/pipermail/clearwater_lists.
> projectclearwater.org/attachments/20160815/29d6328d/attachment-0001.html>
>
> ------------------------------
>
> Message: 3
> Date: Mon, 15 Aug 2016 13:16:47 +0000
> From: "Matt Williams (projectclearwater.org)"
>         <matt at projectclearwater.org>
> To: "clearwater at lists.projectclearwater.org"
>         <clearwater at lists.projectclearwater.org>
> Subject: Re: [Project Clearwater] Stress Testing
> Message-ID:
>         <CY1PR0201MB156372246DC5A77B11839F9D90120 at CY1PR0201MB1563.
> namprd02.prod.outlook.com>
>
> Content-Type: text/plain; charset="utf-8"
>
> Kosala,
>
> You'll need to follow all the steps in http://clearwater.readthedocs.
> io/en/latest/Clearwater_stress_testing.html#manual-i-
> e-non-chef-stress-runs, i.e. bulk provisioning subscribers and installing
> clearwater-sip-stress, but that should be it.
>
> Just to be clear, though, you'll need to set the configuration and install
> the clearwater-sip-stress package on a separate VM, not on the all-in-one
> image itself - the all-in-one image almost certainly opens up ports that
> conflict with those that clearwater-sip-stress tries to use.
>
> This isn't a very well-trodden path, though, so you may hit further issues
> - let me know if so, and we can try to work through them.
>
> Cheers,
>
> Matt
>
> From: Kosala [mailto:kosalayb at gmail.com]
> Sent: 15 August 2016 13:41
> To: Matt Williams (projectclearwater.org) <matt at projectclearwater.org>
> Subject: Re: [Project Clearwater] Stress Testing
>
> Hi Matt,
> Thanks. I set the bono_servers option. Should I add count =5000 to
> /etc/clearwater/shared_config ?
>
> Do I need other changes to run stress tests on all-in-one image?
> Thanks
> Kosala
>
>
>
> On Mon, Aug 15, 2016 at 10:54 AM, Matt Williams (projectclearwater.org<
> http://projectclearwater.org>) <matt at projectclearwater.org<mailto:
> matt at projectclearwater.org>> wrote:
> Kosala,
>
> While it's theoretically possible to do stress testing against an
> all-in-one image, I'd recommend against it - the all-in-one image has been
> squeezed down a lot to fit on a single VM and we'd expect very low
> performance out of it, and I could believe that overload behavior might be
> suboptimal.  If you're looking to stress test for performance reasons, I'd
> strongly recommend running a full deployment as this will give you much
> more reliable numbers.  If you're looking to stress test for other reasons,
> please can you share a bit more about what you're trying to achieve, and we
> can have a think about what would work best?
>
> If you do really want to run stress testing against an all-in-one image,
> it should probably work, even though http://clearwater.readthedocs.
> io/en/latest/Clearwater_stress_testing.html#manual-i-
> e-non-chef-stress-runs only talks about Chef and manual installs.  You'd
> need to set the "bono_servers" option in /etc/clearwater/shared_config to
> point to your all-in-one node, and I suspect you'd need to reduce the
> "count" option to something a lot lower - I'd start around 5000 and see how
> that goes.
>
> I hope that helps.  Please let me know how you get on.
>
> Thanks,
>
> Matt
>
> From: Clearwater [mailto:clearwater-bounces at lists.projectclearwater.org<
> mailto:clearwater-bounces at lists.projectclearwater.org>] On Behalf Of
> Kosala
> Sent: 15 August 2016 10:39
> To: clearwater at lists.projectclearwater.org<mailto:clearwater at lists.
> projectclearwater.org>
> Subject: [Project Clearwater] Stress Testing
>
> Hi Team,
> I installed clearwater "all-in-one" image on Oracle Virtual Box.
> 1. Can I do stress testing ?
> 2. How to do that?
> I am trying to follow Stress Testing on http://clearwater.readthedocs.
> io/en/stable/Clearwater_stress_testing.html#configuring-udp-stress.
> Using chef - > It seems chef/knife install only supports in the Cloud
> approach (The automated install is only supported for deployments running
> in Amazon?s EC2 cloud).
> Manual approach, It looks not supporting all in one image.
> Many Thanks
> Kosala
>
>
> -------------- next part --------------
> An HTML attachment was scrubbed...
> URL: <http://lists.projectclearwater.org/pipermail/clearwater_lists.
> projectclearwater.org/attachments/20160815/11781755/attachment.html>
>
> ------------------------------
>
> Subject: Digest Footer
>
> _______________________________________________
> Clearwater mailing list
> Clearwater at lists.projectclearwater.org
> http://lists.projectclearwater.org/mailman/listinfo/clearwater_lists.
> projectclearwater.org
>
>
> ------------------------------
>
> End of Clearwater Digest, Vol 40, Issue 24
> ******************************************
>
>
>
>
>
>
>
>
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.projectclearwater.org/pipermail/clearwater_lists.projectclearwater.org/attachments/20160817/f71ad7ed/attachment.html>

From matt at projectclearwater.org  Wed Aug 17 07:40:40 2016
From: matt at projectclearwater.org (Matt Williams (projectclearwater.org))
Date: Wed, 17 Aug 2016 11:40:40 +0000
Subject: [Project Clearwater] Clearwater Digest, Vol 40, Issue 24
In-Reply-To: <CAGEe17b2M2uqvbOuqH7t4xM41FbfBYk0xR3zWqiFh+EkSfUzUQ@mail.gmail.com>
References: <mailman.20.1471267072.11502.clearwater_lists.projectclearwater.org@lists.projectclearwater.org>
	<CAGEe17ZLnypQfbzxEwxj9EaB20MUBVpY+YdN-Obv=gHpZmG0KA@mail.gmail.com>
	<CY1PR0201MB1563F9A706F3EC7BE7F9C11590120@CY1PR0201MB1563.namprd02.prod.outlook.com>
	<CAGEe17bfTu1Kpwx=ipqtEbShvWtP+C6pJEEGHi0GSwBR5Dqw8w@mail.gmail.com>
	<CAGEe17aY077tLtotRe1X8k1qU_4otBdHDMJjqDH_g02Zs676Jg@mail.gmail.com>
	<CAGEe17ZeNPPy7AmMz=LCWnHqLm=v9Q7CuLT+AOVKWJTdg8m7Eg@mail.gmail.com>
	<CY1PR0201MB1563CE17983225B985B19D7390130@CY1PR0201MB1563.namprd02.prod.outlook.com>
	<CAGEe17b2M2uqvbOuqH7t4xM41FbfBYk0xR3zWqiFh+EkSfUzUQ@mail.gmail.com>
Message-ID: <CY1PR0201MB1563CD5DDDD6E7B5A0B2DB7290140@CY1PR0201MB1563.namprd02.prod.outlook.com>

Kosala,

They should log to /var/log/clearwater-sip-stress - in particular, the *.1.out file is a log of the output from sipp.  Do you see anything there?

Matt

From: Kosala [mailto:kosalayb at gmail.com]
Sent: 17 August 2016 12:33
To: Matt Williams (projectclearwater.org) <matt at projectclearwater.org>; clearwater at lists.projectclearwater.org
Subject: Re: [Project Clearwater] Clearwater Digest, Vol 40, Issue 24

Hi Matt,
I followed above steps and run sudo apt-get install clearwater-sip-stress.
How do I know stress tests are running? Is is said, stress tests start automatically but I cannot see it.
Thanks
Kosala



On Tue, Aug 16, 2016 at 2:01 PM, Matt Williams (projectclearwater.org<http://projectclearwater.org>) <matt at projectclearwater.org<mailto:matt at projectclearwater.org>> wrote:
Kosala,

I'm glad you've made progress on this.

I had a look at the crest package version, but it seems to be later than the most recent all-in-one image uses (1.0-160811.103635).  When did you download the all-in-one image, and did you apply any patches to it?

Regarding making calls for stress testing, this is where http://clearwater.readthedocs.io/en/latest/Clearwater_stress_testing.html#manual-i-e-non-chef-stress-runs comes in - you need to

?         create a separate VM

?         set the bono_hostname and count parameters in /etc/clearwater/shared_config

?         install the clearwater-sip-stress package.
I hope that helps.

BTW, please remember to copy in clearwater at lists.projectclearwater.org<mailto:clearwater at lists.projectclearwater.org> - that means that other people can see and comment on your posts.

Thanks,

Matt


From: Kosala [mailto:kosalayb at gmail.com<mailto:kosalayb at gmail.com>]
Sent: 16 August 2016 10:48
To: Matt Williams (projectclearwater.org<http://projectclearwater.org>) <matt at projectclearwater.org<mailto:matt at projectclearwater.org>>
Subject: Re: [Project Clearwater] Clearwater Digest, Vol 40, Issue 24

Hi Matt,
Bulk provisioning for all in one image is done using https://github.com/Metaswitch/crest/blob/dev/docs/Bulk-Provisioning%20Numbers.md.
I have records in tables in homestead_cache and homer.
Now How to make calls for stress testing?
Is there any guideline?
Many Thanks,
Kosala




On Tue, Aug 16, 2016 at 9:04 AM, Kosala <kosalayb at gmail.com<mailto:kosalayb at gmail.com>> wrote:
Hi Matt,
TBH, The document in https://github.com/Metaswitch/crest/blob/dev/docs/Bulk-Provisioning%20Numbers.md is not clear to me.
Step 1. Homestead node in deployment. I do not know where is that node in all in one image. It will be helpful the location of that folder from the root.
Step 2. A simple example will be helpful.
Thanks
Kosala


On Tue, Aug 16, 2016 at 8:50 AM, Kosala <kosalayb at gmail.com<mailto:kosalayb at gmail.com>> wrote:
Hi Matt,
I downloaded the all in one package from http://clearwater.readthedocs.io/en/stable/All_in_one_OVF_Installation.html
and imported using oracle virtual box on ubuntu 14.04,
Crest version
[cw-aio]ubuntu at cwaio:~$ sudo dpkg-query -s crest
Package: crest
Status: install ok installed
Priority: optional
Section: network
Installed-Size: 40098
Maintainer: Project Clearwater Maintainers <maintainers at projectclearwater.org<mailto:maintainers at projectclearwater.org>>
Architecture: amd64
Version: 1.0-160815.145007
Thanks
Kosala


On Mon, Aug 15, 2016 at 5:56 PM, Matt Williams (projectclearwater.org<http://projectclearwater.org>) <matt at projectclearwater.org<mailto:matt at projectclearwater.org>> wrote:
Kosala,

That's odd - I don't see that failure on my all-in-one image (spun up just now from the latest image) - which version of all-in-one-image are you running, and which version of crest does it include ("sudo dpkg-query -s crest")?

You may be able to work-around this either by taking the latest all-in-one image or by following the simpler bulk-provisioning process at https://github.com/Metaswitch/crest/blob/dev/docs/Bulk-Provisioning%20Numbers.md (when this doc talks about using the sstables_provisioning process for very large sets of numbers, we mean 1M+ numbers - the 9000 you're provisioning are well within the capabilities of this process).

I hope that helps - please let me know how you get on.

Cheers,

Matt


From: Clearwater [mailto:clearwater-bounces at lists.projectclearwater.org<mailto:clearwater-bounces at lists.projectclearwater.org>] On Behalf Of Kosala
Sent: 15 August 2016 16:58
To: clearwater at lists.projectclearwater.org<mailto:clearwater at lists.projectclearwater.org>
Subject: Re: [Project Clearwater] Clearwater Digest, Vol 40, Issue 24

HI Matt,
Thanks.

I am trying to follow https://github.com/Metaswitch/crest/blob/dev/src/metaswitch/crest/tools/sstable_provisioning/README.md for bulk provisioning.

When I am trying to execute sudo ./BulkProvision homer 21000 29999 example.com<http://example.com> 7kkzTyGW in all-in-one image,
I am getting an error  java.lang.UnsupportedClassVersionError: ClearwaterBulkProvisioner : Unsupported major.minor version 52.0
Java version info in all-in-one image:
[cw-aio]ubuntu at cwaio:/usr/share/clearwater/crest/tools/sstable_provisioning$ java -version
java version "1.7.0_101"
OpenJDK Runtime Environment (IcedTea 2.6.6) (7u101-2.6.6-0ubuntu0.14.04.1)
OpenJDK 64-Bit Server VM (build 24.95-b01, mixed mode)
Thanks
Kosala



On Mon, Aug 15, 2016 at 2:17 PM, <clearwater-request at lists.projectclearwater.org<mailto:clearwater-request at lists.projectclearwater.org>> wrote:
Send Clearwater mailing list submissions to
        clearwater at lists.projectclearwater.org<mailto:clearwater at lists.projectclearwater.org>

To subscribe or unsubscribe via the World Wide Web, visit
        http://lists.projectclearwater.org/mailman/listinfo/clearwater_lists.projectclearwater.org

or, via email, send a message with subject or body 'help' to
        clearwater-request at lists.projectclearwater.org<mailto:clearwater-request at lists.projectclearwater.org>

You can reach the person managing the list at
        clearwater-owner at lists.projectclearwater.org<mailto:clearwater-owner at lists.projectclearwater.org>

When replying, please edit your Subject line so it is more specific
than "Re: Contents of Clearwater digest..."


Today's Topics:

   1. Stress Testing (Kosala)
   2. Re: Stress Testing (Matt Williams (projectclearwater.org<http://projectclearwater.org>))
   3. Re: Stress Testing (Matt Williams (projectclearwater.org<http://projectclearwater.org>))


----------------------------------------------------------------------

Message: 1
Date: Mon, 15 Aug 2016 10:38:57 +0100
From: Kosala <kosalayb at gmail.com<mailto:kosalayb at gmail.com>>
To: clearwater at lists.projectclearwater.org<mailto:clearwater at lists.projectclearwater.org>
Subject: [Project Clearwater] Stress Testing
Message-ID:
        <CAGEe17an2B_bGj8NfKFwms+nU=vJURyhT5CE+mcY1pjcm4YF+A at mail.gmail.com<mailto:vJURyhT5CE%2BmcY1pjcm4YF%2BA at mail.gmail.com>>
Content-Type: text/plain; charset="utf-8"

Hi Team,

I installed clearwater "all-in-one" image on Oracle Virtual Box.
1. Can I do stress testing ?
2. How to do that?

I am trying to follow Stress Testing on
http://clearwater.readthedocs.io/en/stable/Clearwater_stress_testing.html#configuring-udp-stress
.

Using chef - > It seems chef/knife install only supports in the Cloud
approach (The automated install is only supported for deployments running
in Amazon?s EC2 cloud).

Manual approach, It looks not supporting all in one image.

Many Thanks
Kosala
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.projectclearwater.org/pipermail/clearwater_lists.projectclearwater.org/attachments/20160815/15fc3b07/attachment-0001.html>

------------------------------

Message: 2
Date: Mon, 15 Aug 2016 09:54:02 +0000
From: "Matt Williams (projectclearwater.org<http://projectclearwater.org>)"
        <matt at projectclearwater.org<mailto:matt at projectclearwater.org>>
To: Kosala <kosalayb at gmail.com<mailto:kosalayb at gmail.com>>
Cc: "clearwater at lists.projectclearwater.org<mailto:clearwater at lists.projectclearwater.org>"
        <clearwater at lists.projectclearwater.org<mailto:clearwater at lists.projectclearwater.org>>
Subject: Re: [Project Clearwater] Stress Testing
Message-ID:
        <CY1PR0201MB15636F1F20EB91BB180F053390120 at CY1PR0201MB1563.namprd02.prod.outlook.com<mailto:CY1PR0201MB15636F1F20EB91BB180F053390120 at CY1PR0201MB1563.namprd02.prod.outlook.com>>

Content-Type: text/plain; charset="utf-8"

Kosala,

While it's theoretically possible to do stress testing against an all-in-one image, I'd recommend against it - the all-in-one image has been squeezed down a lot to fit on a single VM and we'd expect very low performance out of it, and I could believe that overload behavior might be suboptimal.  If you're looking to stress test for performance reasons, I'd strongly recommend running a full deployment as this will give you much more reliable numbers.  If you're looking to stress test for other reasons, please can you share a bit more about what you're trying to achieve, and we can have a think about what would work best?

If you do really want to run stress testing against an all-in-one image, it should probably work, even though http://clearwater.readthedocs.io/en/latest/Clearwater_stress_testing.html#manual-i-e-non-chef-stress-runs only talks about Chef and manual installs.  You'd need to set the "bono_servers" option in /etc/clearwater/shared_config to point to your all-in-one node, and I suspect you'd need to reduce the "count" option to something a lot lower - I'd start around 5000 and see how that goes.

I hope that helps.  Please let me know how you get on.

Thanks,

Matt

From: Clearwater [mailto:clearwater-bounces at lists.projectclearwater.org<mailto:clearwater-bounces at lists.projectclearwater.org>] On Behalf Of Kosala
Sent: 15 August 2016 10:39
To: clearwater at lists.projectclearwater.org<mailto:clearwater at lists.projectclearwater.org>
Subject: [Project Clearwater] Stress Testing

Hi Team,
I installed clearwater "all-in-one" image on Oracle Virtual Box.
1. Can I do stress testing ?
2. How to do that?
I am trying to follow Stress Testing on http://clearwater.readthedocs.io/en/stable/Clearwater_stress_testing.html#configuring-udp-stress.
Using chef - > It seems chef/knife install only supports in the Cloud approach (The automated install is only supported for deployments running in Amazon?s EC2 cloud).
Manual approach, It looks not supporting all in one image.
Many Thanks
Kosala

-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.projectclearwater.org/pipermail/clearwater_lists.projectclearwater.org/attachments/20160815/29d6328d/attachment-0001.html>

------------------------------

Message: 3
Date: Mon, 15 Aug 2016 13:16:47 +0000
From: "Matt Williams (projectclearwater.org<http://projectclearwater.org>)"
        <matt at projectclearwater.org<mailto:matt at projectclearwater.org>>
To: "clearwater at lists.projectclearwater.org<mailto:clearwater at lists.projectclearwater.org>"
        <clearwater at lists.projectclearwater.org<mailto:clearwater at lists.projectclearwater.org>>
Subject: Re: [Project Clearwater] Stress Testing
Message-ID:
        <CY1PR0201MB156372246DC5A77B11839F9D90120 at CY1PR0201MB1563.namprd02.prod.outlook.com<mailto:CY1PR0201MB156372246DC5A77B11839F9D90120 at CY1PR0201MB1563.namprd02.prod.outlook.com>>

Content-Type: text/plain; charset="utf-8"

Kosala,

You'll need to follow all the steps in http://clearwater.readthedocs.io/en/latest/Clearwater_stress_testing.html#manual-i-e-non-chef-stress-runs, i.e. bulk provisioning subscribers and installing clearwater-sip-stress, but that should be it.

Just to be clear, though, you'll need to set the configuration and install the clearwater-sip-stress package on a separate VM, not on the all-in-one image itself - the all-in-one image almost certainly opens up ports that conflict with those that clearwater-sip-stress tries to use.

This isn't a very well-trodden path, though, so you may hit further issues - let me know if so, and we can try to work through them.

Cheers,

Matt

From: Kosala [mailto:kosalayb at gmail.com<mailto:kosalayb at gmail.com>]
Sent: 15 August 2016 13:41
To: Matt Williams (projectclearwater.org<http://projectclearwater.org>) <matt at projectclearwater.org<mailto:matt at projectclearwater.org>>
Subject: Re: [Project Clearwater] Stress Testing

Hi Matt,
Thanks. I set the bono_servers option. Should I add count =5000 to /etc/clearwater/shared_config ?

Do I need other changes to run stress tests on all-in-one image?
Thanks
Kosala



On Mon, Aug 15, 2016 at 10:54 AM, Matt Williams (projectclearwater.org<http://projectclearwater.org><http://projectclearwater.org>) <matt at projectclearwater.org<mailto:matt at projectclearwater.org><mailto:matt at projectclearwater.org<mailto:matt at projectclearwater.org>>> wrote:
Kosala,

While it's theoretically possible to do stress testing against an all-in-one image, I'd recommend against it - the all-in-one image has been squeezed down a lot to fit on a single VM and we'd expect very low performance out of it, and I could believe that overload behavior might be suboptimal.  If you're looking to stress test for performance reasons, I'd strongly recommend running a full deployment as this will give you much more reliable numbers.  If you're looking to stress test for other reasons, please can you share a bit more about what you're trying to achieve, and we can have a think about what would work best?

If you do really want to run stress testing against an all-in-one image, it should probably work, even though http://clearwater.readthedocs.io/en/latest/Clearwater_stress_testing.html#manual-i-e-non-chef-stress-runs only talks about Chef and manual installs.  You'd need to set the "bono_servers" option in /etc/clearwater/shared_config to point to your all-in-one node, and I suspect you'd need to reduce the "count" option to something a lot lower - I'd start around 5000 and see how that goes.

I hope that helps.  Please let me know how you get on.

Thanks,

Matt

From: Clearwater [mailto:clearwater-bounces at lists.projectclearwater.org<mailto:clearwater-bounces at lists.projectclearwater.org><mailto:clearwater-bounces at lists.projectclearwater.org<mailto:clearwater-bounces at lists.projectclearwater.org>>] On Behalf Of Kosala
Sent: 15 August 2016 10:39
To: clearwater at lists.projectclearwater.org<mailto:clearwater at lists.projectclearwater.org><mailto:clearwater at lists.projectclearwater.org<mailto:clearwater at lists.projectclearwater.org>>
Subject: [Project Clearwater] Stress Testing

Hi Team,
I installed clearwater "all-in-one" image on Oracle Virtual Box.
1. Can I do stress testing ?
2. How to do that?
I am trying to follow Stress Testing on http://clearwater.readthedocs.io/en/stable/Clearwater_stress_testing.html#configuring-udp-stress.
Using chef - > It seems chef/knife install only supports in the Cloud approach (The automated install is only supported for deployments running in Amazon?s EC2 cloud).
Manual approach, It looks not supporting all in one image.
Many Thanks
Kosala


-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.projectclearwater.org/pipermail/clearwater_lists.projectclearwater.org/attachments/20160815/11781755/attachment.html>

------------------------------

Subject: Digest Footer

_______________________________________________
Clearwater mailing list
Clearwater at lists.projectclearwater.org<mailto:Clearwater at lists.projectclearwater.org>
http://lists.projectclearwater.org/mailman/listinfo/clearwater_lists.projectclearwater.org


------------------------------

End of Clearwater Digest, Vol 40, Issue 24
******************************************





-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.projectclearwater.org/pipermail/clearwater_lists.projectclearwater.org/attachments/20160817/f074a52a/attachment.html>

From kosalayb at gmail.com  Wed Aug 17 07:52:36 2016
From: kosalayb at gmail.com (Kosala)
Date: Wed, 17 Aug 2016 12:52:36 +0100
Subject: [Project Clearwater] Clearwater Digest, Vol 40, Issue 24
In-Reply-To: <CAGEe17b2M2uqvbOuqH7t4xM41FbfBYk0xR3zWqiFh+EkSfUzUQ@mail.gmail.com>
References: <mailman.20.1471267072.11502.clearwater_lists.projectclearwater.org@lists.projectclearwater.org>
	<CAGEe17ZLnypQfbzxEwxj9EaB20MUBVpY+YdN-Obv=gHpZmG0KA@mail.gmail.com>
	<CY1PR0201MB1563F9A706F3EC7BE7F9C11590120@CY1PR0201MB1563.namprd02.prod.outlook.com>
	<CAGEe17bfTu1Kpwx=ipqtEbShvWtP+C6pJEEGHi0GSwBR5Dqw8w@mail.gmail.com>
	<CAGEe17aY077tLtotRe1X8k1qU_4otBdHDMJjqDH_g02Zs676Jg@mail.gmail.com>
	<CAGEe17ZeNPPy7AmMz=LCWnHqLm=v9Q7CuLT+AOVKWJTdg8m7Eg@mail.gmail.com>
	<CY1PR0201MB1563CE17983225B985B19D7390130@CY1PR0201MB1563.namprd02.prod.outlook.com>
	<CAGEe17b2M2uqvbOuqH7t4xM41FbfBYk0xR3zWqiFh+EkSfUzUQ@mail.gmail.com>
Message-ID: <CAGEe17ZrX68ufGeQD5S-YTgi=DJYVbnptYomW71Ox1rwW4r+OQ@mail.gmail.com>

Hi Matt,

[cw-aio]ubuntu at cwaio:~$ sudo service clearwater-sip-stress restart
 * Restarting Clearwater SIP stress
sip-stress
* Restarting clearwater-infrastructure clearwater-infrastructure

I am getting:

zmq_msg_recv: Resource temporarily unavailable
zmq_msg_recv: Resource temporarily unavailable
zmq_msg_recv: Resource temporarily unavailable
zmq_msg_recv: Resource temporarily unavailable
zmq_msg_recv: Resource temporarily unavailable
zmq_msg_recv: Resource temporarily unavailable
zmq_msg_recv: Resource temporarily unavailable
zmq_msg_recv: Resource temporarily unavailable
zmq_msg_recv: Resource temporarily unavailable
zmq_msg_recv: Resource temporarily unavailable
/etc/init.d/clearwater-infrastructure: 76:
/etc/init.d/clearwater-infrastructure:
/usr/share/clearwater/infrastructure/scripts/logging.bash: Permission denied
Configuring monit for only localhost access

Thanks
Kosala


On Wed, Aug 17, 2016 at 12:32 PM, Kosala <kosalayb at gmail.com> wrote:

> Hi Matt,
>
> I followed above steps and run sudo apt-get install clearwater-sip-stress.
> How do I know stress tests are running? Is is said, stress tests start
> automatically but I cannot see it.
>
> Thanks
> Kosala
>
>
>
>
> On Tue, Aug 16, 2016 at 2:01 PM, Matt Williams (projectclearwater.org) <
> matt at projectclearwater.org> wrote:
>
>> Kosala,
>>
>>
>>
>> I'm glad you've made progress on this.
>>
>>
>>
>> I had a look at the crest package version, but it seems to be later than
>> the most recent all-in-one image uses (1.0-160811.103635).  When did you
>> download the all-in-one image, and did you apply any patches to it?
>>
>>
>>
>> Regarding making calls for stress testing, this is where
>> http://clearwater.readthedocs.io/en/latest/Clearwater_stress
>> _testing.html#manual-i-e-non-chef-stress-runs comes in - you need to
>>
>> ?         create a separate VM
>>
>> ?         set the bono_hostname and count parameters in
>> /etc/clearwater/shared_config
>>
>> ?         install the clearwater-sip-stress package.
>>
>> I hope that helps.
>>
>>
>>
>> BTW, please remember to copy in clearwater at lists.projectclearwater.org -
>> that means that other people can see and comment on your posts.
>>
>>
>>
>> Thanks,
>>
>>
>>
>> Matt
>>
>>
>>
>>
>>
>> *From:* Kosala [mailto:kosalayb at gmail.com]
>> *Sent:* 16 August 2016 10:48
>> *To:* Matt Williams (projectclearwater.org) <matt at projectclearwater.org>
>> *Subject:* Re: [Project Clearwater] Clearwater Digest, Vol 40, Issue 24
>>
>>
>>
>> Hi Matt,
>>
>> Bulk provisioning for all in one image is done using
>> https://github.com/Metaswitch/crest/blob/dev/docs/Bulk-Provi
>> sioning%20Numbers.md.
>>
>> I have records in tables in homestead_cache and homer.
>>
>> Now How to make calls for stress testing?
>>
>> Is there any guideline?
>>
>> Many Thanks,
>>
>> Kosala
>>
>>
>>
>>
>>
>>
>>
>>
>>
>> On Tue, Aug 16, 2016 at 9:04 AM, Kosala <kosalayb at gmail.com> wrote:
>>
>> Hi Matt,
>>
>> TBH, The document in https://github.com/Metaswitch/
>> crest/blob/dev/docs/Bulk-Provisioning%20Numbers.md is not clear to me.
>>
>> Step 1. Homestead node in deployment. I do not know where is that node in
>> all in one image. It will be helpful the location of that folder from the
>> root.
>>
>> Step 2. A simple example will be helpful.
>>
>> Thanks
>>
>> Kosala
>>
>>
>>
>>
>>
>> On Tue, Aug 16, 2016 at 8:50 AM, Kosala <kosalayb at gmail.com> wrote:
>>
>> Hi Matt,
>>
>> I downloaded the all in one package from http://clearwater.readthedocs.
>> io/en/stable/All_in_one_OVF_Installation.html
>>
>> and imported using oracle virtual box on ubuntu 14.04,
>>
>> Crest version
>>
>> [cw-aio]ubuntu at cwaio:~$ sudo dpkg-query -s crest
>> Package: crest
>> Status: install ok installed
>> Priority: optional
>> Section: network
>> Installed-Size: 40098
>> Maintainer: Project Clearwater Maintainers <maintainers at projectclearwater
>> .org>
>> Architecture: amd64
>> Version: 1.0-160815.145007
>>
>> Thanks
>>
>> Kosala
>>
>>
>>
>>
>>
>> On Mon, Aug 15, 2016 at 5:56 PM, Matt Williams (projectclearwater.org) <
>> matt at projectclearwater.org> wrote:
>>
>> Kosala,
>>
>>
>>
>> That's odd - I don't see that failure on my all-in-one image (spun up
>> just now from the latest image) - which version of all-in-one-image are you
>> running, and which version of crest does it include ("sudo dpkg-query -s
>> crest")?
>>
>>
>>
>> You may be able to work-around this either by taking the latest
>> all-in-one image or by following the simpler bulk-provisioning process at
>> https://github.com/Metaswitch/crest/blob/dev/docs/Bulk-Provi
>> sioning%20Numbers.md (when this doc talks about using the
>> sstables_provisioning process for very large sets of numbers, we mean 1M+
>> numbers - the 9000 you're provisioning are well within the capabilities of
>> this process).
>>
>>
>>
>> I hope that helps - please let me know how you get on.
>>
>>
>>
>> Cheers,
>>
>>
>>
>> Matt
>>
>>
>>
>>
>>
>> *From:* Clearwater [mailto:clearwater-bounces at lists.projectclearwater.org]
>> *On Behalf Of *Kosala
>> *Sent:* 15 August 2016 16:58
>> *To:* clearwater at lists.projectclearwater.org
>> *Subject:* Re: [Project Clearwater] Clearwater Digest, Vol 40, Issue 24
>>
>>
>>
>> HI Matt,
>>
>> Thanks.
>>
>>
>> I am trying to follow https://github.com/Metaswitch/
>> crest/blob/dev/src/metaswitch/crest/tools/sstable_provisioning/README.md
>> for bulk provisioning.
>>
>>
>> When I am trying to execute sudo ./BulkProvision homer 21000 29999
>> example.com 7kkzTyGW in all-in-one image,
>> I am getting an error  java.lang.UnsupportedClassVersionError:
>> ClearwaterBulkProvisioner : Unsupported major.minor version 52.0
>>
>> Java version info in all-in-one image:
>> [cw-aio]ubuntu at cwaio:/usr/share/clearwater/crest/tools/sstable_provisioning$
>> java -version
>> java version "1.7.0_101"
>> OpenJDK Runtime Environment (IcedTea 2.6.6) (7u101-2.6.6-0ubuntu0.14.04.1)
>> OpenJDK 64-Bit Server VM (build 24.95-b01, mixed mode)
>>
>> Thanks
>>
>> Kosala
>>
>>
>>
>>
>>
>>
>> On Mon, Aug 15, 2016 at 2:17 PM, <clearwater-request at lists.proj
>> ectclearwater.org> wrote:
>>
>> Send Clearwater mailing list submissions to
>>         clearwater at lists.projectclearwater.org
>>
>> To subscribe or unsubscribe via the World Wide Web, visit
>>         http://lists.projectclearwater.org/mailman/listinfo/
>> clearwater_lists.projectclearwater.org
>>
>> or, via email, send a message with subject or body 'help' to
>>         clearwater-request at lists.projectclearwater.org
>>
>> You can reach the person managing the list at
>>         clearwater-owner at lists.projectclearwater.org
>>
>> When replying, please edit your Subject line so it is more specific
>> than "Re: Contents of Clearwater digest..."
>>
>>
>> Today's Topics:
>>
>>    1. Stress Testing (Kosala)
>>    2. Re: Stress Testing (Matt Williams (projectclearwater.org))
>>    3. Re: Stress Testing (Matt Williams (projectclearwater.org))
>>
>>
>> ----------------------------------------------------------------------
>>
>> Message: 1
>> Date: Mon, 15 Aug 2016 10:38:57 +0100
>> From: Kosala <kosalayb at gmail.com>
>> To: clearwater at lists.projectclearwater.org
>> Subject: [Project Clearwater] Stress Testing
>> Message-ID:
>>         <CAGEe17an2B_bGj8NfKFwms+nU=vJURyhT5CE+mcY1pjcm4YF+A at mail.gm
>> ail.com>
>> Content-Type: text/plain; charset="utf-8"
>>
>> Hi Team,
>>
>> I installed clearwater "all-in-one" image on Oracle Virtual Box.
>> 1. Can I do stress testing ?
>> 2. How to do that?
>>
>> I am trying to follow Stress Testing on
>> http://clearwater.readthedocs.io/en/stable/Clearwater_stress
>> _testing.html#configuring-udp-stress
>> .
>>
>> Using chef - > It seems chef/knife install only supports in the Cloud
>> approach (The automated install is only supported for deployments running
>> in Amazon?s EC2 cloud).
>>
>> Manual approach, It looks not supporting all in one image.
>>
>> Many Thanks
>> Kosala
>> -------------- next part --------------
>> An HTML attachment was scrubbed...
>> URL: <http://lists.projectclearwater.org/pipermail/clearwater_
>> lists.projectclearwater.org/attachments/20160815/15fc3b07/at
>> tachment-0001.html>
>>
>> ------------------------------
>>
>> Message: 2
>> Date: Mon, 15 Aug 2016 09:54:02 +0000
>> From: "Matt Williams (projectclearwater.org)"
>>         <matt at projectclearwater.org>
>> To: Kosala <kosalayb at gmail.com>
>> Cc: "clearwater at lists.projectclearwater.org"
>>         <clearwater at lists.projectclearwater.org>
>> Subject: Re: [Project Clearwater] Stress Testing
>> Message-ID:
>>         <CY1PR0201MB15636F1F20EB91BB180F053390120 at CY1PR0201MB1563.na
>> mprd02.prod.outlook.com>
>>
>> Content-Type: text/plain; charset="utf-8"
>>
>> Kosala,
>>
>> While it's theoretically possible to do stress testing against an
>> all-in-one image, I'd recommend against it - the all-in-one image has been
>> squeezed down a lot to fit on a single VM and we'd expect very low
>> performance out of it, and I could believe that overload behavior might be
>> suboptimal.  If you're looking to stress test for performance reasons, I'd
>> strongly recommend running a full deployment as this will give you much
>> more reliable numbers.  If you're looking to stress test for other reasons,
>> please can you share a bit more about what you're trying to achieve, and we
>> can have a think about what would work best?
>>
>> If you do really want to run stress testing against an all-in-one image,
>> it should probably work, even though http://clearwater.readthedocs.
>> io/en/latest/Clearwater_stress_testing.html#manual-i-e-non-
>> chef-stress-runs only talks about Chef and manual installs.  You'd need
>> to set the "bono_servers" option in /etc/clearwater/shared_config to point
>> to your all-in-one node, and I suspect you'd need to reduce the "count"
>> option to something a lot lower - I'd start around 5000 and see how that
>> goes.
>>
>> I hope that helps.  Please let me know how you get on.
>>
>> Thanks,
>>
>> Matt
>>
>> From: Clearwater [mailto:clearwater-bounces at lists.projectclearwater.org]
>> On Behalf Of Kosala
>> Sent: 15 August 2016 10:39
>> To: clearwater at lists.projectclearwater.org
>> Subject: [Project Clearwater] Stress Testing
>>
>> Hi Team,
>> I installed clearwater "all-in-one" image on Oracle Virtual Box.
>> 1. Can I do stress testing ?
>> 2. How to do that?
>> I am trying to follow Stress Testing on http://clearwater.readthedocs.
>> io/en/stable/Clearwater_stress_testing.html#configuring-udp-stress.
>> Using chef - > It seems chef/knife install only supports in the Cloud
>> approach (The automated install is only supported for deployments running
>> in Amazon?s EC2 cloud).
>> Manual approach, It looks not supporting all in one image.
>> Many Thanks
>> Kosala
>>
>> -------------- next part --------------
>> An HTML attachment was scrubbed...
>> URL: <http://lists.projectclearwater.org/pipermail/clearwater_
>> lists.projectclearwater.org/attachments/20160815/29d6328d/at
>> tachment-0001.html>
>>
>> ------------------------------
>>
>> Message: 3
>> Date: Mon, 15 Aug 2016 13:16:47 +0000
>> From: "Matt Williams (projectclearwater.org)"
>>         <matt at projectclearwater.org>
>> To: "clearwater at lists.projectclearwater.org"
>>         <clearwater at lists.projectclearwater.org>
>> Subject: Re: [Project Clearwater] Stress Testing
>> Message-ID:
>>         <CY1PR0201MB156372246DC5A77B11839F9D90120 at CY1PR0201MB1563.na
>> mprd02.prod.outlook.com>
>>
>> Content-Type: text/plain; charset="utf-8"
>>
>> Kosala,
>>
>> You'll need to follow all the steps in http://clearwater.readthedocs.
>> io/en/latest/Clearwater_stress_testing.html#manual-i-e-non-
>> chef-stress-runs, i.e. bulk provisioning subscribers and installing
>> clearwater-sip-stress, but that should be it.
>>
>> Just to be clear, though, you'll need to set the configuration and
>> install the clearwater-sip-stress package on a separate VM, not on the
>> all-in-one image itself - the all-in-one image almost certainly opens up
>> ports that conflict with those that clearwater-sip-stress tries to use.
>>
>> This isn't a very well-trodden path, though, so you may hit further
>> issues - let me know if so, and we can try to work through them.
>>
>> Cheers,
>>
>> Matt
>>
>> From: Kosala [mailto:kosalayb at gmail.com]
>> Sent: 15 August 2016 13:41
>> To: Matt Williams (projectclearwater.org) <matt at projectclearwater.org>
>> Subject: Re: [Project Clearwater] Stress Testing
>>
>> Hi Matt,
>> Thanks. I set the bono_servers option. Should I add count =5000 to
>> /etc/clearwater/shared_config ?
>>
>> Do I need other changes to run stress tests on all-in-one image?
>> Thanks
>> Kosala
>>
>>
>>
>> On Mon, Aug 15, 2016 at 10:54 AM, Matt Williams (projectclearwater.org<
>> http://projectclearwater.org>) <matt at projectclearwater.org<mailto:
>> matt at projectclearwater.org>> wrote:
>> Kosala,
>>
>> While it's theoretically possible to do stress testing against an
>> all-in-one image, I'd recommend against it - the all-in-one image has been
>> squeezed down a lot to fit on a single VM and we'd expect very low
>> performance out of it, and I could believe that overload behavior might be
>> suboptimal.  If you're looking to stress test for performance reasons, I'd
>> strongly recommend running a full deployment as this will give you much
>> more reliable numbers.  If you're looking to stress test for other reasons,
>> please can you share a bit more about what you're trying to achieve, and we
>> can have a think about what would work best?
>>
>> If you do really want to run stress testing against an all-in-one image,
>> it should probably work, even though http://clearwater.readthedocs.
>> io/en/latest/Clearwater_stress_testing.html#manual-i-e-non-
>> chef-stress-runs only talks about Chef and manual installs.  You'd need
>> to set the "bono_servers" option in /etc/clearwater/shared_config to point
>> to your all-in-one node, and I suspect you'd need to reduce the "count"
>> option to something a lot lower - I'd start around 5000 and see how that
>> goes.
>>
>> I hope that helps.  Please let me know how you get on.
>>
>> Thanks,
>>
>> Matt
>>
>> From: Clearwater [mailto:clearwater-bounces at lists.projectclearwater.org
>> <mailto:clearwater-bounces at lists.projectclearwater.org>] On Behalf Of
>> Kosala
>> Sent: 15 August 2016 10:39
>> To: clearwater at lists.projectclearwater.org<mailto:clearwater@
>> lists.projectclearwater.org>
>> Subject: [Project Clearwater] Stress Testing
>>
>> Hi Team,
>> I installed clearwater "all-in-one" image on Oracle Virtual Box.
>> 1. Can I do stress testing ?
>> 2. How to do that?
>> I am trying to follow Stress Testing on http://clearwater.readthedocs.
>> io/en/stable/Clearwater_stress_testing.html#configuring-udp-stress.
>> Using chef - > It seems chef/knife install only supports in the Cloud
>> approach (The automated install is only supported for deployments running
>> in Amazon?s EC2 cloud).
>> Manual approach, It looks not supporting all in one image.
>> Many Thanks
>> Kosala
>>
>>
>> -------------- next part --------------
>> An HTML attachment was scrubbed...
>> URL: <http://lists.projectclearwater.org/pipermail/clearwater_
>> lists.projectclearwater.org/attachments/20160815/11781755/attachment.html
>> >
>>
>> ------------------------------
>>
>> Subject: Digest Footer
>>
>> _______________________________________________
>> Clearwater mailing list
>> Clearwater at lists.projectclearwater.org
>> http://lists.projectclearwater.org/mailman/listinfo/
>> clearwater_lists.projectclearwater.org
>>
>>
>> ------------------------------
>>
>> End of Clearwater Digest, Vol 40, Issue 24
>> ******************************************
>>
>>
>>
>>
>>
>>
>>
>>
>>
>
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.projectclearwater.org/pipermail/clearwater_lists.projectclearwater.org/attachments/20160817/ca7c0ba0/attachment.html>

From matt at projectclearwater.org  Wed Aug 17 09:29:21 2016
From: matt at projectclearwater.org (Matt Williams (projectclearwater.org))
Date: Wed, 17 Aug 2016 13:29:21 +0000
Subject: [Project Clearwater] Clearwater Digest, Vol 40, Issue 24
In-Reply-To: <CAGEe17YGnaY1Kqc65gyiVO1sBBuTx=-YzfD9HY3M6QBD2t9AkA@mail.gmail.com>
References: <mailman.20.1471267072.11502.clearwater_lists.projectclearwater.org@lists.projectclearwater.org>
	<CAGEe17ZLnypQfbzxEwxj9EaB20MUBVpY+YdN-Obv=gHpZmG0KA@mail.gmail.com>
	<CY1PR0201MB1563F9A706F3EC7BE7F9C11590120@CY1PR0201MB1563.namprd02.prod.outlook.com>
	<CAGEe17bfTu1Kpwx=ipqtEbShvWtP+C6pJEEGHi0GSwBR5Dqw8w@mail.gmail.com>
	<CAGEe17aY077tLtotRe1X8k1qU_4otBdHDMJjqDH_g02Zs676Jg@mail.gmail.com>
	<CAGEe17ZeNPPy7AmMz=LCWnHqLm=v9Q7CuLT+AOVKWJTdg8m7Eg@mail.gmail.com>
	<CY1PR0201MB1563CE17983225B985B19D7390130@CY1PR0201MB1563.namprd02.prod.outlook.com>
	<CAGEe17b2M2uqvbOuqH7t4xM41FbfBYk0xR3zWqiFh+EkSfUzUQ@mail.gmail.com>
	<CY1PR0201MB1563CD5DDDD6E7B5A0B2DB7290140@CY1PR0201MB1563.namprd02.prod.outlook.com>
	<CAGEe17YGnaY1Kqc65gyiVO1sBBuTx=-YzfD9HY3M6QBD2t9AkA@mail.gmail.com>
Message-ID: <CY1PR0201MB156349F26A0A7670BE7382A890140@CY1PR0201MB1563.namprd02.prod.outlook.com>

Kosala,

Yes, that's the correct screen, and you're correct that it shows that stress is being attempted but failing.

Do regular (non-stress) calls work through this deployment?

You can look at what message the stress node is receiving in the log files in the /var/log/clearwater-sip-stress/ directory - I think there are "errors" logs that contain the unexpected messages.

You can obviously also look at what's happening on the all-in-one node itself, using the /var/log/bono/*, /var/log/sprout/* and /var/log/homestead/* files, as described at http://clearwater.readthedocs.io/en/latest/Troubleshooting_and_Recovery.html.

I hope that helps.

Cheers,

Matt

From: Kosala [mailto:kosalayb at gmail.com]
Sent: 17 August 2016 14:20
To: Matt Williams (projectclearwater.org) <matt at projectclearwater.org>
Subject: Re: [Project Clearwater] Clearwater Digest, Vol 40, Issue 24

Hi Matt,
I can see this scenario screen from sip-stress.1.out. I hope this will be the stress test output results.

------------------------------ Scenario Screen -------- [1-9]: Change Screen --
     Users (length)   Port   Total-time  Total-calls  Remote-host
        2500 (0 ms)   5060      77.15 s         2500  10.0.21.192:5060(TCP)

  Call limit reached (-m 2500), 1.002 s period  1 ms scheduler resolution
  2175 calls (limit 2500)                Peak was 2499 calls, after 0 s
  0 Running, 2177 Paused, 8 Woken up
  0 dead call msg (discarded)            0 out-of-call msg (discarded)
  3 open sockets

                                 Messages  Retrans   Timeout   Unexpected-Msg
       Pause [0ms/10:00]         2500                          0
    REGISTER ---------->         326       0
         401 <----------         0         0         0         325
    REGISTER ---------->         0         0
         200 <----------         0         0         0         0
    REGISTER ---------->         0         0
         401 <----------         0         0         0         0
    REGISTER ---------->         0         0
         200 <----------         0         0         0         0
       Pause [     4:50]         0                             0
    REGISTER ---------->  B-RTD1 0         0
         200 <----------  E-RTD1 0         0         0         0
    REGISTER ---------->  B-RTD1 0         0
         200 <----------  E-RTD1 0         0         0         0
       Pause [     4:50]         0                             0
       Pause [$pre_call_delay]   0                             0
      INVITE ---------->  B-RTD2 0         0
         100 <----------         0         0         0         0
      INVITE <----------         0         0         0         0
         100 <----------         0         0         0         0
      INVITE <----------         0         0         0         0
         100 ---------->         0         0
         180 ---------->         0         0
         180 <----------         0         0         0         0
       Pause [   6000ms]         0                             0
         200 ---------->         0         0
         200 <----------         0         0         0         0
         ACK ---------->         0         0
         ACK <----------         0         0         0         0
      UPDATE ---------->         0         0
      UPDATE <----------         0         0         0         0
         200 ---------->         0         0
         200 <----------  E-RTD2 0         0         0         0
       Pause [    24.0s]         0                             0
         BYE ---------->  B-RTD3 0         0
         BYE <----------         0         0         0         0
         200 ---------->         0         0
         200 <----------  E-RTD3 0         0         0         0
       Pause [$post_call_delay]  0                             0
------- Waiting for active calls to end. Press [q] again to force exit. -------
Last Error: Aborting call on unexpected message for Call-Id '1079-13729 at ...

However there is an unexpected message error at the end.
Thanks
Kosala


On Wed, Aug 17, 2016 at 12:40 PM, Matt Williams (projectclearwater.org<http://projectclearwater.org>) <matt at projectclearwater.org<mailto:matt at projectclearwater.org>> wrote:
Kosala,

They should log to /var/log/clearwater-sip-stress - in particular, the *.1.out file is a log of the output from sipp.  Do you see anything there?

Matt

From: Kosala [mailto:kosalayb at gmail.com<mailto:kosalayb at gmail.com>]
Sent: 17 August 2016 12:33
To: Matt Williams (projectclearwater.org<http://projectclearwater.org>) <matt at projectclearwater.org<mailto:matt at projectclearwater.org>>; clearwater at lists.projectclearwater.org<mailto:clearwater at lists.projectclearwater.org>

Subject: Re: [Project Clearwater] Clearwater Digest, Vol 40, Issue 24

Hi Matt,
I followed above steps and run sudo apt-get install clearwater-sip-stress.
How do I know stress tests are running? Is is said, stress tests start automatically but I cannot see it.
Thanks
Kosala



On Tue, Aug 16, 2016 at 2:01 PM, Matt Williams (projectclearwater.org<http://projectclearwater.org>) <matt at projectclearwater.org<mailto:matt at projectclearwater.org>> wrote:
Kosala,

I'm glad you've made progress on this.

I had a look at the crest package version, but it seems to be later than the most recent all-in-one image uses (1.0-160811.103635).  When did you download the all-in-one image, and did you apply any patches to it?

Regarding making calls for stress testing, this is where http://clearwater.readthedocs.io/en/latest/Clearwater_stress_testing.html#manual-i-e-non-chef-stress-runs comes in - you need to

?         create a separate VM

?         set the bono_hostname and count parameters in /etc/clearwater/shared_config

?         install the clearwater-sip-stress package.
I hope that helps.

BTW, please remember to copy in clearwater at lists.projectclearwater.org<mailto:clearwater at lists.projectclearwater.org> - that means that other people can see and comment on your posts.

Thanks,

Matt


From: Kosala [mailto:kosalayb at gmail.com<mailto:kosalayb at gmail.com>]
Sent: 16 August 2016 10:48
To: Matt Williams (projectclearwater.org<http://projectclearwater.org>) <matt at projectclearwater.org<mailto:matt at projectclearwater.org>>
Subject: Re: [Project Clearwater] Clearwater Digest, Vol 40, Issue 24

Hi Matt,
Bulk provisioning for all in one image is done using https://github.com/Metaswitch/crest/blob/dev/docs/Bulk-Provisioning%20Numbers.md.
I have records in tables in homestead_cache and homer.
Now How to make calls for stress testing?
Is there any guideline?
Many Thanks,
Kosala




On Tue, Aug 16, 2016 at 9:04 AM, Kosala <kosalayb at gmail.com<mailto:kosalayb at gmail.com>> wrote:
Hi Matt,
TBH, The document in https://github.com/Metaswitch/crest/blob/dev/docs/Bulk-Provisioning%20Numbers.md is not clear to me.
Step 1. Homestead node in deployment. I do not know where is that node in all in one image. It will be helpful the location of that folder from the root.
Step 2. A simple example will be helpful.
Thanks
Kosala


On Tue, Aug 16, 2016 at 8:50 AM, Kosala <kosalayb at gmail.com<mailto:kosalayb at gmail.com>> wrote:
Hi Matt,
I downloaded the all in one package from http://clearwater.readthedocs.io/en/stable/All_in_one_OVF_Installation.html
and imported using oracle virtual box on ubuntu 14.04,
Crest version
[cw-aio]ubuntu at cwaio:~$ sudo dpkg-query -s crest
Package: crest
Status: install ok installed
Priority: optional
Section: network
Installed-Size: 40098
Maintainer: Project Clearwater Maintainers <maintainers at projectclearwater.org<mailto:maintainers at projectclearwater.org>>
Architecture: amd64
Version: 1.0-160815.145007
Thanks
Kosala


On Mon, Aug 15, 2016 at 5:56 PM, Matt Williams (projectclearwater.org<http://projectclearwater.org>) <matt at projectclearwater.org<mailto:matt at projectclearwater.org>> wrote:
Kosala,

That's odd - I don't see that failure on my all-in-one image (spun up just now from the latest image) - which version of all-in-one-image are you running, and which version of crest does it include ("sudo dpkg-query -s crest")?

You may be able to work-around this either by taking the latest all-in-one image or by following the simpler bulk-provisioning process at https://github.com/Metaswitch/crest/blob/dev/docs/Bulk-Provisioning%20Numbers.md (when this doc talks about using the sstables_provisioning process for very large sets of numbers, we mean 1M+ numbers - the 9000 you're provisioning are well within the capabilities of this process).

I hope that helps - please let me know how you get on.

Cheers,

Matt


From: Clearwater [mailto:clearwater-bounces at lists.projectclearwater.org<mailto:clearwater-bounces at lists.projectclearwater.org>] On Behalf Of Kosala
Sent: 15 August 2016 16:58
To: clearwater at lists.projectclearwater.org<mailto:clearwater at lists.projectclearwater.org>
Subject: Re: [Project Clearwater] Clearwater Digest, Vol 40, Issue 24

HI Matt,
Thanks.

I am trying to follow https://github.com/Metaswitch/crest/blob/dev/src/metaswitch/crest/tools/sstable_provisioning/README.md for bulk provisioning.

When I am trying to execute sudo ./BulkProvision homer 21000 29999 example.com<http://example.com> 7kkzTyGW in all-in-one image,
I am getting an error  java.lang.UnsupportedClassVersionError: ClearwaterBulkProvisioner : Unsupported major.minor version 52.0
Java version info in all-in-one image:
[cw-aio]ubuntu at cwaio:/usr/share/clearwater/crest/tools/sstable_provisioning$ java -version
java version "1.7.0_101"
OpenJDK Runtime Environment (IcedTea 2.6.6) (7u101-2.6.6-0ubuntu0.14.04.1)
OpenJDK 64-Bit Server VM (build 24.95-b01, mixed mode)
Thanks
Kosala



On Mon, Aug 15, 2016 at 2:17 PM, <clearwater-request at lists.projectclearwater.org<mailto:clearwater-request at lists.projectclearwater.org>> wrote:
Send Clearwater mailing list submissions to
        clearwater at lists.projectclearwater.org<mailto:clearwater at lists.projectclearwater.org>

To subscribe or unsubscribe via the World Wide Web, visit
        http://lists.projectclearwater.org/mailman/listinfo/clearwater_lists.projectclearwater.org

or, via email, send a message with subject or body 'help' to
        clearwater-request at lists.projectclearwater.org<mailto:clearwater-request at lists.projectclearwater.org>

You can reach the person managing the list at
        clearwater-owner at lists.projectclearwater.org<mailto:clearwater-owner at lists.projectclearwater.org>

When replying, please edit your Subject line so it is more specific
than "Re: Contents of Clearwater digest..."


Today's Topics:

   1. Stress Testing (Kosala)
   2. Re: Stress Testing (Matt Williams (projectclearwater.org<http://projectclearwater.org>))
   3. Re: Stress Testing (Matt Williams (projectclearwater.org<http://projectclearwater.org>))


----------------------------------------------------------------------

Message: 1
Date: Mon, 15 Aug 2016 10:38:57 +0100
From: Kosala <kosalayb at gmail.com<mailto:kosalayb at gmail.com>>
To: clearwater at lists.projectclearwater.org<mailto:clearwater at lists.projectclearwater.org>
Subject: [Project Clearwater] Stress Testing
Message-ID:
        <CAGEe17an2B_bGj8NfKFwms+nU=vJURyhT5CE+mcY1pjcm4YF+A at mail.gmail.com<mailto:vJURyhT5CE%2BmcY1pjcm4YF%2BA at mail.gmail.com>>
Content-Type: text/plain; charset="utf-8"

Hi Team,

I installed clearwater "all-in-one" image on Oracle Virtual Box.
1. Can I do stress testing ?
2. How to do that?

I am trying to follow Stress Testing on
http://clearwater.readthedocs.io/en/stable/Clearwater_stress_testing.html#configuring-udp-stress
.

Using chef - > It seems chef/knife install only supports in the Cloud
approach (The automated install is only supported for deployments running
in Amazon?s EC2 cloud).

Manual approach, It looks not supporting all in one image.

Many Thanks
Kosala
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.projectclearwater.org/pipermail/clearwater_lists.projectclearwater.org/attachments/20160815/15fc3b07/attachment-0001.html>

------------------------------

Message: 2
Date: Mon, 15 Aug 2016 09:54:02 +0000
From: "Matt Williams (projectclearwater.org<http://projectclearwater.org>)"
        <matt at projectclearwater.org<mailto:matt at projectclearwater.org>>
To: Kosala <kosalayb at gmail.com<mailto:kosalayb at gmail.com>>
Cc: "clearwater at lists.projectclearwater.org<mailto:clearwater at lists.projectclearwater.org>"
        <clearwater at lists.projectclearwater.org<mailto:clearwater at lists.projectclearwater.org>>
Subject: Re: [Project Clearwater] Stress Testing
Message-ID:
        <CY1PR0201MB15636F1F20EB91BB180F053390120 at CY1PR0201MB1563.namprd02.prod.outlook.com<mailto:CY1PR0201MB15636F1F20EB91BB180F053390120 at CY1PR0201MB1563.namprd02.prod.outlook.com>>

Content-Type: text/plain; charset="utf-8"

Kosala,

While it's theoretically possible to do stress testing against an all-in-one image, I'd recommend against it - the all-in-one image has been squeezed down a lot to fit on a single VM and we'd expect very low performance out of it, and I could believe that overload behavior might be suboptimal.  If you're looking to stress test for performance reasons, I'd strongly recommend running a full deployment as this will give you much more reliable numbers.  If you're looking to stress test for other reasons, please can you share a bit more about what you're trying to achieve, and we can have a think about what would work best?

If you do really want to run stress testing against an all-in-one image, it should probably work, even though http://clearwater.readthedocs.io/en/latest/Clearwater_stress_testing.html#manual-i-e-non-chef-stress-runs only talks about Chef and manual installs.  You'd need to set the "bono_servers" option in /etc/clearwater/shared_config to point to your all-in-one node, and I suspect you'd need to reduce the "count" option to something a lot lower - I'd start around 5000 and see how that goes.

I hope that helps.  Please let me know how you get on.

Thanks,

Matt

From: Clearwater [mailto:clearwater-bounces at lists.projectclearwater.org<mailto:clearwater-bounces at lists.projectclearwater.org>] On Behalf Of Kosala
Sent: 15 August 2016 10:39
To: clearwater at lists.projectclearwater.org<mailto:clearwater at lists.projectclearwater.org>
Subject: [Project Clearwater] Stress Testing

Hi Team,
I installed clearwater "all-in-one" image on Oracle Virtual Box.
1. Can I do stress testing ?
2. How to do that?
I am trying to follow Stress Testing on http://clearwater.readthedocs.io/en/stable/Clearwater_stress_testing.html#configuring-udp-stress.
Using chef - > It seems chef/knife install only supports in the Cloud approach (The automated install is only supported for deployments running in Amazon?s EC2 cloud).
Manual approach, It looks not supporting all in one image.
Many Thanks
Kosala

-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.projectclearwater.org/pipermail/clearwater_lists.projectclearwater.org/attachments/20160815/29d6328d/attachment-0001.html>

------------------------------

Message: 3
Date: Mon, 15 Aug 2016 13:16:47 +0000
From: "Matt Williams (projectclearwater.org<http://projectclearwater.org>)"
        <matt at projectclearwater.org<mailto:matt at projectclearwater.org>>
To: "clearwater at lists.projectclearwater.org<mailto:clearwater at lists.projectclearwater.org>"
        <clearwater at lists.projectclearwater.org<mailto:clearwater at lists.projectclearwater.org>>
Subject: Re: [Project Clearwater] Stress Testing
Message-ID:
        <CY1PR0201MB156372246DC5A77B11839F9D90120 at CY1PR0201MB1563.namprd02.prod.outlook.com<mailto:CY1PR0201MB156372246DC5A77B11839F9D90120 at CY1PR0201MB1563.namprd02.prod.outlook.com>>

Content-Type: text/plain; charset="utf-8"

Kosala,

You'll need to follow all the steps in http://clearwater.readthedocs.io/en/latest/Clearwater_stress_testing.html#manual-i-e-non-chef-stress-runs, i.e. bulk provisioning subscribers and installing clearwater-sip-stress, but that should be it.

Just to be clear, though, you'll need to set the configuration and install the clearwater-sip-stress package on a separate VM, not on the all-in-one image itself - the all-in-one image almost certainly opens up ports that conflict with those that clearwater-sip-stress tries to use.

This isn't a very well-trodden path, though, so you may hit further issues - let me know if so, and we can try to work through them.

Cheers,

Matt

From: Kosala [mailto:kosalayb at gmail.com<mailto:kosalayb at gmail.com>]
Sent: 15 August 2016 13:41
To: Matt Williams (projectclearwater.org<http://projectclearwater.org>) <matt at projectclearwater.org<mailto:matt at projectclearwater.org>>
Subject: Re: [Project Clearwater] Stress Testing

Hi Matt,
Thanks. I set the bono_servers option. Should I add count =5000 to /etc/clearwater/shared_config ?

Do I need other changes to run stress tests on all-in-one image?
Thanks
Kosala



On Mon, Aug 15, 2016 at 10:54 AM, Matt Williams (projectclearwater.org<http://projectclearwater.org><http://projectclearwater.org>) <matt at projectclearwater.org<mailto:matt at projectclearwater.org><mailto:matt at projectclearwater.org<mailto:matt at projectclearwater.org>>> wrote:
Kosala,

While it's theoretically possible to do stress testing against an all-in-one image, I'd recommend against it - the all-in-one image has been squeezed down a lot to fit on a single VM and we'd expect very low performance out of it, and I could believe that overload behavior might be suboptimal.  If you're looking to stress test for performance reasons, I'd strongly recommend running a full deployment as this will give you much more reliable numbers.  If you're looking to stress test for other reasons, please can you share a bit more about what you're trying to achieve, and we can have a think about what would work best?

If you do really want to run stress testing against an all-in-one image, it should probably work, even though http://clearwater.readthedocs.io/en/latest/Clearwater_stress_testing.html#manual-i-e-non-chef-stress-runs only talks about Chef and manual installs.  You'd need to set the "bono_servers" option in /etc/clearwater/shared_config to point to your all-in-one node, and I suspect you'd need to reduce the "count" option to something a lot lower - I'd start around 5000 and see how that goes.

I hope that helps.  Please let me know how you get on.

Thanks,

Matt

From: Clearwater [mailto:clearwater-bounces at lists.projectclearwater.org<mailto:clearwater-bounces at lists.projectclearwater.org><mailto:clearwater-bounces at lists.projectclearwater.org<mailto:clearwater-bounces at lists.projectclearwater.org>>] On Behalf Of Kosala
Sent: 15 August 2016 10:39
To: clearwater at lists.projectclearwater.org<mailto:clearwater at lists.projectclearwater.org><mailto:clearwater at lists.projectclearwater.org<mailto:clearwater at lists.projectclearwater.org>>
Subject: [Project Clearwater] Stress Testing

Hi Team,
I installed clearwater "all-in-one" image on Oracle Virtual Box.
1. Can I do stress testing ?
2. How to do that?
I am trying to follow Stress Testing on http://clearwater.readthedocs.io/en/stable/Clearwater_stress_testing.html#configuring-udp-stress.
Using chef - > It seems chef/knife install only supports in the Cloud approach (The automated install is only supported for deployments running in Amazon?s EC2 cloud).
Manual approach, It looks not supporting all in one image.
Many Thanks
Kosala


-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.projectclearwater.org/pipermail/clearwater_lists.projectclearwater.org/attachments/20160815/11781755/attachment.html>

------------------------------

Subject: Digest Footer

_______________________________________________
Clearwater mailing list
Clearwater at lists.projectclearwater.org<mailto:Clearwater at lists.projectclearwater.org>
http://lists.projectclearwater.org/mailman/listinfo/clearwater_lists.projectclearwater.org


------------------------------

End of Clearwater Digest, Vol 40, Issue 24
******************************************






-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.projectclearwater.org/pipermail/clearwater_lists.projectclearwater.org/attachments/20160817/73f40299/attachment.html>

From matt at projectclearwater.org  Wed Aug 17 09:40:25 2016
From: matt at projectclearwater.org (Matt Williams (projectclearwater.org))
Date: Wed, 17 Aug 2016 13:40:25 +0000
Subject: [Project Clearwater] Clearwater Digest, Vol 40, Issue 24
In-Reply-To: <CAGEe17aRR+Uj8t+vRWss4pK-mcQALBr2m=wLNc6KHsdXV-CXbA@mail.gmail.com>
References: <mailman.20.1471267072.11502.clearwater_lists.projectclearwater.org@lists.projectclearwater.org>
	<CAGEe17ZLnypQfbzxEwxj9EaB20MUBVpY+YdN-Obv=gHpZmG0KA@mail.gmail.com>
	<CY1PR0201MB1563F9A706F3EC7BE7F9C11590120@CY1PR0201MB1563.namprd02.prod.outlook.com>
	<CAGEe17bfTu1Kpwx=ipqtEbShvWtP+C6pJEEGHi0GSwBR5Dqw8w@mail.gmail.com>
	<CAGEe17aY077tLtotRe1X8k1qU_4otBdHDMJjqDH_g02Zs676Jg@mail.gmail.com>
	<CAGEe17ZeNPPy7AmMz=LCWnHqLm=v9Q7CuLT+AOVKWJTdg8m7Eg@mail.gmail.com>
	<CY1PR0201MB1563CE17983225B985B19D7390130@CY1PR0201MB1563.namprd02.prod.outlook.com>
	<CAGEe17b2M2uqvbOuqH7t4xM41FbfBYk0xR3zWqiFh+EkSfUzUQ@mail.gmail.com>
	<CY1PR0201MB1563CD5DDDD6E7B5A0B2DB7290140@CY1PR0201MB1563.namprd02.prod.outlook.com>
	<CAGEe17YGnaY1Kqc65gyiVO1sBBuTx=-YzfD9HY3M6QBD2t9AkA@mail.gmail.com>
	<CAGEe17aRR+Uj8t+vRWss4pK-mcQALBr2m=wLNc6KHsdXV-CXbA@mail.gmail.com>
Message-ID: <CY1PR0201MB15639E8995C94D18E7B85EE590140@CY1PR0201MB1563.namprd02.prod.outlook.com>

Kosala,

OK, so this says that the subscriber you're trying to register as can't be found.

The stress nodes will by default use DNs from 201000000 onwards.  What numbers did you provision?

The docs (https://github.com/Metaswitch/crest/blob/dev/docs/Bulk-Provisioning%20Numbers.md) recommend provisioning 2010000000-2010099999.  However, I recall you trying to run "sudo ./BulkProvision homer 21000 29999 example.com 7kkzTyGW", which would only provision the numbers 21000-29999.  Maybe there's a mismatch here?

Matt

--

Matt Williams
Lead Architect, Project Clearwater
+44 (0) 20 8366 1177

From: Kosala [mailto:kosalayb at gmail.com]
Sent: 17 August 2016 14:34
To: Matt Williams (projectclearwater.org) <matt at projectclearwater.org>
Subject: Re: [Project Clearwater] Clearwater Digest, Vol 40, Issue 24

I am getting followings in sip-stress_18438_errors.log:

2016-08-17      12:26:26:258    1471436786.258684: Aborting call on unexpected message for Call-Id '898-18438 at 10.0.22.193<mailto:898-18438 at 10.0.22.193>': while expecting '401' (index 3), received 'SIP/2.0 404 Not Found^M
Via: SIP/2.0/TCP 10.0.22.193:5060;rport=8826;received=10.0.22.193;branch=z9hG4bK-18438-898-2-2010003204-^M
Record-Route: <sip:scscf.cwaio:5054;transport=TCP;lr;service=scscf;billing-role=charge-orig>^M
Call-ID: 2010003204///898-18438 at 10.0.22.193<mailto:898-18438 at 10.0.22.193>^M
From: <sip:2010003204 at example.com<mailto:sip%3A2010003204 at example.com>>;tag=18438SIPpTag00898^M
To: <sip:2010003204 at example.com<mailto:sip%3A2010003204 at example.com>>;tag=z9hG4bKPjc1xOWCH0ooae6O9npl7fSSrQ-x0vmoV9^M
CSeq: 1 REGISTER^M
Content-Length:  0^M
Any advice is appreciated.
Many Thanks,
Kosala


On Wed, Aug 17, 2016 at 2:20 PM, Kosala <kosalayb at gmail.com<mailto:kosalayb at gmail.com>> wrote:
Hi Matt,
I can see this scenario screen from sip-stress.1.out. I hope this will be the stress test output results.

------------------------------ Scenario Screen -------- [1-9]: Change Screen --
     Users (length)   Port   Total-time  Total-calls  Remote-host
        2500 (0 ms)   5060      77.15 s         2500  10.0.21.192:5060(TCP)

  Call limit reached (-m 2500), 1.002 s period  1 ms scheduler resolution
  2175 calls (limit 2500)                Peak was 2499 calls, after 0 s
  0 Running, 2177 Paused, 8 Woken up
  0 dead call msg (discarded)            0 out-of-call msg (discarded)
  3 open sockets

                                 Messages  Retrans   Timeout   Unexpected-Msg
       Pause [0ms/10:00]         2500                          0
    REGISTER ---------->         326       0
         401 <----------         0         0         0         325
    REGISTER ---------->         0         0
         200 <----------         0         0         0         0
    REGISTER ---------->         0         0
         401 <----------         0         0         0         0
    REGISTER ---------->         0         0
         200 <----------         0         0         0         0
       Pause [     4:50]         0                             0
    REGISTER ---------->  B-RTD1 0         0
         200 <----------  E-RTD1 0         0         0         0
    REGISTER ---------->  B-RTD1 0         0
         200 <----------  E-RTD1 0         0         0         0
       Pause [     4:50]         0                             0
       Pause [$pre_call_delay]   0                             0
      INVITE ---------->  B-RTD2 0         0
         100 <----------         0         0         0         0
      INVITE <----------         0         0         0         0
         100 <----------         0         0         0         0
      INVITE <----------         0         0         0         0
         100 ---------->         0         0
         180 ---------->         0         0
         180 <----------         0         0         0         0
       Pause [   6000ms]         0                             0
         200 ---------->         0         0
         200 <----------         0         0         0         0
         ACK ---------->         0         0
         ACK <----------         0         0         0         0
      UPDATE ---------->         0         0
      UPDATE <----------         0         0         0         0
         200 ---------->         0         0
         200 <----------  E-RTD2 0         0         0         0
       Pause [    24.0s]         0                             0
         BYE ---------->  B-RTD3 0         0
         BYE <----------         0         0         0         0
         200 ---------->         0         0
         200 <----------  E-RTD3 0         0         0         0
       Pause [$post_call_delay]  0                             0
------- Waiting for active calls to end. Press [q] again to force exit. -------
Last Error: Aborting call on unexpected message for Call-Id '1079-13729 at ...

However there is an unexpected message error at the end.
Thanks
Kosala


On Wed, Aug 17, 2016 at 12:40 PM, Matt Williams (projectclearwater.org<http://projectclearwater.org>) <matt at projectclearwater.org<mailto:matt at projectclearwater.org>> wrote:
Kosala,

They should log to /var/log/clearwater-sip-stress - in particular, the *.1.out file is a log of the output from sipp.  Do you see anything there?

Matt

From: Kosala [mailto:kosalayb at gmail.com<mailto:kosalayb at gmail.com>]
Sent: 17 August 2016 12:33
To: Matt Williams (projectclearwater.org<http://projectclearwater.org>) <matt at projectclearwater.org<mailto:matt at projectclearwater.org>>; clearwater at lists.projectclearwater.org<mailto:clearwater at lists.projectclearwater.org>

Subject: Re: [Project Clearwater] Clearwater Digest, Vol 40, Issue 24

Hi Matt,
I followed above steps and run sudo apt-get install clearwater-sip-stress.
How do I know stress tests are running? Is is said, stress tests start automatically but I cannot see it.
Thanks
Kosala



On Tue, Aug 16, 2016 at 2:01 PM, Matt Williams (projectclearwater.org<http://projectclearwater.org>) <matt at projectclearwater.org<mailto:matt at projectclearwater.org>> wrote:
Kosala,

I'm glad you've made progress on this.

I had a look at the crest package version, but it seems to be later than the most recent all-in-one image uses (1.0-160811.103635).  When did you download the all-in-one image, and did you apply any patches to it?

Regarding making calls for stress testing, this is where http://clearwater.readthedocs.io/en/latest/Clearwater_stress_testing.html#manual-i-e-non-chef-stress-runs comes in - you need to

?         create a separate VM

?         set the bono_hostname and count parameters in /etc/clearwater/shared_config

?         install the clearwater-sip-stress package.
I hope that helps.

BTW, please remember to copy in clearwater at lists.projectclearwater.org<mailto:clearwater at lists.projectclearwater.org> - that means that other people can see and comment on your posts.

Thanks,

Matt


From: Kosala [mailto:kosalayb at gmail.com<mailto:kosalayb at gmail.com>]
Sent: 16 August 2016 10:48
To: Matt Williams (projectclearwater.org<http://projectclearwater.org>) <matt at projectclearwater.org<mailto:matt at projectclearwater.org>>
Subject: Re: [Project Clearwater] Clearwater Digest, Vol 40, Issue 24

Hi Matt,
Bulk provisioning for all in one image is done using https://github.com/Metaswitch/crest/blob/dev/docs/Bulk-Provisioning%20Numbers.md.
I have records in tables in homestead_cache and homer.
Now How to make calls for stress testing?
Is there any guideline?
Many Thanks,
Kosala




On Tue, Aug 16, 2016 at 9:04 AM, Kosala <kosalayb at gmail.com<mailto:kosalayb at gmail.com>> wrote:
Hi Matt,
TBH, The document in https://github.com/Metaswitch/crest/blob/dev/docs/Bulk-Provisioning%20Numbers.md is not clear to me.
Step 1. Homestead node in deployment. I do not know where is that node in all in one image. It will be helpful the location of that folder from the root.
Step 2. A simple example will be helpful.
Thanks
Kosala


On Tue, Aug 16, 2016 at 8:50 AM, Kosala <kosalayb at gmail.com<mailto:kosalayb at gmail.com>> wrote:
Hi Matt,
I downloaded the all in one package from http://clearwater.readthedocs.io/en/stable/All_in_one_OVF_Installation.html
and imported using oracle virtual box on ubuntu 14.04,
Crest version
[cw-aio]ubuntu at cwaio:~$ sudo dpkg-query -s crest
Package: crest
Status: install ok installed
Priority: optional
Section: network
Installed-Size: 40098
Maintainer: Project Clearwater Maintainers <maintainers at projectclearwater.org<mailto:maintainers at projectclearwater.org>>
Architecture: amd64
Version: 1.0-160815.145007
Thanks
Kosala


On Mon, Aug 15, 2016 at 5:56 PM, Matt Williams (projectclearwater.org<http://projectclearwater.org>) <matt at projectclearwater.org<mailto:matt at projectclearwater.org>> wrote:
Kosala,

That's odd - I don't see that failure on my all-in-one image (spun up just now from the latest image) - which version of all-in-one-image are you running, and which version of crest does it include ("sudo dpkg-query -s crest")?

You may be able to work-around this either by taking the latest all-in-one image or by following the simpler bulk-provisioning process at https://github.com/Metaswitch/crest/blob/dev/docs/Bulk-Provisioning%20Numbers.md (when this doc talks about using the sstables_provisioning process for very large sets of numbers, we mean 1M+ numbers - the 9000 you're provisioning are well within the capabilities of this process).

I hope that helps - please let me know how you get on.

Cheers,

Matt


From: Clearwater [mailto:clearwater-bounces at lists.projectclearwater.org<mailto:clearwater-bounces at lists.projectclearwater.org>] On Behalf Of Kosala
Sent: 15 August 2016 16:58
To: clearwater at lists.projectclearwater.org<mailto:clearwater at lists.projectclearwater.org>
Subject: Re: [Project Clearwater] Clearwater Digest, Vol 40, Issue 24

HI Matt,
Thanks.

I am trying to follow https://github.com/Metaswitch/crest/blob/dev/src/metaswitch/crest/tools/sstable_provisioning/README.md for bulk provisioning.

When I am trying to execute sudo ./BulkProvision homer 21000 29999 example.com<http://example.com> 7kkzTyGW in all-in-one image,
I am getting an error  java.lang.UnsupportedClassVersionError: ClearwaterBulkProvisioner : Unsupported major.minor version 52.0
Java version info in all-in-one image:
[cw-aio]ubuntu at cwaio:/usr/share/clearwater/crest/tools/sstable_provisioning$ java -version
java version "1.7.0_101"
OpenJDK Runtime Environment (IcedTea 2.6.6) (7u101-2.6.6-0ubuntu0.14.04.1)
OpenJDK 64-Bit Server VM (build 24.95-b01, mixed mode)
Thanks
Kosala



On Mon, Aug 15, 2016 at 2:17 PM, <clearwater-request at lists.projectclearwater.org<mailto:clearwater-request at lists.projectclearwater.org>> wrote:
Send Clearwater mailing list submissions to
        clearwater at lists.projectclearwater.org<mailto:clearwater at lists.projectclearwater.org>

To subscribe or unsubscribe via the World Wide Web, visit
        http://lists.projectclearwater.org/mailman/listinfo/clearwater_lists.projectclearwater.org

or, via email, send a message with subject or body 'help' to
        clearwater-request at lists.projectclearwater.org<mailto:clearwater-request at lists.projectclearwater.org>

You can reach the person managing the list at
        clearwater-owner at lists.projectclearwater.org<mailto:clearwater-owner at lists.projectclearwater.org>

When replying, please edit your Subject line so it is more specific
than "Re: Contents of Clearwater digest..."


Today's Topics:

   1. Stress Testing (Kosala)
   2. Re: Stress Testing (Matt Williams (projectclearwater.org<http://projectclearwater.org>))
   3. Re: Stress Testing (Matt Williams (projectclearwater.org<http://projectclearwater.org>))


----------------------------------------------------------------------

Message: 1
Date: Mon, 15 Aug 2016 10:38:57 +0100
From: Kosala <kosalayb at gmail.com<mailto:kosalayb at gmail.com>>
To: clearwater at lists.projectclearwater.org<mailto:clearwater at lists.projectclearwater.org>
Subject: [Project Clearwater] Stress Testing
Message-ID:
        <CAGEe17an2B_bGj8NfKFwms+nU=vJURyhT5CE+mcY1pjcm4YF+A at mail.gmail.com<mailto:vJURyhT5CE%2BmcY1pjcm4YF%2BA at mail.gmail.com>>
Content-Type: text/plain; charset="utf-8"

Hi Team,

I installed clearwater "all-in-one" image on Oracle Virtual Box.
1. Can I do stress testing ?
2. How to do that?

I am trying to follow Stress Testing on
http://clearwater.readthedocs.io/en/stable/Clearwater_stress_testing.html#configuring-udp-stress
.

Using chef - > It seems chef/knife install only supports in the Cloud
approach (The automated install is only supported for deployments running
in Amazon?s EC2 cloud).

Manual approach, It looks not supporting all in one image.

Many Thanks
Kosala
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.projectclearwater.org/pipermail/clearwater_lists.projectclearwater.org/attachments/20160815/15fc3b07/attachment-0001.html>

------------------------------

Message: 2
Date: Mon, 15 Aug 2016 09:54:02 +0000
From: "Matt Williams (projectclearwater.org<http://projectclearwater.org>)"
        <matt at projectclearwater.org<mailto:matt at projectclearwater.org>>
To: Kosala <kosalayb at gmail.com<mailto:kosalayb at gmail.com>>
Cc: "clearwater at lists.projectclearwater.org<mailto:clearwater at lists.projectclearwater.org>"
        <clearwater at lists.projectclearwater.org<mailto:clearwater at lists.projectclearwater.org>>
Subject: Re: [Project Clearwater] Stress Testing
Message-ID:
        <CY1PR0201MB15636F1F20EB91BB180F053390120 at CY1PR0201MB1563.namprd02.prod.outlook.com<mailto:CY1PR0201MB15636F1F20EB91BB180F053390120 at CY1PR0201MB1563.namprd02.prod.outlook.com>>

Content-Type: text/plain; charset="utf-8"

Kosala,

While it's theoretically possible to do stress testing against an all-in-one image, I'd recommend against it - the all-in-one image has been squeezed down a lot to fit on a single VM and we'd expect very low performance out of it, and I could believe that overload behavior might be suboptimal.  If you're looking to stress test for performance reasons, I'd strongly recommend running a full deployment as this will give you much more reliable numbers.  If you're looking to stress test for other reasons, please can you share a bit more about what you're trying to achieve, and we can have a think about what would work best?

If you do really want to run stress testing against an all-in-one image, it should probably work, even though http://clearwater.readthedocs.io/en/latest/Clearwater_stress_testing.html#manual-i-e-non-chef-stress-runs only talks about Chef and manual installs.  You'd need to set the "bono_servers" option in /etc/clearwater/shared_config to point to your all-in-one node, and I suspect you'd need to reduce the "count" option to something a lot lower - I'd start around 5000 and see how that goes.

I hope that helps.  Please let me know how you get on.

Thanks,

Matt

From: Clearwater [mailto:clearwater-bounces at lists.projectclearwater.org<mailto:clearwater-bounces at lists.projectclearwater.org>] On Behalf Of Kosala
Sent: 15 August 2016 10:39
To: clearwater at lists.projectclearwater.org<mailto:clearwater at lists.projectclearwater.org>
Subject: [Project Clearwater] Stress Testing

Hi Team,
I installed clearwater "all-in-one" image on Oracle Virtual Box.
1. Can I do stress testing ?
2. How to do that?
I am trying to follow Stress Testing on http://clearwater.readthedocs.io/en/stable/Clearwater_stress_testing.html#configuring-udp-stress.
Using chef - > It seems chef/knife install only supports in the Cloud approach (The automated install is only supported for deployments running in Amazon?s EC2 cloud).
Manual approach, It looks not supporting all in one image.
Many Thanks
Kosala

-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.projectclearwater.org/pipermail/clearwater_lists.projectclearwater.org/attachments/20160815/29d6328d/attachment-0001.html>

------------------------------

Message: 3
Date: Mon, 15 Aug 2016 13:16:47 +0000
From: "Matt Williams (projectclearwater.org<http://projectclearwater.org>)"
        <matt at projectclearwater.org<mailto:matt at projectclearwater.org>>
To: "clearwater at lists.projectclearwater.org<mailto:clearwater at lists.projectclearwater.org>"
        <clearwater at lists.projectclearwater.org<mailto:clearwater at lists.projectclearwater.org>>
Subject: Re: [Project Clearwater] Stress Testing
Message-ID:
        <CY1PR0201MB156372246DC5A77B11839F9D90120 at CY1PR0201MB1563.namprd02.prod.outlook.com<mailto:CY1PR0201MB156372246DC5A77B11839F9D90120 at CY1PR0201MB1563.namprd02.prod.outlook.com>>

Content-Type: text/plain; charset="utf-8"

Kosala,

You'll need to follow all the steps in http://clearwater.readthedocs.io/en/latest/Clearwater_stress_testing.html#manual-i-e-non-chef-stress-runs, i.e. bulk provisioning subscribers and installing clearwater-sip-stress, but that should be it.

Just to be clear, though, you'll need to set the configuration and install the clearwater-sip-stress package on a separate VM, not on the all-in-one image itself - the all-in-one image almost certainly opens up ports that conflict with those that clearwater-sip-stress tries to use.

This isn't a very well-trodden path, though, so you may hit further issues - let me know if so, and we can try to work through them.

Cheers,

Matt

From: Kosala [mailto:kosalayb at gmail.com<mailto:kosalayb at gmail.com>]
Sent: 15 August 2016 13:41
To: Matt Williams (projectclearwater.org<http://projectclearwater.org>) <matt at projectclearwater.org<mailto:matt at projectclearwater.org>>
Subject: Re: [Project Clearwater] Stress Testing

Hi Matt,
Thanks. I set the bono_servers option. Should I add count =5000 to /etc/clearwater/shared_config ?

Do I need other changes to run stress tests on all-in-one image?
Thanks
Kosala



On Mon, Aug 15, 2016 at 10:54 AM, Matt Williams (projectclearwater.org<http://projectclearwater.org><http://projectclearwater.org>) <matt at projectclearwater.org<mailto:matt at projectclearwater.org><mailto:matt at projectclearwater.org<mailto:matt at projectclearwater.org>>> wrote:
Kosala,

While it's theoretically possible to do stress testing against an all-in-one image, I'd recommend against it - the all-in-one image has been squeezed down a lot to fit on a single VM and we'd expect very low performance out of it, and I could believe that overload behavior might be suboptimal.  If you're looking to stress test for performance reasons, I'd strongly recommend running a full deployment as this will give you much more reliable numbers.  If you're looking to stress test for other reasons, please can you share a bit more about what you're trying to achieve, and we can have a think about what would work best?

If you do really want to run stress testing against an all-in-one image, it should probably work, even though http://clearwater.readthedocs.io/en/latest/Clearwater_stress_testing.html#manual-i-e-non-chef-stress-runs only talks about Chef and manual installs.  You'd need to set the "bono_servers" option in /etc/clearwater/shared_config to point to your all-in-one node, and I suspect you'd need to reduce the "count" option to something a lot lower - I'd start around 5000 and see how that goes.

I hope that helps.  Please let me know how you get on.

Thanks,

Matt

From: Clearwater [mailto:clearwater-bounces at lists.projectclearwater.org<mailto:clearwater-bounces at lists.projectclearwater.org><mailto:clearwater-bounces at lists.projectclearwater.org<mailto:clearwater-bounces at lists.projectclearwater.org>>] On Behalf Of Kosala
Sent: 15 August 2016 10:39
To: clearwater at lists.projectclearwater.org<mailto:clearwater at lists.projectclearwater.org><mailto:clearwater at lists.projectclearwater.org<mailto:clearwater at lists.projectclearwater.org>>
Subject: [Project Clearwater] Stress Testing

Hi Team,
I installed clearwater "all-in-one" image on Oracle Virtual Box.
1. Can I do stress testing ?
2. How to do that?
I am trying to follow Stress Testing on http://clearwater.readthedocs.io/en/stable/Clearwater_stress_testing.html#configuring-udp-stress.
Using chef - > It seems chef/knife install only supports in the Cloud approach (The automated install is only supported for deployments running in Amazon?s EC2 cloud).
Manual approach, It looks not supporting all in one image.
Many Thanks
Kosala


-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.projectclearwater.org/pipermail/clearwater_lists.projectclearwater.org/attachments/20160815/11781755/attachment.html>

------------------------------

Subject: Digest Footer

_______________________________________________
Clearwater mailing list
Clearwater at lists.projectclearwater.org<mailto:Clearwater at lists.projectclearwater.org>
http://lists.projectclearwater.org/mailman/listinfo/clearwater_lists.projectclearwater.org


------------------------------

End of Clearwater Digest, Vol 40, Issue 24
******************************************







-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.projectclearwater.org/pipermail/clearwater_lists.projectclearwater.org/attachments/20160817/a79188ac/attachment.html>

From kosalayb at gmail.com  Wed Aug 17 10:54:48 2016
From: kosalayb at gmail.com (Kosala)
Date: Wed, 17 Aug 2016 15:54:48 +0100
Subject: [Project Clearwater] Clearwater Digest, Vol 40, Issue 24
In-Reply-To: <CY1PR0201MB15639E8995C94D18E7B85EE590140@CY1PR0201MB1563.namprd02.prod.outlook.com>
References: <mailman.20.1471267072.11502.clearwater_lists.projectclearwater.org@lists.projectclearwater.org>
	<CAGEe17ZLnypQfbzxEwxj9EaB20MUBVpY+YdN-Obv=gHpZmG0KA@mail.gmail.com>
	<CY1PR0201MB1563F9A706F3EC7BE7F9C11590120@CY1PR0201MB1563.namprd02.prod.outlook.com>
	<CAGEe17bfTu1Kpwx=ipqtEbShvWtP+C6pJEEGHi0GSwBR5Dqw8w@mail.gmail.com>
	<CAGEe17aY077tLtotRe1X8k1qU_4otBdHDMJjqDH_g02Zs676Jg@mail.gmail.com>
	<CAGEe17ZeNPPy7AmMz=LCWnHqLm=v9Q7CuLT+AOVKWJTdg8m7Eg@mail.gmail.com>
	<CY1PR0201MB1563CE17983225B985B19D7390130@CY1PR0201MB1563.namprd02.prod.outlook.com>
	<CAGEe17b2M2uqvbOuqH7t4xM41FbfBYk0xR3zWqiFh+EkSfUzUQ@mail.gmail.com>
	<CY1PR0201MB1563CD5DDDD6E7B5A0B2DB7290140@CY1PR0201MB1563.namprd02.prod.outlook.com>
	<CAGEe17YGnaY1Kqc65gyiVO1sBBuTx=-YzfD9HY3M6QBD2t9AkA@mail.gmail.com>
	<CAGEe17aRR+Uj8t+vRWss4pK-mcQALBr2m=wLNc6KHsdXV-CXbA@mail.gmail.com>
	<CY1PR0201MB15639E8995C94D18E7B85EE590140@CY1PR0201MB1563.namprd02.prod.outlook.com>
Message-ID: <CAGEe17bF5oKWGOV36aCb=4PxR69HLzgqNJYGioFxP=P6XJoqDw@mail.gmail.com>

Hi Matt,

 I changed the provisioning range as 2010000000-2010000999.
However, I am still getting this error " unexpected message for Call-Id .."


Last Error: Aborting call on unexpected message for Call-Id '2467-27374@
...^M
^[[2J------------------------------ Scenario Screen -------- [1-9]: Change
Screen --^M
     Users (length)   Port   Total-time  Total-calls  Remote-host^M
        2500 (0 ms)   5060     384.70 s         2500  10.0.21.192:5060
(TCP)^M
^M
  Call limit reached (-m 2500), 1.001 s period  1 ms scheduler resolution^M
  919 calls (limit 2500)                 Peak was 2500 calls, after 0 s^M
  0 Running, 921 Paused, 7 Woken up^M
  0 dead call msg (discarded)            0 out-of-call msg
(discarded)        ^M
  2 open sockets                        ^M
^M
                                 Messages  Retrans   Timeout
Unexpected-Msg^M
       Pause [0ms/10:00]         2500                          0        ^M
    REGISTER ---------->         1581      0                            ^M
         401 <----------         0         0         0         1581     ^M
    REGISTER ---------->         0         0                            ^M
         200 <----------         0         0         0         0        ^M
    REGISTER ---------->         0         0                            ^M
         401 <----------         0         0         0         0        ^M
    REGISTER ---------->         0         0                            ^M
         200 <----------         0         0         0         0        ^M
       Pause [     4:50]         0                             0        ^M
    REGISTER ---------->  B-RTD1 0         0                            ^M
         200 <----------  E-RTD1 0         0         0         0        ^M
    REGISTER ---------->  B-RTD1 0         0                            ^M
         200 <----------  E-RTD1 0         0         0         0        ^M
       Pause [     4:50]         0                             0        ^M
       Pause [$pre_call_delay]   0                             0        ^M
      INVITE ---------->  B-RTD2 0         0                            ^M
         100 <----------         0         0         0         0        ^M
      INVITE <----------         0         0         0         0        ^M
         100 <----------         0         0         0         0        ^M
      INVITE <----------         0         0         0         0        ^M
         100 ---------->         0         0                            ^M
         180 ---------->         0         0                            ^M
         180 <----------         0         0         0         0        ^M
       Pause [   6000ms]         0                             0        ^M
         200 ---------->         0         0                            ^M
         200 <----------         0         0         0         0        ^M
         ACK ---------->         0         0                            ^M
         ACK <----------         0         0         0         0        ^M
      UPDATE ---------->         0         0                            ^M
      UPDATE <----------         0         0         0         0        ^M
         200 ---------->         0         0                            ^M
         200 <----------  E-RTD2 0         0         0         0        ^M
       Pause [    24.0s]         0                             0        ^M
         BYE ---------->  B-RTD3 0         0                            ^M
         BYE <----------         0         0         0         0        ^M
         200 ---------->         0         0                            ^M
         200 <----------  E-RTD3 0         0         0         0        ^M
       Pause [$post_call_delay]  0                             0        ^M
------- Waiting for active calls to end. Press [q] again to force exit.
-------^M
^M
Last Error: Aborting call on unexpected message for Call-Id '2216-27374@
...^M

Any advice is appreciated.

Kosala



On Wed, Aug 17, 2016 at 2:40 PM, Matt Williams (projectclearwater.org) <
matt at projectclearwater.org> wrote:

> Kosala,
>
>
>
> OK, so this says that the subscriber you're trying to register as can't be
> found.
>
>
>
> The stress nodes will by default use DNs from 201000000 onwards.  What
> numbers did you provision?
>
>
>
> The docs (https://github.com/Metaswitch/crest/blob/dev/
> docs/Bulk-Provisioning%20Numbers.md) recommend provisioning
> 2010000000-2010099999.  However, I recall you trying to run "sudo
> ./BulkProvision homer 21000 29999 example.com 7kkzTyGW", which would only
> provision the numbers 21000-29999.  Maybe there's a mismatch here?
>
>
>
> Matt
>
>
>
> --
>
>
>
> Matt Williams
> Lead Architect, Project Clearwater
>
> +44 (0) 20 8366 1177
>
>
>
> *From:* Kosala [mailto:kosalayb at gmail.com]
> *Sent:* 17 August 2016 14:34
>
> *To:* Matt Williams (projectclearwater.org) <matt at projectclearwater.org>
> *Subject:* Re: [Project Clearwater] Clearwater Digest, Vol 40, Issue 24
>
>
>
> I am getting followings in sip-stress_18438_errors.log:
>
> 2016-08-17      12:26:26:258    1471436786.258684: Aborting call on
> unexpected message for Call-Id '898-18438 at 10.0.22.193': while expecting
> '401' (index 3), received 'SIP/2.0 404 Not Found^M
> Via: SIP/2.0/TCP 10.0.22.193:5060;rport=8826;received=10.0.22.193;branch=
> z9hG4bK-18438-898-2-2010003204-^M
> Record-Route: <sip:scscf.cwaio:5054;transport=TCP;lr;service=
> scscf;billing-role=charge-orig>^M
> Call-ID: 2010003204///898-18438 at 10.0.22.193^M
> From: <sip:2010003204 at example.com>;tag=18438SIPpTag00898^M
> To: <sip:2010003204 at example.com>;tag=z9hG4bKPjc1xOWCH0ooae6O9npl7fS
> SrQ-x0vmoV9^M
> CSeq: 1 REGISTER^M
> Content-Length:  0^M
>
> Any advice is appreciated.
>
> Many Thanks,
>
> Kosala
>
>
>
>
>
> On Wed, Aug 17, 2016 at 2:20 PM, Kosala <kosalayb at gmail.com> wrote:
>
> Hi Matt,
>
> I can see this scenario screen from sip-stress.1.out. I hope this will be
> the stress test output results.
>
>
> ------------------------------ Scenario Screen -------- [1-9]: Change
> Screen --
>      Users (length)   Port   Total-time  Total-calls  Remote-host
>         2500 (0 ms)   5060      77.15 s         2500  10.0.21.192:5060
> (TCP)
>
>   Call limit reached (-m 2500), 1.002 s period  1 ms scheduler resolution
>   2175 calls (limit 2500)                Peak was 2499 calls, after 0 s
>   0 Running, 2177 Paused, 8 Woken up
>   0 dead call msg (discarded)            0 out-of-call msg
> (discarded)
>   3 open sockets
>
>                                  Messages  Retrans   Timeout
> Unexpected-Msg
>        Pause [0ms/10:00]         2500                          0
>     REGISTER ---------->         326       0
>          401 <----------         0         0         0         325
>     REGISTER ---------->         0         0
>          200 <----------         0         0         0         0
>     REGISTER ---------->         0         0
>          401 <----------         0         0         0         0
>     REGISTER ---------->         0         0
>          200 <----------         0         0         0         0
>        Pause [     4:50]         0                             0
>     REGISTER ---------->  B-RTD1 0         0
>          200 <----------  E-RTD1 0         0         0         0
>     REGISTER ---------->  B-RTD1 0         0
>          200 <----------  E-RTD1 0         0         0         0
>        Pause [     4:50]         0                             0
>        Pause [$pre_call_delay]   0                             0
>       INVITE ---------->  B-RTD2 0         0
>          100 <----------         0         0         0         0
>       INVITE <----------         0         0         0         0
>          100 <----------         0         0         0         0
>       INVITE <----------         0         0         0         0
>          100 ---------->         0         0
>          180 ---------->         0         0
>          180 <----------         0         0         0         0
>        Pause [   6000ms]         0                             0
>          200 ---------->         0         0
>          200 <----------         0         0         0         0
>          ACK ---------->         0         0
>          ACK <----------         0         0         0         0
>       UPDATE ---------->         0         0
>       UPDATE <----------         0         0         0         0
>          200 ---------->         0         0
>          200 <----------  E-RTD2 0         0         0         0
>        Pause [    24.0s]         0                             0
>          BYE ---------->  B-RTD3 0         0
>          BYE <----------         0         0         0         0
>          200 ---------->         0         0
>          200 <----------  E-RTD3 0         0         0         0
>        Pause [$post_call_delay]  0                             0
> ------- Waiting for active calls to end. Press [q] again to force exit.
> -------
> Last Error: Aborting call on unexpected message for Call-Id '1079-13729@
> ...
>
> However there is an unexpected message error at the end.
>
> Thanks
>
> Kosala
>
>
>
>
>
> On Wed, Aug 17, 2016 at 12:40 PM, Matt Williams (projectclearwater.org) <
> matt at projectclearwater.org> wrote:
>
> Kosala,
>
>
>
> They should log to /var/log/clearwater-sip-stress - in particular, the
> *.1.out file is a log of the output from sipp.  Do you see anything there?
>
>
>
> Matt
>
>
>
> *From:* Kosala [mailto:kosalayb at gmail.com]
> *Sent:* 17 August 2016 12:33
> *To:* Matt Williams (projectclearwater.org) <matt at projectclearwater.org>;
> clearwater at lists.projectclearwater.org
>
>
> *Subject:* Re: [Project Clearwater] Clearwater Digest, Vol 40, Issue 24
>
>
>
> Hi Matt,
>
> I followed above steps and run sudo apt-get install clearwater-sip-stress.
>
> How do I know stress tests are running? Is is said, stress tests start
> automatically but I cannot see it.
>
> Thanks
>
> Kosala
>
>
>
>
>
>
> On Tue, Aug 16, 2016 at 2:01 PM, Matt Williams (projectclearwater.org) <
> matt at projectclearwater.org> wrote:
>
> Kosala,
>
>
>
> I'm glad you've made progress on this.
>
>
>
> I had a look at the crest package version, but it seems to be later than
> the most recent all-in-one image uses (1.0-160811.103635).  When did you
> download the all-in-one image, and did you apply any patches to it?
>
>
>
> Regarding making calls for stress testing, this is where
> http://clearwater.readthedocs.io/en/latest/Clearwater_
> stress_testing.html#manual-i-e-non-chef-stress-runs comes in - you need to
>
> ?         create a separate VM
>
> ?         set the bono_hostname and count parameters in
> /etc/clearwater/shared_config
>
> ?         install the clearwater-sip-stress package.
>
> I hope that helps.
>
>
>
> BTW, please remember to copy in clearwater at lists.projectclearwater.org -
> that means that other people can see and comment on your posts.
>
>
>
> Thanks,
>
>
>
> Matt
>
>
>
>
>
> *From:* Kosala [mailto:kosalayb at gmail.com]
> *Sent:* 16 August 2016 10:48
> *To:* Matt Williams (projectclearwater.org) <matt at projectclearwater.org>
>
> *Subject:* Re: [Project Clearwater] Clearwater Digest, Vol 40, Issue 24
>
>
>
> Hi Matt,
>
> Bulk provisioning for all in one image is done using
> https://github.com/Metaswitch/crest/blob/dev/docs/Bulk-
> Provisioning%20Numbers.md.
>
> I have records in tables in homestead_cache and homer.
>
> Now How to make calls for stress testing?
>
> Is there any guideline?
>
> Many Thanks,
>
> Kosala
>
>
>
>
>
>
>
>
>
> On Tue, Aug 16, 2016 at 9:04 AM, Kosala <kosalayb at gmail.com> wrote:
>
> Hi Matt,
>
> TBH, The document in https://github.com/Metaswitch/
> crest/blob/dev/docs/Bulk-Provisioning%20Numbers.md is not clear to me.
>
> Step 1. Homestead node in deployment. I do not know where is that node in
> all in one image. It will be helpful the location of that folder from the
> root.
>
> Step 2. A simple example will be helpful.
>
> Thanks
>
> Kosala
>
>
>
>
>
> On Tue, Aug 16, 2016 at 8:50 AM, Kosala <kosalayb at gmail.com> wrote:
>
> Hi Matt,
>
> I downloaded the all in one package from http://clearwater.readthedocs.
> io/en/stable/All_in_one_OVF_Installation.html
>
> and imported using oracle virtual box on ubuntu 14.04,
>
> Crest version
>
> [cw-aio]ubuntu at cwaio:~$ sudo dpkg-query -s crest
> Package: crest
> Status: install ok installed
> Priority: optional
> Section: network
> Installed-Size: 40098
> Maintainer: Project Clearwater Maintainers <maintainers@
> projectclearwater.org>
> Architecture: amd64
> Version: 1.0-160815.145007
>
> Thanks
>
> Kosala
>
>
>
>
>
> On Mon, Aug 15, 2016 at 5:56 PM, Matt Williams (projectclearwater.org) <
> matt at projectclearwater.org> wrote:
>
> Kosala,
>
>
>
> That's odd - I don't see that failure on my all-in-one image (spun up just
> now from the latest image) - which version of all-in-one-image are you
> running, and which version of crest does it include ("sudo dpkg-query -s
> crest")?
>
>
>
> You may be able to work-around this either by taking the latest all-in-one
> image or by following the simpler bulk-provisioning process at
> https://github.com/Metaswitch/crest/blob/dev/docs/Bulk-
> Provisioning%20Numbers.md (when this doc talks about using the
> sstables_provisioning process for very large sets of numbers, we mean 1M+
> numbers - the 9000 you're provisioning are well within the capabilities of
> this process).
>
>
>
> I hope that helps - please let me know how you get on.
>
>
>
> Cheers,
>
>
>
> Matt
>
>
>
>
>
> *From:* Clearwater [mailto:clearwater-bounces at lists.projectclearwater.org]
> *On Behalf Of *Kosala
> *Sent:* 15 August 2016 16:58
> *To:* clearwater at lists.projectclearwater.org
> *Subject:* Re: [Project Clearwater] Clearwater Digest, Vol 40, Issue 24
>
>
>
> HI Matt,
>
> Thanks.
>
>
> I am trying to follow https://github.com/Metaswitch/
> crest/blob/dev/src/metaswitch/crest/tools/sstable_provisioning/README.md
> for bulk provisioning.
>
>
> When I am trying to execute sudo ./BulkProvision homer 21000 29999
> example.com 7kkzTyGW in all-in-one image,
> I am getting an error  java.lang.UnsupportedClassVersionError:
> ClearwaterBulkProvisioner : Unsupported major.minor version 52.0
>
> Java version info in all-in-one image:
> [cw-aio]ubuntu at cwaio:/usr/share/clearwater/crest/tools/sstable_provisioning$
> java -version
> java version "1.7.0_101"
> OpenJDK Runtime Environment (IcedTea 2.6.6) (7u101-2.6.6-0ubuntu0.14.04.1)
> OpenJDK 64-Bit Server VM (build 24.95-b01, mixed mode)
>
> Thanks
>
> Kosala
>
>
>
>
>
>
> On Mon, Aug 15, 2016 at 2:17 PM, <clearwater-request at lists.
> projectclearwater.org> wrote:
>
> Send Clearwater mailing list submissions to
>         clearwater at lists.projectclearwater.org
>
> To subscribe or unsubscribe via the World Wide Web, visit
>         http://lists.projectclearwater.org/mailman/
> listinfo/clearwater_lists.projectclearwater.org
>
> or, via email, send a message with subject or body 'help' to
>         clearwater-request at lists.projectclearwater.org
>
> You can reach the person managing the list at
>         clearwater-owner at lists.projectclearwater.org
>
> When replying, please edit your Subject line so it is more specific
> than "Re: Contents of Clearwater digest..."
>
>
> Today's Topics:
>
>    1. Stress Testing (Kosala)
>    2. Re: Stress Testing (Matt Williams (projectclearwater.org))
>    3. Re: Stress Testing (Matt Williams (projectclearwater.org))
>
>
> ----------------------------------------------------------------------
>
> Message: 1
> Date: Mon, 15 Aug 2016 10:38:57 +0100
> From: Kosala <kosalayb at gmail.com>
> To: clearwater at lists.projectclearwater.org
> Subject: [Project Clearwater] Stress Testing
> Message-ID:
>         <CAGEe17an2B_bGj8NfKFwms+nU=vJURyhT5CE+mcY1pjcm4YF+A at mail.
> gmail.com>
> Content-Type: text/plain; charset="utf-8"
>
> Hi Team,
>
> I installed clearwater "all-in-one" image on Oracle Virtual Box.
> 1. Can I do stress testing ?
> 2. How to do that?
>
> I am trying to follow Stress Testing on
> http://clearwater.readthedocs.io/en/stable/Clearwater_stress_testing.html#
> configuring-udp-stress
> .
>
> Using chef - > It seems chef/knife install only supports in the Cloud
> approach (The automated install is only supported for deployments running
> in Amazon?s EC2 cloud).
>
> Manual approach, It looks not supporting all in one image.
>
> Many Thanks
> Kosala
> -------------- next part --------------
> An HTML attachment was scrubbed...
> URL: <http://lists.projectclearwater.org/pipermail/clearwater_lists.
> projectclearwater.org/attachments/20160815/15fc3b07/attachment-0001.html>
>
> ------------------------------
>
> Message: 2
> Date: Mon, 15 Aug 2016 09:54:02 +0000
> From: "Matt Williams (projectclearwater.org)"
>         <matt at projectclearwater.org>
> To: Kosala <kosalayb at gmail.com>
> Cc: "clearwater at lists.projectclearwater.org"
>         <clearwater at lists.projectclearwater.org>
> Subject: Re: [Project Clearwater] Stress Testing
> Message-ID:
>         <CY1PR0201MB15636F1F20EB91BB180F053390120 at CY1PR0201MB1563.
> namprd02.prod.outlook.com>
>
> Content-Type: text/plain; charset="utf-8"
>
> Kosala,
>
> While it's theoretically possible to do stress testing against an
> all-in-one image, I'd recommend against it - the all-in-one image has been
> squeezed down a lot to fit on a single VM and we'd expect very low
> performance out of it, and I could believe that overload behavior might be
> suboptimal.  If you're looking to stress test for performance reasons, I'd
> strongly recommend running a full deployment as this will give you much
> more reliable numbers.  If you're looking to stress test for other reasons,
> please can you share a bit more about what you're trying to achieve, and we
> can have a think about what would work best?
>
> If you do really want to run stress testing against an all-in-one image,
> it should probably work, even though http://clearwater.readthedocs.
> io/en/latest/Clearwater_stress_testing.html#manual-i-
> e-non-chef-stress-runs only talks about Chef and manual installs.  You'd
> need to set the "bono_servers" option in /etc/clearwater/shared_config to
> point to your all-in-one node, and I suspect you'd need to reduce the
> "count" option to something a lot lower - I'd start around 5000 and see how
> that goes.
>
> I hope that helps.  Please let me know how you get on.
>
> Thanks,
>
> Matt
>
> From: Clearwater [mailto:clearwater-bounces at lists.projectclearwater.org]
> On Behalf Of Kosala
> Sent: 15 August 2016 10:39
> To: clearwater at lists.projectclearwater.org
> Subject: [Project Clearwater] Stress Testing
>
> Hi Team,
> I installed clearwater "all-in-one" image on Oracle Virtual Box.
> 1. Can I do stress testing ?
> 2. How to do that?
> I am trying to follow Stress Testing on http://clearwater.readthedocs.
> io/en/stable/Clearwater_stress_testing.html#configuring-udp-stress.
> Using chef - > It seems chef/knife install only supports in the Cloud
> approach (The automated install is only supported for deployments running
> in Amazon?s EC2 cloud).
> Manual approach, It looks not supporting all in one image.
> Many Thanks
> Kosala
>
> -------------- next part --------------
> An HTML attachment was scrubbed...
> URL: <http://lists.projectclearwater.org/pipermail/clearwater_lists.
> projectclearwater.org/attachments/20160815/29d6328d/attachment-0001.html>
>
> ------------------------------
>
> Message: 3
> Date: Mon, 15 Aug 2016 13:16:47 +0000
> From: "Matt Williams (projectclearwater.org)"
>         <matt at projectclearwater.org>
> To: "clearwater at lists.projectclearwater.org"
>         <clearwater at lists.projectclearwater.org>
> Subject: Re: [Project Clearwater] Stress Testing
> Message-ID:
>         <CY1PR0201MB156372246DC5A77B11839F9D90120 at CY1PR0201MB1563.
> namprd02.prod.outlook.com>
>
> Content-Type: text/plain; charset="utf-8"
>
> Kosala,
>
> You'll need to follow all the steps in http://clearwater.readthedocs.
> io/en/latest/Clearwater_stress_testing.html#manual-i-
> e-non-chef-stress-runs, i.e. bulk provisioning subscribers and installing
> clearwater-sip-stress, but that should be it.
>
> Just to be clear, though, you'll need to set the configuration and install
> the clearwater-sip-stress package on a separate VM, not on the all-in-one
> image itself - the all-in-one image almost certainly opens up ports that
> conflict with those that clearwater-sip-stress tries to use.
>
> This isn't a very well-trodden path, though, so you may hit further issues
> - let me know if so, and we can try to work through them.
>
> Cheers,
>
> Matt
>
> From: Kosala [mailto:kosalayb at gmail.com]
> Sent: 15 August 2016 13:41
> To: Matt Williams (projectclearwater.org) <matt at projectclearwater.org>
> Subject: Re: [Project Clearwater] Stress Testing
>
> Hi Matt,
> Thanks. I set the bono_servers option. Should I add count =5000 to
> /etc/clearwater/shared_config ?
>
> Do I need other changes to run stress tests on all-in-one image?
> Thanks
> Kosala
>
>
>
> On Mon, Aug 15, 2016 at 10:54 AM, Matt Williams (projectclearwater.org<
> http://projectclearwater.org>) <matt at projectclearwater.org<mailto:
> matt at projectclearwater.org>> wrote:
> Kosala,
>
> While it's theoretically possible to do stress testing against an
> all-in-one image, I'd recommend against it - the all-in-one image has been
> squeezed down a lot to fit on a single VM and we'd expect very low
> performance out of it, and I could believe that overload behavior might be
> suboptimal.  If you're looking to stress test for performance reasons, I'd
> strongly recommend running a full deployment as this will give you much
> more reliable numbers.  If you're looking to stress test for other reasons,
> please can you share a bit more about what you're trying to achieve, and we
> can have a think about what would work best?
>
> If you do really want to run stress testing against an all-in-one image,
> it should probably work, even though http://clearwater.readthedocs.
> io/en/latest/Clearwater_stress_testing.html#manual-i-
> e-non-chef-stress-runs only talks about Chef and manual installs.  You'd
> need to set the "bono_servers" option in /etc/clearwater/shared_config to
> point to your all-in-one node, and I suspect you'd need to reduce the
> "count" option to something a lot lower - I'd start around 5000 and see how
> that goes.
>
> I hope that helps.  Please let me know how you get on.
>
> Thanks,
>
> Matt
>
> From: Clearwater [mailto:clearwater-bounces at lists.projectclearwater.org<
> mailto:clearwater-bounces at lists.projectclearwater.org>] On Behalf Of
> Kosala
> Sent: 15 August 2016 10:39
> To: clearwater at lists.projectclearwater.org<mailto:clearwater at lists.
> projectclearwater.org>
> Subject: [Project Clearwater] Stress Testing
>
> Hi Team,
> I installed clearwater "all-in-one" image on Oracle Virtual Box.
> 1. Can I do stress testing ?
> 2. How to do that?
> I am trying to follow Stress Testing on http://clearwater.readthedocs.
> io/en/stable/Clearwater_stress_testing.html#configuring-udp-stress.
> Using chef - > It seems chef/knife install only supports in the Cloud
> approach (The automated install is only supported for deployments running
> in Amazon?s EC2 cloud).
> Manual approach, It looks not supporting all in one image.
> Many Thanks
> Kosala
>
>
> -------------- next part --------------
> An HTML attachment was scrubbed...
> URL: <http://lists.projectclearwater.org/pipermail/clearwater_lists.
> projectclearwater.org/attachments/20160815/11781755/attachment.html>
>
> ------------------------------
>
> Subject: Digest Footer
>
> _______________________________________________
> Clearwater mailing list
> Clearwater at lists.projectclearwater.org
> http://lists.projectclearwater.org/mailman/listinfo/clearwater_lists.
> projectclearwater.org
>
>
> ------------------------------
>
> End of Clearwater Digest, Vol 40, Issue 24
> ******************************************
>
>
>
>
>
>
>
>
>
>
>
>
>
>
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.projectclearwater.org/pipermail/clearwater_lists.projectclearwater.org/attachments/20160817/b3359a7a/attachment.html>

From kosalayb at gmail.com  Wed Aug 17 11:01:12 2016
From: kosalayb at gmail.com (Kosala)
Date: Wed, 17 Aug 2016 16:01:12 +0100
Subject: [Project Clearwater] Clearwater Digest, Vol 40, Issue 24
In-Reply-To: <CAGEe17bF5oKWGOV36aCb=4PxR69HLzgqNJYGioFxP=P6XJoqDw@mail.gmail.com>
References: <mailman.20.1471267072.11502.clearwater_lists.projectclearwater.org@lists.projectclearwater.org>
	<CAGEe17ZLnypQfbzxEwxj9EaB20MUBVpY+YdN-Obv=gHpZmG0KA@mail.gmail.com>
	<CY1PR0201MB1563F9A706F3EC7BE7F9C11590120@CY1PR0201MB1563.namprd02.prod.outlook.com>
	<CAGEe17bfTu1Kpwx=ipqtEbShvWtP+C6pJEEGHi0GSwBR5Dqw8w@mail.gmail.com>
	<CAGEe17aY077tLtotRe1X8k1qU_4otBdHDMJjqDH_g02Zs676Jg@mail.gmail.com>
	<CAGEe17ZeNPPy7AmMz=LCWnHqLm=v9Q7CuLT+AOVKWJTdg8m7Eg@mail.gmail.com>
	<CY1PR0201MB1563CE17983225B985B19D7390130@CY1PR0201MB1563.namprd02.prod.outlook.com>
	<CAGEe17b2M2uqvbOuqH7t4xM41FbfBYk0xR3zWqiFh+EkSfUzUQ@mail.gmail.com>
	<CY1PR0201MB1563CD5DDDD6E7B5A0B2DB7290140@CY1PR0201MB1563.namprd02.prod.outlook.com>
	<CAGEe17YGnaY1Kqc65gyiVO1sBBuTx=-YzfD9HY3M6QBD2t9AkA@mail.gmail.com>
	<CAGEe17aRR+Uj8t+vRWss4pK-mcQALBr2m=wLNc6KHsdXV-CXbA@mail.gmail.com>
	<CY1PR0201MB15639E8995C94D18E7B85EE590140@CY1PR0201MB1563.namprd02.prod.outlook.com>
	<CAGEe17bF5oKWGOV36aCb=4PxR69HLzgqNJYGioFxP=P6XJoqDw@mail.gmail.com>
Message-ID: <CAGEe17ZQtTqfn8D7nO7M8jv4CAL5jzMunGZLg8Z0_9Shw-Uttg@mail.gmail.com>

Sorry  I could not add error log (sip-stress_543_errors.log). This is as
below:

sipp: The following events occured:
2016-08-17      14:53:20:985    1471445600.985925: Aborting call on
unexpected message for Call-Id '954-543 at 10.0.22.193': while expecting '401'
(index 3), received 'SIP/2.0 404 Not Found^M
Via: SIP/2.0/TCP 10.0.22.193:5060
;rport=47137;received=10.0.22.193;branch=z9hG4bK-543-954-2-2010003092-^M
Record-Route:
<sip:scscf.cwaio:5054;transport=TCP;lr;service=scscf;billing-role=charge-orig>^M
Call-ID: 2010003092///954-543 at 10.0.22.193^M
From: <sip:2010003092 at example.com>;tag=543SIPpTag00954^M
To: <sip:2010003092 at example.com
>;tag=z9hG4bKPjbzBKmCQaMJKB5als7O2r1RyzYp37C91d^M
CSeq: 1 REGISTER^M
Content-Length:  0^M
^M
'.
2016-08-17      14:53:21:255    1471445601.255900: Aborting call on
unexpected message for Call-Id '1317-543 at 10.0.22.193': while expecting
'401' (index 3), received 'SIP/2.0 404 Not Found^M
Via: SIP/2.0/TCP 10.0.22.193:5060
;rport=47138;received=10.0.22.193;branch=z9hG4bK-543-1317-2-2010002366-^M
Record-Route:
<sip:scscf.cwaio:5054;transport=TCP;lr;service=scscf;billing-role=charge-orig>^M
Call-ID: 2010002366///1317-543 at 10.0.22.193^M
From: <sip:2010002366 at example.com>;tag=543SIPpTag001317^M
To: <sip:2010002366 at example.com
>;tag=z9hG4bKPj3jbAiJfr3TrTlzsuq4n3J8VVGdfeCFNX^M
CSeq: 1 REGISTER^M
Content-Length:  0^M

...

Thanks
Kosala


On Wed, Aug 17, 2016 at 3:54 PM, Kosala <kosalayb at gmail.com> wrote:

> Hi Matt,
>
>  I changed the provisioning range as 2010000000-2010000999.
> However, I am still getting this error " unexpected message for Call-Id
> .."
>
>
> Last Error: Aborting call on unexpected message for Call-Id '2467-27374@
> ...^M
> ^[[2J------------------------------ Scenario Screen -------- [1-9]:
> Change Screen --^M
>      Users (length)   Port   Total-time  Total-calls  Remote-host^M
>         2500 (0 ms)   5060     384.70 s         2500  10.0.21.192:5060
> (TCP)^M
> ^M
>   Call limit reached (-m 2500), 1.001 s period  1 ms scheduler resolution^M
>   919 calls (limit 2500)                 Peak was 2500 calls, after 0 s^M
>   0 Running, 921 Paused, 7 Woken up^M
>   0 dead call msg (discarded)            0 out-of-call msg
> (discarded)        ^M
>   2 open sockets                        ^M
> ^M
>                                  Messages  Retrans   Timeout
> Unexpected-Msg^M
>        Pause [0ms/10:00]         2500                          0        ^M
>     REGISTER ---------->         1581      0                            ^M
>          401 <----------         0         0         0         1581     ^M
>     REGISTER ---------->         0         0                            ^M
>          200 <----------         0         0         0         0        ^M
>     REGISTER ---------->         0         0                            ^M
>          401 <----------         0         0         0         0        ^M
>     REGISTER ---------->         0         0                            ^M
>          200 <----------         0         0         0         0        ^M
>        Pause [     4:50]         0                             0        ^M
>     REGISTER ---------->  B-RTD1 0         0                            ^M
>          200 <----------  E-RTD1 0         0         0         0        ^M
>     REGISTER ---------->  B-RTD1 0         0                            ^M
>          200 <----------  E-RTD1 0         0         0         0        ^M
>        Pause [     4:50]         0                             0        ^M
>        Pause [$pre_call_delay]   0                             0        ^M
>       INVITE ---------->  B-RTD2 0         0                            ^M
>          100 <----------         0         0         0         0        ^M
>       INVITE <----------         0         0         0         0        ^M
>          100 <----------         0         0         0         0        ^M
>       INVITE <----------         0         0         0         0        ^M
>          100 ---------->         0         0                            ^M
>          180 ---------->         0         0                            ^M
>          180 <----------         0         0         0         0        ^M
>        Pause [   6000ms]         0                             0        ^M
>          200 ---------->         0         0                            ^M
>          200 <----------         0         0         0         0        ^M
>          ACK ---------->         0         0                            ^M
>          ACK <----------         0         0         0         0        ^M
>       UPDATE ---------->         0         0                            ^M
>       UPDATE <----------         0         0         0         0        ^M
>          200 ---------->         0         0                            ^M
>          200 <----------  E-RTD2 0         0         0         0        ^M
>        Pause [    24.0s]         0                             0        ^M
>          BYE ---------->  B-RTD3 0         0                            ^M
>          BYE <----------         0         0         0         0        ^M
>          200 ---------->         0         0                            ^M
>          200 <----------  E-RTD3 0         0         0         0        ^M
>        Pause [$post_call_delay]  0                             0        ^M
> ------- Waiting for active calls to end. Press [q] again to force exit.
> -------^M
> ^M
> Last Error: Aborting call on unexpected message for Call-Id '2216-27374@
> ...^M
>
> Any advice is appreciated.
>
> Kosala
>
>
>
> On Wed, Aug 17, 2016 at 2:40 PM, Matt Williams (projectclearwater.org) <
> matt at projectclearwater.org> wrote:
>
>> Kosala,
>>
>>
>>
>> OK, so this says that the subscriber you're trying to register as can't
>> be found.
>>
>>
>>
>> The stress nodes will by default use DNs from 201000000 onwards.  What
>> numbers did you provision?
>>
>>
>>
>> The docs (https://github.com/Metaswitch/crest/blob/dev/docs/Bulk-
>> Provisioning%20Numbers.md) recommend provisioning
>> 2010000000-2010099999.  However, I recall you trying to run "sudo
>> ./BulkProvision homer 21000 29999 example.com 7kkzTyGW", which would
>> only provision the numbers 21000-29999.  Maybe there's a mismatch here?
>>
>>
>>
>> Matt
>>
>>
>>
>> --
>>
>>
>>
>> Matt Williams
>> Lead Architect, Project Clearwater
>>
>> +44 (0) 20 8366 1177
>>
>>
>>
>> *From:* Kosala [mailto:kosalayb at gmail.com]
>> *Sent:* 17 August 2016 14:34
>>
>> *To:* Matt Williams (projectclearwater.org) <matt at projectclearwater.org>
>> *Subject:* Re: [Project Clearwater] Clearwater Digest, Vol 40, Issue 24
>>
>>
>>
>> I am getting followings in sip-stress_18438_errors.log:
>>
>> 2016-08-17      12:26:26:258    1471436786.258684: Aborting call on
>> unexpected message for Call-Id '898-18438 at 10.0.22.193': while expecting
>> '401' (index 3), received 'SIP/2.0 404 Not Found^M
>> Via: SIP/2.0/TCP 10.0.22.193:5060;rport=8826;re
>> ceived=10.0.22.193;branch=z9hG4bK-18438-898-2-2010003204-^M
>> Record-Route: <sip:scscf.cwaio:5054;transport=TCP;lr;service=scscf;
>> billing-role=charge-orig>^M
>> Call-ID: 2010003204///898-18438 at 10.0.22.193^M
>> From: <sip:2010003204 at example.com>;tag=18438SIPpTag00898^M
>> To: <sip:2010003204 at example.com>;tag=z9hG4bKPjc1xOWCH0ooae6O9npl
>> 7fSSrQ-x0vmoV9^M
>> CSeq: 1 REGISTER^M
>> Content-Length:  0^M
>>
>> Any advice is appreciated.
>>
>> Many Thanks,
>>
>> Kosala
>>
>>
>>
>>
>>
>> On Wed, Aug 17, 2016 at 2:20 PM, Kosala <kosalayb at gmail.com> wrote:
>>
>> Hi Matt,
>>
>> I can see this scenario screen from sip-stress.1.out. I hope this will be
>> the stress test output results.
>>
>>
>> ------------------------------ Scenario Screen -------- [1-9]: Change
>> Screen --
>>      Users (length)   Port   Total-time  Total-calls  Remote-host
>>         2500 (0 ms)   5060      77.15 s         2500  10.0.21.192:5060
>> (TCP)
>>
>>   Call limit reached (-m 2500), 1.002 s period  1 ms scheduler resolution
>>   2175 calls (limit 2500)                Peak was 2499 calls, after 0 s
>>   0 Running, 2177 Paused, 8 Woken up
>>   0 dead call msg (discarded)            0 out-of-call msg
>> (discarded)
>>   3 open sockets
>>
>>                                  Messages  Retrans   Timeout
>> Unexpected-Msg
>>        Pause [0ms/10:00]         2500                          0
>>     REGISTER ---------->         326       0
>>          401 <----------         0         0         0         325
>>     REGISTER ---------->         0         0
>>          200 <----------         0         0         0         0
>>     REGISTER ---------->         0         0
>>          401 <----------         0         0         0         0
>>     REGISTER ---------->         0         0
>>          200 <----------         0         0         0         0
>>        Pause [     4:50]         0                             0
>>     REGISTER ---------->  B-RTD1 0         0
>>          200 <----------  E-RTD1 0         0         0         0
>>     REGISTER ---------->  B-RTD1 0         0
>>          200 <----------  E-RTD1 0         0         0         0
>>        Pause [     4:50]         0                             0
>>        Pause [$pre_call_delay]   0                             0
>>       INVITE ---------->  B-RTD2 0         0
>>          100 <----------         0         0         0         0
>>       INVITE <----------         0         0         0         0
>>          100 <----------         0         0         0         0
>>       INVITE <----------         0         0         0         0
>>          100 ---------->         0         0
>>          180 ---------->         0         0
>>          180 <----------         0         0         0         0
>>        Pause [   6000ms]         0                             0
>>          200 ---------->         0         0
>>          200 <----------         0         0         0         0
>>          ACK ---------->         0         0
>>          ACK <----------         0         0         0         0
>>       UPDATE ---------->         0         0
>>       UPDATE <----------         0         0         0         0
>>          200 ---------->         0         0
>>          200 <----------  E-RTD2 0         0         0         0
>>        Pause [    24.0s]         0                             0
>>          BYE ---------->  B-RTD3 0         0
>>          BYE <----------         0         0         0         0
>>          200 ---------->         0         0
>>          200 <----------  E-RTD3 0         0         0         0
>>        Pause [$post_call_delay]  0                             0
>> ------- Waiting for active calls to end. Press [q] again to force exit.
>> -------
>> Last Error: Aborting call on unexpected message for Call-Id '1079-13729@
>> ...
>>
>> However there is an unexpected message error at the end.
>>
>> Thanks
>>
>> Kosala
>>
>>
>>
>>
>>
>> On Wed, Aug 17, 2016 at 12:40 PM, Matt Williams (projectclearwater.org) <
>> matt at projectclearwater.org> wrote:
>>
>> Kosala,
>>
>>
>>
>> They should log to /var/log/clearwater-sip-stress - in particular, the
>> *.1.out file is a log of the output from sipp.  Do you see anything there?
>>
>>
>>
>> Matt
>>
>>
>>
>> *From:* Kosala [mailto:kosalayb at gmail.com]
>> *Sent:* 17 August 2016 12:33
>> *To:* Matt Williams (projectclearwater.org) <matt at projectclearwater.org>;
>> clearwater at lists.projectclearwater.org
>>
>>
>> *Subject:* Re: [Project Clearwater] Clearwater Digest, Vol 40, Issue 24
>>
>>
>>
>> Hi Matt,
>>
>> I followed above steps and run sudo apt-get install
>> clearwater-sip-stress.
>>
>> How do I know stress tests are running? Is is said, stress tests start
>> automatically but I cannot see it.
>>
>> Thanks
>>
>> Kosala
>>
>>
>>
>>
>>
>>
>> On Tue, Aug 16, 2016 at 2:01 PM, Matt Williams (projectclearwater.org) <
>> matt at projectclearwater.org> wrote:
>>
>> Kosala,
>>
>>
>>
>> I'm glad you've made progress on this.
>>
>>
>>
>> I had a look at the crest package version, but it seems to be later than
>> the most recent all-in-one image uses (1.0-160811.103635).  When did you
>> download the all-in-one image, and did you apply any patches to it?
>>
>>
>>
>> Regarding making calls for stress testing, this is where
>> http://clearwater.readthedocs.io/en/latest/Clearwater_stress
>> _testing.html#manual-i-e-non-chef-stress-runs comes in - you need to
>>
>> ?         create a separate VM
>>
>> ?         set the bono_hostname and count parameters in
>> /etc/clearwater/shared_config
>>
>> ?         install the clearwater-sip-stress package.
>>
>> I hope that helps.
>>
>>
>>
>> BTW, please remember to copy in clearwater at lists.projectclearwater.org -
>> that means that other people can see and comment on your posts.
>>
>>
>>
>> Thanks,
>>
>>
>>
>> Matt
>>
>>
>>
>>
>>
>> *From:* Kosala [mailto:kosalayb at gmail.com]
>> *Sent:* 16 August 2016 10:48
>> *To:* Matt Williams (projectclearwater.org) <matt at projectclearwater.org>
>>
>> *Subject:* Re: [Project Clearwater] Clearwater Digest, Vol 40, Issue 24
>>
>>
>>
>> Hi Matt,
>>
>> Bulk provisioning for all in one image is done using
>> https://github.com/Metaswitch/crest/blob/dev/docs/Bulk-Provi
>> sioning%20Numbers.md.
>>
>> I have records in tables in homestead_cache and homer.
>>
>> Now How to make calls for stress testing?
>>
>> Is there any guideline?
>>
>> Many Thanks,
>>
>> Kosala
>>
>>
>>
>>
>>
>>
>>
>>
>>
>> On Tue, Aug 16, 2016 at 9:04 AM, Kosala <kosalayb at gmail.com> wrote:
>>
>> Hi Matt,
>>
>> TBH, The document in https://github.com/Metaswitch/
>> crest/blob/dev/docs/Bulk-Provisioning%20Numbers.md is not clear to me.
>>
>> Step 1. Homestead node in deployment. I do not know where is that node in
>> all in one image. It will be helpful the location of that folder from the
>> root.
>>
>> Step 2. A simple example will be helpful.
>>
>> Thanks
>>
>> Kosala
>>
>>
>>
>>
>>
>> On Tue, Aug 16, 2016 at 8:50 AM, Kosala <kosalayb at gmail.com> wrote:
>>
>> Hi Matt,
>>
>> I downloaded the all in one package from http://clearwater.readthedocs.
>> io/en/stable/All_in_one_OVF_Installation.html
>>
>> and imported using oracle virtual box on ubuntu 14.04,
>>
>> Crest version
>>
>> [cw-aio]ubuntu at cwaio:~$ sudo dpkg-query -s crest
>> Package: crest
>> Status: install ok installed
>> Priority: optional
>> Section: network
>> Installed-Size: 40098
>> Maintainer: Project Clearwater Maintainers <maintainers at projectclearwater
>> .org>
>> Architecture: amd64
>> Version: 1.0-160815.145007
>>
>> Thanks
>>
>> Kosala
>>
>>
>>
>>
>>
>> On Mon, Aug 15, 2016 at 5:56 PM, Matt Williams (projectclearwater.org) <
>> matt at projectclearwater.org> wrote:
>>
>> Kosala,
>>
>>
>>
>> That's odd - I don't see that failure on my all-in-one image (spun up
>> just now from the latest image) - which version of all-in-one-image are you
>> running, and which version of crest does it include ("sudo dpkg-query -s
>> crest")?
>>
>>
>>
>> You may be able to work-around this either by taking the latest
>> all-in-one image or by following the simpler bulk-provisioning process at
>> https://github.com/Metaswitch/crest/blob/dev/docs/Bulk-Provi
>> sioning%20Numbers.md (when this doc talks about using the
>> sstables_provisioning process for very large sets of numbers, we mean 1M+
>> numbers - the 9000 you're provisioning are well within the capabilities of
>> this process).
>>
>>
>>
>> I hope that helps - please let me know how you get on.
>>
>>
>>
>> Cheers,
>>
>>
>>
>> Matt
>>
>>
>>
>>
>>
>> *From:* Clearwater [mailto:clearwater-bounces at lists.projectclearwater.org]
>> *On Behalf Of *Kosala
>> *Sent:* 15 August 2016 16:58
>> *To:* clearwater at lists.projectclearwater.org
>> *Subject:* Re: [Project Clearwater] Clearwater Digest, Vol 40, Issue 24
>>
>>
>>
>> HI Matt,
>>
>> Thanks.
>>
>>
>> I am trying to follow https://github.com/Metaswitch/
>> crest/blob/dev/src/metaswitch/crest/tools/sstable_provisioning/README.md
>> for bulk provisioning.
>>
>>
>> When I am trying to execute sudo ./BulkProvision homer 21000 29999
>> example.com 7kkzTyGW in all-in-one image,
>> I am getting an error  java.lang.UnsupportedClassVersionError:
>> ClearwaterBulkProvisioner : Unsupported major.minor version 52.0
>>
>> Java version info in all-in-one image:
>> [cw-aio]ubuntu at cwaio:/usr/share/clearwater/crest/tools/sstable_provisioning$
>> java -version
>> java version "1.7.0_101"
>> OpenJDK Runtime Environment (IcedTea 2.6.6) (7u101-2.6.6-0ubuntu0.14.04.1)
>> OpenJDK 64-Bit Server VM (build 24.95-b01, mixed mode)
>>
>> Thanks
>>
>> Kosala
>>
>>
>>
>>
>>
>>
>> On Mon, Aug 15, 2016 at 2:17 PM, <clearwater-request at lists.proj
>> ectclearwater.org> wrote:
>>
>> Send Clearwater mailing list submissions to
>>         clearwater at lists.projectclearwater.org
>>
>> To subscribe or unsubscribe via the World Wide Web, visit
>>         http://lists.projectclearwater.org/mailman/listinfo/
>> clearwater_lists.projectclearwater.org
>>
>> or, via email, send a message with subject or body 'help' to
>>         clearwater-request at lists.projectclearwater.org
>>
>> You can reach the person managing the list at
>>         clearwater-owner at lists.projectclearwater.org
>>
>> When replying, please edit your Subject line so it is more specific
>> than "Re: Contents of Clearwater digest..."
>>
>>
>> Today's Topics:
>>
>>    1. Stress Testing (Kosala)
>>    2. Re: Stress Testing (Matt Williams (projectclearwater.org))
>>    3. Re: Stress Testing (Matt Williams (projectclearwater.org))
>>
>>
>> ----------------------------------------------------------------------
>>
>> Message: 1
>> Date: Mon, 15 Aug 2016 10:38:57 +0100
>> From: Kosala <kosalayb at gmail.com>
>> To: clearwater at lists.projectclearwater.org
>> Subject: [Project Clearwater] Stress Testing
>> Message-ID:
>>         <CAGEe17an2B_bGj8NfKFwms+nU=vJURyhT5CE+mcY1pjcm4YF+A at mail.gm
>> ail.com>
>> Content-Type: text/plain; charset="utf-8"
>>
>> Hi Team,
>>
>> I installed clearwater "all-in-one" image on Oracle Virtual Box.
>> 1. Can I do stress testing ?
>> 2. How to do that?
>>
>> I am trying to follow Stress Testing on
>> http://clearwater.readthedocs.io/en/stable/Clearwater_stress
>> _testing.html#configuring-udp-stress
>> .
>>
>> Using chef - > It seems chef/knife install only supports in the Cloud
>> approach (The automated install is only supported for deployments running
>> in Amazon?s EC2 cloud).
>>
>> Manual approach, It looks not supporting all in one image.
>>
>> Many Thanks
>> Kosala
>> -------------- next part --------------
>> An HTML attachment was scrubbed...
>> URL: <http://lists.projectclearwater.org/pipermail/clearwater_
>> lists.projectclearwater.org/attachments/20160815/15fc3b07/at
>> tachment-0001.html>
>>
>> ------------------------------
>>
>> Message: 2
>> Date: Mon, 15 Aug 2016 09:54:02 +0000
>> From: "Matt Williams (projectclearwater.org)"
>>         <matt at projectclearwater.org>
>> To: Kosala <kosalayb at gmail.com>
>> Cc: "clearwater at lists.projectclearwater.org"
>>         <clearwater at lists.projectclearwater.org>
>> Subject: Re: [Project Clearwater] Stress Testing
>> Message-ID:
>>         <CY1PR0201MB15636F1F20EB91BB180F053390120 at CY1PR0201MB1563.na
>> mprd02.prod.outlook.com>
>>
>> Content-Type: text/plain; charset="utf-8"
>>
>> Kosala,
>>
>> While it's theoretically possible to do stress testing against an
>> all-in-one image, I'd recommend against it - the all-in-one image has been
>> squeezed down a lot to fit on a single VM and we'd expect very low
>> performance out of it, and I could believe that overload behavior might be
>> suboptimal.  If you're looking to stress test for performance reasons, I'd
>> strongly recommend running a full deployment as this will give you much
>> more reliable numbers.  If you're looking to stress test for other reasons,
>> please can you share a bit more about what you're trying to achieve, and we
>> can have a think about what would work best?
>>
>> If you do really want to run stress testing against an all-in-one image,
>> it should probably work, even though http://clearwater.readthedocs.
>> io/en/latest/Clearwater_stress_testing.html#manual-i-e-non-
>> chef-stress-runs only talks about Chef and manual installs.  You'd need
>> to set the "bono_servers" option in /etc/clearwater/shared_config to point
>> to your all-in-one node, and I suspect you'd need to reduce the "count"
>> option to something a lot lower - I'd start around 5000 and see how that
>> goes.
>>
>> I hope that helps.  Please let me know how you get on.
>>
>> Thanks,
>>
>> Matt
>>
>> From: Clearwater [mailto:clearwater-bounces at lists.projectclearwater.org]
>> On Behalf Of Kosala
>> Sent: 15 August 2016 10:39
>> To: clearwater at lists.projectclearwater.org
>> Subject: [Project Clearwater] Stress Testing
>>
>> Hi Team,
>> I installed clearwater "all-in-one" image on Oracle Virtual Box.
>> 1. Can I do stress testing ?
>> 2. How to do that?
>> I am trying to follow Stress Testing on http://clearwater.readthedocs.
>> io/en/stable/Clearwater_stress_testing.html#configuring-udp-stress.
>> Using chef - > It seems chef/knife install only supports in the Cloud
>> approach (The automated install is only supported for deployments running
>> in Amazon?s EC2 cloud).
>> Manual approach, It looks not supporting all in one image.
>> Many Thanks
>> Kosala
>>
>> -------------- next part --------------
>> An HTML attachment was scrubbed...
>> URL: <http://lists.projectclearwater.org/pipermail/clearwater_
>> lists.projectclearwater.org/attachments/20160815/29d6328d/at
>> tachment-0001.html>
>>
>> ------------------------------
>>
>> Message: 3
>> Date: Mon, 15 Aug 2016 13:16:47 +0000
>> From: "Matt Williams (projectclearwater.org)"
>>         <matt at projectclearwater.org>
>> To: "clearwater at lists.projectclearwater.org"
>>         <clearwater at lists.projectclearwater.org>
>> Subject: Re: [Project Clearwater] Stress Testing
>> Message-ID:
>>         <CY1PR0201MB156372246DC5A77B11839F9D90120 at CY1PR0201MB1563.na
>> mprd02.prod.outlook.com>
>>
>> Content-Type: text/plain; charset="utf-8"
>>
>> Kosala,
>>
>> You'll need to follow all the steps in http://clearwater.readthedocs.
>> io/en/latest/Clearwater_stress_testing.html#manual-i-e-non-
>> chef-stress-runs, i.e. bulk provisioning subscribers and installing
>> clearwater-sip-stress, but that should be it.
>>
>> Just to be clear, though, you'll need to set the configuration and
>> install the clearwater-sip-stress package on a separate VM, not on the
>> all-in-one image itself - the all-in-one image almost certainly opens up
>> ports that conflict with those that clearwater-sip-stress tries to use.
>>
>> This isn't a very well-trodden path, though, so you may hit further
>> issues - let me know if so, and we can try to work through them.
>>
>> Cheers,
>>
>> Matt
>>
>> From: Kosala [mailto:kosalayb at gmail.com]
>> Sent: 15 August 2016 13:41
>> To: Matt Williams (projectclearwater.org) <matt at projectclearwater.org>
>> Subject: Re: [Project Clearwater] Stress Testing
>>
>> Hi Matt,
>> Thanks. I set the bono_servers option. Should I add count =5000 to
>> /etc/clearwater/shared_config ?
>>
>> Do I need other changes to run stress tests on all-in-one image?
>> Thanks
>> Kosala
>>
>>
>>
>> On Mon, Aug 15, 2016 at 10:54 AM, Matt Williams (projectclearwater.org<
>> http://projectclearwater.org>) <matt at projectclearwater.org<mailto:
>> matt at projectclearwater.org>> wrote:
>> Kosala,
>>
>> While it's theoretically possible to do stress testing against an
>> all-in-one image, I'd recommend against it - the all-in-one image has been
>> squeezed down a lot to fit on a single VM and we'd expect very low
>> performance out of it, and I could believe that overload behavior might be
>> suboptimal.  If you're looking to stress test for performance reasons, I'd
>> strongly recommend running a full deployment as this will give you much
>> more reliable numbers.  If you're looking to stress test for other reasons,
>> please can you share a bit more about what you're trying to achieve, and we
>> can have a think about what would work best?
>>
>> If you do really want to run stress testing against an all-in-one image,
>> it should probably work, even though http://clearwater.readthedocs.
>> io/en/latest/Clearwater_stress_testing.html#manual-i-e-non-
>> chef-stress-runs only talks about Chef and manual installs.  You'd need
>> to set the "bono_servers" option in /etc/clearwater/shared_config to point
>> to your all-in-one node, and I suspect you'd need to reduce the "count"
>> option to something a lot lower - I'd start around 5000 and see how that
>> goes.
>>
>> I hope that helps.  Please let me know how you get on.
>>
>> Thanks,
>>
>> Matt
>>
>> From: Clearwater [mailto:clearwater-bounces at lists.projectclearwater.org
>> <mailto:clearwater-bounces at lists.projectclearwater.org>] On Behalf Of
>> Kosala
>> Sent: 15 August 2016 10:39
>> To: clearwater at lists.projectclearwater.org<mailto:clearwater@
>> lists.projectclearwater.org>
>> Subject: [Project Clearwater] Stress Testing
>>
>> Hi Team,
>> I installed clearwater "all-in-one" image on Oracle Virtual Box.
>> 1. Can I do stress testing ?
>> 2. How to do that?
>> I am trying to follow Stress Testing on http://clearwater.readthedocs.
>> io/en/stable/Clearwater_stress_testing.html#configuring-udp-stress.
>> Using chef - > It seems chef/knife install only supports in the Cloud
>> approach (The automated install is only supported for deployments running
>> in Amazon?s EC2 cloud).
>> Manual approach, It looks not supporting all in one image.
>> Many Thanks
>> Kosala
>>
>>
>> -------------- next part --------------
>> An HTML attachment was scrubbed...
>> URL: <http://lists.projectclearwater.org/pipermail/clearwater_
>> lists.projectclearwater.org/attachments/20160815/11781755/attachment.html
>> >
>>
>> ------------------------------
>>
>> Subject: Digest Footer
>>
>> _______________________________________________
>> Clearwater mailing list
>> Clearwater at lists.projectclearwater.org
>> http://lists.projectclearwater.org/mailman/listinfo/
>> clearwater_lists.projectclearwater.org
>>
>>
>> ------------------------------
>>
>> End of Clearwater Digest, Vol 40, Issue 24
>> ******************************************
>>
>>
>>
>>
>>
>>
>>
>>
>>
>>
>>
>>
>>
>>
>>
>
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.projectclearwater.org/pipermail/clearwater_lists.projectclearwater.org/attachments/20160817/26fdf8f9/attachment.html>

From kosalayb at gmail.com  Wed Aug 17 11:08:32 2016
From: kosalayb at gmail.com (Kosala)
Date: Wed, 17 Aug 2016 16:08:32 +0100
Subject: [Project Clearwater] Clearwater Digest, Vol 40, Issue 24
In-Reply-To: <CAGEe17ZQtTqfn8D7nO7M8jv4CAL5jzMunGZLg8Z0_9Shw-Uttg@mail.gmail.com>
References: <mailman.20.1471267072.11502.clearwater_lists.projectclearwater.org@lists.projectclearwater.org>
	<CAGEe17ZLnypQfbzxEwxj9EaB20MUBVpY+YdN-Obv=gHpZmG0KA@mail.gmail.com>
	<CY1PR0201MB1563F9A706F3EC7BE7F9C11590120@CY1PR0201MB1563.namprd02.prod.outlook.com>
	<CAGEe17bfTu1Kpwx=ipqtEbShvWtP+C6pJEEGHi0GSwBR5Dqw8w@mail.gmail.com>
	<CAGEe17aY077tLtotRe1X8k1qU_4otBdHDMJjqDH_g02Zs676Jg@mail.gmail.com>
	<CAGEe17ZeNPPy7AmMz=LCWnHqLm=v9Q7CuLT+AOVKWJTdg8m7Eg@mail.gmail.com>
	<CY1PR0201MB1563CE17983225B985B19D7390130@CY1PR0201MB1563.namprd02.prod.outlook.com>
	<CAGEe17b2M2uqvbOuqH7t4xM41FbfBYk0xR3zWqiFh+EkSfUzUQ@mail.gmail.com>
	<CY1PR0201MB1563CD5DDDD6E7B5A0B2DB7290140@CY1PR0201MB1563.namprd02.prod.outlook.com>
	<CAGEe17YGnaY1Kqc65gyiVO1sBBuTx=-YzfD9HY3M6QBD2t9AkA@mail.gmail.com>
	<CAGEe17aRR+Uj8t+vRWss4pK-mcQALBr2m=wLNc6KHsdXV-CXbA@mail.gmail.com>
	<CY1PR0201MB15639E8995C94D18E7B85EE590140@CY1PR0201MB1563.namprd02.prod.outlook.com>
	<CAGEe17bF5oKWGOV36aCb=4PxR69HLzgqNJYGioFxP=P6XJoqDw@mail.gmail.com>
	<CAGEe17ZQtTqfn8D7nO7M8jv4CAL5jzMunGZLg8Z0_9Shw-Uttg@mail.gmail.com>
Message-ID: <CAGEe17YUpkEQx6G6MJTeWJQW0Af9a8AxZ+9c7Odn-9vAtd3kbg@mail.gmail.com>

And the other thing, I noticed is From id and To id are same in errors
found in sip-stress_543_errors.log

2016-08-17      14:53:21:255    1471445601.255900: Aborting call on
unexpected message for Call-Id '1317-543 at 10.0.22.193': while expecting
'401' (index 3), received 'SIP/2.0 404 Not Found^M
Via: SIP/2.0/TCP 10.0.22.193:5060;rport=47138;received=10.0.22.193;branch=
z9hG4bK-543-1317-2-2010002366-^M
Record-Route: <sip:scscf.cwaio:5054;transport=TCP;lr;service=
scscf;billing-role=charge-orig>^M
Call-ID: 2010002366///1317-543 at 10.0.22.193^M
From: <sip:2010002366 at example.com>;tag=543SIPpTag001317^M
To: <sip:2010002366 at example.com>;tag=z9hG4bKPj3jbAiJfr3TrTlzsuq4n3J
8VVGdfeCFNX^M
CSeq: 1 REGISTER^M
Content-Length:  0^M

Is this the issu?


Thanks
Kosala


On Wed, Aug 17, 2016 at 4:01 PM, Kosala <kosalayb at gmail.com> wrote:

> Sorry  I could not add error log (sip-stress_543_errors.log). This is as
> below:
>
> sipp: The following events occured:
> 2016-08-17      14:53:20:985    1471445600.985925: Aborting call on
> unexpected message for Call-Id '954-543 at 10.0.22.193': while expecting
> '401' (index 3), received 'SIP/2.0 404 Not Found^M
> Via: SIP/2.0/TCP 10.0.22.193:5060;rport=47137;received=10.0.22.193;branch=
> z9hG4bK-543-954-2-2010003092-^M
> Record-Route: <sip:scscf.cwaio:5054;transport=TCP;lr;service=
> scscf;billing-role=charge-orig>^M
> Call-ID: 2010003092///954-543 at 10.0.22.193^M
> From: <sip:2010003092 at example.com>;tag=543SIPpTag00954^M
> To: <sip:2010003092 at example.com>;tag=z9hG4bKPjbzBKmCQaMJKB5als7O2r1
> RyzYp37C91d^M
> CSeq: 1 REGISTER^M
> Content-Length:  0^M
> ^M
> '.
> 2016-08-17      14:53:21:255    1471445601.255900: Aborting call on
> unexpected message for Call-Id '1317-543 at 10.0.22.193': while expecting
> '401' (index 3), received 'SIP/2.0 404 Not Found^M
> Via: SIP/2.0/TCP 10.0.22.193:5060;rport=47138;received=10.0.22.193;branch=
> z9hG4bK-543-1317-2-2010002366-^M
> Record-Route: <sip:scscf.cwaio:5054;transport=TCP;lr;service=
> scscf;billing-role=charge-orig>^M
> Call-ID: 2010002366///1317-543 at 10.0.22.193^M
> From: <sip:2010002366 at example.com>;tag=543SIPpTag001317^M
> To: <sip:2010002366 at example.com>;tag=z9hG4bKPj3jbAiJfr3TrTlzsuq4n3J
> 8VVGdfeCFNX^M
> CSeq: 1 REGISTER^M
> Content-Length:  0^M
>
> ...
>
> Thanks
> Kosala
>
>
> On Wed, Aug 17, 2016 at 3:54 PM, Kosala <kosalayb at gmail.com> wrote:
>
>> Hi Matt,
>>
>>  I changed the provisioning range as 2010000000-2010000999.
>> However, I am still getting this error " unexpected message for Call-Id
>> .."
>>
>>
>> Last Error: Aborting call on unexpected message for Call-Id '2467-27374@
>> ...^M
>> ^[[2J------------------------------ Scenario Screen -------- [1-9]:
>> Change Screen --^M
>>      Users (length)   Port   Total-time  Total-calls  Remote-host^M
>>         2500 (0 ms)   5060     384.70 s         2500  10.0.21.192:5060
>> (TCP)^M
>> ^M
>>   Call limit reached (-m 2500), 1.001 s period  1 ms scheduler
>> resolution^M
>>   919 calls (limit 2500)                 Peak was 2500 calls, after 0 s^M
>>   0 Running, 921 Paused, 7 Woken up^M
>>   0 dead call msg (discarded)            0 out-of-call msg
>> (discarded)        ^M
>>   2 open sockets                        ^M
>> ^M
>>                                  Messages  Retrans   Timeout
>> Unexpected-Msg^M
>>        Pause [0ms/10:00]         2500                          0        ^M
>>     REGISTER ---------->         1581      0                            ^M
>>          401 <----------         0         0         0         1581     ^M
>>     REGISTER ---------->         0         0                            ^M
>>          200 <----------         0         0         0         0        ^M
>>     REGISTER ---------->         0         0                            ^M
>>          401 <----------         0         0         0         0        ^M
>>     REGISTER ---------->         0         0                            ^M
>>          200 <----------         0         0         0         0        ^M
>>        Pause [     4:50]         0                             0        ^M
>>     REGISTER ---------->  B-RTD1 0         0                            ^M
>>          200 <----------  E-RTD1 0         0         0         0        ^M
>>     REGISTER ---------->  B-RTD1 0         0                            ^M
>>          200 <----------  E-RTD1 0         0         0         0        ^M
>>        Pause [     4:50]         0                             0        ^M
>>        Pause [$pre_call_delay]   0                             0        ^M
>>       INVITE ---------->  B-RTD2 0         0                            ^M
>>          100 <----------         0         0         0         0        ^M
>>       INVITE <----------         0         0         0         0        ^M
>>          100 <----------         0         0         0         0        ^M
>>       INVITE <----------         0         0         0         0        ^M
>>          100 ---------->         0         0                            ^M
>>          180 ---------->         0         0                            ^M
>>          180 <----------         0         0         0         0        ^M
>>        Pause [   6000ms]         0                             0        ^M
>>          200 ---------->         0         0                            ^M
>>          200 <----------         0         0         0         0        ^M
>>          ACK ---------->         0         0                            ^M
>>          ACK <----------         0         0         0         0        ^M
>>       UPDATE ---------->         0         0                            ^M
>>       UPDATE <----------         0         0         0         0        ^M
>>          200 ---------->         0         0                            ^M
>>          200 <----------  E-RTD2 0         0         0         0        ^M
>>        Pause [    24.0s]         0                             0        ^M
>>          BYE ---------->  B-RTD3 0         0                            ^M
>>          BYE <----------         0         0         0         0        ^M
>>          200 ---------->         0         0                            ^M
>>          200 <----------  E-RTD3 0         0         0         0        ^M
>>        Pause [$post_call_delay]  0                             0        ^M
>> ------- Waiting for active calls to end. Press [q] again to force exit.
>> -------^M
>> ^M
>> Last Error: Aborting call on unexpected message for Call-Id '2216-27374@
>> ...^M
>>
>> Any advice is appreciated.
>>
>> Kosala
>>
>>
>>
>> On Wed, Aug 17, 2016 at 2:40 PM, Matt Williams (projectclearwater.org) <
>> matt at projectclearwater.org> wrote:
>>
>>> Kosala,
>>>
>>>
>>>
>>> OK, so this says that the subscriber you're trying to register as can't
>>> be found.
>>>
>>>
>>>
>>> The stress nodes will by default use DNs from 201000000 onwards.  What
>>> numbers did you provision?
>>>
>>>
>>>
>>> The docs (https://github.com/Metaswitch/crest/blob/dev/docs/Bulk-Prov
>>> isioning%20Numbers.md) recommend provisioning 2010000000-2010099999.
>>> However, I recall you trying to run "sudo ./BulkProvision homer 21000 29999
>>> example.com 7kkzTyGW", which would only provision the numbers
>>> 21000-29999.  Maybe there's a mismatch here?
>>>
>>>
>>>
>>> Matt
>>>
>>>
>>>
>>> --
>>>
>>>
>>>
>>> Matt Williams
>>> Lead Architect, Project Clearwater
>>>
>>> +44 (0) 20 8366 1177
>>>
>>>
>>>
>>> *From:* Kosala [mailto:kosalayb at gmail.com]
>>> *Sent:* 17 August 2016 14:34
>>>
>>> *To:* Matt Williams (projectclearwater.org) <matt at projectclearwater.org>
>>> *Subject:* Re: [Project Clearwater] Clearwater Digest, Vol 40, Issue 24
>>>
>>>
>>>
>>> I am getting followings in sip-stress_18438_errors.log:
>>>
>>> 2016-08-17      12:26:26:258    1471436786.258684: Aborting call on
>>> unexpected message for Call-Id '898-18438 at 10.0.22.193': while expecting
>>> '401' (index 3), received 'SIP/2.0 404 Not Found^M
>>> Via: SIP/2.0/TCP 10.0.22.193:5060;rport=8826;re
>>> ceived=10.0.22.193;branch=z9hG4bK-18438-898-2-2010003204-^M
>>> Record-Route: <sip:scscf.cwaio:5054;transpor
>>> t=TCP;lr;service=scscf;billing-role=charge-orig>^M
>>> Call-ID: 2010003204///898-18438 at 10.0.22.193^M
>>> From: <sip:2010003204 at example.com>;tag=18438SIPpTag00898^M
>>> To: <sip:2010003204 at example.com>;tag=z9hG4bKPjc1xOWCH0ooae6O9npl
>>> 7fSSrQ-x0vmoV9^M
>>> CSeq: 1 REGISTER^M
>>> Content-Length:  0^M
>>>
>>> Any advice is appreciated.
>>>
>>> Many Thanks,
>>>
>>> Kosala
>>>
>>>
>>>
>>>
>>>
>>> On Wed, Aug 17, 2016 at 2:20 PM, Kosala <kosalayb at gmail.com> wrote:
>>>
>>> Hi Matt,
>>>
>>> I can see this scenario screen from sip-stress.1.out. I hope this will
>>> be the stress test output results.
>>>
>>>
>>> ------------------------------ Scenario Screen -------- [1-9]: Change
>>> Screen --
>>>      Users (length)   Port   Total-time  Total-calls  Remote-host
>>>         2500 (0 ms)   5060      77.15 s         2500  10.0.21.192:5060
>>> (TCP)
>>>
>>>   Call limit reached (-m 2500), 1.002 s period  1 ms scheduler resolution
>>>   2175 calls (limit 2500)                Peak was 2499 calls, after 0 s
>>>   0 Running, 2177 Paused, 8 Woken up
>>>   0 dead call msg (discarded)            0 out-of-call msg
>>> (discarded)
>>>   3 open sockets
>>>
>>>                                  Messages  Retrans   Timeout
>>> Unexpected-Msg
>>>        Pause [0ms/10:00]         2500                          0
>>>     REGISTER ---------->         326       0
>>>          401 <----------         0         0         0         325
>>>     REGISTER ---------->         0         0
>>>          200 <----------         0         0         0         0
>>>     REGISTER ---------->         0         0
>>>          401 <----------         0         0         0         0
>>>     REGISTER ---------->         0         0
>>>          200 <----------         0         0         0         0
>>>        Pause [     4:50]         0                             0
>>>     REGISTER ---------->  B-RTD1 0         0
>>>          200 <----------  E-RTD1 0         0         0         0
>>>     REGISTER ---------->  B-RTD1 0         0
>>>          200 <----------  E-RTD1 0         0         0         0
>>>        Pause [     4:50]         0                             0
>>>        Pause [$pre_call_delay]   0                             0
>>>       INVITE ---------->  B-RTD2 0         0
>>>          100 <----------         0         0         0         0
>>>       INVITE <----------         0         0         0         0
>>>          100 <----------         0         0         0         0
>>>       INVITE <----------         0         0         0         0
>>>          100 ---------->         0         0
>>>          180 ---------->         0         0
>>>          180 <----------         0         0         0         0
>>>        Pause [   6000ms]         0                             0
>>>          200 ---------->         0         0
>>>          200 <----------         0         0         0         0
>>>          ACK ---------->         0         0
>>>          ACK <----------         0         0         0         0
>>>       UPDATE ---------->         0         0
>>>       UPDATE <----------         0         0         0         0
>>>          200 ---------->         0         0
>>>          200 <----------  E-RTD2 0         0         0         0
>>>        Pause [    24.0s]         0                             0
>>>          BYE ---------->  B-RTD3 0         0
>>>          BYE <----------         0         0         0         0
>>>          200 ---------->         0         0
>>>          200 <----------  E-RTD3 0         0         0         0
>>>        Pause [$post_call_delay]  0                             0
>>> ------- Waiting for active calls to end. Press [q] again to force exit.
>>> -------
>>> Last Error: Aborting call on unexpected message for Call-Id '1079-13729@
>>> ...
>>>
>>> However there is an unexpected message error at the end.
>>>
>>> Thanks
>>>
>>> Kosala
>>>
>>>
>>>
>>>
>>>
>>> On Wed, Aug 17, 2016 at 12:40 PM, Matt Williams (projectclearwater.org)
>>> <matt at projectclearwater.org> wrote:
>>>
>>> Kosala,
>>>
>>>
>>>
>>> They should log to /var/log/clearwater-sip-stress - in particular, the
>>> *.1.out file is a log of the output from sipp.  Do you see anything there?
>>>
>>>
>>>
>>> Matt
>>>
>>>
>>>
>>> *From:* Kosala [mailto:kosalayb at gmail.com]
>>> *Sent:* 17 August 2016 12:33
>>> *To:* Matt Williams (projectclearwater.org) <matt at projectclearwater.org>;
>>> clearwater at lists.projectclearwater.org
>>>
>>>
>>> *Subject:* Re: [Project Clearwater] Clearwater Digest, Vol 40, Issue 24
>>>
>>>
>>>
>>> Hi Matt,
>>>
>>> I followed above steps and run sudo apt-get install
>>> clearwater-sip-stress.
>>>
>>> How do I know stress tests are running? Is is said, stress tests start
>>> automatically but I cannot see it.
>>>
>>> Thanks
>>>
>>> Kosala
>>>
>>>
>>>
>>>
>>>
>>>
>>> On Tue, Aug 16, 2016 at 2:01 PM, Matt Williams (projectclearwater.org) <
>>> matt at projectclearwater.org> wrote:
>>>
>>> Kosala,
>>>
>>>
>>>
>>> I'm glad you've made progress on this.
>>>
>>>
>>>
>>> I had a look at the crest package version, but it seems to be later than
>>> the most recent all-in-one image uses (1.0-160811.103635).  When did you
>>> download the all-in-one image, and did you apply any patches to it?
>>>
>>>
>>>
>>> Regarding making calls for stress testing, this is where
>>> http://clearwater.readthedocs.io/en/latest/Clearwater_stress
>>> _testing.html#manual-i-e-non-chef-stress-runs comes in - you need to
>>>
>>> ?         create a separate VM
>>>
>>> ?         set the bono_hostname and count parameters in
>>> /etc/clearwater/shared_config
>>>
>>> ?         install the clearwater-sip-stress package.
>>>
>>> I hope that helps.
>>>
>>>
>>>
>>> BTW, please remember to copy in clearwater at lists.projectclearwater.org
>>> - that means that other people can see and comment on your posts.
>>>
>>>
>>>
>>> Thanks,
>>>
>>>
>>>
>>> Matt
>>>
>>>
>>>
>>>
>>>
>>> *From:* Kosala [mailto:kosalayb at gmail.com]
>>> *Sent:* 16 August 2016 10:48
>>> *To:* Matt Williams (projectclearwater.org) <matt at projectclearwater.org>
>>>
>>> *Subject:* Re: [Project Clearwater] Clearwater Digest, Vol 40, Issue 24
>>>
>>>
>>>
>>> Hi Matt,
>>>
>>> Bulk provisioning for all in one image is done using
>>> https://github.com/Metaswitch/crest/blob/dev/docs/Bulk-Provi
>>> sioning%20Numbers.md.
>>>
>>> I have records in tables in homestead_cache and homer.
>>>
>>> Now How to make calls for stress testing?
>>>
>>> Is there any guideline?
>>>
>>> Many Thanks,
>>>
>>> Kosala
>>>
>>>
>>>
>>>
>>>
>>>
>>>
>>>
>>>
>>> On Tue, Aug 16, 2016 at 9:04 AM, Kosala <kosalayb at gmail.com> wrote:
>>>
>>> Hi Matt,
>>>
>>> TBH, The document in https://github.com/Metaswitch/
>>> crest/blob/dev/docs/Bulk-Provisioning%20Numbers.md is not clear to me.
>>>
>>> Step 1. Homestead node in deployment. I do not know where is that node
>>> in all in one image. It will be helpful the location of that folder from
>>> the root.
>>>
>>> Step 2. A simple example will be helpful.
>>>
>>> Thanks
>>>
>>> Kosala
>>>
>>>
>>>
>>>
>>>
>>> On Tue, Aug 16, 2016 at 8:50 AM, Kosala <kosalayb at gmail.com> wrote:
>>>
>>> Hi Matt,
>>>
>>> I downloaded the all in one package from http://clearwater.readthedocs.
>>> io/en/stable/All_in_one_OVF_Installation.html
>>>
>>> and imported using oracle virtual box on ubuntu 14.04,
>>>
>>> Crest version
>>>
>>> [cw-aio]ubuntu at cwaio:~$ sudo dpkg-query -s crest
>>> Package: crest
>>> Status: install ok installed
>>> Priority: optional
>>> Section: network
>>> Installed-Size: 40098
>>> Maintainer: Project Clearwater Maintainers <
>>> maintainers at projectclearwater.org>
>>> Architecture: amd64
>>> Version: 1.0-160815.145007
>>>
>>> Thanks
>>>
>>> Kosala
>>>
>>>
>>>
>>>
>>>
>>> On Mon, Aug 15, 2016 at 5:56 PM, Matt Williams (projectclearwater.org) <
>>> matt at projectclearwater.org> wrote:
>>>
>>> Kosala,
>>>
>>>
>>>
>>> That's odd - I don't see that failure on my all-in-one image (spun up
>>> just now from the latest image) - which version of all-in-one-image are you
>>> running, and which version of crest does it include ("sudo dpkg-query -s
>>> crest")?
>>>
>>>
>>>
>>> You may be able to work-around this either by taking the latest
>>> all-in-one image or by following the simpler bulk-provisioning process at
>>> https://github.com/Metaswitch/crest/blob/dev/docs/Bulk-Provi
>>> sioning%20Numbers.md (when this doc talks about using the
>>> sstables_provisioning process for very large sets of numbers, we mean 1M+
>>> numbers - the 9000 you're provisioning are well within the capabilities of
>>> this process).
>>>
>>>
>>>
>>> I hope that helps - please let me know how you get on.
>>>
>>>
>>>
>>> Cheers,
>>>
>>>
>>>
>>> Matt
>>>
>>>
>>>
>>>
>>>
>>> *From:* Clearwater [mailto:clearwater-bounces at lis
>>> ts.projectclearwater.org] *On Behalf Of *Kosala
>>> *Sent:* 15 August 2016 16:58
>>> *To:* clearwater at lists.projectclearwater.org
>>> *Subject:* Re: [Project Clearwater] Clearwater Digest, Vol 40, Issue 24
>>>
>>>
>>>
>>> HI Matt,
>>>
>>> Thanks.
>>>
>>>
>>> I am trying to follow https://github.com/Metaswitch/
>>> crest/blob/dev/src/metaswitch/crest/tools/sstable_provisioning/README.md
>>> for bulk provisioning.
>>>
>>>
>>> When I am trying to execute sudo ./BulkProvision homer 21000 29999
>>> example.com 7kkzTyGW in all-in-one image,
>>> I am getting an error  java.lang.UnsupportedClassVersionError:
>>> ClearwaterBulkProvisioner : Unsupported major.minor version 52.0
>>>
>>> Java version info in all-in-one image:
>>> [cw-aio]ubuntu at cwaio:/usr/share/clearwater/crest/tools/sstable_provisioning$
>>> java -version
>>> java version "1.7.0_101"
>>> OpenJDK Runtime Environment (IcedTea 2.6.6)
>>> (7u101-2.6.6-0ubuntu0.14.04.1)
>>> OpenJDK 64-Bit Server VM (build 24.95-b01, mixed mode)
>>>
>>> Thanks
>>>
>>> Kosala
>>>
>>>
>>>
>>>
>>>
>>>
>>> On Mon, Aug 15, 2016 at 2:17 PM, <clearwater-request at lists.proj
>>> ectclearwater.org> wrote:
>>>
>>> Send Clearwater mailing list submissions to
>>>         clearwater at lists.projectclearwater.org
>>>
>>> To subscribe or unsubscribe via the World Wide Web, visit
>>>         http://lists.projectclearwater.org/mailman/listinfo/clearwat
>>> er_lists.projectclearwater.org
>>>
>>> or, via email, send a message with subject or body 'help' to
>>>         clearwater-request at lists.projectclearwater.org
>>>
>>> You can reach the person managing the list at
>>>         clearwater-owner at lists.projectclearwater.org
>>>
>>> When replying, please edit your Subject line so it is more specific
>>> than "Re: Contents of Clearwater digest..."
>>>
>>>
>>> Today's Topics:
>>>
>>>    1. Stress Testing (Kosala)
>>>    2. Re: Stress Testing (Matt Williams (projectclearwater.org))
>>>    3. Re: Stress Testing (Matt Williams (projectclearwater.org))
>>>
>>>
>>> ----------------------------------------------------------------------
>>>
>>> Message: 1
>>> Date: Mon, 15 Aug 2016 10:38:57 +0100
>>> From: Kosala <kosalayb at gmail.com>
>>> To: clearwater at lists.projectclearwater.org
>>> Subject: [Project Clearwater] Stress Testing
>>> Message-ID:
>>>         <CAGEe17an2B_bGj8NfKFwms+nU=vJURyhT5CE+mcY1pjcm4YF+A at mail.gm
>>> ail.com>
>>> Content-Type: text/plain; charset="utf-8"
>>>
>>> Hi Team,
>>>
>>> I installed clearwater "all-in-one" image on Oracle Virtual Box.
>>> 1. Can I do stress testing ?
>>> 2. How to do that?
>>>
>>> I am trying to follow Stress Testing on
>>> http://clearwater.readthedocs.io/en/stable/Clearwater_stress
>>> _testing.html#configuring-udp-stress
>>> .
>>>
>>> Using chef - > It seems chef/knife install only supports in the Cloud
>>> approach (The automated install is only supported for deployments running
>>> in Amazon?s EC2 cloud).
>>>
>>> Manual approach, It looks not supporting all in one image.
>>>
>>> Many Thanks
>>> Kosala
>>> -------------- next part --------------
>>> An HTML attachment was scrubbed...
>>> URL: <http://lists.projectclearwater.org/pipermail/clearwater_lis
>>> ts.projectclearwater.org/attachments/20160815/15fc3b07/attac
>>> hment-0001.html>
>>>
>>> ------------------------------
>>>
>>> Message: 2
>>> Date: Mon, 15 Aug 2016 09:54:02 +0000
>>> From: "Matt Williams (projectclearwater.org)"
>>>         <matt at projectclearwater.org>
>>> To: Kosala <kosalayb at gmail.com>
>>> Cc: "clearwater at lists.projectclearwater.org"
>>>         <clearwater at lists.projectclearwater.org>
>>> Subject: Re: [Project Clearwater] Stress Testing
>>> Message-ID:
>>>         <CY1PR0201MB15636F1F20EB91BB180F053390120 at CY1PR0201MB1563.na
>>> mprd02.prod.outlook.com>
>>>
>>> Content-Type: text/plain; charset="utf-8"
>>>
>>> Kosala,
>>>
>>> While it's theoretically possible to do stress testing against an
>>> all-in-one image, I'd recommend against it - the all-in-one image has been
>>> squeezed down a lot to fit on a single VM and we'd expect very low
>>> performance out of it, and I could believe that overload behavior might be
>>> suboptimal.  If you're looking to stress test for performance reasons, I'd
>>> strongly recommend running a full deployment as this will give you much
>>> more reliable numbers.  If you're looking to stress test for other reasons,
>>> please can you share a bit more about what you're trying to achieve, and we
>>> can have a think about what would work best?
>>>
>>> If you do really want to run stress testing against an all-in-one image,
>>> it should probably work, even though http://clearwater.readthedocs.
>>> io/en/latest/Clearwater_stress_testing.html#manual-i-e-non-c
>>> hef-stress-runs only talks about Chef and manual installs.  You'd need
>>> to set the "bono_servers" option in /etc/clearwater/shared_config to point
>>> to your all-in-one node, and I suspect you'd need to reduce the "count"
>>> option to something a lot lower - I'd start around 5000 and see how that
>>> goes.
>>>
>>> I hope that helps.  Please let me know how you get on.
>>>
>>> Thanks,
>>>
>>> Matt
>>>
>>> From: Clearwater [mailto:clearwater-bounces at lists.projectclearwater.org]
>>> On Behalf Of Kosala
>>> Sent: 15 August 2016 10:39
>>> To: clearwater at lists.projectclearwater.org
>>> Subject: [Project Clearwater] Stress Testing
>>>
>>> Hi Team,
>>> I installed clearwater "all-in-one" image on Oracle Virtual Box.
>>> 1. Can I do stress testing ?
>>> 2. How to do that?
>>> I am trying to follow Stress Testing on http://clearwater.readthedocs.
>>> io/en/stable/Clearwater_stress_testing.html#configuring-udp-stress.
>>> Using chef - > It seems chef/knife install only supports in the Cloud
>>> approach (The automated install is only supported for deployments running
>>> in Amazon?s EC2 cloud).
>>> Manual approach, It looks not supporting all in one image.
>>> Many Thanks
>>> Kosala
>>>
>>> -------------- next part --------------
>>> An HTML attachment was scrubbed...
>>> URL: <http://lists.projectclearwater.org/pipermail/clearwater_lis
>>> ts.projectclearwater.org/attachments/20160815/29d6328d/attac
>>> hment-0001.html>
>>>
>>> ------------------------------
>>>
>>> Message: 3
>>> Date: Mon, 15 Aug 2016 13:16:47 +0000
>>> From: "Matt Williams (projectclearwater.org)"
>>>         <matt at projectclearwater.org>
>>> To: "clearwater at lists.projectclearwater.org"
>>>         <clearwater at lists.projectclearwater.org>
>>> Subject: Re: [Project Clearwater] Stress Testing
>>> Message-ID:
>>>         <CY1PR0201MB156372246DC5A77B11839F9D90120 at CY1PR0201MB1563.na
>>> mprd02.prod.outlook.com>
>>>
>>> Content-Type: text/plain; charset="utf-8"
>>>
>>> Kosala,
>>>
>>> You'll need to follow all the steps in http://clearwater.readthedocs.
>>> io/en/latest/Clearwater_stress_testing.html#manual-i-e-non-c
>>> hef-stress-runs, i.e. bulk provisioning subscribers and installing
>>> clearwater-sip-stress, but that should be it.
>>>
>>> Just to be clear, though, you'll need to set the configuration and
>>> install the clearwater-sip-stress package on a separate VM, not on the
>>> all-in-one image itself - the all-in-one image almost certainly opens up
>>> ports that conflict with those that clearwater-sip-stress tries to use.
>>>
>>> This isn't a very well-trodden path, though, so you may hit further
>>> issues - let me know if so, and we can try to work through them.
>>>
>>> Cheers,
>>>
>>> Matt
>>>
>>> From: Kosala [mailto:kosalayb at gmail.com]
>>> Sent: 15 August 2016 13:41
>>> To: Matt Williams (projectclearwater.org) <matt at projectclearwater.org>
>>> Subject: Re: [Project Clearwater] Stress Testing
>>>
>>> Hi Matt,
>>> Thanks. I set the bono_servers option. Should I add count =5000 to
>>> /etc/clearwater/shared_config ?
>>>
>>> Do I need other changes to run stress tests on all-in-one image?
>>> Thanks
>>> Kosala
>>>
>>>
>>>
>>> On Mon, Aug 15, 2016 at 10:54 AM, Matt Williams (projectclearwater.org<
>>> http://projectclearwater.org>) <matt at projectclearwater.org<mailto:
>>> matt at projectclearwater.org>> wrote:
>>> Kosala,
>>>
>>> While it's theoretically possible to do stress testing against an
>>> all-in-one image, I'd recommend against it - the all-in-one image has been
>>> squeezed down a lot to fit on a single VM and we'd expect very low
>>> performance out of it, and I could believe that overload behavior might be
>>> suboptimal.  If you're looking to stress test for performance reasons, I'd
>>> strongly recommend running a full deployment as this will give you much
>>> more reliable numbers.  If you're looking to stress test for other reasons,
>>> please can you share a bit more about what you're trying to achieve, and we
>>> can have a think about what would work best?
>>>
>>> If you do really want to run stress testing against an all-in-one image,
>>> it should probably work, even though http://clearwater.readthedocs.
>>> io/en/latest/Clearwater_stress_testing.html#manual-i-e-non-c
>>> hef-stress-runs only talks about Chef and manual installs.  You'd need
>>> to set the "bono_servers" option in /etc/clearwater/shared_config to point
>>> to your all-in-one node, and I suspect you'd need to reduce the "count"
>>> option to something a lot lower - I'd start around 5000 and see how that
>>> goes.
>>>
>>> I hope that helps.  Please let me know how you get on.
>>>
>>> Thanks,
>>>
>>> Matt
>>>
>>> From: Clearwater [mailto:clearwater-bounces at lists.projectclearwater.org
>>> <mailto:clearwater-bounces at lists.projectclearwater.org>] On Behalf Of
>>> Kosala
>>> Sent: 15 August 2016 10:39
>>> To: clearwater at lists.projectclearwater.org<mailto:clearwater at lis
>>> ts.projectclearwater.org>
>>> Subject: [Project Clearwater] Stress Testing
>>>
>>> Hi Team,
>>> I installed clearwater "all-in-one" image on Oracle Virtual Box.
>>> 1. Can I do stress testing ?
>>> 2. How to do that?
>>> I am trying to follow Stress Testing on http://clearwater.readthedocs.
>>> io/en/stable/Clearwater_stress_testing.html#configuring-udp-stress.
>>> Using chef - > It seems chef/knife install only supports in the Cloud
>>> approach (The automated install is only supported for deployments running
>>> in Amazon?s EC2 cloud).
>>> Manual approach, It looks not supporting all in one image.
>>> Many Thanks
>>> Kosala
>>>
>>>
>>> -------------- next part --------------
>>> An HTML attachment was scrubbed...
>>> URL: <http://lists.projectclearwater.org/pipermail/clearwater_lis
>>> ts.projectclearwater.org/attachments/20160815/11781755/attachment.html>
>>>
>>> ------------------------------
>>>
>>> Subject: Digest Footer
>>>
>>> _______________________________________________
>>> Clearwater mailing list
>>> Clearwater at lists.projectclearwater.org
>>> http://lists.projectclearwater.org/mailman/listinfo/clearwat
>>> er_lists.projectclearwater.org
>>>
>>>
>>> ------------------------------
>>>
>>> End of Clearwater Digest, Vol 40, Issue 24
>>> ******************************************
>>>
>>>
>>>
>>>
>>>
>>>
>>>
>>>
>>>
>>>
>>>
>>>
>>>
>>>
>>>
>>
>>
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.projectclearwater.org/pipermail/clearwater_lists.projectclearwater.org/attachments/20160817/7e54b4d3/attachment.html>

From richard.whitehouse at projectclearwater.org  Wed Aug 17 10:56:18 2016
From: richard.whitehouse at projectclearwater.org (Richard Whitehouse (projectclearwater.org))
Date: Wed, 17 Aug 2016 14:56:18 +0000
Subject: [Project Clearwater] Too many hops error
In-Reply-To: <44984089.13384646.1471032726071.JavaMail.yahoo@mail.yahoo.com>
References: <44984089.13384646.1471032726071.JavaMail.yahoo.ref@mail.yahoo.com>
	<44984089.13384646.1471032726071.JavaMail.yahoo@mail.yahoo.com>
Message-ID: <BY2PR0201MB18162F0799B0DAE756A3E68CF0140@BY2PR0201MB1816.namprd02.prod.outlook.com>

Vijay,

Too many hops errors are normally a result of a loop, so you probably want to trace a SIP message through the system to see where it?s being routed. You should be able to do this by increasing the log level on the Sprout and Bono nodes, and then looking for the messages in the logs. Alternatively, you can capture the messages in a packet capture using TCP dump if they are being routed between Sprout and Bono, and then viewing it in Wireshark.

The maximum hop count isn?t a configuration option ? instead it?s provided by the SIP endpoint on the ?Max-Forwards? header. If it?s not set, it?ll be defaulted to 70, as per the SIP RFC ? see section 16.6, step 3 https://tools.ietf.org/html/rfc3261#section-16.6.

Cheers,

Richard

From: Clearwater [mailto:clearwater-bounces at lists.projectclearwater.org] On Behalf Of Vijay
Sent: 12 August 2016 21:12
To: clearwater at lists.projectclearwater.org
Subject: [Project Clearwater] Too many hops error


Hello,
I am using Kubernetes to deploy clearwater. I have scscf.sprout kubernetes service created. In bono and sprout /etc/clearwater/shared_config, for upstream_hostname,  if I use the full address of the service, I get "too many Hop"s error when the clients try to register. I had to replace that by ip address of the container (which may change if it crashes or restarts). Is there a way to set the hop count or any other configuration settings?
Thanks!
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.projectclearwater.org/pipermail/clearwater_lists.projectclearwater.org/attachments/20160817/418cd419/attachment.html>

From matt at projectclearwater.org  Wed Aug 17 13:15:04 2016
From: matt at projectclearwater.org (Matt Williams (projectclearwater.org))
Date: Wed, 17 Aug 2016 17:15:04 +0000
Subject: [Project Clearwater] Clearwater Digest, Vol 40, Issue 24
In-Reply-To: <CAGEe17YUpkEQx6G6MJTeWJQW0Af9a8AxZ+9c7Odn-9vAtd3kbg@mail.gmail.com>
References: <mailman.20.1471267072.11502.clearwater_lists.projectclearwater.org@lists.projectclearwater.org>
	<CAGEe17ZLnypQfbzxEwxj9EaB20MUBVpY+YdN-Obv=gHpZmG0KA@mail.gmail.com>
	<CY1PR0201MB1563F9A706F3EC7BE7F9C11590120@CY1PR0201MB1563.namprd02.prod.outlook.com>
	<CAGEe17bfTu1Kpwx=ipqtEbShvWtP+C6pJEEGHi0GSwBR5Dqw8w@mail.gmail.com>
	<CAGEe17aY077tLtotRe1X8k1qU_4otBdHDMJjqDH_g02Zs676Jg@mail.gmail.com>
	<CAGEe17ZeNPPy7AmMz=LCWnHqLm=v9Q7CuLT+AOVKWJTdg8m7Eg@mail.gmail.com>
	<CY1PR0201MB1563CE17983225B985B19D7390130@CY1PR0201MB1563.namprd02.prod.outlook.com>
	<CAGEe17b2M2uqvbOuqH7t4xM41FbfBYk0xR3zWqiFh+EkSfUzUQ@mail.gmail.com>
	<CY1PR0201MB1563CD5DDDD6E7B5A0B2DB7290140@CY1PR0201MB1563.namprd02.prod.outlook.com>
	<CAGEe17YGnaY1Kqc65gyiVO1sBBuTx=-YzfD9HY3M6QBD2t9AkA@mail.gmail.com>
	<CAGEe17aRR+Uj8t+vRWss4pK-mcQALBr2m=wLNc6KHsdXV-CXbA@mail.gmail.com>
	<CY1PR0201MB15639E8995C94D18E7B85EE590140@CY1PR0201MB1563.namprd02.prod.outlook.com>
	<CAGEe17bF5oKWGOV36aCb=4PxR69HLzgqNJYGioFxP=P6XJoqDw@mail.gmail.com>
	<CAGEe17ZQtTqfn8D7nO7M8jv4CAL5jzMunGZLg8Z0_9Shw-Uttg@mail.gmail.com>
	<CAGEe17YUpkEQx6G6MJTeWJQW0Af9a8AxZ+9c7Odn-9vAtd3kbg@mail.gmail.com>
Message-ID: <CY1PR0201MB1563DC552C1777E42BD485C890140@CY1PR0201MB1563.namprd02.prod.outlook.com>

Kosala,

The To and From headers should be the same - this is a REGISTER message.  (So this isn't the problem with the message you pulled out below.)  If you're not familiar with SIP, it might be worth reading up on it - the definitive resource is RFC 3261 (https://www.ietf.org/rfc/rfc3261.txt) but there might be easier-to-get-started primers available on the Internet.

Are you able to register and make calls manually (without stress)?  See http://clearwater.readthedocs.io/en/latest/Making_your_first_call.html for details.  If not, you should troubleshoot that first, before trying to ramp up stress - it will be much easier.

As described in http://clearwater.readthedocs.io/en/latest/Troubleshooting_and_Recovery.html, you can enable finer-grain diagnostics on your Bono and Sprout nodes, which should give you more detail than the one-line error reports you're currently seeing.

I hope that helps.

Matt

From: Kosala [mailto:kosalayb at gmail.com]
Sent: 17 August 2016 16:09
To: Matt Williams (projectclearwater.org) <matt at projectclearwater.org>; clearwater at lists.projectclearwater.org
Subject: Re: [Project Clearwater] Clearwater Digest, Vol 40, Issue 24

And the other thing, I noticed is From id and To id are same in errors found in sip-stress_543_errors.log

2016-08-17      14:53:21:255    1471445601.255900: Aborting call on unexpected message for Call-Id '1317-543 at 10.0.22.193<mailto:1317-543 at 10.0.22.193>': while expecting '401' (index 3), received 'SIP/2.0 404 Not Found^M
Via: SIP/2.0/TCP 10.0.22.193:5060;rport=47138;received=10.0.22.193;branch=z9hG4bK-543-1317-2-2010002366-^M
Record-Route: <sip:scscf.cwaio:5054;transport=TCP;lr;service=scscf;billing-role=charge-orig>^M
Call-ID: 2010002366///1317-543 at 10.0.22.193<mailto:1317-543 at 10.0.22.193>^M
From: <sip:2010002366 at example.com<mailto:sip%3A2010002366 at example.com>>;tag=543SIPpTag001317^M
To: <sip:2010002366 at example.com<mailto:sip%3A2010002366 at example.com>>;tag=z9hG4bKPj3jbAiJfr3TrTlzsuq4n3J8VVGdfeCFNX^M
CSeq: 1 REGISTER^M
Content-Length:  0^M

Is this the issu?
Thanks
Kosala

On Wed, Aug 17, 2016 at 4:01 PM, Kosala <kosalayb at gmail.com<mailto:kosalayb at gmail.com>> wrote:
Sorry  I could not add error log (sip-stress_543_errors.log). This is as below:

sipp: The following events occured:
2016-08-17      14:53:20:985    1471445600.985925: Aborting call on unexpected message for Call-Id '954-543 at 10.0.22.193<mailto:954-543 at 10.0.22.193>': while expecting '401' (index 3), received 'SIP/2.0 404 Not Found^M
Via: SIP/2.0/TCP 10.0.22.193:5060;rport=47137;received=10.0.22.193;branch=z9hG4bK-543-954-2-2010003092-^M
Record-Route: <sip:scscf.cwaio:5054;transport=TCP;lr;service=scscf;billing-role=charge-orig>^M
Call-ID: 2010003092///954-543 at 10.0.22.193<mailto:954-543 at 10.0.22.193>^M
From: <sip:2010003092 at example.com<mailto:sip%3A2010003092 at example.com>>;tag=543SIPpTag00954^M
To: <sip:2010003092 at example.com<mailto:sip%3A2010003092 at example.com>>;tag=z9hG4bKPjbzBKmCQaMJKB5als7O2r1RyzYp37C91d^M
CSeq: 1 REGISTER^M
Content-Length:  0^M
^M
'.
2016-08-17      14:53:21:255    1471445601.255900: Aborting call on unexpected message for Call-Id '1317-543 at 10.0.22.193<mailto:1317-543 at 10.0.22.193>': while expecting '401' (index 3), received 'SIP/2.0 404 Not Found^M
Via: SIP/2.0/TCP 10.0.22.193:5060;rport=47138;received=10.0.22.193;branch=z9hG4bK-543-1317-2-2010002366-^M
Record-Route: <sip:scscf.cwaio:5054;transport=TCP;lr;service=scscf;billing-role=charge-orig>^M
Call-ID: 2010002366///1317-543 at 10.0.22.193<mailto:1317-543 at 10.0.22.193>^M
From: <sip:2010002366 at example.com<mailto:sip%3A2010002366 at example.com>>;tag=543SIPpTag001317^M
To: <sip:2010002366 at example.com<mailto:sip%3A2010002366 at example.com>>;tag=z9hG4bKPj3jbAiJfr3TrTlzsuq4n3J8VVGdfeCFNX^M
CSeq: 1 REGISTER^M
Content-Length:  0^M

...
Thanks
Kosala


On Wed, Aug 17, 2016 at 3:54 PM, Kosala <kosalayb at gmail.com<mailto:kosalayb at gmail.com>> wrote:
Hi Matt,
 I changed the provisioning range as 2010000000-2010000999.
However, I am still getting this error " unexpected message for Call-Id .."

Last Error: Aborting call on unexpected message for Call-Id '2467-27374 at ...^M
^[[2J------------------------------ Scenario Screen -------- [1-9]: Change Screen --^M
     Users (length)   Port   Total-time  Total-calls  Remote-host^M
        2500 (0 ms)   5060     384.70 s         2500  10.0.21.192:5060(TCP)^M
^M
  Call limit reached (-m 2500), 1.001 s period  1 ms scheduler resolution^M
  919 calls (limit 2500)                 Peak was 2500 calls, after 0 s^M
  0 Running, 921 Paused, 7 Woken up^M
  0 dead call msg (discarded)            0 out-of-call msg (discarded)        ^M
  2 open sockets                        ^M
^M
                                 Messages  Retrans   Timeout   Unexpected-Msg^M
       Pause [0ms/10:00]         2500                          0        ^M
    REGISTER ---------->         1581      0                            ^M
         401 <----------         0         0         0         1581     ^M
    REGISTER ---------->         0         0                            ^M
         200 <----------         0         0         0         0        ^M
    REGISTER ---------->         0         0                            ^M
         401 <----------         0         0         0         0        ^M
    REGISTER ---------->         0         0                            ^M
         200 <----------         0         0         0         0        ^M
       Pause [     4:50]         0                             0        ^M
    REGISTER ---------->  B-RTD1 0         0                            ^M
         200 <----------  E-RTD1 0         0         0         0        ^M
    REGISTER ---------->  B-RTD1 0         0                            ^M
         200 <----------  E-RTD1 0         0         0         0        ^M
       Pause [     4:50]         0                             0        ^M
       Pause [$pre_call_delay]   0                             0        ^M
      INVITE ---------->  B-RTD2 0         0                            ^M
         100 <----------         0         0         0         0        ^M
      INVITE <----------         0         0         0         0        ^M
         100 <----------         0         0         0         0        ^M
      INVITE <----------         0         0         0         0        ^M
         100 ---------->         0         0                            ^M
         180 ---------->         0         0                            ^M
         180 <----------         0         0         0         0        ^M
       Pause [   6000ms]         0                             0        ^M
         200 ---------->         0         0                            ^M
         200 <----------         0         0         0         0        ^M
         ACK ---------->         0         0                            ^M
         ACK <----------         0         0         0         0        ^M
      UPDATE ---------->         0         0                            ^M
      UPDATE <----------         0         0         0         0        ^M
         200 ---------->         0         0                            ^M
         200 <----------  E-RTD2 0         0         0         0        ^M
       Pause [    24.0s]         0                             0        ^M
         BYE ---------->  B-RTD3 0         0                            ^M
         BYE <----------         0         0         0         0        ^M
         200 ---------->         0         0                            ^M
         200 <----------  E-RTD3 0         0         0         0        ^M
       Pause [$post_call_delay]  0                             0        ^M
------- Waiting for active calls to end. Press [q] again to force exit. -------^M
^M
Last Error: Aborting call on unexpected message for Call-Id '2216-27374 at ...^M

Any advice is appreciated.
Kosala

On Wed, Aug 17, 2016 at 2:40 PM, Matt Williams (projectclearwater.org<http://projectclearwater.org>) <matt at projectclearwater.org<mailto:matt at projectclearwater.org>> wrote:
Kosala,

OK, so this says that the subscriber you're trying to register as can't be found.

The stress nodes will by default use DNs from 201000000 onwards.  What numbers did you provision?

The docs (https://github.com/Metaswitch/crest/blob/dev/docs/Bulk-Provisioning%20Numbers.md) recommend provisioning 2010000000-2010099999.  However, I recall you trying to run "sudo ./BulkProvision homer 21000 29999 example.com<http://example.com> 7kkzTyGW", which would only provision the numbers 21000-29999.  Maybe there's a mismatch here?

Matt

--

Matt Williams
Lead Architect, Project Clearwater
+44 (0) 20 8366 1177<tel:%2B44%20%280%29%2020%208366%201177>

From: Kosala [mailto:kosalayb at gmail.com<mailto:kosalayb at gmail.com>]
Sent: 17 August 2016 14:34

To: Matt Williams (projectclearwater.org<http://projectclearwater.org>) <matt at projectclearwater.org<mailto:matt at projectclearwater.org>>
Subject: Re: [Project Clearwater] Clearwater Digest, Vol 40, Issue 24

I am getting followings in sip-stress_18438_errors.log:

2016-08-17      12:26:26:258    1471436786.258684: Aborting call on unexpected message for Call-Id '898-18438 at 10.0.22.193<mailto:898-18438 at 10.0.22.193>': while expecting '401' (index 3), received 'SIP/2.0 404 Not Found^M
Via: SIP/2.0/TCP 10.0.22.193:5060;rport=8826;received=10.0.22.193;branch=z9hG4bK-18438-898-2-2010003204-^M
Record-Route: <sip:scscf.cwaio:5054;transport=TCP;lr;service=scscf;billing-role=charge-orig>^M
Call-ID: 2010003204///898-18438 at 10.0.22.193<mailto:898-18438 at 10.0.22.193>^M
From: <sip:2010003204 at example.com<mailto:sip%3A2010003204 at example.com>>;tag=18438SIPpTag00898^M
To: <sip:2010003204 at example.com<mailto:sip%3A2010003204 at example.com>>;tag=z9hG4bKPjc1xOWCH0ooae6O9npl7fSSrQ-x0vmoV9^M
CSeq: 1 REGISTER^M
Content-Length:  0^M
Any advice is appreciated.
Many Thanks,
Kosala


On Wed, Aug 17, 2016 at 2:20 PM, Kosala <kosalayb at gmail.com<mailto:kosalayb at gmail.com>> wrote:
Hi Matt,
I can see this scenario screen from sip-stress.1.out. I hope this will be the stress test output results.

------------------------------ Scenario Screen -------- [1-9]: Change Screen --
     Users (length)   Port   Total-time  Total-calls  Remote-host
        2500 (0 ms)   5060      77.15 s         2500  10.0.21.192:5060(TCP)

  Call limit reached (-m 2500), 1.002 s period  1 ms scheduler resolution
  2175 calls (limit 2500)                Peak was 2499 calls, after 0 s
  0 Running, 2177 Paused, 8 Woken up
  0 dead call msg (discarded)            0 out-of-call msg (discarded)
  3 open sockets

                                 Messages  Retrans   Timeout   Unexpected-Msg
       Pause [0ms/10:00]         2500                          0
    REGISTER ---------->         326       0
         401 <----------         0         0         0         325
    REGISTER ---------->         0         0
         200 <----------         0         0         0         0
    REGISTER ---------->         0         0
         401 <----------         0         0         0         0
    REGISTER ---------->         0         0
         200 <----------         0         0         0         0
       Pause [     4:50]         0                             0
    REGISTER ---------->  B-RTD1 0         0
         200 <----------  E-RTD1 0         0         0         0
    REGISTER ---------->  B-RTD1 0         0
         200 <----------  E-RTD1 0         0         0         0
       Pause [     4:50]         0                             0
       Pause [$pre_call_delay]   0                             0
      INVITE ---------->  B-RTD2 0         0
         100 <----------         0         0         0         0
      INVITE <----------         0         0         0         0
         100 <----------         0         0         0         0
      INVITE <----------         0         0         0         0
         100 ---------->         0         0
         180 ---------->         0         0
         180 <----------         0         0         0         0
       Pause [   6000ms]         0                             0
         200 ---------->         0         0
         200 <----------         0         0         0         0
         ACK ---------->         0         0
         ACK <----------         0         0         0         0
      UPDATE ---------->         0         0
      UPDATE <----------         0         0         0         0
         200 ---------->         0         0
         200 <----------  E-RTD2 0         0         0         0
       Pause [    24.0s]         0                             0
         BYE ---------->  B-RTD3 0         0
         BYE <----------         0         0         0         0
         200 ---------->         0         0
         200 <----------  E-RTD3 0         0         0         0
       Pause [$post_call_delay]  0                             0
------- Waiting for active calls to end. Press [q] again to force exit. -------
Last Error: Aborting call on unexpected message for Call-Id '1079-13729 at ...
However there is an unexpected message error at the end.
Thanks
Kosala


On Wed, Aug 17, 2016 at 12:40 PM, Matt Williams (projectclearwater.org<http://projectclearwater.org>) <matt at projectclearwater.org<mailto:matt at projectclearwater.org>> wrote:
Kosala,

They should log to /var/log/clearwater-sip-stress - in particular, the *.1.out file is a log of the output from sipp.  Do you see anything there?

Matt

From: Kosala [mailto:kosalayb at gmail.com<mailto:kosalayb at gmail.com>]
Sent: 17 August 2016 12:33
To: Matt Williams (projectclearwater.org<http://projectclearwater.org>) <matt at projectclearwater.org<mailto:matt at projectclearwater.org>>; clearwater at lists.projectclearwater.org<mailto:clearwater at lists.projectclearwater.org>

Subject: Re: [Project Clearwater] Clearwater Digest, Vol 40, Issue 24

Hi Matt,
I followed above steps and run sudo apt-get install clearwater-sip-stress.
How do I know stress tests are running? Is is said, stress tests start automatically but I cannot see it.
Thanks
Kosala



On Tue, Aug 16, 2016 at 2:01 PM, Matt Williams (projectclearwater.org<http://projectclearwater.org>) <matt at projectclearwater.org<mailto:matt at projectclearwater.org>> wrote:
Kosala,

I'm glad you've made progress on this.

I had a look at the crest package version, but it seems to be later than the most recent all-in-one image uses (1.0-160811.103635).  When did you download the all-in-one image, and did you apply any patches to it?

Regarding making calls for stress testing, this is where http://clearwater.readthedocs.io/en/latest/Clearwater_stress_testing.html#manual-i-e-non-chef-stress-runs comes in - you need to

?         create a separate VM

?         set the bono_hostname and count parameters in /etc/clearwater/shared_config

?         install the clearwater-sip-stress package.
I hope that helps.

BTW, please remember to copy in clearwater at lists.projectclearwater.org<mailto:clearwater at lists.projectclearwater.org> - that means that other people can see and comment on your posts.

Thanks,

Matt


From: Kosala [mailto:kosalayb at gmail.com<mailto:kosalayb at gmail.com>]
Sent: 16 August 2016 10:48
To: Matt Williams (projectclearwater.org<http://projectclearwater.org>) <matt at projectclearwater.org<mailto:matt at projectclearwater.org>>
Subject: Re: [Project Clearwater] Clearwater Digest, Vol 40, Issue 24

Hi Matt,
Bulk provisioning for all in one image is done using https://github.com/Metaswitch/crest/blob/dev/docs/Bulk-Provisioning%20Numbers.md.
I have records in tables in homestead_cache and homer.
Now How to make calls for stress testing?
Is there any guideline?
Many Thanks,
Kosala




On Tue, Aug 16, 2016 at 9:04 AM, Kosala <kosalayb at gmail.com<mailto:kosalayb at gmail.com>> wrote:
Hi Matt,
TBH, The document in https://github.com/Metaswitch/crest/blob/dev/docs/Bulk-Provisioning%20Numbers.md is not clear to me.
Step 1. Homestead node in deployment. I do not know where is that node in all in one image. It will be helpful the location of that folder from the root.
Step 2. A simple example will be helpful.
Thanks
Kosala


On Tue, Aug 16, 2016 at 8:50 AM, Kosala <kosalayb at gmail.com<mailto:kosalayb at gmail.com>> wrote:
Hi Matt,
I downloaded the all in one package from http://clearwater.readthedocs.io/en/stable/All_in_one_OVF_Installation.html
and imported using oracle virtual box on ubuntu 14.04,
Crest version
[cw-aio]ubuntu at cwaio:~$ sudo dpkg-query -s crest
Package: crest
Status: install ok installed
Priority: optional
Section: network
Installed-Size: 40098
Maintainer: Project Clearwater Maintainers <maintainers at projectclearwater.org<mailto:maintainers at projectclearwater.org>>
Architecture: amd64
Version: 1.0-160815.145007
Thanks
Kosala


On Mon, Aug 15, 2016 at 5:56 PM, Matt Williams (projectclearwater.org<http://projectclearwater.org>) <matt at projectclearwater.org<mailto:matt at projectclearwater.org>> wrote:
Kosala,

That's odd - I don't see that failure on my all-in-one image (spun up just now from the latest image) - which version of all-in-one-image are you running, and which version of crest does it include ("sudo dpkg-query -s crest")?

You may be able to work-around this either by taking the latest all-in-one image or by following the simpler bulk-provisioning process at https://github.com/Metaswitch/crest/blob/dev/docs/Bulk-Provisioning%20Numbers.md (when this doc talks about using the sstables_provisioning process for very large sets of numbers, we mean 1M+ numbers - the 9000 you're provisioning are well within the capabilities of this process).

I hope that helps - please let me know how you get on.

Cheers,

Matt


From: Clearwater [mailto:clearwater-bounces at lists.projectclearwater.org<mailto:clearwater-bounces at lists.projectclearwater.org>] On Behalf Of Kosala
Sent: 15 August 2016 16:58
To: clearwater at lists.projectclearwater.org<mailto:clearwater at lists.projectclearwater.org>
Subject: Re: [Project Clearwater] Clearwater Digest, Vol 40, Issue 24

HI Matt,
Thanks.

I am trying to follow https://github.com/Metaswitch/crest/blob/dev/src/metaswitch/crest/tools/sstable_provisioning/README.md for bulk provisioning.

When I am trying to execute sudo ./BulkProvision homer 21000 29999 example.com<http://example.com> 7kkzTyGW in all-in-one image,
I am getting an error  java.lang.UnsupportedClassVersionError: ClearwaterBulkProvisioner : Unsupported major.minor version 52.0
Java version info in all-in-one image:
[cw-aio]ubuntu at cwaio:/usr/share/clearwater/crest/tools/sstable_provisioning$ java -version
java version "1.7.0_101"
OpenJDK Runtime Environment (IcedTea 2.6.6) (7u101-2.6.6-0ubuntu0.14.04.1)
OpenJDK 64-Bit Server VM (build 24.95-b01, mixed mode)
Thanks
Kosala



On Mon, Aug 15, 2016 at 2:17 PM, <clearwater-request at lists.projectclearwater.org<mailto:clearwater-request at lists.projectclearwater.org>> wrote:
Send Clearwater mailing list submissions to
        clearwater at lists.projectclearwater.org<mailto:clearwater at lists.projectclearwater.org>

To subscribe or unsubscribe via the World Wide Web, visit
        http://lists.projectclearwater.org/mailman/listinfo/clearwater_lists.projectclearwater.org

or, via email, send a message with subject or body 'help' to
        clearwater-request at lists.projectclearwater.org<mailto:clearwater-request at lists.projectclearwater.org>

You can reach the person managing the list at
        clearwater-owner at lists.projectclearwater.org<mailto:clearwater-owner at lists.projectclearwater.org>

When replying, please edit your Subject line so it is more specific
than "Re: Contents of Clearwater digest..."


Today's Topics:

   1. Stress Testing (Kosala)
   2. Re: Stress Testing (Matt Williams (projectclearwater.org<http://projectclearwater.org>))
   3. Re: Stress Testing (Matt Williams (projectclearwater.org<http://projectclearwater.org>))


----------------------------------------------------------------------

Message: 1
Date: Mon, 15 Aug 2016 10:38:57 +0100
From: Kosala <kosalayb at gmail.com<mailto:kosalayb at gmail.com>>
To: clearwater at lists.projectclearwater.org<mailto:clearwater at lists.projectclearwater.org>
Subject: [Project Clearwater] Stress Testing
Message-ID:
        <CAGEe17an2B_bGj8NfKFwms+nU=vJURyhT5CE+mcY1pjcm4YF+A at mail.gmail.com<mailto:vJURyhT5CE%2BmcY1pjcm4YF%2BA at mail.gmail.com>>
Content-Type: text/plain; charset="utf-8"

Hi Team,

I installed clearwater "all-in-one" image on Oracle Virtual Box.
1. Can I do stress testing ?
2. How to do that?

I am trying to follow Stress Testing on
http://clearwater.readthedocs.io/en/stable/Clearwater_stress_testing.html#configuring-udp-stress
.

Using chef - > It seems chef/knife install only supports in the Cloud
approach (The automated install is only supported for deployments running
in Amazon?s EC2 cloud).

Manual approach, It looks not supporting all in one image.

Many Thanks
Kosala
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.projectclearwater.org/pipermail/clearwater_lists.projectclearwater.org/attachments/20160815/15fc3b07/attachment-0001.html>

------------------------------

Message: 2
Date: Mon, 15 Aug 2016 09:54:02 +0000
From: "Matt Williams (projectclearwater.org<http://projectclearwater.org>)"
        <matt at projectclearwater.org<mailto:matt at projectclearwater.org>>
To: Kosala <kosalayb at gmail.com<mailto:kosalayb at gmail.com>>
Cc: "clearwater at lists.projectclearwater.org<mailto:clearwater at lists.projectclearwater.org>"
        <clearwater at lists.projectclearwater.org<mailto:clearwater at lists.projectclearwater.org>>
Subject: Re: [Project Clearwater] Stress Testing
Message-ID:
        <CY1PR0201MB15636F1F20EB91BB180F053390120 at CY1PR0201MB1563.namprd02.prod.outlook.com<mailto:CY1PR0201MB15636F1F20EB91BB180F053390120 at CY1PR0201MB1563.namprd02.prod.outlook.com>>

Content-Type: text/plain; charset="utf-8"

Kosala,

While it's theoretically possible to do stress testing against an all-in-one image, I'd recommend against it - the all-in-one image has been squeezed down a lot to fit on a single VM and we'd expect very low performance out of it, and I could believe that overload behavior might be suboptimal.  If you're looking to stress test for performance reasons, I'd strongly recommend running a full deployment as this will give you much more reliable numbers.  If you're looking to stress test for other reasons, please can you share a bit more about what you're trying to achieve, and we can have a think about what would work best?

If you do really want to run stress testing against an all-in-one image, it should probably work, even though http://clearwater.readthedocs.io/en/latest/Clearwater_stress_testing.html#manual-i-e-non-chef-stress-runs only talks about Chef and manual installs.  You'd need to set the "bono_servers" option in /etc/clearwater/shared_config to point to your all-in-one node, and I suspect you'd need to reduce the "count" option to something a lot lower - I'd start around 5000 and see how that goes.

I hope that helps.  Please let me know how you get on.

Thanks,

Matt

From: Clearwater [mailto:clearwater-bounces at lists.projectclearwater.org<mailto:clearwater-bounces at lists.projectclearwater.org>] On Behalf Of Kosala
Sent: 15 August 2016 10:39
To: clearwater at lists.projectclearwater.org<mailto:clearwater at lists.projectclearwater.org>
Subject: [Project Clearwater] Stress Testing

Hi Team,
I installed clearwater "all-in-one" image on Oracle Virtual Box.
1. Can I do stress testing ?
2. How to do that?
I am trying to follow Stress Testing on http://clearwater.readthedocs.io/en/stable/Clearwater_stress_testing.html#configuring-udp-stress.
Using chef - > It seems chef/knife install only supports in the Cloud approach (The automated install is only supported for deployments running in Amazon?s EC2 cloud).
Manual approach, It looks not supporting all in one image.
Many Thanks
Kosala

-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.projectclearwater.org/pipermail/clearwater_lists.projectclearwater.org/attachments/20160815/29d6328d/attachment-0001.html>

------------------------------

Message: 3
Date: Mon, 15 Aug 2016 13:16:47 +0000
From: "Matt Williams (projectclearwater.org<http://projectclearwater.org>)"
        <matt at projectclearwater.org<mailto:matt at projectclearwater.org>>
To: "clearwater at lists.projectclearwater.org<mailto:clearwater at lists.projectclearwater.org>"
        <clearwater at lists.projectclearwater.org<mailto:clearwater at lists.projectclearwater.org>>
Subject: Re: [Project Clearwater] Stress Testing
Message-ID:
        <CY1PR0201MB156372246DC5A77B11839F9D90120 at CY1PR0201MB1563.namprd02.prod.outlook.com<mailto:CY1PR0201MB156372246DC5A77B11839F9D90120 at CY1PR0201MB1563.namprd02.prod.outlook.com>>

Content-Type: text/plain; charset="utf-8"

Kosala,

You'll need to follow all the steps in http://clearwater.readthedocs.io/en/latest/Clearwater_stress_testing.html#manual-i-e-non-chef-stress-runs, i.e. bulk provisioning subscribers and installing clearwater-sip-stress, but that should be it.

Just to be clear, though, you'll need to set the configuration and install the clearwater-sip-stress package on a separate VM, not on the all-in-one image itself - the all-in-one image almost certainly opens up ports that conflict with those that clearwater-sip-stress tries to use.

This isn't a very well-trodden path, though, so you may hit further issues - let me know if so, and we can try to work through them.

Cheers,

Matt

From: Kosala [mailto:kosalayb at gmail.com<mailto:kosalayb at gmail.com>]
Sent: 15 August 2016 13:41
To: Matt Williams (projectclearwater.org<http://projectclearwater.org>) <matt at projectclearwater.org<mailto:matt at projectclearwater.org>>
Subject: Re: [Project Clearwater] Stress Testing

Hi Matt,
Thanks. I set the bono_servers option. Should I add count =5000 to /etc/clearwater/shared_config ?

Do I need other changes to run stress tests on all-in-one image?
Thanks
Kosala



On Mon, Aug 15, 2016 at 10:54 AM, Matt Williams (projectclearwater.org<http://projectclearwater.org><http://projectclearwater.org>) <matt at projectclearwater.org<mailto:matt at projectclearwater.org><mailto:matt at projectclearwater.org<mailto:matt at projectclearwater.org>>> wrote:
Kosala,

While it's theoretically possible to do stress testing against an all-in-one image, I'd recommend against it - the all-in-one image has been squeezed down a lot to fit on a single VM and we'd expect very low performance out of it, and I could believe that overload behavior might be suboptimal.  If you're looking to stress test for performance reasons, I'd strongly recommend running a full deployment as this will give you much more reliable numbers.  If you're looking to stress test for other reasons, please can you share a bit more about what you're trying to achieve, and we can have a think about what would work best?

If you do really want to run stress testing against an all-in-one image, it should probably work, even though http://clearwater.readthedocs.io/en/latest/Clearwater_stress_testing.html#manual-i-e-non-chef-stress-runs only talks about Chef and manual installs.  You'd need to set the "bono_servers" option in /etc/clearwater/shared_config to point to your all-in-one node, and I suspect you'd need to reduce the "count" option to something a lot lower - I'd start around 5000 and see how that goes.

I hope that helps.  Please let me know how you get on.

Thanks,

Matt

From: Clearwater [mailto:clearwater-bounces at lists.projectclearwater.org<mailto:clearwater-bounces at lists.projectclearwater.org><mailto:clearwater-bounces at lists.projectclearwater.org<mailto:clearwater-bounces at lists.projectclearwater.org>>] On Behalf Of Kosala
Sent: 15 August 2016 10:39
To: clearwater at lists.projectclearwater.org<mailto:clearwater at lists.projectclearwater.org><mailto:clearwater at lists.projectclearwater.org<mailto:clearwater at lists.projectclearwater.org>>
Subject: [Project Clearwater] Stress Testing

Hi Team,
I installed clearwater "all-in-one" image on Oracle Virtual Box.
1. Can I do stress testing ?
2. How to do that?
I am trying to follow Stress Testing on http://clearwater.readthedocs.io/en/stable/Clearwater_stress_testing.html#configuring-udp-stress.
Using chef - > It seems chef/knife install only supports in the Cloud approach (The automated install is only supported for deployments running in Amazon?s EC2 cloud).
Manual approach, It looks not supporting all in one image.
Many Thanks
Kosala


-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.projectclearwater.org/pipermail/clearwater_lists.projectclearwater.org/attachments/20160815/11781755/attachment.html>

------------------------------

Subject: Digest Footer

_______________________________________________
Clearwater mailing list
Clearwater at lists.projectclearwater.org<mailto:Clearwater at lists.projectclearwater.org>
http://lists.projectclearwater.org/mailman/listinfo/clearwater_lists.projectclearwater.org


------------------------------

End of Clearwater Digest, Vol 40, Issue 24
******************************************










-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.projectclearwater.org/pipermail/clearwater_lists.projectclearwater.org/attachments/20160817/4e1b95ab/attachment.html>

From kosalayb at gmail.com  Thu Aug 18 04:55:34 2016
From: kosalayb at gmail.com (Kosala)
Date: Thu, 18 Aug 2016 09:55:34 +0100
Subject: [Project Clearwater] Clearwater Digest, Vol 40, Issue 24
In-Reply-To: <CY1PR0201MB156349F26A0A7670BE7382A890140@CY1PR0201MB1563.namprd02.prod.outlook.com>
References: <mailman.20.1471267072.11502.clearwater_lists.projectclearwater.org@lists.projectclearwater.org>
	<CAGEe17ZLnypQfbzxEwxj9EaB20MUBVpY+YdN-Obv=gHpZmG0KA@mail.gmail.com>
	<CY1PR0201MB1563F9A706F3EC7BE7F9C11590120@CY1PR0201MB1563.namprd02.prod.outlook.com>
	<CAGEe17bfTu1Kpwx=ipqtEbShvWtP+C6pJEEGHi0GSwBR5Dqw8w@mail.gmail.com>
	<CAGEe17aY077tLtotRe1X8k1qU_4otBdHDMJjqDH_g02Zs676Jg@mail.gmail.com>
	<CAGEe17ZeNPPy7AmMz=LCWnHqLm=v9Q7CuLT+AOVKWJTdg8m7Eg@mail.gmail.com>
	<CY1PR0201MB1563CE17983225B985B19D7390130@CY1PR0201MB1563.namprd02.prod.outlook.com>
	<CAGEe17b2M2uqvbOuqH7t4xM41FbfBYk0xR3zWqiFh+EkSfUzUQ@mail.gmail.com>
	<CY1PR0201MB1563CD5DDDD6E7B5A0B2DB7290140@CY1PR0201MB1563.namprd02.prod.outlook.com>
	<CAGEe17YGnaY1Kqc65gyiVO1sBBuTx=-YzfD9HY3M6QBD2t9AkA@mail.gmail.com>
	<CY1PR0201MB156349F26A0A7670BE7382A890140@CY1PR0201MB1563.namprd02.prod.outlook.com>
Message-ID: <CAGEe17ZkY2ESNzwQYddrv6=jUJ5fPHu3gJXT7R1UjQmBd+eFUg@mail.gmail.com>

Hi Matt,

In SIP node, when I am trying to execute "sudo service
clearwater-sip-stress restart", I am getting an error

/etc/init.d/clearwater-infrastructure: 76:
/etc/init.d/clearwater-infrastructure:
/usr/share/clearwater/infrastructure/scripts/logging.bash: Permission denied
Configuring monit for only localhost access

Any clue about this error?

Thanks
Kosala


On Wed, Aug 17, 2016 at 2:29 PM, Matt Williams (projectclearwater.org) <
matt at projectclearwater.org> wrote:

> Kosala,
>
>
>
> Yes, that's the correct screen, and you're correct that it shows that
> stress is being attempted but failing.
>
>
>
> Do regular (non-stress) calls work through this deployment?
>
>
>
> You can look at what message the stress node is receiving in the log files
> in the /var/log/clearwater-sip-stress/ directory - I think there are
> "errors" logs that contain the unexpected messages.
>
>
>
> You can obviously also look at what's happening on the all-in-one node
> itself, using the /var/log/bono/*, /var/log/sprout/* and
> /var/log/homestead/* files, as described at http://clearwater.readthedocs.
> io/en/latest/Troubleshooting_and_Recovery.html.
>
>
>
> I hope that helps.
>
>
>
> Cheers,
>
>
>
> Matt
>
>
>
> *From:* Kosala [mailto:kosalayb at gmail.com]
> *Sent:* 17 August 2016 14:20
>
> *To:* Matt Williams (projectclearwater.org) <matt at projectclearwater.org>
> *Subject:* Re: [Project Clearwater] Clearwater Digest, Vol 40, Issue 24
>
>
>
> Hi Matt,
>
> I can see this scenario screen from sip-stress.1.out. I hope this will be
> the stress test output results.
>
>
> ------------------------------ Scenario Screen -------- [1-9]: Change
> Screen --
>      Users (length)   Port   Total-time  Total-calls  Remote-host
>         2500 (0 ms)   5060      77.15 s         2500  10.0.21.192:5060
> (TCP)
>
>   Call limit reached (-m 2500), 1.002 s period  1 ms scheduler resolution
>   2175 calls (limit 2500)                Peak was 2499 calls, after 0 s
>   0 Running, 2177 Paused, 8 Woken up
>   0 dead call msg (discarded)            0 out-of-call msg
> (discarded)
>   3 open sockets
>
>                                  Messages  Retrans   Timeout
> Unexpected-Msg
>        Pause [0ms/10:00]         2500                          0
>     REGISTER ---------->         326       0
>          401 <----------         0         0         0         325
>     REGISTER ---------->         0         0
>          200 <----------         0         0         0         0
>     REGISTER ---------->         0         0
>          401 <----------         0         0         0         0
>     REGISTER ---------->         0         0
>          200 <----------         0         0         0         0
>        Pause [     4:50]         0                             0
>     REGISTER ---------->  B-RTD1 0         0
>          200 <----------  E-RTD1 0         0         0         0
>     REGISTER ---------->  B-RTD1 0         0
>          200 <----------  E-RTD1 0         0         0         0
>        Pause [     4:50]         0                             0
>        Pause [$pre_call_delay]   0                             0
>       INVITE ---------->  B-RTD2 0         0
>          100 <----------         0         0         0         0
>       INVITE <----------         0         0         0         0
>          100 <----------         0         0         0         0
>       INVITE <----------         0         0         0         0
>          100 ---------->         0         0
>          180 ---------->         0         0
>          180 <----------         0         0         0         0
>        Pause [   6000ms]         0                             0
>          200 ---------->         0         0
>          200 <----------         0         0         0         0
>          ACK ---------->         0         0
>          ACK <----------         0         0         0         0
>       UPDATE ---------->         0         0
>       UPDATE <----------         0         0         0         0
>          200 ---------->         0         0
>          200 <----------  E-RTD2 0         0         0         0
>        Pause [    24.0s]         0                             0
>          BYE ---------->  B-RTD3 0         0
>          BYE <----------         0         0         0         0
>          200 ---------->         0         0
>          200 <----------  E-RTD3 0         0         0         0
>        Pause [$post_call_delay]  0                             0
> ------- Waiting for active calls to end. Press [q] again to force exit.
> -------
> Last Error: Aborting call on unexpected message for Call-Id '1079-13729@
> ...
>
> However there is an unexpected message error at the end.
>
> Thanks
>
> Kosala
>
>
>
>
>
> On Wed, Aug 17, 2016 at 12:40 PM, Matt Williams (projectclearwater.org) <
> matt at projectclearwater.org> wrote:
>
> Kosala,
>
>
>
> They should log to /var/log/clearwater-sip-stress - in particular, the
> *.1.out file is a log of the output from sipp.  Do you see anything there?
>
>
>
> Matt
>
>
>
> *From:* Kosala [mailto:kosalayb at gmail.com]
> *Sent:* 17 August 2016 12:33
> *To:* Matt Williams (projectclearwater.org) <matt at projectclearwater.org>;
> clearwater at lists.projectclearwater.org
>
>
> *Subject:* Re: [Project Clearwater] Clearwater Digest, Vol 40, Issue 24
>
>
>
> Hi Matt,
>
> I followed above steps and run sudo apt-get install clearwater-sip-stress.
>
> How do I know stress tests are running? Is is said, stress tests start
> automatically but I cannot see it.
>
> Thanks
>
> Kosala
>
>
>
>
>
>
> On Tue, Aug 16, 2016 at 2:01 PM, Matt Williams (projectclearwater.org) <
> matt at projectclearwater.org> wrote:
>
> Kosala,
>
>
>
> I'm glad you've made progress on this.
>
>
>
> I had a look at the crest package version, but it seems to be later than
> the most recent all-in-one image uses (1.0-160811.103635).  When did you
> download the all-in-one image, and did you apply any patches to it?
>
>
>
> Regarding making calls for stress testing, this is where
> http://clearwater.readthedocs.io/en/latest/Clearwater_
> stress_testing.html#manual-i-e-non-chef-stress-runs comes in - you need to
>
> ?         create a separate VM
>
> ?         set the bono_hostname and count parameters in
> /etc/clearwater/shared_config
>
> ?         install the clearwater-sip-stress package.
>
> I hope that helps.
>
>
>
> BTW, please remember to copy in clearwater at lists.projectclearwater.org -
> that means that other people can see and comment on your posts.
>
>
>
> Thanks,
>
>
>
> Matt
>
>
>
>
>
> *From:* Kosala [mailto:kosalayb at gmail.com]
> *Sent:* 16 August 2016 10:48
> *To:* Matt Williams (projectclearwater.org) <matt at projectclearwater.org>
>
> *Subject:* Re: [Project Clearwater] Clearwater Digest, Vol 40, Issue 24
>
>
>
> Hi Matt,
>
> Bulk provisioning for all in one image is done using
> https://github.com/Metaswitch/crest/blob/dev/docs/Bulk-
> Provisioning%20Numbers.md.
>
> I have records in tables in homestead_cache and homer.
>
> Now How to make calls for stress testing?
>
> Is there any guideline?
>
> Many Thanks,
>
> Kosala
>
>
>
>
>
>
>
>
>
> On Tue, Aug 16, 2016 at 9:04 AM, Kosala <kosalayb at gmail.com> wrote:
>
> Hi Matt,
>
> TBH, The document in https://github.com/Metaswitch/
> crest/blob/dev/docs/Bulk-Provisioning%20Numbers.md is not clear to me.
>
> Step 1. Homestead node in deployment. I do not know where is that node in
> all in one image. It will be helpful the location of that folder from the
> root.
>
> Step 2. A simple example will be helpful.
>
> Thanks
>
> Kosala
>
>
>
>
>
> On Tue, Aug 16, 2016 at 8:50 AM, Kosala <kosalayb at gmail.com> wrote:
>
> Hi Matt,
>
> I downloaded the all in one package from http://clearwater.readthedocs.
> io/en/stable/All_in_one_OVF_Installation.html
>
> and imported using oracle virtual box on ubuntu 14.04,
>
> Crest version
>
> [cw-aio]ubuntu at cwaio:~$ sudo dpkg-query -s crest
> Package: crest
> Status: install ok installed
> Priority: optional
> Section: network
> Installed-Size: 40098
> Maintainer: Project Clearwater Maintainers <maintainers@
> projectclearwater.org>
> Architecture: amd64
> Version: 1.0-160815.145007
>
> Thanks
>
> Kosala
>
>
>
>
>
> On Mon, Aug 15, 2016 at 5:56 PM, Matt Williams (projectclearwater.org) <
> matt at projectclearwater.org> wrote:
>
> Kosala,
>
>
>
> That's odd - I don't see that failure on my all-in-one image (spun up just
> now from the latest image) - which version of all-in-one-image are you
> running, and which version of crest does it include ("sudo dpkg-query -s
> crest")?
>
>
>
> You may be able to work-around this either by taking the latest all-in-one
> image or by following the simpler bulk-provisioning process at
> https://github.com/Metaswitch/crest/blob/dev/docs/Bulk-
> Provisioning%20Numbers.md (when this doc talks about using the
> sstables_provisioning process for very large sets of numbers, we mean 1M+
> numbers - the 9000 you're provisioning are well within the capabilities of
> this process).
>
>
>
> I hope that helps - please let me know how you get on.
>
>
>
> Cheers,
>
>
>
> Matt
>
>
>
>
>
> *From:* Clearwater [mailto:clearwater-bounces at lists.projectclearwater.org]
> *On Behalf Of *Kosala
> *Sent:* 15 August 2016 16:58
> *To:* clearwater at lists.projectclearwater.org
> *Subject:* Re: [Project Clearwater] Clearwater Digest, Vol 40, Issue 24
>
>
>
> HI Matt,
>
> Thanks.
>
>
> I am trying to follow https://github.com/Metaswitch/
> crest/blob/dev/src/metaswitch/crest/tools/sstable_provisioning/README.md
> for bulk provisioning.
>
>
> When I am trying to execute sudo ./BulkProvision homer 21000 29999
> example.com 7kkzTyGW in all-in-one image,
> I am getting an error  java.lang.UnsupportedClassVersionError:
> ClearwaterBulkProvisioner : Unsupported major.minor version 52.0
>
> Java version info in all-in-one image:
> [cw-aio]ubuntu at cwaio:/usr/share/clearwater/crest/tools/sstable_provisioning$
> java -version
> java version "1.7.0_101"
> OpenJDK Runtime Environment (IcedTea 2.6.6) (7u101-2.6.6-0ubuntu0.14.04.1)
> OpenJDK 64-Bit Server VM (build 24.95-b01, mixed mode)
>
> Thanks
>
> Kosala
>
>
>
>
>
>
> On Mon, Aug 15, 2016 at 2:17 PM, <clearwater-request at lists.
> projectclearwater.org> wrote:
>
> Send Clearwater mailing list submissions to
>         clearwater at lists.projectclearwater.org
>
> To subscribe or unsubscribe via the World Wide Web, visit
>         http://lists.projectclearwater.org/mailman/
> listinfo/clearwater_lists.projectclearwater.org
>
> or, via email, send a message with subject or body 'help' to
>         clearwater-request at lists.projectclearwater.org
>
> You can reach the person managing the list at
>         clearwater-owner at lists.projectclearwater.org
>
> When replying, please edit your Subject line so it is more specific
> than "Re: Contents of Clearwater digest..."
>
>
> Today's Topics:
>
>    1. Stress Testing (Kosala)
>    2. Re: Stress Testing (Matt Williams (projectclearwater.org))
>    3. Re: Stress Testing (Matt Williams (projectclearwater.org))
>
>
> ----------------------------------------------------------------------
>
> Message: 1
> Date: Mon, 15 Aug 2016 10:38:57 +0100
> From: Kosala <kosalayb at gmail.com>
> To: clearwater at lists.projectclearwater.org
> Subject: [Project Clearwater] Stress Testing
> Message-ID:
>         <CAGEe17an2B_bGj8NfKFwms+nU=vJURyhT5CE+mcY1pjcm4YF+A at mail.
> gmail.com>
> Content-Type: text/plain; charset="utf-8"
>
> Hi Team,
>
> I installed clearwater "all-in-one" image on Oracle Virtual Box.
> 1. Can I do stress testing ?
> 2. How to do that?
>
> I am trying to follow Stress Testing on
> http://clearwater.readthedocs.io/en/stable/Clearwater_stress_testing.html#
> configuring-udp-stress
> .
>
> Using chef - > It seems chef/knife install only supports in the Cloud
> approach (The automated install is only supported for deployments running
> in Amazon?s EC2 cloud).
>
> Manual approach, It looks not supporting all in one image.
>
> Many Thanks
> Kosala
> -------------- next part --------------
> An HTML attachment was scrubbed...
> URL: <http://lists.projectclearwater.org/pipermail/clearwater_lists.
> projectclearwater.org/attachments/20160815/15fc3b07/attachment-0001.html>
>
> ------------------------------
>
> Message: 2
> Date: Mon, 15 Aug 2016 09:54:02 +0000
> From: "Matt Williams (projectclearwater.org)"
>         <matt at projectclearwater.org>
> To: Kosala <kosalayb at gmail.com>
> Cc: "clearwater at lists.projectclearwater.org"
>         <clearwater at lists.projectclearwater.org>
> Subject: Re: [Project Clearwater] Stress Testing
> Message-ID:
>         <CY1PR0201MB15636F1F20EB91BB180F053390120 at CY1PR0201MB1563.
> namprd02.prod.outlook.com>
>
> Content-Type: text/plain; charset="utf-8"
>
> Kosala,
>
> While it's theoretically possible to do stress testing against an
> all-in-one image, I'd recommend against it - the all-in-one image has been
> squeezed down a lot to fit on a single VM and we'd expect very low
> performance out of it, and I could believe that overload behavior might be
> suboptimal.  If you're looking to stress test for performance reasons, I'd
> strongly recommend running a full deployment as this will give you much
> more reliable numbers.  If you're looking to stress test for other reasons,
> please can you share a bit more about what you're trying to achieve, and we
> can have a think about what would work best?
>
> If you do really want to run stress testing against an all-in-one image,
> it should probably work, even though http://clearwater.readthedocs.
> io/en/latest/Clearwater_stress_testing.html#manual-i-
> e-non-chef-stress-runs only talks about Chef and manual installs.  You'd
> need to set the "bono_servers" option in /etc/clearwater/shared_config to
> point to your all-in-one node, and I suspect you'd need to reduce the
> "count" option to something a lot lower - I'd start around 5000 and see how
> that goes.
>
> I hope that helps.  Please let me know how you get on.
>
> Thanks,
>
> Matt
>
> From: Clearwater [mailto:clearwater-bounces at lists.projectclearwater.org]
> On Behalf Of Kosala
> Sent: 15 August 2016 10:39
> To: clearwater at lists.projectclearwater.org
> Subject: [Project Clearwater] Stress Testing
>
> Hi Team,
> I installed clearwater "all-in-one" image on Oracle Virtual Box.
> 1. Can I do stress testing ?
> 2. How to do that?
> I am trying to follow Stress Testing on http://clearwater.readthedocs.
> io/en/stable/Clearwater_stress_testing.html#configuring-udp-stress.
> Using chef - > It seems chef/knife install only supports in the Cloud
> approach (The automated install is only supported for deployments running
> in Amazon?s EC2 cloud).
> Manual approach, It looks not supporting all in one image.
> Many Thanks
> Kosala
>
> -------------- next part --------------
> An HTML attachment was scrubbed...
> URL: <http://lists.projectclearwater.org/pipermail/clearwater_lists.
> projectclearwater.org/attachments/20160815/29d6328d/attachment-0001.html>
>
> ------------------------------
>
> Message: 3
> Date: Mon, 15 Aug 2016 13:16:47 +0000
> From: "Matt Williams (projectclearwater.org)"
>         <matt at projectclearwater.org>
> To: "clearwater at lists.projectclearwater.org"
>         <clearwater at lists.projectclearwater.org>
> Subject: Re: [Project Clearwater] Stress Testing
> Message-ID:
>         <CY1PR0201MB156372246DC5A77B11839F9D90120 at CY1PR0201MB1563.
> namprd02.prod.outlook.com>
>
> Content-Type: text/plain; charset="utf-8"
>
> Kosala,
>
> You'll need to follow all the steps in http://clearwater.readthedocs.
> io/en/latest/Clearwater_stress_testing.html#manual-i-
> e-non-chef-stress-runs, i.e. bulk provisioning subscribers and installing
> clearwater-sip-stress, but that should be it.
>
> Just to be clear, though, you'll need to set the configuration and install
> the clearwater-sip-stress package on a separate VM, not on the all-in-one
> image itself - the all-in-one image almost certainly opens up ports that
> conflict with those that clearwater-sip-stress tries to use.
>
> This isn't a very well-trodden path, though, so you may hit further issues
> - let me know if so, and we can try to work through them.
>
> Cheers,
>
> Matt
>
> From: Kosala [mailto:kosalayb at gmail.com]
> Sent: 15 August 2016 13:41
> To: Matt Williams (projectclearwater.org) <matt at projectclearwater.org>
> Subject: Re: [Project Clearwater] Stress Testing
>
> Hi Matt,
> Thanks. I set the bono_servers option. Should I add count =5000 to
> /etc/clearwater/shared_config ?
>
> Do I need other changes to run stress tests on all-in-one image?
> Thanks
> Kosala
>
>
>
> On Mon, Aug 15, 2016 at 10:54 AM, Matt Williams (projectclearwater.org<
> http://projectclearwater.org>) <matt at projectclearwater.org<mailto:
> matt at projectclearwater.org>> wrote:
> Kosala,
>
> While it's theoretically possible to do stress testing against an
> all-in-one image, I'd recommend against it - the all-in-one image has been
> squeezed down a lot to fit on a single VM and we'd expect very low
> performance out of it, and I could believe that overload behavior might be
> suboptimal.  If you're looking to stress test for performance reasons, I'd
> strongly recommend running a full deployment as this will give you much
> more reliable numbers.  If you're looking to stress test for other reasons,
> please can you share a bit more about what you're trying to achieve, and we
> can have a think about what would work best?
>
> If you do really want to run stress testing against an all-in-one image,
> it should probably work, even though http://clearwater.readthedocs.
> io/en/latest/Clearwater_stress_testing.html#manual-i-
> e-non-chef-stress-runs only talks about Chef and manual installs.  You'd
> need to set the "bono_servers" option in /etc/clearwater/shared_config to
> point to your all-in-one node, and I suspect you'd need to reduce the
> "count" option to something a lot lower - I'd start around 5000 and see how
> that goes.
>
> I hope that helps.  Please let me know how you get on.
>
> Thanks,
>
> Matt
>
> From: Clearwater [mailto:clearwater-bounces at lists.projectclearwater.org<
> mailto:clearwater-bounces at lists.projectclearwater.org>] On Behalf Of
> Kosala
> Sent: 15 August 2016 10:39
> To: clearwater at lists.projectclearwater.org<mailto:clearwater at lists.
> projectclearwater.org>
> Subject: [Project Clearwater] Stress Testing
>
> Hi Team,
> I installed clearwater "all-in-one" image on Oracle Virtual Box.
> 1. Can I do stress testing ?
> 2. How to do that?
> I am trying to follow Stress Testing on http://clearwater.readthedocs.
> io/en/stable/Clearwater_stress_testing.html#configuring-udp-stress.
> Using chef - > It seems chef/knife install only supports in the Cloud
> approach (The automated install is only supported for deployments running
> in Amazon?s EC2 cloud).
> Manual approach, It looks not supporting all in one image.
> Many Thanks
> Kosala
>
>
> -------------- next part --------------
> An HTML attachment was scrubbed...
> URL: <http://lists.projectclearwater.org/pipermail/clearwater_lists.
> projectclearwater.org/attachments/20160815/11781755/attachment.html>
>
> ------------------------------
>
> Subject: Digest Footer
>
> _______________________________________________
> Clearwater mailing list
> Clearwater at lists.projectclearwater.org
> http://lists.projectclearwater.org/mailman/listinfo/clearwater_lists.
> projectclearwater.org
>
>
> ------------------------------
>
> End of Clearwater Digest, Vol 40, Issue 24
> ******************************************
>
>
>
>
>
>
>
>
>
>
>
>
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.projectclearwater.org/pipermail/clearwater_lists.projectclearwater.org/attachments/20160818/0b5054ca/attachment.html>

From matt at projectclearwater.org  Thu Aug 18 05:01:38 2016
From: matt at projectclearwater.org (Matt Williams (projectclearwater.org))
Date: Thu, 18 Aug 2016 09:01:38 +0000
Subject: [Project Clearwater] Clearwater Digest, Vol 40, Issue 24
In-Reply-To: <CAGEe17ZkY2ESNzwQYddrv6=jUJ5fPHu3gJXT7R1UjQmBd+eFUg@mail.gmail.com>
References: <mailman.20.1471267072.11502.clearwater_lists.projectclearwater.org@lists.projectclearwater.org>
	<CAGEe17ZLnypQfbzxEwxj9EaB20MUBVpY+YdN-Obv=gHpZmG0KA@mail.gmail.com>
	<CY1PR0201MB1563F9A706F3EC7BE7F9C11590120@CY1PR0201MB1563.namprd02.prod.outlook.com>
	<CAGEe17bfTu1Kpwx=ipqtEbShvWtP+C6pJEEGHi0GSwBR5Dqw8w@mail.gmail.com>
	<CAGEe17aY077tLtotRe1X8k1qU_4otBdHDMJjqDH_g02Zs676Jg@mail.gmail.com>
	<CAGEe17ZeNPPy7AmMz=LCWnHqLm=v9Q7CuLT+AOVKWJTdg8m7Eg@mail.gmail.com>
	<CY1PR0201MB1563CE17983225B985B19D7390130@CY1PR0201MB1563.namprd02.prod.outlook.com>
	<CAGEe17b2M2uqvbOuqH7t4xM41FbfBYk0xR3zWqiFh+EkSfUzUQ@mail.gmail.com>
	<CY1PR0201MB1563CD5DDDD6E7B5A0B2DB7290140@CY1PR0201MB1563.namprd02.prod.outlook.com>
	<CAGEe17YGnaY1Kqc65gyiVO1sBBuTx=-YzfD9HY3M6QBD2t9AkA@mail.gmail.com>
	<CY1PR0201MB156349F26A0A7670BE7382A890140@CY1PR0201MB1563.namprd02.prod.outlook.com>
	<CAGEe17ZkY2ESNzwQYddrv6=jUJ5fPHu3gJXT7R1UjQmBd+eFUg@mail.gmail.com>
Message-ID: <CY1PR0201MB1563C979B2D641DA59F1945A90150@CY1PR0201MB1563.namprd02.prod.outlook.com>

Kosala,

Yes, it's https://github.com/Metaswitch/clearwater-infrastructure/issues/355 and it should be benign.

However, this was fixed about 2 weeks ago.  Please can you confirm when you downloaded the all-in-one image, and whether you've upgraded it all?  (As I observed earlier, your crest release was from only a few days ago.)

Have you got manual calls working?

Thanks,

Matt


From: Kosala [mailto:kosalayb at gmail.com]
Sent: 18 August 2016 09:56
To: Matt Williams (projectclearwater.org) <matt at projectclearwater.org>
Cc: clearwater at lists.projectclearwater.org
Subject: Re: [Project Clearwater] Clearwater Digest, Vol 40, Issue 24

Hi Matt,
In SIP node, when I am trying to execute "sudo service clearwater-sip-stress restart", I am getting an error

/etc/init.d/clearwater-infrastructure: 76: /etc/init.d/clearwater-infrastructure: /usr/share/clearwater/infrastructure/scripts/logging.bash: Permission denied
Configuring monit for only localhost access
Any clue about this error?
Thanks
Kosala


On Wed, Aug 17, 2016 at 2:29 PM, Matt Williams (projectclearwater.org<http://projectclearwater.org>) <matt at projectclearwater.org<mailto:matt at projectclearwater.org>> wrote:
Kosala,

Yes, that's the correct screen, and you're correct that it shows that stress is being attempted but failing.

Do regular (non-stress) calls work through this deployment?

You can look at what message the stress node is receiving in the log files in the /var/log/clearwater-sip-stress/ directory - I think there are "errors" logs that contain the unexpected messages.

You can obviously also look at what's happening on the all-in-one node itself, using the /var/log/bono/*, /var/log/sprout/* and /var/log/homestead/* files, as described at http://clearwater.readthedocs.io/en/latest/Troubleshooting_and_Recovery.html.

I hope that helps.

Cheers,

Matt

From: Kosala [mailto:kosalayb at gmail.com<mailto:kosalayb at gmail.com>]
Sent: 17 August 2016 14:20

To: Matt Williams (projectclearwater.org<http://projectclearwater.org>) <matt at projectclearwater.org<mailto:matt at projectclearwater.org>>
Subject: Re: [Project Clearwater] Clearwater Digest, Vol 40, Issue 24

Hi Matt,
I can see this scenario screen from sip-stress.1.out. I hope this will be the stress test output results.

------------------------------ Scenario Screen -------- [1-9]: Change Screen --
     Users (length)   Port   Total-time  Total-calls  Remote-host
        2500 (0 ms)   5060      77.15 s         2500  10.0.21.192:5060(TCP)

  Call limit reached (-m 2500), 1.002 s period  1 ms scheduler resolution
  2175 calls (limit 2500)                Peak was 2499 calls, after 0 s
  0 Running, 2177 Paused, 8 Woken up
  0 dead call msg (discarded)            0 out-of-call msg (discarded)
  3 open sockets

                                 Messages  Retrans   Timeout   Unexpected-Msg
       Pause [0ms/10:00]         2500                          0
    REGISTER ---------->         326       0
         401 <----------         0         0         0         325
    REGISTER ---------->         0         0
         200 <----------         0         0         0         0
    REGISTER ---------->         0         0
         401 <----------         0         0         0         0
    REGISTER ---------->         0         0
         200 <----------         0         0         0         0
       Pause [     4:50]         0                             0
    REGISTER ---------->  B-RTD1 0         0
         200 <----------  E-RTD1 0         0         0         0
    REGISTER ---------->  B-RTD1 0         0
         200 <----------  E-RTD1 0         0         0         0
       Pause [     4:50]         0                             0
       Pause [$pre_call_delay]   0                             0
      INVITE ---------->  B-RTD2 0         0
         100 <----------         0         0         0         0
      INVITE <----------         0         0         0         0
         100 <----------         0         0         0         0
      INVITE <----------         0         0         0         0
         100 ---------->         0         0
         180 ---------->         0         0
         180 <----------         0         0         0         0
       Pause [   6000ms]         0                             0
         200 ---------->         0         0
         200 <----------         0         0         0         0
         ACK ---------->         0         0
         ACK <----------         0         0         0         0
      UPDATE ---------->         0         0
      UPDATE <----------         0         0         0         0
         200 ---------->         0         0
         200 <----------  E-RTD2 0         0         0         0
       Pause [    24.0s]         0                             0
         BYE ---------->  B-RTD3 0         0
         BYE <----------         0         0         0         0
         200 ---------->         0         0
         200 <----------  E-RTD3 0         0         0         0
       Pause [$post_call_delay]  0                             0
------- Waiting for active calls to end. Press [q] again to force exit. -------
Last Error: Aborting call on unexpected message for Call-Id '1079-13729 at ...
However there is an unexpected message error at the end.
Thanks
Kosala


On Wed, Aug 17, 2016 at 12:40 PM, Matt Williams (projectclearwater.org<http://projectclearwater.org>) <matt at projectclearwater.org<mailto:matt at projectclearwater.org>> wrote:
Kosala,

They should log to /var/log/clearwater-sip-stress - in particular, the *.1.out file is a log of the output from sipp.  Do you see anything there?

Matt

From: Kosala [mailto:kosalayb at gmail.com<mailto:kosalayb at gmail.com>]
Sent: 17 August 2016 12:33
To: Matt Williams (projectclearwater.org<http://projectclearwater.org>) <matt at projectclearwater.org<mailto:matt at projectclearwater.org>>; clearwater at lists.projectclearwater.org<mailto:clearwater at lists.projectclearwater.org>

Subject: Re: [Project Clearwater] Clearwater Digest, Vol 40, Issue 24

Hi Matt,
I followed above steps and run sudo apt-get install clearwater-sip-stress.
How do I know stress tests are running? Is is said, stress tests start automatically but I cannot see it.
Thanks
Kosala



On Tue, Aug 16, 2016 at 2:01 PM, Matt Williams (projectclearwater.org<http://projectclearwater.org>) <matt at projectclearwater.org<mailto:matt at projectclearwater.org>> wrote:
Kosala,

I'm glad you've made progress on this.

I had a look at the crest package version, but it seems to be later than the most recent all-in-one image uses (1.0-160811.103635).  When did you download the all-in-one image, and did you apply any patches to it?

Regarding making calls for stress testing, this is where http://clearwater.readthedocs.io/en/latest/Clearwater_stress_testing.html#manual-i-e-non-chef-stress-runs comes in - you need to

?         create a separate VM

?         set the bono_hostname and count parameters in /etc/clearwater/shared_config

?         install the clearwater-sip-stress package.
I hope that helps.

BTW, please remember to copy in clearwater at lists.projectclearwater.org<mailto:clearwater at lists.projectclearwater.org> - that means that other people can see and comment on your posts.

Thanks,

Matt


From: Kosala [mailto:kosalayb at gmail.com<mailto:kosalayb at gmail.com>]
Sent: 16 August 2016 10:48
To: Matt Williams (projectclearwater.org<http://projectclearwater.org>) <matt at projectclearwater.org<mailto:matt at projectclearwater.org>>
Subject: Re: [Project Clearwater] Clearwater Digest, Vol 40, Issue 24

Hi Matt,
Bulk provisioning for all in one image is done using https://github.com/Metaswitch/crest/blob/dev/docs/Bulk-Provisioning%20Numbers.md.
I have records in tables in homestead_cache and homer.
Now How to make calls for stress testing?
Is there any guideline?
Many Thanks,
Kosala




On Tue, Aug 16, 2016 at 9:04 AM, Kosala <kosalayb at gmail.com<mailto:kosalayb at gmail.com>> wrote:
Hi Matt,
TBH, The document in https://github.com/Metaswitch/crest/blob/dev/docs/Bulk-Provisioning%20Numbers.md is not clear to me.
Step 1. Homestead node in deployment. I do not know where is that node in all in one image. It will be helpful the location of that folder from the root.
Step 2. A simple example will be helpful.
Thanks
Kosala


On Tue, Aug 16, 2016 at 8:50 AM, Kosala <kosalayb at gmail.com<mailto:kosalayb at gmail.com>> wrote:
Hi Matt,
I downloaded the all in one package from http://clearwater.readthedocs.io/en/stable/All_in_one_OVF_Installation.html
and imported using oracle virtual box on ubuntu 14.04,
Crest version
[cw-aio]ubuntu at cwaio:~$ sudo dpkg-query -s crest
Package: crest
Status: install ok installed
Priority: optional
Section: network
Installed-Size: 40098
Maintainer: Project Clearwater Maintainers <maintainers at projectclearwater.org<mailto:maintainers at projectclearwater.org>>
Architecture: amd64
Version: 1.0-160815.145007
Thanks
Kosala


On Mon, Aug 15, 2016 at 5:56 PM, Matt Williams (projectclearwater.org<http://projectclearwater.org>) <matt at projectclearwater.org<mailto:matt at projectclearwater.org>> wrote:
Kosala,

That's odd - I don't see that failure on my all-in-one image (spun up just now from the latest image) - which version of all-in-one-image are you running, and which version of crest does it include ("sudo dpkg-query -s crest")?

You may be able to work-around this either by taking the latest all-in-one image or by following the simpler bulk-provisioning process at https://github.com/Metaswitch/crest/blob/dev/docs/Bulk-Provisioning%20Numbers.md (when this doc talks about using the sstables_provisioning process for very large sets of numbers, we mean 1M+ numbers - the 9000 you're provisioning are well within the capabilities of this process).

I hope that helps - please let me know how you get on.

Cheers,

Matt


From: Clearwater [mailto:clearwater-bounces at lists.projectclearwater.org<mailto:clearwater-bounces at lists.projectclearwater.org>] On Behalf Of Kosala
Sent: 15 August 2016 16:58
To: clearwater at lists.projectclearwater.org<mailto:clearwater at lists.projectclearwater.org>
Subject: Re: [Project Clearwater] Clearwater Digest, Vol 40, Issue 24

HI Matt,
Thanks.

I am trying to follow https://github.com/Metaswitch/crest/blob/dev/src/metaswitch/crest/tools/sstable_provisioning/README.md for bulk provisioning.

When I am trying to execute sudo ./BulkProvision homer 21000 29999 example.com<http://example.com> 7kkzTyGW in all-in-one image,
I am getting an error  java.lang.UnsupportedClassVersionError: ClearwaterBulkProvisioner : Unsupported major.minor version 52.0
Java version info in all-in-one image:
[cw-aio]ubuntu at cwaio:/usr/share/clearwater/crest/tools/sstable_provisioning$ java -version
java version "1.7.0_101"
OpenJDK Runtime Environment (IcedTea 2.6.6) (7u101-2.6.6-0ubuntu0.14.04.1)
OpenJDK 64-Bit Server VM (build 24.95-b01, mixed mode)
Thanks
Kosala



On Mon, Aug 15, 2016 at 2:17 PM, <clearwater-request at lists.projectclearwater.org<mailto:clearwater-request at lists.projectclearwater.org>> wrote:
Send Clearwater mailing list submissions to
        clearwater at lists.projectclearwater.org<mailto:clearwater at lists.projectclearwater.org>

To subscribe or unsubscribe via the World Wide Web, visit
        http://lists.projectclearwater.org/mailman/listinfo/clearwater_lists.projectclearwater.org

or, via email, send a message with subject or body 'help' to
        clearwater-request at lists.projectclearwater.org<mailto:clearwater-request at lists.projectclearwater.org>

You can reach the person managing the list at
        clearwater-owner at lists.projectclearwater.org<mailto:clearwater-owner at lists.projectclearwater.org>

When replying, please edit your Subject line so it is more specific
than "Re: Contents of Clearwater digest..."


Today's Topics:

   1. Stress Testing (Kosala)
   2. Re: Stress Testing (Matt Williams (projectclearwater.org<http://projectclearwater.org>))
   3. Re: Stress Testing (Matt Williams (projectclearwater.org<http://projectclearwater.org>))


----------------------------------------------------------------------

Message: 1
Date: Mon, 15 Aug 2016 10:38:57 +0100
From: Kosala <kosalayb at gmail.com<mailto:kosalayb at gmail.com>>
To: clearwater at lists.projectclearwater.org<mailto:clearwater at lists.projectclearwater.org>
Subject: [Project Clearwater] Stress Testing
Message-ID:
        <CAGEe17an2B_bGj8NfKFwms+nU=vJURyhT5CE+mcY1pjcm4YF+A at mail.gmail.com<mailto:vJURyhT5CE%2BmcY1pjcm4YF%2BA at mail.gmail.com>>
Content-Type: text/plain; charset="utf-8"

Hi Team,

I installed clearwater "all-in-one" image on Oracle Virtual Box.
1. Can I do stress testing ?
2. How to do that?

I am trying to follow Stress Testing on
http://clearwater.readthedocs.io/en/stable/Clearwater_stress_testing.html#configuring-udp-stress
.

Using chef - > It seems chef/knife install only supports in the Cloud
approach (The automated install is only supported for deployments running
in Amazon?s EC2 cloud).

Manual approach, It looks not supporting all in one image.

Many Thanks
Kosala
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.projectclearwater.org/pipermail/clearwater_lists.projectclearwater.org/attachments/20160815/15fc3b07/attachment-0001.html>

------------------------------

Message: 2
Date: Mon, 15 Aug 2016 09:54:02 +0000
From: "Matt Williams (projectclearwater.org<http://projectclearwater.org>)"
        <matt at projectclearwater.org<mailto:matt at projectclearwater.org>>
To: Kosala <kosalayb at gmail.com<mailto:kosalayb at gmail.com>>
Cc: "clearwater at lists.projectclearwater.org<mailto:clearwater at lists.projectclearwater.org>"
        <clearwater at lists.projectclearwater.org<mailto:clearwater at lists.projectclearwater.org>>
Subject: Re: [Project Clearwater] Stress Testing
Message-ID:
        <CY1PR0201MB15636F1F20EB91BB180F053390120 at CY1PR0201MB1563.namprd02.prod.outlook.com<mailto:CY1PR0201MB15636F1F20EB91BB180F053390120 at CY1PR0201MB1563.namprd02.prod.outlook.com>>

Content-Type: text/plain; charset="utf-8"

Kosala,

While it's theoretically possible to do stress testing against an all-in-one image, I'd recommend against it - the all-in-one image has been squeezed down a lot to fit on a single VM and we'd expect very low performance out of it, and I could believe that overload behavior might be suboptimal.  If you're looking to stress test for performance reasons, I'd strongly recommend running a full deployment as this will give you much more reliable numbers.  If you're looking to stress test for other reasons, please can you share a bit more about what you're trying to achieve, and we can have a think about what would work best?

If you do really want to run stress testing against an all-in-one image, it should probably work, even though http://clearwater.readthedocs.io/en/latest/Clearwater_stress_testing.html#manual-i-e-non-chef-stress-runs only talks about Chef and manual installs.  You'd need to set the "bono_servers" option in /etc/clearwater/shared_config to point to your all-in-one node, and I suspect you'd need to reduce the "count" option to something a lot lower - I'd start around 5000 and see how that goes.

I hope that helps.  Please let me know how you get on.

Thanks,

Matt

From: Clearwater [mailto:clearwater-bounces at lists.projectclearwater.org<mailto:clearwater-bounces at lists.projectclearwater.org>] On Behalf Of Kosala
Sent: 15 August 2016 10:39
To: clearwater at lists.projectclearwater.org<mailto:clearwater at lists.projectclearwater.org>
Subject: [Project Clearwater] Stress Testing

Hi Team,
I installed clearwater "all-in-one" image on Oracle Virtual Box.
1. Can I do stress testing ?
2. How to do that?
I am trying to follow Stress Testing on http://clearwater.readthedocs.io/en/stable/Clearwater_stress_testing.html#configuring-udp-stress.
Using chef - > It seems chef/knife install only supports in the Cloud approach (The automated install is only supported for deployments running in Amazon?s EC2 cloud).
Manual approach, It looks not supporting all in one image.
Many Thanks
Kosala

-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.projectclearwater.org/pipermail/clearwater_lists.projectclearwater.org/attachments/20160815/29d6328d/attachment-0001.html>

------------------------------

Message: 3
Date: Mon, 15 Aug 2016 13:16:47 +0000
From: "Matt Williams (projectclearwater.org<http://projectclearwater.org>)"
        <matt at projectclearwater.org<mailto:matt at projectclearwater.org>>
To: "clearwater at lists.projectclearwater.org<mailto:clearwater at lists.projectclearwater.org>"
        <clearwater at lists.projectclearwater.org<mailto:clearwater at lists.projectclearwater.org>>
Subject: Re: [Project Clearwater] Stress Testing
Message-ID:
        <CY1PR0201MB156372246DC5A77B11839F9D90120 at CY1PR0201MB1563.namprd02.prod.outlook.com<mailto:CY1PR0201MB156372246DC5A77B11839F9D90120 at CY1PR0201MB1563.namprd02.prod.outlook.com>>

Content-Type: text/plain; charset="utf-8"

Kosala,

You'll need to follow all the steps in http://clearwater.readthedocs.io/en/latest/Clearwater_stress_testing.html#manual-i-e-non-chef-stress-runs, i.e. bulk provisioning subscribers and installing clearwater-sip-stress, but that should be it.

Just to be clear, though, you'll need to set the configuration and install the clearwater-sip-stress package on a separate VM, not on the all-in-one image itself - the all-in-one image almost certainly opens up ports that conflict with those that clearwater-sip-stress tries to use.

This isn't a very well-trodden path, though, so you may hit further issues - let me know if so, and we can try to work through them.

Cheers,

Matt

From: Kosala [mailto:kosalayb at gmail.com<mailto:kosalayb at gmail.com>]
Sent: 15 August 2016 13:41
To: Matt Williams (projectclearwater.org<http://projectclearwater.org>) <matt at projectclearwater.org<mailto:matt at projectclearwater.org>>
Subject: Re: [Project Clearwater] Stress Testing

Hi Matt,
Thanks. I set the bono_servers option. Should I add count =5000 to /etc/clearwater/shared_config ?

Do I need other changes to run stress tests on all-in-one image?
Thanks
Kosala



On Mon, Aug 15, 2016 at 10:54 AM, Matt Williams (projectclearwater.org<http://projectclearwater.org><http://projectclearwater.org>) <matt at projectclearwater.org<mailto:matt at projectclearwater.org><mailto:matt at projectclearwater.org<mailto:matt at projectclearwater.org>>> wrote:
Kosala,

While it's theoretically possible to do stress testing against an all-in-one image, I'd recommend against it - the all-in-one image has been squeezed down a lot to fit on a single VM and we'd expect very low performance out of it, and I could believe that overload behavior might be suboptimal.  If you're looking to stress test for performance reasons, I'd strongly recommend running a full deployment as this will give you much more reliable numbers.  If you're looking to stress test for other reasons, please can you share a bit more about what you're trying to achieve, and we can have a think about what would work best?

If you do really want to run stress testing against an all-in-one image, it should probably work, even though http://clearwater.readthedocs.io/en/latest/Clearwater_stress_testing.html#manual-i-e-non-chef-stress-runs only talks about Chef and manual installs.  You'd need to set the "bono_servers" option in /etc/clearwater/shared_config to point to your all-in-one node, and I suspect you'd need to reduce the "count" option to something a lot lower - I'd start around 5000 and see how that goes.

I hope that helps.  Please let me know how you get on.

Thanks,

Matt

From: Clearwater [mailto:clearwater-bounces at lists.projectclearwater.org<mailto:clearwater-bounces at lists.projectclearwater.org><mailto:clearwater-bounces at lists.projectclearwater.org<mailto:clearwater-bounces at lists.projectclearwater.org>>] On Behalf Of Kosala
Sent: 15 August 2016 10:39
To: clearwater at lists.projectclearwater.org<mailto:clearwater at lists.projectclearwater.org><mailto:clearwater at lists.projectclearwater.org<mailto:clearwater at lists.projectclearwater.org>>
Subject: [Project Clearwater] Stress Testing

Hi Team,
I installed clearwater "all-in-one" image on Oracle Virtual Box.
1. Can I do stress testing ?
2. How to do that?
I am trying to follow Stress Testing on http://clearwater.readthedocs.io/en/stable/Clearwater_stress_testing.html#configuring-udp-stress.
Using chef - > It seems chef/knife install only supports in the Cloud approach (The automated install is only supported for deployments running in Amazon?s EC2 cloud).
Manual approach, It looks not supporting all in one image.
Many Thanks
Kosala


-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.projectclearwater.org/pipermail/clearwater_lists.projectclearwater.org/attachments/20160815/11781755/attachment.html>

------------------------------

Subject: Digest Footer

_______________________________________________
Clearwater mailing list
Clearwater at lists.projectclearwater.org<mailto:Clearwater at lists.projectclearwater.org>
http://lists.projectclearwater.org/mailman/listinfo/clearwater_lists.projectclearwater.org


------------------------------

End of Clearwater Digest, Vol 40, Issue 24
******************************************







-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.projectclearwater.org/pipermail/clearwater_lists.projectclearwater.org/attachments/20160818/ad22e1d5/attachment.html>

From kosalayb at gmail.com  Thu Aug 18 05:33:55 2016
From: kosalayb at gmail.com (Kosala)
Date: Thu, 18 Aug 2016 10:33:55 +0100
Subject: [Project Clearwater] Clearwater Digest, Vol 40, Issue 24
In-Reply-To: <CY1PR0201MB1563C979B2D641DA59F1945A90150@CY1PR0201MB1563.namprd02.prod.outlook.com>
References: <mailman.20.1471267072.11502.clearwater_lists.projectclearwater.org@lists.projectclearwater.org>
	<CAGEe17ZLnypQfbzxEwxj9EaB20MUBVpY+YdN-Obv=gHpZmG0KA@mail.gmail.com>
	<CY1PR0201MB1563F9A706F3EC7BE7F9C11590120@CY1PR0201MB1563.namprd02.prod.outlook.com>
	<CAGEe17bfTu1Kpwx=ipqtEbShvWtP+C6pJEEGHi0GSwBR5Dqw8w@mail.gmail.com>
	<CAGEe17aY077tLtotRe1X8k1qU_4otBdHDMJjqDH_g02Zs676Jg@mail.gmail.com>
	<CAGEe17ZeNPPy7AmMz=LCWnHqLm=v9Q7CuLT+AOVKWJTdg8m7Eg@mail.gmail.com>
	<CY1PR0201MB1563CE17983225B985B19D7390130@CY1PR0201MB1563.namprd02.prod.outlook.com>
	<CAGEe17b2M2uqvbOuqH7t4xM41FbfBYk0xR3zWqiFh+EkSfUzUQ@mail.gmail.com>
	<CY1PR0201MB1563CD5DDDD6E7B5A0B2DB7290140@CY1PR0201MB1563.namprd02.prod.outlook.com>
	<CAGEe17YGnaY1Kqc65gyiVO1sBBuTx=-YzfD9HY3M6QBD2t9AkA@mail.gmail.com>
	<CY1PR0201MB156349F26A0A7670BE7382A890140@CY1PR0201MB1563.namprd02.prod.outlook.com>
	<CAGEe17ZkY2ESNzwQYddrv6=jUJ5fPHu3gJXT7R1UjQmBd+eFUg@mail.gmail.com>
	<CY1PR0201MB1563C979B2D641DA59F1945A90150@CY1PR0201MB1563.namprd02.prod.outlook.com>
Message-ID: <CAGEe17bC+xmhP3D7w768r0svzBAxdBedVXhis1Z33Yqdq4THgA@mail.gmail.com>

Hi Matt,

Yeah, Manual calls are working fine.

As it is said in the big fix, https://github.com/Metaswitch/
clearwater-infrastructure/issues/355 , I copied logging.bash to
/usr/share/clearwater/utils
but I am still getting

/etc/init.d/clearwater-infrastructure: 76:
/etc/init.d/clearwater-infrastructure:
/usr/share/clearwater/infrastructure/scripts/logging.bash: Permission denied
Configuring monit for only localhost access

Kosala



On Thu, Aug 18, 2016 at 10:01 AM, Matt Williams (projectclearwater.org) <
matt at projectclearwater.org> wrote:

> Kosala,
>
>
>
> Yes, it's https://github.com/Metaswitch/clearwater-infrastructure/
> issues/355 and it should be benign.
>
>
>
> However, this was fixed about 2 weeks ago.  Please can you confirm when
> you downloaded the all-in-one image, and whether you've upgraded it all?
> (As I observed earlier, your crest release was from only a few days ago.)
>
>
>
> Have you got manual calls working?
>
>
>
> Thanks,
>
>
>
> Matt
>
>
>
>
>
> *From:* Kosala [mailto:kosalayb at gmail.com]
> *Sent:* 18 August 2016 09:56
> *To:* Matt Williams (projectclearwater.org) <matt at projectclearwater.org>
> *Cc:* clearwater at lists.projectclearwater.org
>
> *Subject:* Re: [Project Clearwater] Clearwater Digest, Vol 40, Issue 24
>
>
>
> Hi Matt,
>
> In SIP node, when I am trying to execute "sudo service
> clearwater-sip-stress restart", I am getting an error
>
>
> /etc/init.d/clearwater-infrastructure: 76: /etc/init.d/clearwater-infrastructure:
> /usr/share/clearwater/infrastructure/scripts/logging.bash: Permission
> denied
> Configuring monit for only localhost access
>
> Any clue about this error?
>
> Thanks
>
> Kosala
>
>
>
>
>
> On Wed, Aug 17, 2016 at 2:29 PM, Matt Williams (projectclearwater.org) <
> matt at projectclearwater.org> wrote:
>
> Kosala,
>
>
>
> Yes, that's the correct screen, and you're correct that it shows that
> stress is being attempted but failing.
>
>
>
> Do regular (non-stress) calls work through this deployment?
>
>
>
> You can look at what message the stress node is receiving in the log files
> in the /var/log/clearwater-sip-stress/ directory - I think there are
> "errors" logs that contain the unexpected messages.
>
>
>
> You can obviously also look at what's happening on the all-in-one node
> itself, using the /var/log/bono/*, /var/log/sprout/* and
> /var/log/homestead/* files, as described at http://clearwater.readthedocs.
> io/en/latest/Troubleshooting_and_Recovery.html.
>
>
>
> I hope that helps.
>
>
>
> Cheers,
>
>
>
> Matt
>
>
>
> *From:* Kosala [mailto:kosalayb at gmail.com]
> *Sent:* 17 August 2016 14:20
>
>
> *To:* Matt Williams (projectclearwater.org) <matt at projectclearwater.org>
> *Subject:* Re: [Project Clearwater] Clearwater Digest, Vol 40, Issue 24
>
>
>
> Hi Matt,
>
> I can see this scenario screen from sip-stress.1.out. I hope this will be
> the stress test output results.
>
>
> ------------------------------ Scenario Screen -------- [1-9]: Change
> Screen --
>      Users (length)   Port   Total-time  Total-calls  Remote-host
>         2500 (0 ms)   5060      77.15 s         2500  10.0.21.192:5060
> (TCP)
>
>   Call limit reached (-m 2500), 1.002 s period  1 ms scheduler resolution
>   2175 calls (limit 2500)                Peak was 2499 calls, after 0 s
>   0 Running, 2177 Paused, 8 Woken up
>   0 dead call msg (discarded)            0 out-of-call msg
> (discarded)
>   3 open sockets
>
>                                  Messages  Retrans   Timeout
> Unexpected-Msg
>        Pause [0ms/10:00]         2500                          0
>     REGISTER ---------->         326       0
>          401 <----------         0         0         0         325
>     REGISTER ---------->         0         0
>          200 <----------         0         0         0         0
>     REGISTER ---------->         0         0
>          401 <----------         0         0         0         0
>     REGISTER ---------->         0         0
>          200 <----------         0         0         0         0
>        Pause [     4:50]         0                             0
>     REGISTER ---------->  B-RTD1 0         0
>          200 <----------  E-RTD1 0         0         0         0
>     REGISTER ---------->  B-RTD1 0         0
>          200 <----------  E-RTD1 0         0         0         0
>        Pause [     4:50]         0                             0
>        Pause [$pre_call_delay]   0                             0
>       INVITE ---------->  B-RTD2 0         0
>          100 <----------         0         0         0         0
>       INVITE <----------         0         0         0         0
>          100 <----------         0         0         0         0
>       INVITE <----------         0         0         0         0
>          100 ---------->         0         0
>          180 ---------->         0         0
>          180 <----------         0         0         0         0
>        Pause [   6000ms]         0                             0
>          200 ---------->         0         0
>          200 <----------         0         0         0         0
>          ACK ---------->         0         0
>          ACK <----------         0         0         0         0
>       UPDATE ---------->         0         0
>       UPDATE <----------         0         0         0         0
>          200 ---------->         0         0
>          200 <----------  E-RTD2 0         0         0         0
>        Pause [    24.0s]         0                             0
>          BYE ---------->  B-RTD3 0         0
>          BYE <----------         0         0         0         0
>          200 ---------->         0         0
>          200 <----------  E-RTD3 0         0         0         0
>        Pause [$post_call_delay]  0                             0
> ------- Waiting for active calls to end. Press [q] again to force exit.
> -------
> Last Error: Aborting call on unexpected message for Call-Id '1079-13729@
> ...
>
> However there is an unexpected message error at the end.
>
> Thanks
>
> Kosala
>
>
>
>
>
> On Wed, Aug 17, 2016 at 12:40 PM, Matt Williams (projectclearwater.org) <
> matt at projectclearwater.org> wrote:
>
> Kosala,
>
>
>
> They should log to /var/log/clearwater-sip-stress - in particular, the
> *.1.out file is a log of the output from sipp.  Do you see anything there?
>
>
>
> Matt
>
>
>
> *From:* Kosala [mailto:kosalayb at gmail.com]
> *Sent:* 17 August 2016 12:33
> *To:* Matt Williams (projectclearwater.org) <matt at projectclearwater.org>;
> clearwater at lists.projectclearwater.org
>
>
> *Subject:* Re: [Project Clearwater] Clearwater Digest, Vol 40, Issue 24
>
>
>
> Hi Matt,
>
> I followed above steps and run sudo apt-get install clearwater-sip-stress.
>
> How do I know stress tests are running? Is is said, stress tests start
> automatically but I cannot see it.
>
> Thanks
>
> Kosala
>
>
>
>
>
>
> On Tue, Aug 16, 2016 at 2:01 PM, Matt Williams (projectclearwater.org) <
> matt at projectclearwater.org> wrote:
>
> Kosala,
>
>
>
> I'm glad you've made progress on this.
>
>
>
> I had a look at the crest package version, but it seems to be later than
> the most recent all-in-one image uses (1.0-160811.103635).  When did you
> download the all-in-one image, and did you apply any patches to it?
>
>
>
> Regarding making calls for stress testing, this is where
> http://clearwater.readthedocs.io/en/latest/Clearwater_
> stress_testing.html#manual-i-e-non-chef-stress-runs comes in - you need to
>
> ?         create a separate VM
>
> ?         set the bono_hostname and count parameters in
> /etc/clearwater/shared_config
>
> ?         install the clearwater-sip-stress package.
>
> I hope that helps.
>
>
>
> BTW, please remember to copy in clearwater at lists.projectclearwater.org -
> that means that other people can see and comment on your posts.
>
>
>
> Thanks,
>
>
>
> Matt
>
>
>
>
>
> *From:* Kosala [mailto:kosalayb at gmail.com]
> *Sent:* 16 August 2016 10:48
> *To:* Matt Williams (projectclearwater.org) <matt at projectclearwater.org>
>
> *Subject:* Re: [Project Clearwater] Clearwater Digest, Vol 40, Issue 24
>
>
>
> Hi Matt,
>
> Bulk provisioning for all in one image is done using
> https://github.com/Metaswitch/crest/blob/dev/docs/Bulk-
> Provisioning%20Numbers.md.
>
> I have records in tables in homestead_cache and homer.
>
> Now How to make calls for stress testing?
>
> Is there any guideline?
>
> Many Thanks,
>
> Kosala
>
>
>
>
>
>
>
>
>
> On Tue, Aug 16, 2016 at 9:04 AM, Kosala <kosalayb at gmail.com> wrote:
>
> Hi Matt,
>
> TBH, The document in https://github.com/Metaswitch/
> crest/blob/dev/docs/Bulk-Provisioning%20Numbers.md is not clear to me.
>
> Step 1. Homestead node in deployment. I do not know where is that node in
> all in one image. It will be helpful the location of that folder from the
> root.
>
> Step 2. A simple example will be helpful.
>
> Thanks
>
> Kosala
>
>
>
>
>
> On Tue, Aug 16, 2016 at 8:50 AM, Kosala <kosalayb at gmail.com> wrote:
>
> Hi Matt,
>
> I downloaded the all in one package from http://clearwater.readthedocs.
> io/en/stable/All_in_one_OVF_Installation.html
>
> and imported using oracle virtual box on ubuntu 14.04,
>
> Crest version
>
> [cw-aio]ubuntu at cwaio:~$ sudo dpkg-query -s crest
> Package: crest
> Status: install ok installed
> Priority: optional
> Section: network
> Installed-Size: 40098
> Maintainer: Project Clearwater Maintainers <maintainers@
> projectclearwater.org>
> Architecture: amd64
> Version: 1.0-160815.145007
>
> Thanks
>
> Kosala
>
>
>
>
>
> On Mon, Aug 15, 2016 at 5:56 PM, Matt Williams (projectclearwater.org) <
> matt at projectclearwater.org> wrote:
>
> Kosala,
>
>
>
> That's odd - I don't see that failure on my all-in-one image (spun up just
> now from the latest image) - which version of all-in-one-image are you
> running, and which version of crest does it include ("sudo dpkg-query -s
> crest")?
>
>
>
> You may be able to work-around this either by taking the latest all-in-one
> image or by following the simpler bulk-provisioning process at
> https://github.com/Metaswitch/crest/blob/dev/docs/Bulk-
> Provisioning%20Numbers.md (when this doc talks about using the
> sstables_provisioning process for very large sets of numbers, we mean 1M+
> numbers - the 9000 you're provisioning are well within the capabilities of
> this process).
>
>
>
> I hope that helps - please let me know how you get on.
>
>
>
> Cheers,
>
>
>
> Matt
>
>
>
>
>
> *From:* Clearwater [mailto:clearwater-bounces at lists.projectclearwater.org]
> *On Behalf Of *Kosala
> *Sent:* 15 August 2016 16:58
> *To:* clearwater at lists.projectclearwater.org
> *Subject:* Re: [Project Clearwater] Clearwater Digest, Vol 40, Issue 24
>
>
>
> HI Matt,
>
> Thanks.
>
>
> I am trying to follow https://github.com/Metaswitch/
> crest/blob/dev/src/metaswitch/crest/tools/sstable_provisioning/README.md
> for bulk provisioning.
>
>
> When I am trying to execute sudo ./BulkProvision homer 21000 29999
> example.com 7kkzTyGW in all-in-one image,
> I am getting an error  java.lang.UnsupportedClassVersionError:
> ClearwaterBulkProvisioner : Unsupported major.minor version 52.0
>
> Java version info in all-in-one image:
> [cw-aio]ubuntu at cwaio:/usr/share/clearwater/crest/tools/sstable_provisioning$
> java -version
> java version "1.7.0_101"
> OpenJDK Runtime Environment (IcedTea 2.6.6) (7u101-2.6.6-0ubuntu0.14.04.1)
> OpenJDK 64-Bit Server VM (build 24.95-b01, mixed mode)
>
> Thanks
>
> Kosala
>
>
>
>
>
>
> On Mon, Aug 15, 2016 at 2:17 PM, <clearwater-request at lists.
> projectclearwater.org> wrote:
>
> Send Clearwater mailing list submissions to
>         clearwater at lists.projectclearwater.org
>
> To subscribe or unsubscribe via the World Wide Web, visit
>         http://lists.projectclearwater.org/mailman/
> listinfo/clearwater_lists.projectclearwater.org
>
> or, via email, send a message with subject or body 'help' to
>         clearwater-request at lists.projectclearwater.org
>
> You can reach the person managing the list at
>         clearwater-owner at lists.projectclearwater.org
>
> When replying, please edit your Subject line so it is more specific
> than "Re: Contents of Clearwater digest..."
>
>
> Today's Topics:
>
>    1. Stress Testing (Kosala)
>    2. Re: Stress Testing (Matt Williams (projectclearwater.org))
>    3. Re: Stress Testing (Matt Williams (projectclearwater.org))
>
>
> ----------------------------------------------------------------------
>
> Message: 1
> Date: Mon, 15 Aug 2016 10:38:57 +0100
> From: Kosala <kosalayb at gmail.com>
> To: clearwater at lists.projectclearwater.org
> Subject: [Project Clearwater] Stress Testing
> Message-ID:
>         <CAGEe17an2B_bGj8NfKFwms+nU=vJURyhT5CE+mcY1pjcm4YF+A at mail.
> gmail.com>
> Content-Type: text/plain; charset="utf-8"
>
> Hi Team,
>
> I installed clearwater "all-in-one" image on Oracle Virtual Box.
> 1. Can I do stress testing ?
> 2. How to do that?
>
> I am trying to follow Stress Testing on
> http://clearwater.readthedocs.io/en/stable/Clearwater_stress_testing.html#
> configuring-udp-stress
> .
>
> Using chef - > It seems chef/knife install only supports in the Cloud
> approach (The automated install is only supported for deployments running
> in Amazon?s EC2 cloud).
>
> Manual approach, It looks not supporting all in one image.
>
> Many Thanks
> Kosala
> -------------- next part --------------
> An HTML attachment was scrubbed...
> URL: <http://lists.projectclearwater.org/pipermail/clearwater_lists.
> projectclearwater.org/attachments/20160815/15fc3b07/attachment-0001.html>
>
> ------------------------------
>
> Message: 2
> Date: Mon, 15 Aug 2016 09:54:02 +0000
> From: "Matt Williams (projectclearwater.org)"
>         <matt at projectclearwater.org>
> To: Kosala <kosalayb at gmail.com>
> Cc: "clearwater at lists.projectclearwater.org"
>         <clearwater at lists.projectclearwater.org>
> Subject: Re: [Project Clearwater] Stress Testing
> Message-ID:
>         <CY1PR0201MB15636F1F20EB91BB180F053390120 at CY1PR0201MB1563.
> namprd02.prod.outlook.com>
>
> Content-Type: text/plain; charset="utf-8"
>
> Kosala,
>
> While it's theoretically possible to do stress testing against an
> all-in-one image, I'd recommend against it - the all-in-one image has been
> squeezed down a lot to fit on a single VM and we'd expect very low
> performance out of it, and I could believe that overload behavior might be
> suboptimal.  If you're looking to stress test for performance reasons, I'd
> strongly recommend running a full deployment as this will give you much
> more reliable numbers.  If you're looking to stress test for other reasons,
> please can you share a bit more about what you're trying to achieve, and we
> can have a think about what would work best?
>
> If you do really want to run stress testing against an all-in-one image,
> it should probably work, even though http://clearwater.readthedocs.
> io/en/latest/Clearwater_stress_testing.html#manual-i-
> e-non-chef-stress-runs only talks about Chef and manual installs.  You'd
> need to set the "bono_servers" option in /etc/clearwater/shared_config to
> point to your all-in-one node, and I suspect you'd need to reduce the
> "count" option to something a lot lower - I'd start around 5000 and see how
> that goes.
>
> I hope that helps.  Please let me know how you get on.
>
> Thanks,
>
> Matt
>
> From: Clearwater [mailto:clearwater-bounces at lists.projectclearwater.org]
> On Behalf Of Kosala
> Sent: 15 August 2016 10:39
> To: clearwater at lists.projectclearwater.org
> Subject: [Project Clearwater] Stress Testing
>
> Hi Team,
> I installed clearwater "all-in-one" image on Oracle Virtual Box.
> 1. Can I do stress testing ?
> 2. How to do that?
> I am trying to follow Stress Testing on http://clearwater.readthedocs.
> io/en/stable/Clearwater_stress_testing.html#configuring-udp-stress.
> Using chef - > It seems chef/knife install only supports in the Cloud
> approach (The automated install is only supported for deployments running
> in Amazon?s EC2 cloud).
> Manual approach, It looks not supporting all in one image.
> Many Thanks
> Kosala
>
> -------------- next part --------------
> An HTML attachment was scrubbed...
> URL: <http://lists.projectclearwater.org/pipermail/clearwater_lists.
> projectclearwater.org/attachments/20160815/29d6328d/attachment-0001.html>
>
> ------------------------------
>
> Message: 3
> Date: Mon, 15 Aug 2016 13:16:47 +0000
> From: "Matt Williams (projectclearwater.org)"
>         <matt at projectclearwater.org>
> To: "clearwater at lists.projectclearwater.org"
>         <clearwater at lists.projectclearwater.org>
> Subject: Re: [Project Clearwater] Stress Testing
> Message-ID:
>         <CY1PR0201MB156372246DC5A77B11839F9D90120 at CY1PR0201MB1563.
> namprd02.prod.outlook.com>
>
> Content-Type: text/plain; charset="utf-8"
>
> Kosala,
>
> You'll need to follow all the steps in http://clearwater.readthedocs.
> io/en/latest/Clearwater_stress_testing.html#manual-i-
> e-non-chef-stress-runs, i.e. bulk provisioning subscribers and installing
> clearwater-sip-stress, but that should be it.
>
> Just to be clear, though, you'll need to set the configuration and install
> the clearwater-sip-stress package on a separate VM, not on the all-in-one
> image itself - the all-in-one image almost certainly opens up ports that
> conflict with those that clearwater-sip-stress tries to use.
>
> This isn't a very well-trodden path, though, so you may hit further issues
> - let me know if so, and we can try to work through them.
>
> Cheers,
>
> Matt
>
> From: Kosala [mailto:kosalayb at gmail.com]
> Sent: 15 August 2016 13:41
> To: Matt Williams (projectclearwater.org) <matt at projectclearwater.org>
> Subject: Re: [Project Clearwater] Stress Testing
>
> Hi Matt,
> Thanks. I set the bono_servers option. Should I add count =5000 to
> /etc/clearwater/shared_config ?
>
> Do I need other changes to run stress tests on all-in-one image?
> Thanks
> Kosala
>
>
>
> On Mon, Aug 15, 2016 at 10:54 AM, Matt Williams (projectclearwater.org<
> http://projectclearwater.org>) <matt at projectclearwater.org<mailto:
> matt at projectclearwater.org>> wrote:
> Kosala,
>
> While it's theoretically possible to do stress testing against an
> all-in-one image, I'd recommend against it - the all-in-one image has been
> squeezed down a lot to fit on a single VM and we'd expect very low
> performance out of it, and I could believe that overload behavior might be
> suboptimal.  If you're looking to stress test for performance reasons, I'd
> strongly recommend running a full deployment as this will give you much
> more reliable numbers.  If you're looking to stress test for other reasons,
> please can you share a bit more about what you're trying to achieve, and we
> can have a think about what would work best?
>
> If you do really want to run stress testing against an all-in-one image,
> it should probably work, even though http://clearwater.readthedocs.
> io/en/latest/Clearwater_stress_testing.html#manual-i-
> e-non-chef-stress-runs only talks about Chef and manual installs.  You'd
> need to set the "bono_servers" option in /etc/clearwater/shared_config to
> point to your all-in-one node, and I suspect you'd need to reduce the
> "count" option to something a lot lower - I'd start around 5000 and see how
> that goes.
>
> I hope that helps.  Please let me know how you get on.
>
> Thanks,
>
> Matt
>
> From: Clearwater [mailto:clearwater-bounces at lists.projectclearwater.org<
> mailto:clearwater-bounces at lists.projectclearwater.org>] On Behalf Of
> Kosala
> Sent: 15 August 2016 10:39
> To: clearwater at lists.projectclearwater.org<mailto:clearwater at lists.
> projectclearwater.org>
> Subject: [Project Clearwater] Stress Testing
>
> Hi Team,
> I installed clearwater "all-in-one" image on Oracle Virtual Box.
> 1. Can I do stress testing ?
> 2. How to do that?
> I am trying to follow Stress Testing on http://clearwater.readthedocs.
> io/en/stable/Clearwater_stress_testing.html#configuring-udp-stress.
> Using chef - > It seems chef/knife install only supports in the Cloud
> approach (The automated install is only supported for deployments running
> in Amazon?s EC2 cloud).
> Manual approach, It looks not supporting all in one image.
> Many Thanks
> Kosala
>
>
> -------------- next part --------------
> An HTML attachment was scrubbed...
> URL: <http://lists.projectclearwater.org/pipermail/clearwater_lists.
> projectclearwater.org/attachments/20160815/11781755/attachment.html>
>
> ------------------------------
>
> Subject: Digest Footer
>
> _______________________________________________
> Clearwater mailing list
> Clearwater at lists.projectclearwater.org
> http://lists.projectclearwater.org/mailman/listinfo/clearwater_lists.
> projectclearwater.org
>
>
> ------------------------------
>
> End of Clearwater Digest, Vol 40, Issue 24
> ******************************************
>
>
>
>
>
>
>
>
>
>
>
>
>
>
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.projectclearwater.org/pipermail/clearwater_lists.projectclearwater.org/attachments/20160818/dd2f1d97/attachment.html>

From matt at projectclearwater.org  Thu Aug 18 05:47:30 2016
From: matt at projectclearwater.org (Matt Williams (projectclearwater.org))
Date: Thu, 18 Aug 2016 09:47:30 +0000
Subject: [Project Clearwater] Clearwater Digest, Vol 40, Issue 24
In-Reply-To: <CAGEe17bC+xmhP3D7w768r0svzBAxdBedVXhis1Z33Yqdq4THgA@mail.gmail.com>
References: <mailman.20.1471267072.11502.clearwater_lists.projectclearwater.org@lists.projectclearwater.org>
	<CAGEe17ZLnypQfbzxEwxj9EaB20MUBVpY+YdN-Obv=gHpZmG0KA@mail.gmail.com>
	<CY1PR0201MB1563F9A706F3EC7BE7F9C11590120@CY1PR0201MB1563.namprd02.prod.outlook.com>
	<CAGEe17bfTu1Kpwx=ipqtEbShvWtP+C6pJEEGHi0GSwBR5Dqw8w@mail.gmail.com>
	<CAGEe17aY077tLtotRe1X8k1qU_4otBdHDMJjqDH_g02Zs676Jg@mail.gmail.com>
	<CAGEe17ZeNPPy7AmMz=LCWnHqLm=v9Q7CuLT+AOVKWJTdg8m7Eg@mail.gmail.com>
	<CY1PR0201MB1563CE17983225B985B19D7390130@CY1PR0201MB1563.namprd02.prod.outlook.com>
	<CAGEe17b2M2uqvbOuqH7t4xM41FbfBYk0xR3zWqiFh+EkSfUzUQ@mail.gmail.com>
	<CY1PR0201MB1563CD5DDDD6E7B5A0B2DB7290140@CY1PR0201MB1563.namprd02.prod.outlook.com>
	<CAGEe17YGnaY1Kqc65gyiVO1sBBuTx=-YzfD9HY3M6QBD2t9AkA@mail.gmail.com>
	<CY1PR0201MB156349F26A0A7670BE7382A890140@CY1PR0201MB1563.namprd02.prod.outlook.com>
	<CAGEe17ZkY2ESNzwQYddrv6=jUJ5fPHu3gJXT7R1UjQmBd+eFUg@mail.gmail.com>
	<CY1PR0201MB1563C979B2D641DA59F1945A90150@CY1PR0201MB1563.namprd02.prod.outlook.com>
	<CAGEe17bC+xmhP3D7w768r0svzBAxdBedVXhis1Z33Yqdq4THgA@mail.gmail.com>
Message-ID: <CY1PR0201MB1563F865DFBF86128118AC5290150@CY1PR0201MB1563.namprd02.prod.outlook.com>

Kosala,

The fix is not to copy this to /usr/share/clearwater/utils, but to move it.  However, since the error is benign, I'd suggest just ignoring it while we get this working.

As I asked below, please can you confirm what version you're running?  I'm concerned that it's going to be very hard to troubleshoot problems if you have an all-in-one image from a few weeks ago, with some packages updated to more recent versions and then some further fixes manually applied.

Thanks,

Matt


From: Kosala [mailto:kosalayb at gmail.com]
Sent: 18 August 2016 10:34
To: Matt Williams (projectclearwater.org) <matt at projectclearwater.org>
Cc: clearwater at lists.projectclearwater.org
Subject: Re: [Project Clearwater] Clearwater Digest, Vol 40, Issue 24

Hi Matt,
Yeah, Manual calls are working fine.
As it is said in the big fix, https://github.com/Metaswitch/clearwater-infrastructure/issues/355 , I copied logging.bash to /usr/share/clearwater/utils
but I am still getting

/etc/init.d/clearwater-infrastructure: 76: /etc/init.d/clearwater-infrastructure: /usr/share/clearwater/infrastructure/scripts/logging.bash: Permission denied
Configuring monit for only localhost access
Kosala


On Thu, Aug 18, 2016 at 10:01 AM, Matt Williams (projectclearwater.org<http://projectclearwater.org>) <matt at projectclearwater.org<mailto:matt at projectclearwater.org>> wrote:
Kosala,

Yes, it's https://github.com/Metaswitch/clearwater-infrastructure/issues/355 and it should be benign.

However, this was fixed about 2 weeks ago.  Please can you confirm when you downloaded the all-in-one image, and whether you've upgraded it all?  (As I observed earlier, your crest release was from only a few days ago.)

Have you got manual calls working?

Thanks,

Matt


From: Kosala [mailto:kosalayb at gmail.com<mailto:kosalayb at gmail.com>]
Sent: 18 August 2016 09:56
To: Matt Williams (projectclearwater.org<http://projectclearwater.org>) <matt at projectclearwater.org<mailto:matt at projectclearwater.org>>
Cc: clearwater at lists.projectclearwater.org<mailto:clearwater at lists.projectclearwater.org>

Subject: Re: [Project Clearwater] Clearwater Digest, Vol 40, Issue 24

Hi Matt,
In SIP node, when I am trying to execute "sudo service clearwater-sip-stress restart", I am getting an error

/etc/init.d/clearwater-infrastructure: 76: /etc/init.d/clearwater-infrastructure: /usr/share/clearwater/infrastructure/scripts/logging.bash: Permission denied
Configuring monit for only localhost access
Any clue about this error?
Thanks
Kosala


On Wed, Aug 17, 2016 at 2:29 PM, Matt Williams (projectclearwater.org<http://projectclearwater.org>) <matt at projectclearwater.org<mailto:matt at projectclearwater.org>> wrote:
Kosala,

Yes, that's the correct screen, and you're correct that it shows that stress is being attempted but failing.

Do regular (non-stress) calls work through this deployment?

You can look at what message the stress node is receiving in the log files in the /var/log/clearwater-sip-stress/ directory - I think there are "errors" logs that contain the unexpected messages.

You can obviously also look at what's happening on the all-in-one node itself, using the /var/log/bono/*, /var/log/sprout/* and /var/log/homestead/* files, as described at http://clearwater.readthedocs.io/en/latest/Troubleshooting_and_Recovery.html.

I hope that helps.

Cheers,

Matt

From: Kosala [mailto:kosalayb at gmail.com<mailto:kosalayb at gmail.com>]
Sent: 17 August 2016 14:20

To: Matt Williams (projectclearwater.org<http://projectclearwater.org>) <matt at projectclearwater.org<mailto:matt at projectclearwater.org>>
Subject: Re: [Project Clearwater] Clearwater Digest, Vol 40, Issue 24

Hi Matt,
I can see this scenario screen from sip-stress.1.out. I hope this will be the stress test output results.

------------------------------ Scenario Screen -------- [1-9]: Change Screen --
     Users (length)   Port   Total-time  Total-calls  Remote-host
        2500 (0 ms)   5060      77.15 s         2500  10.0.21.192:5060(TCP)

  Call limit reached (-m 2500), 1.002 s period  1 ms scheduler resolution
  2175 calls (limit 2500)                Peak was 2499 calls, after 0 s
  0 Running, 2177 Paused, 8 Woken up
  0 dead call msg (discarded)            0 out-of-call msg (discarded)
  3 open sockets

                                 Messages  Retrans   Timeout   Unexpected-Msg
       Pause [0ms/10:00]         2500                          0
    REGISTER ---------->         326       0
         401 <----------         0         0         0         325
    REGISTER ---------->         0         0
         200 <----------         0         0         0         0
    REGISTER ---------->         0         0
         401 <----------         0         0         0         0
    REGISTER ---------->         0         0
         200 <----------         0         0         0         0
       Pause [     4:50]         0                             0
    REGISTER ---------->  B-RTD1 0         0
         200 <----------  E-RTD1 0         0         0         0
    REGISTER ---------->  B-RTD1 0         0
         200 <----------  E-RTD1 0         0         0         0
       Pause [     4:50]         0                             0
       Pause [$pre_call_delay]   0                             0
      INVITE ---------->  B-RTD2 0         0
         100 <----------         0         0         0         0
      INVITE <----------         0         0         0         0
         100 <----------         0         0         0         0
      INVITE <----------         0         0         0         0
         100 ---------->         0         0
         180 ---------->         0         0
         180 <----------         0         0         0         0
       Pause [   6000ms]         0                             0
         200 ---------->         0         0
         200 <----------         0         0         0         0
         ACK ---------->         0         0
         ACK <----------         0         0         0         0
      UPDATE ---------->         0         0
      UPDATE <----------         0         0         0         0
         200 ---------->         0         0
         200 <----------  E-RTD2 0         0         0         0
       Pause [    24.0s]         0                             0
         BYE ---------->  B-RTD3 0         0
         BYE <----------         0         0         0         0
         200 ---------->         0         0
         200 <----------  E-RTD3 0         0         0         0
       Pause [$post_call_delay]  0                             0
------- Waiting for active calls to end. Press [q] again to force exit. -------
Last Error: Aborting call on unexpected message for Call-Id '1079-13729 at ...
However there is an unexpected message error at the end.
Thanks
Kosala


On Wed, Aug 17, 2016 at 12:40 PM, Matt Williams (projectclearwater.org<http://projectclearwater.org>) <matt at projectclearwater.org<mailto:matt at projectclearwater.org>> wrote:
Kosala,

They should log to /var/log/clearwater-sip-stress - in particular, the *.1.out file is a log of the output from sipp.  Do you see anything there?

Matt

From: Kosala [mailto:kosalayb at gmail.com<mailto:kosalayb at gmail.com>]
Sent: 17 August 2016 12:33
To: Matt Williams (projectclearwater.org<http://projectclearwater.org>) <matt at projectclearwater.org<mailto:matt at projectclearwater.org>>; clearwater at lists.projectclearwater.org<mailto:clearwater at lists.projectclearwater.org>

Subject: Re: [Project Clearwater] Clearwater Digest, Vol 40, Issue 24

Hi Matt,
I followed above steps and run sudo apt-get install clearwater-sip-stress.
How do I know stress tests are running? Is is said, stress tests start automatically but I cannot see it.
Thanks
Kosala



On Tue, Aug 16, 2016 at 2:01 PM, Matt Williams (projectclearwater.org<http://projectclearwater.org>) <matt at projectclearwater.org<mailto:matt at projectclearwater.org>> wrote:
Kosala,

I'm glad you've made progress on this.

I had a look at the crest package version, but it seems to be later than the most recent all-in-one image uses (1.0-160811.103635).  When did you download the all-in-one image, and did you apply any patches to it?

Regarding making calls for stress testing, this is where http://clearwater.readthedocs.io/en/latest/Clearwater_stress_testing.html#manual-i-e-non-chef-stress-runs comes in - you need to

?         create a separate VM

?         set the bono_hostname and count parameters in /etc/clearwater/shared_config

?         install the clearwater-sip-stress package.
I hope that helps.

BTW, please remember to copy in clearwater at lists.projectclearwater.org<mailto:clearwater at lists.projectclearwater.org> - that means that other people can see and comment on your posts.

Thanks,

Matt


From: Kosala [mailto:kosalayb at gmail.com<mailto:kosalayb at gmail.com>]
Sent: 16 August 2016 10:48
To: Matt Williams (projectclearwater.org<http://projectclearwater.org>) <matt at projectclearwater.org<mailto:matt at projectclearwater.org>>
Subject: Re: [Project Clearwater] Clearwater Digest, Vol 40, Issue 24

Hi Matt,
Bulk provisioning for all in one image is done using https://github.com/Metaswitch/crest/blob/dev/docs/Bulk-Provisioning%20Numbers.md.
I have records in tables in homestead_cache and homer.
Now How to make calls for stress testing?
Is there any guideline?
Many Thanks,
Kosala




On Tue, Aug 16, 2016 at 9:04 AM, Kosala <kosalayb at gmail.com<mailto:kosalayb at gmail.com>> wrote:
Hi Matt,
TBH, The document in https://github.com/Metaswitch/crest/blob/dev/docs/Bulk-Provisioning%20Numbers.md is not clear to me.
Step 1. Homestead node in deployment. I do not know where is that node in all in one image. It will be helpful the location of that folder from the root.
Step 2. A simple example will be helpful.
Thanks
Kosala


On Tue, Aug 16, 2016 at 8:50 AM, Kosala <kosalayb at gmail.com<mailto:kosalayb at gmail.com>> wrote:
Hi Matt,
I downloaded the all in one package from http://clearwater.readthedocs.io/en/stable/All_in_one_OVF_Installation.html
and imported using oracle virtual box on ubuntu 14.04,
Crest version
[cw-aio]ubuntu at cwaio:~$ sudo dpkg-query -s crest
Package: crest
Status: install ok installed
Priority: optional
Section: network
Installed-Size: 40098
Maintainer: Project Clearwater Maintainers <maintainers at projectclearwater.org<mailto:maintainers at projectclearwater.org>>
Architecture: amd64
Version: 1.0-160815.145007
Thanks
Kosala


On Mon, Aug 15, 2016 at 5:56 PM, Matt Williams (projectclearwater.org<http://projectclearwater.org>) <matt at projectclearwater.org<mailto:matt at projectclearwater.org>> wrote:
Kosala,

That's odd - I don't see that failure on my all-in-one image (spun up just now from the latest image) - which version of all-in-one-image are you running, and which version of crest does it include ("sudo dpkg-query -s crest")?

You may be able to work-around this either by taking the latest all-in-one image or by following the simpler bulk-provisioning process at https://github.com/Metaswitch/crest/blob/dev/docs/Bulk-Provisioning%20Numbers.md (when this doc talks about using the sstables_provisioning process for very large sets of numbers, we mean 1M+ numbers - the 9000 you're provisioning are well within the capabilities of this process).

I hope that helps - please let me know how you get on.

Cheers,

Matt


From: Clearwater [mailto:clearwater-bounces at lists.projectclearwater.org<mailto:clearwater-bounces at lists.projectclearwater.org>] On Behalf Of Kosala
Sent: 15 August 2016 16:58
To: clearwater at lists.projectclearwater.org<mailto:clearwater at lists.projectclearwater.org>
Subject: Re: [Project Clearwater] Clearwater Digest, Vol 40, Issue 24

HI Matt,
Thanks.

I am trying to follow https://github.com/Metaswitch/crest/blob/dev/src/metaswitch/crest/tools/sstable_provisioning/README.md for bulk provisioning.

When I am trying to execute sudo ./BulkProvision homer 21000 29999 example.com<http://example.com> 7kkzTyGW in all-in-one image,
I am getting an error  java.lang.UnsupportedClassVersionError: ClearwaterBulkProvisioner : Unsupported major.minor version 52.0
Java version info in all-in-one image:
[cw-aio]ubuntu at cwaio:/usr/share/clearwater/crest/tools/sstable_provisioning$ java -version
java version "1.7.0_101"
OpenJDK Runtime Environment (IcedTea 2.6.6) (7u101-2.6.6-0ubuntu0.14.04.1)
OpenJDK 64-Bit Server VM (build 24.95-b01, mixed mode)
Thanks
Kosala



On Mon, Aug 15, 2016 at 2:17 PM, <clearwater-request at lists.projectclearwater.org<mailto:clearwater-request at lists.projectclearwater.org>> wrote:
Send Clearwater mailing list submissions to
        clearwater at lists.projectclearwater.org<mailto:clearwater at lists.projectclearwater.org>

To subscribe or unsubscribe via the World Wide Web, visit
        http://lists.projectclearwater.org/mailman/listinfo/clearwater_lists.projectclearwater.org

or, via email, send a message with subject or body 'help' to
        clearwater-request at lists.projectclearwater.org<mailto:clearwater-request at lists.projectclearwater.org>

You can reach the person managing the list at
        clearwater-owner at lists.projectclearwater.org<mailto:clearwater-owner at lists.projectclearwater.org>

When replying, please edit your Subject line so it is more specific
than "Re: Contents of Clearwater digest..."


Today's Topics:

   1. Stress Testing (Kosala)
   2. Re: Stress Testing (Matt Williams (projectclearwater.org<http://projectclearwater.org>))
   3. Re: Stress Testing (Matt Williams (projectclearwater.org<http://projectclearwater.org>))


----------------------------------------------------------------------

Message: 1
Date: Mon, 15 Aug 2016 10:38:57 +0100
From: Kosala <kosalayb at gmail.com<mailto:kosalayb at gmail.com>>
To: clearwater at lists.projectclearwater.org<mailto:clearwater at lists.projectclearwater.org>
Subject: [Project Clearwater] Stress Testing
Message-ID:
        <CAGEe17an2B_bGj8NfKFwms+nU=vJURyhT5CE+mcY1pjcm4YF+A at mail.gmail.com<mailto:vJURyhT5CE%2BmcY1pjcm4YF%2BA at mail.gmail.com>>
Content-Type: text/plain; charset="utf-8"

Hi Team,

I installed clearwater "all-in-one" image on Oracle Virtual Box.
1. Can I do stress testing ?
2. How to do that?

I am trying to follow Stress Testing on
http://clearwater.readthedocs.io/en/stable/Clearwater_stress_testing.html#configuring-udp-stress
.

Using chef - > It seems chef/knife install only supports in the Cloud
approach (The automated install is only supported for deployments running
in Amazon?s EC2 cloud).

Manual approach, It looks not supporting all in one image.

Many Thanks
Kosala
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.projectclearwater.org/pipermail/clearwater_lists.projectclearwater.org/attachments/20160815/15fc3b07/attachment-0001.html>

------------------------------

Message: 2
Date: Mon, 15 Aug 2016 09:54:02 +0000
From: "Matt Williams (projectclearwater.org<http://projectclearwater.org>)"
        <matt at projectclearwater.org<mailto:matt at projectclearwater.org>>
To: Kosala <kosalayb at gmail.com<mailto:kosalayb at gmail.com>>
Cc: "clearwater at lists.projectclearwater.org<mailto:clearwater at lists.projectclearwater.org>"
        <clearwater at lists.projectclearwater.org<mailto:clearwater at lists.projectclearwater.org>>
Subject: Re: [Project Clearwater] Stress Testing
Message-ID:
        <CY1PR0201MB15636F1F20EB91BB180F053390120 at CY1PR0201MB1563.namprd02.prod.outlook.com<mailto:CY1PR0201MB15636F1F20EB91BB180F053390120 at CY1PR0201MB1563.namprd02.prod.outlook.com>>

Content-Type: text/plain; charset="utf-8"

Kosala,

While it's theoretically possible to do stress testing against an all-in-one image, I'd recommend against it - the all-in-one image has been squeezed down a lot to fit on a single VM and we'd expect very low performance out of it, and I could believe that overload behavior might be suboptimal.  If you're looking to stress test for performance reasons, I'd strongly recommend running a full deployment as this will give you much more reliable numbers.  If you're looking to stress test for other reasons, please can you share a bit more about what you're trying to achieve, and we can have a think about what would work best?

If you do really want to run stress testing against an all-in-one image, it should probably work, even though http://clearwater.readthedocs.io/en/latest/Clearwater_stress_testing.html#manual-i-e-non-chef-stress-runs only talks about Chef and manual installs.  You'd need to set the "bono_servers" option in /etc/clearwater/shared_config to point to your all-in-one node, and I suspect you'd need to reduce the "count" option to something a lot lower - I'd start around 5000 and see how that goes.

I hope that helps.  Please let me know how you get on.

Thanks,

Matt

From: Clearwater [mailto:clearwater-bounces at lists.projectclearwater.org<mailto:clearwater-bounces at lists.projectclearwater.org>] On Behalf Of Kosala
Sent: 15 August 2016 10:39
To: clearwater at lists.projectclearwater.org<mailto:clearwater at lists.projectclearwater.org>
Subject: [Project Clearwater] Stress Testing

Hi Team,
I installed clearwater "all-in-one" image on Oracle Virtual Box.
1. Can I do stress testing ?
2. How to do that?
I am trying to follow Stress Testing on http://clearwater.readthedocs.io/en/stable/Clearwater_stress_testing.html#configuring-udp-stress.
Using chef - > It seems chef/knife install only supports in the Cloud approach (The automated install is only supported for deployments running in Amazon?s EC2 cloud).
Manual approach, It looks not supporting all in one image.
Many Thanks
Kosala

-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.projectclearwater.org/pipermail/clearwater_lists.projectclearwater.org/attachments/20160815/29d6328d/attachment-0001.html>

------------------------------

Message: 3
Date: Mon, 15 Aug 2016 13:16:47 +0000
From: "Matt Williams (projectclearwater.org<http://projectclearwater.org>)"
        <matt at projectclearwater.org<mailto:matt at projectclearwater.org>>
To: "clearwater at lists.projectclearwater.org<mailto:clearwater at lists.projectclearwater.org>"
        <clearwater at lists.projectclearwater.org<mailto:clearwater at lists.projectclearwater.org>>
Subject: Re: [Project Clearwater] Stress Testing
Message-ID:
        <CY1PR0201MB156372246DC5A77B11839F9D90120 at CY1PR0201MB1563.namprd02.prod.outlook.com<mailto:CY1PR0201MB156372246DC5A77B11839F9D90120 at CY1PR0201MB1563.namprd02.prod.outlook.com>>

Content-Type: text/plain; charset="utf-8"

Kosala,

You'll need to follow all the steps in http://clearwater.readthedocs.io/en/latest/Clearwater_stress_testing.html#manual-i-e-non-chef-stress-runs, i.e. bulk provisioning subscribers and installing clearwater-sip-stress, but that should be it.

Just to be clear, though, you'll need to set the configuration and install the clearwater-sip-stress package on a separate VM, not on the all-in-one image itself - the all-in-one image almost certainly opens up ports that conflict with those that clearwater-sip-stress tries to use.

This isn't a very well-trodden path, though, so you may hit further issues - let me know if so, and we can try to work through them.

Cheers,

Matt

From: Kosala [mailto:kosalayb at gmail.com<mailto:kosalayb at gmail.com>]
Sent: 15 August 2016 13:41
To: Matt Williams (projectclearwater.org<http://projectclearwater.org>) <matt at projectclearwater.org<mailto:matt at projectclearwater.org>>
Subject: Re: [Project Clearwater] Stress Testing

Hi Matt,
Thanks. I set the bono_servers option. Should I add count =5000 to /etc/clearwater/shared_config ?

Do I need other changes to run stress tests on all-in-one image?
Thanks
Kosala



On Mon, Aug 15, 2016 at 10:54 AM, Matt Williams (projectclearwater.org<http://projectclearwater.org><http://projectclearwater.org>) <matt at projectclearwater.org<mailto:matt at projectclearwater.org><mailto:matt at projectclearwater.org<mailto:matt at projectclearwater.org>>> wrote:
Kosala,

While it's theoretically possible to do stress testing against an all-in-one image, I'd recommend against it - the all-in-one image has been squeezed down a lot to fit on a single VM and we'd expect very low performance out of it, and I could believe that overload behavior might be suboptimal.  If you're looking to stress test for performance reasons, I'd strongly recommend running a full deployment as this will give you much more reliable numbers.  If you're looking to stress test for other reasons, please can you share a bit more about what you're trying to achieve, and we can have a think about what would work best?

If you do really want to run stress testing against an all-in-one image, it should probably work, even though http://clearwater.readthedocs.io/en/latest/Clearwater_stress_testing.html#manual-i-e-non-chef-stress-runs only talks about Chef and manual installs.  You'd need to set the "bono_servers" option in /etc/clearwater/shared_config to point to your all-in-one node, and I suspect you'd need to reduce the "count" option to something a lot lower - I'd start around 5000 and see how that goes.

I hope that helps.  Please let me know how you get on.

Thanks,

Matt

From: Clearwater [mailto:clearwater-bounces at lists.projectclearwater.org<mailto:clearwater-bounces at lists.projectclearwater.org><mailto:clearwater-bounces at lists.projectclearwater.org<mailto:clearwater-bounces at lists.projectclearwater.org>>] On Behalf Of Kosala
Sent: 15 August 2016 10:39
To: clearwater at lists.projectclearwater.org<mailto:clearwater at lists.projectclearwater.org><mailto:clearwater at lists.projectclearwater.org<mailto:clearwater at lists.projectclearwater.org>>
Subject: [Project Clearwater] Stress Testing

Hi Team,
I installed clearwater "all-in-one" image on Oracle Virtual Box.
1. Can I do stress testing ?
2. How to do that?
I am trying to follow Stress Testing on http://clearwater.readthedocs.io/en/stable/Clearwater_stress_testing.html#configuring-udp-stress.
Using chef - > It seems chef/knife install only supports in the Cloud approach (The automated install is only supported for deployments running in Amazon?s EC2 cloud).
Manual approach, It looks not supporting all in one image.
Many Thanks
Kosala


-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.projectclearwater.org/pipermail/clearwater_lists.projectclearwater.org/attachments/20160815/11781755/attachment.html>

------------------------------

Subject: Digest Footer

_______________________________________________
Clearwater mailing list
Clearwater at lists.projectclearwater.org<mailto:Clearwater at lists.projectclearwater.org>
http://lists.projectclearwater.org/mailman/listinfo/clearwater_lists.projectclearwater.org


------------------------------

End of Clearwater Digest, Vol 40, Issue 24
******************************************








-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.projectclearwater.org/pipermail/clearwater_lists.projectclearwater.org/attachments/20160818/1aac03c5/attachment.html>

From matt at projectclearwater.org  Thu Aug 18 07:38:39 2016
From: matt at projectclearwater.org (Matt Williams (projectclearwater.org))
Date: Thu, 18 Aug 2016 11:38:39 +0000
Subject: [Project Clearwater] Clearwater Digest, Vol 40, Issue 24
In-Reply-To: <CAGEe17Z2wBvTgPrnK_TdQPerVE9Moxnt=u9CWPpq8V04GJtfUw@mail.gmail.com>
References: <mailman.20.1471267072.11502.clearwater_lists.projectclearwater.org@lists.projectclearwater.org>
	<CAGEe17ZLnypQfbzxEwxj9EaB20MUBVpY+YdN-Obv=gHpZmG0KA@mail.gmail.com>
	<CY1PR0201MB1563F9A706F3EC7BE7F9C11590120@CY1PR0201MB1563.namprd02.prod.outlook.com>
	<CAGEe17bfTu1Kpwx=ipqtEbShvWtP+C6pJEEGHi0GSwBR5Dqw8w@mail.gmail.com>
	<CAGEe17aY077tLtotRe1X8k1qU_4otBdHDMJjqDH_g02Zs676Jg@mail.gmail.com>
	<CAGEe17ZeNPPy7AmMz=LCWnHqLm=v9Q7CuLT+AOVKWJTdg8m7Eg@mail.gmail.com>
	<CY1PR0201MB1563CE17983225B985B19D7390130@CY1PR0201MB1563.namprd02.prod.outlook.com>
	<CAGEe17b2M2uqvbOuqH7t4xM41FbfBYk0xR3zWqiFh+EkSfUzUQ@mail.gmail.com>
	<CY1PR0201MB1563CD5DDDD6E7B5A0B2DB7290140@CY1PR0201MB1563.namprd02.prod.outlook.com>
	<CAGEe17YGnaY1Kqc65gyiVO1sBBuTx=-YzfD9HY3M6QBD2t9AkA@mail.gmail.com>
	<CY1PR0201MB156349F26A0A7670BE7382A890140@CY1PR0201MB1563.namprd02.prod.outlook.com>
	<CAGEe17ZkY2ESNzwQYddrv6=jUJ5fPHu3gJXT7R1UjQmBd+eFUg@mail.gmail.com>
	<CY1PR0201MB1563C979B2D641DA59F1945A90150@CY1PR0201MB1563.namprd02.prod.outlook.com>
	<CAGEe17bC+xmhP3D7w768r0svzBAxdBedVXhis1Z33Yqdq4THgA@mail.gmail.com>
	<CY1PR0201MB1563F865DFBF86128118AC5290150@CY1PR0201MB1563.namprd02.prod.outlook.com>
	<CAGEe17Z2wBvTgPrnK_TdQPerVE9Moxnt=u9CWPpq8V04GJtfUw@mail.gmail.com>
Message-ID: <CY1PR0201MB1563A30C3B9C4D8EE65FAD4390150@CY1PR0201MB1563.namprd02.prod.outlook.com>

Kosala,

Thanks!  I'm very confused about your software version, though, as the latest all-in-one image has

?         crest 1.0-160811.103635 (i.e. older than yours)

?         homestead 1.0-160814.205535 (i.e. slightly newer than yours)

?         sprout 1.0-160814.205701 (i.e. much newer than yours)

?         the logging.bash script fix already applied.
It looks as though your might have taken the previous all-in-one image, and then upgraded some of the packages.  Please can you confirm: have you upgraded any packages?

On the issue you're seeing, I think you're saying that

?         you're running clearwater-sip-stress (which defaults to using numbers in the range above 2010000000)

?         you've deleted all these numbers from Homestead's Cassandra

?         you see errors in clearwater-sip-stress's log file saying that registration are failing with "404 Not Found".
I think this is expected - you need to provision numbers in Homestead's Cassandra that match the numbers that clearwater-sip-stress is expecting to register as.  Please let me know if I've misunderstood.

Thanks,

Matt

From: Kosala [mailto:kosalayb at gmail.com]
Sent: 18 August 2016 11:46
To: Matt Williams (projectclearwater.org) <matt at projectclearwater.org>
Subject: Re: [Project Clearwater] Clearwater Digest, Vol 40, Issue 24


Hi Matt,
I am running the latest version all-in-one which i downloaded from http://vm-images.cw-ngv.com/cw-aio.ova.

[cw-aio]ubuntu at cwaio:~$ sudo dpkg-query -s crest
[sudo] password for ubuntu:
Package: crest
Status: install ok installed
Priority: optional
Section: network
Installed-Size: 40102
Maintainer: Project Clearwater Maintainers <maintainers at projectclearwater.org<mailto:maintainers at projectclearwater.org>>
Architecture: amd64
Version: 1.0-160818.091648
homestead
Version: 1.0-160812.164051
sprout
Version: 1.0-160726.101022
And one strange thing is:
I deleted all the records in tables from homestead_cache and homestead_provisioning. Then when I check the SIP node for logs, sip-stress_14320_errors.log still has records with sip: ids which are not in Cassandra. For example, sip:2010021460 at example.com<mailto:sip%3A2010021460 at example.com>
2016-08-18      10:26:08:288    1471515968.288189: Aborting call on unexpected message for Call-Id '4270-14320 at 10.0.22.193<mailto:4270-14320 at 10.0.22.193>': while expecting '401' (index 3), received 'SIP/2.0 404 Not Found^M
Via: SIP/2.0/TCP 10.0.22.193:5060;rport=35233;received=10.0.22.193;branch=z9hG4bK-14320-4270-2-2010021460-^M
Record-Route: <sip:scscf.cwaio:5054;transport=TCP;lr;service=scscf;billing-role=charge-orig>^M
Call-ID: 2010021460///4270-14320 at 10.0.22.193<mailto:4270-14320 at 10.0.22.193>^M
From: <sip:2010021460 at example.com<mailto:sip%3A2010021460 at example.com>>;tag=14320SIPpTag004270^M
To: <sip:2010021460 at example.com<mailto:sip%3A2010021460 at example.com>>;tag=z9hG4bKPjVe2he9j28lou.0Dl9NmKGS7ypUMLjMJv^M
CSeq: 1 REGISTER^M
Content-Length:  0^M
Thanks
Kosala

On Thu, Aug 18, 2016 at 10:47 AM, Matt Williams (projectclearwater.org<http://projectclearwater.org>) <matt at projectclearwater.org<mailto:matt at projectclearwater.org>> wrote:
Kosala,

The fix is not to copy this to /usr/share/clearwater/utils, but to move it.  However, since the error is benign, I'd suggest just ignoring it while we get this working.

As I asked below, please can you confirm what version you're running?  I'm concerned that it's going to be very hard to troubleshoot problems if you have an all-in-one image from a few weeks ago, with some packages updated to more recent versions and then some further fixes manually applied.

Thanks,

Matt


From: Kosala [mailto:kosalayb at gmail.com<mailto:kosalayb at gmail.com>]
Sent: 18 August 2016 10:34

To: Matt Williams (projectclearwater.org<http://projectclearwater.org>) <matt at projectclearwater.org<mailto:matt at projectclearwater.org>>
Cc: clearwater at lists.projectclearwater.org<mailto:clearwater at lists.projectclearwater.org>
Subject: Re: [Project Clearwater] Clearwater Digest, Vol 40, Issue 24

Hi Matt,
Yeah, Manual calls are working fine.
As it is said in the big fix, https://github.com/Metaswitch/clearwater-infrastructure/issues/355 , I copied logging.bash to /usr/share/clearwater/utils
but I am still getting

/etc/init.d/clearwater-infrastructure: 76: /etc/init.d/clearwater-infrastructure: /usr/share/clearwater/infrastructure/scripts/logging.bash: Permission denied
Configuring monit for only localhost access
Kosala


On Thu, Aug 18, 2016 at 10:01 AM, Matt Williams (projectclearwater.org<http://projectclearwater.org>) <matt at projectclearwater.org<mailto:matt at projectclearwater.org>> wrote:
Kosala,

Yes, it's https://github.com/Metaswitch/clearwater-infrastructure/issues/355 and it should be benign.

However, this was fixed about 2 weeks ago.  Please can you confirm when you downloaded the all-in-one image, and whether you've upgraded it all?  (As I observed earlier, your crest release was from only a few days ago.)

Have you got manual calls working?

Thanks,

Matt


From: Kosala [mailto:kosalayb at gmail.com<mailto:kosalayb at gmail.com>]
Sent: 18 August 2016 09:56
To: Matt Williams (projectclearwater.org<http://projectclearwater.org>) <matt at projectclearwater.org<mailto:matt at projectclearwater.org>>
Cc: clearwater at lists.projectclearwater.org<mailto:clearwater at lists.projectclearwater.org>

Subject: Re: [Project Clearwater] Clearwater Digest, Vol 40, Issue 24

Hi Matt,
In SIP node, when I am trying to execute "sudo service clearwater-sip-stress restart", I am getting an error

/etc/init.d/clearwater-infrastructure: 76: /etc/init.d/clearwater-infrastructure: /usr/share/clearwater/infrastructure/scripts/logging.bash: Permission denied
Configuring monit for only localhost access
Any clue about this error?
Thanks
Kosala


On Wed, Aug 17, 2016 at 2:29 PM, Matt Williams (projectclearwater.org<http://projectclearwater.org>) <matt at projectclearwater.org<mailto:matt at projectclearwater.org>> wrote:
Kosala,

Yes, that's the correct screen, and you're correct that it shows that stress is being attempted but failing.

Do regular (non-stress) calls work through this deployment?

You can look at what message the stress node is receiving in the log files in the /var/log/clearwater-sip-stress/ directory - I think there are "errors" logs that contain the unexpected messages.

You can obviously also look at what's happening on the all-in-one node itself, using the /var/log/bono/*, /var/log/sprout/* and /var/log/homestead/* files, as described at http://clearwater.readthedocs.io/en/latest/Troubleshooting_and_Recovery.html.

I hope that helps.

Cheers,

Matt

From: Kosala [mailto:kosalayb at gmail.com<mailto:kosalayb at gmail.com>]
Sent: 17 August 2016 14:20

To: Matt Williams (projectclearwater.org<http://projectclearwater.org>) <matt at projectclearwater.org<mailto:matt at projectclearwater.org>>
Subject: Re: [Project Clearwater] Clearwater Digest, Vol 40, Issue 24

Hi Matt,
I can see this scenario screen from sip-stress.1.out. I hope this will be the stress test output results.

------------------------------ Scenario Screen -------- [1-9]: Change Screen --
     Users (length)   Port   Total-time  Total-calls  Remote-host
        2500 (0 ms)   5060      77.15 s         2500  10.0.21.192:5060(TCP)

  Call limit reached (-m 2500), 1.002 s period  1 ms scheduler resolution
  2175 calls (limit 2500)                Peak was 2499 calls, after 0 s
  0 Running, 2177 Paused, 8 Woken up
  0 dead call msg (discarded)            0 out-of-call msg (discarded)
  3 open sockets

                                 Messages  Retrans   Timeout   Unexpected-Msg
       Pause [0ms/10:00]         2500                          0
    REGISTER ---------->         326       0
         401 <----------         0         0         0         325
    REGISTER ---------->         0         0
         200 <----------         0         0         0         0
    REGISTER ---------->         0         0
         401 <----------         0         0         0         0
    REGISTER ---------->         0         0
         200 <----------         0         0         0         0
       Pause [     4:50]         0                             0
    REGISTER ---------->  B-RTD1 0         0
         200 <----------  E-RTD1 0         0         0         0
    REGISTER ---------->  B-RTD1 0         0
         200 <----------  E-RTD1 0         0         0         0
       Pause [     4:50]         0                             0
       Pause [$pre_call_delay]   0                             0
      INVITE ---------->  B-RTD2 0         0
         100 <----------         0         0         0         0
      INVITE <----------         0         0         0         0
         100 <----------         0         0         0         0
      INVITE <----------         0         0         0         0
         100 ---------->         0         0
         180 ---------->         0         0
         180 <----------         0         0         0         0
       Pause [   6000ms]         0                             0
         200 ---------->         0         0
         200 <----------         0         0         0         0
         ACK ---------->         0         0
         ACK <----------         0         0         0         0
      UPDATE ---------->         0         0
      UPDATE <----------         0         0         0         0
         200 ---------->         0         0
         200 <----------  E-RTD2 0         0         0         0
       Pause [    24.0s]         0                             0
         BYE ---------->  B-RTD3 0         0
         BYE <----------         0         0         0         0
         200 ---------->         0         0
         200 <----------  E-RTD3 0         0         0         0
       Pause [$post_call_delay]  0                             0
------- Waiting for active calls to end. Press [q] again to force exit. -------
Last Error: Aborting call on unexpected message for Call-Id '1079-13729 at ...
However there is an unexpected message error at the end.
Thanks
Kosala


On Wed, Aug 17, 2016 at 12:40 PM, Matt Williams (projectclearwater.org<http://projectclearwater.org>) <matt at projectclearwater.org<mailto:matt at projectclearwater.org>> wrote:
Kosala,

They should log to /var/log/clearwater-sip-stress - in particular, the *.1.out file is a log of the output from sipp.  Do you see anything there?

Matt

From: Kosala [mailto:kosalayb at gmail.com<mailto:kosalayb at gmail.com>]
Sent: 17 August 2016 12:33
To: Matt Williams (projectclearwater.org<http://projectclearwater.org>) <matt at projectclearwater.org<mailto:matt at projectclearwater.org>>; clearwater at lists.projectclearwater.org<mailto:clearwater at lists.projectclearwater.org>

Subject: Re: [Project Clearwater] Clearwater Digest, Vol 40, Issue 24

Hi Matt,
I followed above steps and run sudo apt-get install clearwater-sip-stress.
How do I know stress tests are running? Is is said, stress tests start automatically but I cannot see it.
Thanks
Kosala



On Tue, Aug 16, 2016 at 2:01 PM, Matt Williams (projectclearwater.org<http://projectclearwater.org>) <matt at projectclearwater.org<mailto:matt at projectclearwater.org>> wrote:
Kosala,

I'm glad you've made progress on this.

I had a look at the crest package version, but it seems to be later than the most recent all-in-one image uses (1.0-160811.103635).  When did you download the all-in-one image, and did you apply any patches to it?

Regarding making calls for stress testing, this is where http://clearwater.readthedocs.io/en/latest/Clearwater_stress_testing.html#manual-i-e-non-chef-stress-runs comes in - you need to

?         create a separate VM

?         set the bono_hostname and count parameters in /etc/clearwater/shared_config

?         install the clearwater-sip-stress package.
I hope that helps.

BTW, please remember to copy in clearwater at lists.projectclearwater.org<mailto:clearwater at lists.projectclearwater.org> - that means that other people can see and comment on your posts.

Thanks,

Matt


From: Kosala [mailto:kosalayb at gmail.com<mailto:kosalayb at gmail.com>]
Sent: 16 August 2016 10:48
To: Matt Williams (projectclearwater.org<http://projectclearwater.org>) <matt at projectclearwater.org<mailto:matt at projectclearwater.org>>
Subject: Re: [Project Clearwater] Clearwater Digest, Vol 40, Issue 24

Hi Matt,
Bulk provisioning for all in one image is done using https://github.com/Metaswitch/crest/blob/dev/docs/Bulk-Provisioning%20Numbers.md.
I have records in tables in homestead_cache and homer.
Now How to make calls for stress testing?
Is there any guideline?
Many Thanks,
Kosala




On Tue, Aug 16, 2016 at 9:04 AM, Kosala <kosalayb at gmail.com<mailto:kosalayb at gmail.com>> wrote:
Hi Matt,
TBH, The document in https://github.com/Metaswitch/crest/blob/dev/docs/Bulk-Provisioning%20Numbers.md is not clear to me.
Step 1. Homestead node in deployment. I do not know where is that node in all in one image. It will be helpful the location of that folder from the root.
Step 2. A simple example will be helpful.
Thanks
Kosala


On Tue, Aug 16, 2016 at 8:50 AM, Kosala <kosalayb at gmail.com<mailto:kosalayb at gmail.com>> wrote:
Hi Matt,
I downloaded the all in one package from http://clearwater.readthedocs.io/en/stable/All_in_one_OVF_Installation.html
and imported using oracle virtual box on ubuntu 14.04,
Crest version
[cw-aio]ubuntu at cwaio:~$ sudo dpkg-query -s crest
Package: crest
Status: install ok installed
Priority: optional
Section: network
Installed-Size: 40098
Maintainer: Project Clearwater Maintainers <maintainers at projectclearwater.org<mailto:maintainers at projectclearwater.org>>
Architecture: amd64
Version: 1.0-160815.145007
Thanks
Kosala


On Mon, Aug 15, 2016 at 5:56 PM, Matt Williams (projectclearwater.org<http://projectclearwater.org>) <matt at projectclearwater.org<mailto:matt at projectclearwater.org>> wrote:
Kosala,

That's odd - I don't see that failure on my all-in-one image (spun up just now from the latest image) - which version of all-in-one-image are you running, and which version of crest does it include ("sudo dpkg-query -s crest")?

You may be able to work-around this either by taking the latest all-in-one image or by following the simpler bulk-provisioning process at https://github.com/Metaswitch/crest/blob/dev/docs/Bulk-Provisioning%20Numbers.md (when this doc talks about using the sstables_provisioning process for very large sets of numbers, we mean 1M+ numbers - the 9000 you're provisioning are well within the capabilities of this process).

I hope that helps - please let me know how you get on.

Cheers,

Matt


From: Clearwater [mailto:clearwater-bounces at lists.projectclearwater.org<mailto:clearwater-bounces at lists.projectclearwater.org>] On Behalf Of Kosala
Sent: 15 August 2016 16:58
To: clearwater at lists.projectclearwater.org<mailto:clearwater at lists.projectclearwater.org>
Subject: Re: [Project Clearwater] Clearwater Digest, Vol 40, Issue 24

HI Matt,
Thanks.

I am trying to follow https://github.com/Metaswitch/crest/blob/dev/src/metaswitch/crest/tools/sstable_provisioning/README.md for bulk provisioning.

When I am trying to execute sudo ./BulkProvision homer 21000 29999 example.com<http://example.com> 7kkzTyGW in all-in-one image,
I am getting an error  java.lang.UnsupportedClassVersionError: ClearwaterBulkProvisioner : Unsupported major.minor version 52.0
Java version info in all-in-one image:
[cw-aio]ubuntu at cwaio:/usr/share/clearwater/crest/tools/sstable_provisioning$ java -version
java version "1.7.0_101"
OpenJDK Runtime Environment (IcedTea 2.6.6) (7u101-2.6.6-0ubuntu0.14.04.1)
OpenJDK 64-Bit Server VM (build 24.95-b01, mixed mode)
Thanks
Kosala



On Mon, Aug 15, 2016 at 2:17 PM, <clearwater-request at lists.projectclearwater.org<mailto:clearwater-request at lists.projectclearwater.org>> wrote:
Send Clearwater mailing list submissions to
        clearwater at lists.projectclearwater.org<mailto:clearwater at lists.projectclearwater.org>

To subscribe or unsubscribe via the World Wide Web, visit
        http://lists.projectclearwater.org/mailman/listinfo/clearwater_lists.projectclearwater.org

or, via email, send a message with subject or body 'help' to
        clearwater-request at lists.projectclearwater.org<mailto:clearwater-request at lists.projectclearwater.org>

You can reach the person managing the list at
        clearwater-owner at lists.projectclearwater.org<mailto:clearwater-owner at lists.projectclearwater.org>

When replying, please edit your Subject line so it is more specific
than "Re: Contents of Clearwater digest..."


Today's Topics:

   1. Stress Testing (Kosala)
   2. Re: Stress Testing (Matt Williams (projectclearwater.org<http://projectclearwater.org>))
   3. Re: Stress Testing (Matt Williams (projectclearwater.org<http://projectclearwater.org>))


----------------------------------------------------------------------

Message: 1
Date: Mon, 15 Aug 2016 10:38:57 +0100
From: Kosala <kosalayb at gmail.com<mailto:kosalayb at gmail.com>>
To: clearwater at lists.projectclearwater.org<mailto:clearwater at lists.projectclearwater.org>
Subject: [Project Clearwater] Stress Testing
Message-ID:
        <CAGEe17an2B_bGj8NfKFwms+nU=vJURyhT5CE+mcY1pjcm4YF+A at mail.gmail.com<mailto:vJURyhT5CE%2BmcY1pjcm4YF%2BA at mail.gmail.com>>
Content-Type: text/plain; charset="utf-8"

Hi Team,

I installed clearwater "all-in-one" image on Oracle Virtual Box.
1. Can I do stress testing ?
2. How to do that?

I am trying to follow Stress Testing on
http://clearwater.readthedocs.io/en/stable/Clearwater_stress_testing.html#configuring-udp-stress
.

Using chef - > It seems chef/knife install only supports in the Cloud
approach (The automated install is only supported for deployments running
in Amazon?s EC2 cloud).

Manual approach, It looks not supporting all in one image.

Many Thanks
Kosala
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.projectclearwater.org/pipermail/clearwater_lists.projectclearwater.org/attachments/20160815/15fc3b07/attachment-0001.html>

------------------------------

Message: 2
Date: Mon, 15 Aug 2016 09:54:02 +0000
From: "Matt Williams (projectclearwater.org<http://projectclearwater.org>)"
        <matt at projectclearwater.org<mailto:matt at projectclearwater.org>>
To: Kosala <kosalayb at gmail.com<mailto:kosalayb at gmail.com>>
Cc: "clearwater at lists.projectclearwater.org<mailto:clearwater at lists.projectclearwater.org>"
        <clearwater at lists.projectclearwater.org<mailto:clearwater at lists.projectclearwater.org>>
Subject: Re: [Project Clearwater] Stress Testing
Message-ID:
        <CY1PR0201MB15636F1F20EB91BB180F053390120 at CY1PR0201MB1563.namprd02.prod.outlook.com<mailto:CY1PR0201MB15636F1F20EB91BB180F053390120 at CY1PR0201MB1563.namprd02.prod.outlook.com>>

Content-Type: text/plain; charset="utf-8"

Kosala,

While it's theoretically possible to do stress testing against an all-in-one image, I'd recommend against it - the all-in-one image has been squeezed down a lot to fit on a single VM and we'd expect very low performance out of it, and I could believe that overload behavior might be suboptimal.  If you're looking to stress test for performance reasons, I'd strongly recommend running a full deployment as this will give you much more reliable numbers.  If you're looking to stress test for other reasons, please can you share a bit more about what you're trying to achieve, and we can have a think about what would work best?

If you do really want to run stress testing against an all-in-one image, it should probably work, even though http://clearwater.readthedocs.io/en/latest/Clearwater_stress_testing.html#manual-i-e-non-chef-stress-runs only talks about Chef and manual installs.  You'd need to set the "bono_servers" option in /etc/clearwater/shared_config to point to your all-in-one node, and I suspect you'd need to reduce the "count" option to something a lot lower - I'd start around 5000 and see how that goes.

I hope that helps.  Please let me know how you get on.

Thanks,

Matt

From: Clearwater [mailto:clearwater-bounces at lists.projectclearwater.org<mailto:clearwater-bounces at lists.projectclearwater.org>] On Behalf Of Kosala
Sent: 15 August 2016 10:39
To: clearwater at lists.projectclearwater.org<mailto:clearwater at lists.projectclearwater.org>
Subject: [Project Clearwater] Stress Testing

Hi Team,
I installed clearwater "all-in-one" image on Oracle Virtual Box.
1. Can I do stress testing ?
2. How to do that?
I am trying to follow Stress Testing on http://clearwater.readthedocs.io/en/stable/Clearwater_stress_testing.html#configuring-udp-stress.
Using chef - > It seems chef/knife install only supports in the Cloud approach (The automated install is only supported for deployments running in Amazon?s EC2 cloud).
Manual approach, It looks not supporting all in one image.
Many Thanks
Kosala

-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.projectclearwater.org/pipermail/clearwater_lists.projectclearwater.org/attachments/20160815/29d6328d/attachment-0001.html>

------------------------------

Message: 3
Date: Mon, 15 Aug 2016 13:16:47 +0000
From: "Matt Williams (projectclearwater.org<http://projectclearwater.org>)"
        <matt at projectclearwater.org<mailto:matt at projectclearwater.org>>
To: "clearwater at lists.projectclearwater.org<mailto:clearwater at lists.projectclearwater.org>"
        <clearwater at lists.projectclearwater.org<mailto:clearwater at lists.projectclearwater.org>>
Subject: Re: [Project Clearwater] Stress Testing
Message-ID:
        <CY1PR0201MB156372246DC5A77B11839F9D90120 at CY1PR0201MB1563.namprd02.prod.outlook.com<mailto:CY1PR0201MB156372246DC5A77B11839F9D90120 at CY1PR0201MB1563.namprd02.prod.outlook.com>>

Content-Type: text/plain; charset="utf-8"

Kosala,

You'll need to follow all the steps in http://clearwater.readthedocs.io/en/latest/Clearwater_stress_testing.html#manual-i-e-non-chef-stress-runs, i.e. bulk provisioning subscribers and installing clearwater-sip-stress, but that should be it.

Just to be clear, though, you'll need to set the configuration and install the clearwater-sip-stress package on a separate VM, not on the all-in-one image itself - the all-in-one image almost certainly opens up ports that conflict with those that clearwater-sip-stress tries to use.

This isn't a very well-trodden path, though, so you may hit further issues - let me know if so, and we can try to work through them.

Cheers,

Matt

From: Kosala [mailto:kosalayb at gmail.com<mailto:kosalayb at gmail.com>]
Sent: 15 August 2016 13:41
To: Matt Williams (projectclearwater.org<http://projectclearwater.org>) <matt at projectclearwater.org<mailto:matt at projectclearwater.org>>
Subject: Re: [Project Clearwater] Stress Testing

Hi Matt,
Thanks. I set the bono_servers option. Should I add count =5000 to /etc/clearwater/shared_config ?

Do I need other changes to run stress tests on all-in-one image?
Thanks
Kosala



On Mon, Aug 15, 2016 at 10:54 AM, Matt Williams (projectclearwater.org<http://projectclearwater.org><http://projectclearwater.org>) <matt at projectclearwater.org<mailto:matt at projectclearwater.org><mailto:matt at projectclearwater.org<mailto:matt at projectclearwater.org>>> wrote:
Kosala,

While it's theoretically possible to do stress testing against an all-in-one image, I'd recommend against it - the all-in-one image has been squeezed down a lot to fit on a single VM and we'd expect very low performance out of it, and I could believe that overload behavior might be suboptimal.  If you're looking to stress test for performance reasons, I'd strongly recommend running a full deployment as this will give you much more reliable numbers.  If you're looking to stress test for other reasons, please can you share a bit more about what you're trying to achieve, and we can have a think about what would work best?

If you do really want to run stress testing against an all-in-one image, it should probably work, even though http://clearwater.readthedocs.io/en/latest/Clearwater_stress_testing.html#manual-i-e-non-chef-stress-runs only talks about Chef and manual installs.  You'd need to set the "bono_servers" option in /etc/clearwater/shared_config to point to your all-in-one node, and I suspect you'd need to reduce the "count" option to something a lot lower - I'd start around 5000 and see how that goes.

I hope that helps.  Please let me know how you get on.

Thanks,

Matt

From: Clearwater [mailto:clearwater-bounces at lists.projectclearwater.org<mailto:clearwater-bounces at lists.projectclearwater.org><mailto:clearwater-bounces at lists.projectclearwater.org<mailto:clearwater-bounces at lists.projectclearwater.org>>] On Behalf Of Kosala
Sent: 15 August 2016 10:39
To: clearwater at lists.projectclearwater.org<mailto:clearwater at lists.projectclearwater.org><mailto:clearwater at lists.projectclearwater.org<mailto:clearwater at lists.projectclearwater.org>>
Subject: [Project Clearwater] Stress Testing

Hi Team,
I installed clearwater "all-in-one" image on Oracle Virtual Box.
1. Can I do stress testing ?
2. How to do that?
I am trying to follow Stress Testing on http://clearwater.readthedocs.io/en/stable/Clearwater_stress_testing.html#configuring-udp-stress.
Using chef - > It seems chef/knife install only supports in the Cloud approach (The automated install is only supported for deployments running in Amazon?s EC2 cloud).
Manual approach, It looks not supporting all in one image.
Many Thanks
Kosala


-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.projectclearwater.org/pipermail/clearwater_lists.projectclearwater.org/attachments/20160815/11781755/attachment.html>

------------------------------

Subject: Digest Footer

_______________________________________________
Clearwater mailing list
Clearwater at lists.projectclearwater.org<mailto:Clearwater at lists.projectclearwater.org>
http://lists.projectclearwater.org/mailman/listinfo/clearwater_lists.projectclearwater.org


------------------------------

End of Clearwater Digest, Vol 40, Issue 24
******************************************









-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.projectclearwater.org/pipermail/clearwater_lists.projectclearwater.org/attachments/20160818/c88a7659/attachment.html>

From kosalayb at gmail.com  Thu Aug 18 09:13:25 2016
From: kosalayb at gmail.com (Kosala)
Date: Thu, 18 Aug 2016 14:13:25 +0100
Subject: [Project Clearwater] Clearwater Digest, Vol 40, Issue 24
In-Reply-To: <CY1PR0201MB1563A30C3B9C4D8EE65FAD4390150@CY1PR0201MB1563.namprd02.prod.outlook.com>
References: <mailman.20.1471267072.11502.clearwater_lists.projectclearwater.org@lists.projectclearwater.org>
	<CAGEe17ZLnypQfbzxEwxj9EaB20MUBVpY+YdN-Obv=gHpZmG0KA@mail.gmail.com>
	<CY1PR0201MB1563F9A706F3EC7BE7F9C11590120@CY1PR0201MB1563.namprd02.prod.outlook.com>
	<CAGEe17bfTu1Kpwx=ipqtEbShvWtP+C6pJEEGHi0GSwBR5Dqw8w@mail.gmail.com>
	<CAGEe17aY077tLtotRe1X8k1qU_4otBdHDMJjqDH_g02Zs676Jg@mail.gmail.com>
	<CAGEe17ZeNPPy7AmMz=LCWnHqLm=v9Q7CuLT+AOVKWJTdg8m7Eg@mail.gmail.com>
	<CY1PR0201MB1563CE17983225B985B19D7390130@CY1PR0201MB1563.namprd02.prod.outlook.com>
	<CAGEe17b2M2uqvbOuqH7t4xM41FbfBYk0xR3zWqiFh+EkSfUzUQ@mail.gmail.com>
	<CY1PR0201MB1563CD5DDDD6E7B5A0B2DB7290140@CY1PR0201MB1563.namprd02.prod.outlook.com>
	<CAGEe17YGnaY1Kqc65gyiVO1sBBuTx=-YzfD9HY3M6QBD2t9AkA@mail.gmail.com>
	<CY1PR0201MB156349F26A0A7670BE7382A890140@CY1PR0201MB1563.namprd02.prod.outlook.com>
	<CAGEe17ZkY2ESNzwQYddrv6=jUJ5fPHu3gJXT7R1UjQmBd+eFUg@mail.gmail.com>
	<CY1PR0201MB1563C979B2D641DA59F1945A90150@CY1PR0201MB1563.namprd02.prod.outlook.com>
	<CAGEe17bC+xmhP3D7w768r0svzBAxdBedVXhis1Z33Yqdq4THgA@mail.gmail.com>
	<CY1PR0201MB1563F865DFBF86128118AC5290150@CY1PR0201MB1563.namprd02.prod.outlook.com>
	<CAGEe17Z2wBvTgPrnK_TdQPerVE9Moxnt=u9CWPpq8V04GJtfUw@mail.gmail.com>
	<CY1PR0201MB1563A30C3B9C4D8EE65FAD4390150@CY1PR0201MB1563.namprd02.prod.outlook.com>
Message-ID: <CAGEe17ZVrag9yFkLgPF-kfgDPDT_nJETkei_Uwv47mohbAwyxg@mail.gmail.com>

Hi Matt,

Now for the numbers I have in Cassandra, at SP node, I am getting "SIP/2.0
504 Server Timeout"

2016-08-18      11:49:03:189    1471520943.189039: Aborting call on
unexpected message for Call-Id '1073-27637 at 10.0.22.193': while expecting
'401' (index 3), received 'SIP/2.0 504 Server Timeout^M
Via: SIP/2.0/TCP 10.0.22.193:5060
;rport=32939;received=10.0.22.193;branch=z9hG4bK-27637-1073-2-2010000854-^M
Record-Route:
<sip:scscf.cwaio:5054;transport=TCP;lr;service=scscf;billing-role=charge-orig>^M
Call-ID: 2010000854///1073-27637 at 10.0.22.193^M
From: <sip:2010000854 at example.com>;tag=27637SIPpTag001073^M
To: <sip:2010000854 at example.com
>;tag=z9hG4bKPjuN16eRA0bDott9z6ZA-fwIYe3VA-KMkQ^M
CSeq: 1 REGISTER^M
Content-Length:  0^M
^M
'.
2016-08-18      11:49:04:185    1471520944.185945: Aborting call on
unexpected message for Call-Id '1154-27637 at 10.0.22.193': while expecting
'401' (index 3), received 'SIP/2.0 504 Server Timeout^M
Via: SIP/2.0/TCP 10.0.22.193:5060
;rport=32940;received=10.0.22.193;branch=z9hG4bK-27637-1154-2-2010000692-^M
Record-Route:
<sip:scscf.cwaio:5054;transport=TCP;lr;service=scscf;billing-role=charge-orig>^M
Call-ID: 2010000692///1154-27637 at 10.0.22.193^M
From: <sip:2010000692 at example.com>;tag=27637SIPpTag001154^M
To: <sip:2010000692 at example.com
>;tag=z9hG4bKPjk-5lYhadbnX7rqNirT8tjwQdDjLAQo0j^M
CSeq: 1 REGISTER^M
Content-Length:  0^M

How do I know, stress tests are running properly? Can I see statistics such
as memory usage, cpu time,  etc ?

Thanks
Kosala


On Thu, Aug 18, 2016 at 12:38 PM, Matt Williams (projectclearwater.org) <
matt at projectclearwater.org> wrote:

> Kosala,
>
>
>
> Thanks!  I'm very confused about your software version, though, as the
> latest all-in-one image has
>
> ?         crest 1.0-160811.103635 (i.e. older than yours)
>
> ?         homestead 1.0-160814.205535 (i.e. slightly newer than yours)
>
> ?         sprout 1.0-160814.205701 (i.e. much newer than yours)
>
> ?         the logging.bash script fix already applied.
>
> It looks as though your might have taken the previous all-in-one image,
> and then upgraded some of the packages.  Please can you confirm: have you
> upgraded any packages?
>
>
>
> On the issue you're seeing, I think you're saying that
>
> ?         you're running clearwater-sip-stress (which defaults to using
> numbers in the range above 2010000000)
>
> ?         you've deleted all these numbers from Homestead's Cassandra
>
> ?         you see errors in clearwater-sip-stress's log file saying that
> registration are failing with "404 Not Found".
>
> I think this is expected - you need to provision numbers in Homestead's
> Cassandra that match the numbers that clearwater-sip-stress is expecting to
> register as.  Please let me know if I've misunderstood.
>
>
>
> Thanks,
>
>
>
> Matt
>
>
>
> *From:* Kosala [mailto:kosalayb at gmail.com]
> *Sent:* 18 August 2016 11:46
>
> *To:* Matt Williams (projectclearwater.org) <matt at projectclearwater.org>
> *Subject:* Re: [Project Clearwater] Clearwater Digest, Vol 40, Issue 24
>
>
>
>
>
> Hi Matt,
>
> I am running the latest version all-in-one which i downloaded from
> http://vm-images.cw-ngv.com/cw-aio.ova.
>
> [cw-aio]ubuntu at cwaio:~$ sudo dpkg-query -s crest
> [sudo] password for ubuntu:
> Package: crest
> Status: install ok installed
> Priority: optional
> Section: network
> Installed-Size: 40102
> Maintainer: Project Clearwater Maintainers <maintainers@
> projectclearwater.org>
> Architecture: amd64
> Version: 1.0-160818.091648
>
> homestead
> Version: 1.0-160812.164051
>
> sprout
> Version: 1.0-160726.101022
>
> And one strange thing is:
>
> I deleted all the records in tables from homestead_cache and
> homestead_provisioning. Then when I check the SIP node for logs,
> sip-stress_14320_errors.log still has records with sip: ids which are not
> in Cassandra. For example, sip:2010021460 at example.com
>
> 2016-08-18      10:26:08:288    1471515968.288189: Aborting call on
> unexpected message for Call-Id '4270-14320 at 10.0.22.193': while expecting
> '401' (index 3), received 'SIP/2.0 404 Not Found^M
> Via: SIP/2.0/TCP 10.0.22.193:5060;rport=35233;received=10.0.22.193;branch=
> z9hG4bK-14320-4270-2-2010021460-^M
> Record-Route: <sip:scscf.cwaio:5054;transport=TCP;lr;service=
> scscf;billing-role=charge-orig>^M
> Call-ID: 2010021460///4270-14320 at 10.0.22.193^M
> From: <sip:2010021460 at example.com>;tag=14320SIPpTag004270^M
> To: <sip:2010021460 at example.com>;tag=z9hG4bKPjVe2he9j28lou.
> 0Dl9NmKGS7ypUMLjMJv^M
> CSeq: 1 REGISTER^M
> Content-Length:  0^M
>
> Thanks
>
> Kosala
>
>
>
> On Thu, Aug 18, 2016 at 10:47 AM, Matt Williams (projectclearwater.org) <
> matt at projectclearwater.org> wrote:
>
> Kosala,
>
>
>
> The fix is not to *copy* this to /usr/share/clearwater/utils, but to
> *move* it.  However, since the error is benign, I'd suggest just ignoring
> it while we get this working.
>
>
>
> As I asked below, please can you confirm what version you're running?  I'm
> concerned that it's going to be very hard to troubleshoot problems if you
> have an all-in-one image from a few weeks ago, with some packages updated
> to more recent versions and then some further fixes manually applied.
>
>
>
> Thanks,
>
>
>
> Matt
>
>
>
>
>
> *From:* Kosala [mailto:kosalayb at gmail.com]
> *Sent:* 18 August 2016 10:34
>
>
> *To:* Matt Williams (projectclearwater.org) <matt at projectclearwater.org>
> *Cc:* clearwater at lists.projectclearwater.org
> *Subject:* Re: [Project Clearwater] Clearwater Digest, Vol 40, Issue 24
>
>
>
> Hi Matt,
>
> Yeah, Manual calls are working fine.
>
> As it is said in the big fix, https://github.com/Metaswitch/
> clearwater-infrastructure/issues/355 , I copied logging.bash to
> /usr/share/clearwater/utils
>
> but I am still getting
>
> /etc/init.d/clearwater-infrastructure: 76: /etc/init.d/clearwater-infrastructure:
> /usr/share/clearwater/infrastructure/scripts/logging.bash: Permission
> denied
> Configuring monit for only localhost access
>
> Kosala
>
>
>
>
>
> On Thu, Aug 18, 2016 at 10:01 AM, Matt Williams (projectclearwater.org) <
> matt at projectclearwater.org> wrote:
>
> Kosala,
>
>
>
> Yes, it's https://github.com/Metaswitch/clearwater-infrastructure/
> issues/355 and it should be benign.
>
>
>
> However, this was fixed about 2 weeks ago.  Please can you confirm when
> you downloaded the all-in-one image, and whether you've upgraded it all?
> (As I observed earlier, your crest release was from only a few days ago.)
>
>
>
> Have you got manual calls working?
>
>
>
> Thanks,
>
>
>
> Matt
>
>
>
>
>
> *From:* Kosala [mailto:kosalayb at gmail.com]
> *Sent:* 18 August 2016 09:56
> *To:* Matt Williams (projectclearwater.org) <matt at projectclearwater.org>
> *Cc:* clearwater at lists.projectclearwater.org
>
>
> *Subject:* Re: [Project Clearwater] Clearwater Digest, Vol 40, Issue 24
>
>
>
> Hi Matt,
>
> In SIP node, when I am trying to execute "sudo service
> clearwater-sip-stress restart", I am getting an error
>
>
> /etc/init.d/clearwater-infrastructure: 76: /etc/init.d/clearwater-infrastructure:
> /usr/share/clearwater/infrastructure/scripts/logging.bash: Permission
> denied
> Configuring monit for only localhost access
>
> Any clue about this error?
>
> Thanks
>
> Kosala
>
>
>
>
>
> On Wed, Aug 17, 2016 at 2:29 PM, Matt Williams (projectclearwater.org) <
> matt at projectclearwater.org> wrote:
>
> Kosala,
>
>
>
> Yes, that's the correct screen, and you're correct that it shows that
> stress is being attempted but failing.
>
>
>
> Do regular (non-stress) calls work through this deployment?
>
>
>
> You can look at what message the stress node is receiving in the log files
> in the /var/log/clearwater-sip-stress/ directory - I think there are
> "errors" logs that contain the unexpected messages.
>
>
>
> You can obviously also look at what's happening on the all-in-one node
> itself, using the /var/log/bono/*, /var/log/sprout/* and
> /var/log/homestead/* files, as described at http://clearwater.readthedocs.
> io/en/latest/Troubleshooting_and_Recovery.html.
>
>
>
> I hope that helps.
>
>
>
> Cheers,
>
>
>
> Matt
>
>
>
> *From:* Kosala [mailto:kosalayb at gmail.com]
> *Sent:* 17 August 2016 14:20
>
>
> *To:* Matt Williams (projectclearwater.org) <matt at projectclearwater.org>
> *Subject:* Re: [Project Clearwater] Clearwater Digest, Vol 40, Issue 24
>
>
>
> Hi Matt,
>
> I can see this scenario screen from sip-stress.1.out. I hope this will be
> the stress test output results.
>
>
> ------------------------------ Scenario Screen -------- [1-9]: Change
> Screen --
>      Users (length)   Port   Total-time  Total-calls  Remote-host
>         2500 (0 ms)   5060      77.15 s         2500  10.0.21.192:5060
> (TCP)
>
>   Call limit reached (-m 2500), 1.002 s period  1 ms scheduler resolution
>   2175 calls (limit 2500)                Peak was 2499 calls, after 0 s
>   0 Running, 2177 Paused, 8 Woken up
>   0 dead call msg (discarded)            0 out-of-call msg
> (discarded)
>   3 open sockets
>
>                                  Messages  Retrans   Timeout
> Unexpected-Msg
>        Pause [0ms/10:00]         2500                          0
>     REGISTER ---------->         326       0
>          401 <----------         0         0         0         325
>     REGISTER ---------->         0         0
>          200 <----------         0         0         0         0
>     REGISTER ---------->         0         0
>          401 <----------         0         0         0         0
>     REGISTER ---------->         0         0
>          200 <----------         0         0         0         0
>        Pause [     4:50]         0                             0
>     REGISTER ---------->  B-RTD1 0         0
>          200 <----------  E-RTD1 0         0         0         0
>     REGISTER ---------->  B-RTD1 0         0
>          200 <----------  E-RTD1 0         0         0         0
>        Pause [     4:50]         0                             0
>        Pause [$pre_call_delay]   0                             0
>       INVITE ---------->  B-RTD2 0         0
>          100 <----------         0         0         0         0
>       INVITE <----------         0         0         0         0
>          100 <----------         0         0         0         0
>       INVITE <----------         0         0         0         0
>          100 ---------->         0         0
>          180 ---------->         0         0
>          180 <----------         0         0         0         0
>        Pause [   6000ms]         0                             0
>          200 ---------->         0         0
>          200 <----------         0         0         0         0
>          ACK ---------->         0         0
>          ACK <----------         0         0         0         0
>       UPDATE ---------->         0         0
>       UPDATE <----------         0         0         0         0
>          200 ---------->         0         0
>          200 <----------  E-RTD2 0         0         0         0
>        Pause [    24.0s]         0                             0
>          BYE ---------->  B-RTD3 0         0
>          BYE <----------         0         0         0         0
>          200 ---------->         0         0
>          200 <----------  E-RTD3 0         0         0         0
>        Pause [$post_call_delay]  0                             0
> ------- Waiting for active calls to end. Press [q] again to force exit.
> -------
> Last Error: Aborting call on unexpected message for Call-Id '1079-13729@
> ...
>
> However there is an unexpected message error at the end.
>
> Thanks
>
> Kosala
>
>
>
>
>
> On Wed, Aug 17, 2016 at 12:40 PM, Matt Williams (projectclearwater.org) <
> matt at projectclearwater.org> wrote:
>
> Kosala,
>
>
>
> They should log to /var/log/clearwater-sip-stress - in particular, the
> *.1.out file is a log of the output from sipp.  Do you see anything there?
>
>
>
> Matt
>
>
>
> *From:* Kosala [mailto:kosalayb at gmail.com]
> *Sent:* 17 August 2016 12:33
> *To:* Matt Williams (projectclearwater.org) <matt at projectclearwater.org>;
> clearwater at lists.projectclearwater.org
>
>
> *Subject:* Re: [Project Clearwater] Clearwater Digest, Vol 40, Issue 24
>
>
>
> Hi Matt,
>
> I followed above steps and run sudo apt-get install clearwater-sip-stress.
>
> How do I know stress tests are running? Is is said, stress tests start
> automatically but I cannot see it.
>
> Thanks
>
> Kosala
>
>
>
>
>
>
> On Tue, Aug 16, 2016 at 2:01 PM, Matt Williams (projectclearwater.org) <
> matt at projectclearwater.org> wrote:
>
> Kosala,
>
>
>
> I'm glad you've made progress on this.
>
>
>
> I had a look at the crest package version, but it seems to be later than
> the most recent all-in-one image uses (1.0-160811.103635).  When did you
> download the all-in-one image, and did you apply any patches to it?
>
>
>
> Regarding making calls for stress testing, this is where
> http://clearwater.readthedocs.io/en/latest/Clearwater_
> stress_testing.html#manual-i-e-non-chef-stress-runs comes in - you need to
>
> ?         create a separate VM
>
> ?         set the bono_hostname and count parameters in
> /etc/clearwater/shared_config
>
> ?         install the clearwater-sip-stress package.
>
> I hope that helps.
>
>
>
> BTW, please remember to copy in clearwater at lists.projectclearwater.org -
> that means that other people can see and comment on your posts.
>
>
>
> Thanks,
>
>
>
> Matt
>
>
>
>
>
> *From:* Kosala [mailto:kosalayb at gmail.com]
> *Sent:* 16 August 2016 10:48
> *To:* Matt Williams (projectclearwater.org) <matt at projectclearwater.org>
>
> *Subject:* Re: [Project Clearwater] Clearwater Digest, Vol 40, Issue 24
>
>
>
> Hi Matt,
>
> Bulk provisioning for all in one image is done using
> https://github.com/Metaswitch/crest/blob/dev/docs/Bulk-
> Provisioning%20Numbers.md.
>
> I have records in tables in homestead_cache and homer.
>
> Now How to make calls for stress testing?
>
> Is there any guideline?
>
> Many Thanks,
>
> Kosala
>
>
>
>
>
>
>
>
>
> On Tue, Aug 16, 2016 at 9:04 AM, Kosala <kosalayb at gmail.com> wrote:
>
> Hi Matt,
>
> TBH, The document in https://github.com/Metaswitch/
> crest/blob/dev/docs/Bulk-Provisioning%20Numbers.md is not clear to me.
>
> Step 1. Homestead node in deployment. I do not know where is that node in
> all in one image. It will be helpful the location of that folder from the
> root.
>
> Step 2. A simple example will be helpful.
>
> Thanks
>
> Kosala
>
>
>
>
>
> On Tue, Aug 16, 2016 at 8:50 AM, Kosala <kosalayb at gmail.com> wrote:
>
> Hi Matt,
>
> I downloaded the all in one package from http://clearwater.readthedocs.
> io/en/stable/All_in_one_OVF_Installation.html
>
> and imported using oracle virtual box on ubuntu 14.04,
>
> Crest version
>
> [cw-aio]ubuntu at cwaio:~$ sudo dpkg-query -s crest
> Package: crest
> Status: install ok installed
> Priority: optional
> Section: network
> Installed-Size: 40098
> Maintainer: Project Clearwater Maintainers <maintainers@
> projectclearwater.org>
> Architecture: amd64
> Version: 1.0-160815.145007
>
> Thanks
>
> Kosala
>
>
>
>
>
> On Mon, Aug 15, 2016 at 5:56 PM, Matt Williams (projectclearwater.org) <
> matt at projectclearwater.org> wrote:
>
> Kosala,
>
>
>
> That's odd - I don't see that failure on my all-in-one image (spun up just
> now from the latest image) - which version of all-in-one-image are you
> running, and which version of crest does it include ("sudo dpkg-query -s
> crest")?
>
>
>
> You may be able to work-around this either by taking the latest all-in-one
> image or by following the simpler bulk-provisioning process at
> https://github.com/Metaswitch/crest/blob/dev/docs/Bulk-
> Provisioning%20Numbers.md (when this doc talks about using the
> sstables_provisioning process for very large sets of numbers, we mean 1M+
> numbers - the 9000 you're provisioning are well within the capabilities of
> this process).
>
>
>
> I hope that helps - please let me know how you get on.
>
>
>
> Cheers,
>
>
>
> Matt
>
>
>
>
>
> *From:* Clearwater [mailto:clearwater-bounces at lists.projectclearwater.org]
> *On Behalf Of *Kosala
> *Sent:* 15 August 2016 16:58
> *To:* clearwater at lists.projectclearwater.org
> *Subject:* Re: [Project Clearwater] Clearwater Digest, Vol 40, Issue 24
>
>
>
> HI Matt,
>
> Thanks.
>
>
> I am trying to follow https://github.com/Metaswitch/
> crest/blob/dev/src/metaswitch/crest/tools/sstable_provisioning/README.md
> for bulk provisioning.
>
>
> When I am trying to execute sudo ./BulkProvision homer 21000 29999
> example.com 7kkzTyGW in all-in-one image,
> I am getting an error  java.lang.UnsupportedClassVersionError:
> ClearwaterBulkProvisioner : Unsupported major.minor version 52.0
>
> Java version info in all-in-one image:
> [cw-aio]ubuntu at cwaio:/usr/share/clearwater/crest/tools/sstable_provisioning$
> java -version
> java version "1.7.0_101"
> OpenJDK Runtime Environment (IcedTea 2.6.6) (7u101-2.6.6-0ubuntu0.14.04.1)
> OpenJDK 64-Bit Server VM (build 24.95-b01, mixed mode)
>
> Thanks
>
> Kosala
>
>
>
>
>
>
> On Mon, Aug 15, 2016 at 2:17 PM, <clearwater-request at lists.
> projectclearwater.org> wrote:
>
> Send Clearwater mailing list submissions to
>         clearwater at lists.projectclearwater.org
>
> To subscribe or unsubscribe via the World Wide Web, visit
>         http://lists.projectclearwater.org/mailman/
> listinfo/clearwater_lists.projectclearwater.org
>
> or, via email, send a message with subject or body 'help' to
>         clearwater-request at lists.projectclearwater.org
>
> You can reach the person managing the list at
>         clearwater-owner at lists.projectclearwater.org
>
> When replying, please edit your Subject line so it is more specific
> than "Re: Contents of Clearwater digest..."
>
>
> Today's Topics:
>
>    1. Stress Testing (Kosala)
>    2. Re: Stress Testing (Matt Williams (projectclearwater.org))
>    3. Re: Stress Testing (Matt Williams (projectclearwater.org))
>
>
> ----------------------------------------------------------------------
>
> Message: 1
> Date: Mon, 15 Aug 2016 10:38:57 +0100
> From: Kosala <kosalayb at gmail.com>
> To: clearwater at lists.projectclearwater.org
> Subject: [Project Clearwater] Stress Testing
> Message-ID:
>         <CAGEe17an2B_bGj8NfKFwms+nU=vJURyhT5CE+mcY1pjcm4YF+A at mail.
> gmail.com>
> Content-Type: text/plain; charset="utf-8"
>
> Hi Team,
>
> I installed clearwater "all-in-one" image on Oracle Virtual Box.
> 1. Can I do stress testing ?
> 2. How to do that?
>
> I am trying to follow Stress Testing on
> http://clearwater.readthedocs.io/en/stable/Clearwater_stress_testing.html#
> configuring-udp-stress
> .
>
> Using chef - > It seems chef/knife install only supports in the Cloud
> approach (The automated install is only supported for deployments running
> in Amazon?s EC2 cloud).
>
> Manual approach, It looks not supporting all in one image.
>
> Many Thanks
> Kosala
> -------------- next part --------------
> An HTML attachment was scrubbed...
> URL: <http://lists.projectclearwater.org/pipermail/clearwater_lists.
> projectclearwater.org/attachments/20160815/15fc3b07/attachment-0001.html>
>
> ------------------------------
>
> Message: 2
> Date: Mon, 15 Aug 2016 09:54:02 +0000
> From: "Matt Williams (projectclearwater.org)"
>         <matt at projectclearwater.org>
> To: Kosala <kosalayb at gmail.com>
> Cc: "clearwater at lists.projectclearwater.org"
>         <clearwater at lists.projectclearwater.org>
> Subject: Re: [Project Clearwater] Stress Testing
> Message-ID:
>         <CY1PR0201MB15636F1F20EB91BB180F053390120 at CY1PR0201MB1563.
> namprd02.prod.outlook.com>
>
> Content-Type: text/plain; charset="utf-8"
>
> Kosala,
>
> While it's theoretically possible to do stress testing against an
> all-in-one image, I'd recommend against it - the all-in-one image has been
> squeezed down a lot to fit on a single VM and we'd expect very low
> performance out of it, and I could believe that overload behavior might be
> suboptimal.  If you're looking to stress test for performance reasons, I'd
> strongly recommend running a full deployment as this will give you much
> more reliable numbers.  If you're looking to stress test for other reasons,
> please can you share a bit more about what you're trying to achieve, and we
> can have a think about what would work best?
>
> If you do really want to run stress testing against an all-in-one image,
> it should probably work, even though http://clearwater.readthedocs.
> io/en/latest/Clearwater_stress_testing.html#manual-i-
> e-non-chef-stress-runs only talks about Chef and manual installs.  You'd
> need to set the "bono_servers" option in /etc/clearwater/shared_config to
> point to your all-in-one node, and I suspect you'd need to reduce the
> "count" option to something a lot lower - I'd start around 5000 and see how
> that goes.
>
> I hope that helps.  Please let me know how you get on.
>
> Thanks,
>
> Matt
>
> From: Clearwater [mailto:clearwater-bounces at lists.projectclearwater.org]
> On Behalf Of Kosala
> Sent: 15 August 2016 10:39
> To: clearwater at lists.projectclearwater.org
> Subject: [Project Clearwater] Stress Testing
>
> Hi Team,
> I installed clearwater "all-in-one" image on Oracle Virtual Box.
> 1. Can I do stress testing ?
> 2. How to do that?
> I am trying to follow Stress Testing on http://clearwater.readthedocs.
> io/en/stable/Clearwater_stress_testing.html#configuring-udp-stress.
> Using chef - > It seems chef/knife install only supports in the Cloud
> approach (The automated install is only supported for deployments running
> in Amazon?s EC2 cloud).
> Manual approach, It looks not supporting all in one image.
> Many Thanks
> Kosala
>
> -------------- next part --------------
> An HTML attachment was scrubbed...
> URL: <http://lists.projectclearwater.org/pipermail/clearwater_lists.
> projectclearwater.org/attachments/20160815/29d6328d/attachment-0001.html>
>
> ------------------------------
>
> Message: 3
> Date: Mon, 15 Aug 2016 13:16:47 +0000
> From: "Matt Williams (projectclearwater.org)"
>         <matt at projectclearwater.org>
> To: "clearwater at lists.projectclearwater.org"
>         <clearwater at lists.projectclearwater.org>
> Subject: Re: [Project Clearwater] Stress Testing
> Message-ID:
>         <CY1PR0201MB156372246DC5A77B11839F9D90120 at CY1PR0201MB1563.
> namprd02.prod.outlook.com>
>
> Content-Type: text/plain; charset="utf-8"
>
> Kosala,
>
> You'll need to follow all the steps in http://clearwater.readthedocs.
> io/en/latest/Clearwater_stress_testing.html#manual-i-
> e-non-chef-stress-runs, i.e. bulk provisioning subscribers and installing
> clearwater-sip-stress, but that should be it.
>
> Just to be clear, though, you'll need to set the configuration and install
> the clearwater-sip-stress package on a separate VM, not on the all-in-one
> image itself - the all-in-one image almost certainly opens up ports that
> conflict with those that clearwater-sip-stress tries to use.
>
> This isn't a very well-trodden path, though, so you may hit further issues
> - let me know if so, and we can try to work through them.
>
> Cheers,
>
> Matt
>
> From: Kosala [mailto:kosalayb at gmail.com]
> Sent: 15 August 2016 13:41
> To: Matt Williams (projectclearwater.org) <matt at projectclearwater.org>
> Subject: Re: [Project Clearwater] Stress Testing
>
> Hi Matt,
> Thanks. I set the bono_servers option. Should I add count =5000 to
> /etc/clearwater/shared_config ?
>
> Do I need other changes to run stress tests on all-in-one image?
> Thanks
> Kosala
>
>
>
> On Mon, Aug 15, 2016 at 10:54 AM, Matt Williams (projectclearwater.org<
> http://projectclearwater.org>) <matt at projectclearwater.org<mailto:
> matt at projectclearwater.org>> wrote:
> Kosala,
>
> While it's theoretically possible to do stress testing against an
> all-in-one image, I'd recommend against it - the all-in-one image has been
> squeezed down a lot to fit on a single VM and we'd expect very low
> performance out of it, and I could believe that overload behavior might be
> suboptimal.  If you're looking to stress test for performance reasons, I'd
> strongly recommend running a full deployment as this will give you much
> more reliable numbers.  If you're looking to stress test for other reasons,
> please can you share a bit more about what you're trying to achieve, and we
> can have a think about what would work best?
>
> If you do really want to run stress testing against an all-in-one image,
> it should probably work, even though http://clearwater.readthedocs.
> io/en/latest/Clearwater_stress_testing.html#manual-i-
> e-non-chef-stress-runs only talks about Chef and manual installs.  You'd
> need to set the "bono_servers" option in /etc/clearwater/shared_config to
> point to your all-in-one node, and I suspect you'd need to reduce the
> "count" option to something a lot lower - I'd start around 5000 and see how
> that goes.
>
> I hope that helps.  Please let me know how you get on.
>
> Thanks,
>
> Matt
>
> From: Clearwater [mailto:clearwater-bounces at lists.projectclearwater.org<
> mailto:clearwater-bounces at lists.projectclearwater.org>] On Behalf Of
> Kosala
> Sent: 15 August 2016 10:39
> To: clearwater at lists.projectclearwater.org<mailto:clearwater at lists.
> projectclearwater.org>
> Subject: [Project Clearwater] Stress Testing
>
> Hi Team,
> I installed clearwater "all-in-one" image on Oracle Virtual Box.
> 1. Can I do stress testing ?
> 2. How to do that?
> I am trying to follow Stress Testing on http://clearwater.readthedocs.
> io/en/stable/Clearwater_stress_testing.html#configuring-udp-stress.
> Using chef - > It seems chef/knife install only supports in the Cloud
> approach (The automated install is only supported for deployments running
> in Amazon?s EC2 cloud).
> Manual approach, It looks not supporting all in one image.
> Many Thanks
> Kosala
>
>
> -------------- next part --------------
> An HTML attachment was scrubbed...
> URL: <http://lists.projectclearwater.org/pipermail/clearwater_lists.
> projectclearwater.org/attachments/20160815/11781755/attachment.html>
>
> ------------------------------
>
> Subject: Digest Footer
>
> _______________________________________________
> Clearwater mailing list
> Clearwater at lists.projectclearwater.org
> http://lists.projectclearwater.org/mailman/listinfo/clearwater_lists.
> projectclearwater.org
>
>
> ------------------------------
>
> End of Clearwater Digest, Vol 40, Issue 24
> ******************************************
>
>
>
>
>
>
>
>
>
>
>
>
>
>
>
>
>
>
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.projectclearwater.org/pipermail/clearwater_lists.projectclearwater.org/attachments/20160818/4aa2db6c/attachment.html>

From matt at projectclearwater.org  Thu Aug 18 09:59:40 2016
From: matt at projectclearwater.org (Matt Williams (projectclearwater.org))
Date: Thu, 18 Aug 2016 13:59:40 +0000
Subject: [Project Clearwater] Clearwater Digest, Vol 40, Issue 24
In-Reply-To: <CAGEe17ZVrag9yFkLgPF-kfgDPDT_nJETkei_Uwv47mohbAwyxg@mail.gmail.com>
References: <mailman.20.1471267072.11502.clearwater_lists.projectclearwater.org@lists.projectclearwater.org>
	<CAGEe17ZLnypQfbzxEwxj9EaB20MUBVpY+YdN-Obv=gHpZmG0KA@mail.gmail.com>
	<CY1PR0201MB1563F9A706F3EC7BE7F9C11590120@CY1PR0201MB1563.namprd02.prod.outlook.com>
	<CAGEe17bfTu1Kpwx=ipqtEbShvWtP+C6pJEEGHi0GSwBR5Dqw8w@mail.gmail.com>
	<CAGEe17aY077tLtotRe1X8k1qU_4otBdHDMJjqDH_g02Zs676Jg@mail.gmail.com>
	<CAGEe17ZeNPPy7AmMz=LCWnHqLm=v9Q7CuLT+AOVKWJTdg8m7Eg@mail.gmail.com>
	<CY1PR0201MB1563CE17983225B985B19D7390130@CY1PR0201MB1563.namprd02.prod.outlook.com>
	<CAGEe17b2M2uqvbOuqH7t4xM41FbfBYk0xR3zWqiFh+EkSfUzUQ@mail.gmail.com>
	<CY1PR0201MB1563CD5DDDD6E7B5A0B2DB7290140@CY1PR0201MB1563.namprd02.prod.outlook.com>
	<CAGEe17YGnaY1Kqc65gyiVO1sBBuTx=-YzfD9HY3M6QBD2t9AkA@mail.gmail.com>
	<CY1PR0201MB156349F26A0A7670BE7382A890140@CY1PR0201MB1563.namprd02.prod.outlook.com>
	<CAGEe17ZkY2ESNzwQYddrv6=jUJ5fPHu3gJXT7R1UjQmBd+eFUg@mail.gmail.com>
	<CY1PR0201MB1563C979B2D641DA59F1945A90150@CY1PR0201MB1563.namprd02.prod.outlook.com>
	<CAGEe17bC+xmhP3D7w768r0svzBAxdBedVXhis1Z33Yqdq4THgA@mail.gmail.com>
	<CY1PR0201MB1563F865DFBF86128118AC5290150@CY1PR0201MB1563.namprd02.prod.outlook.com>
	<CAGEe17Z2wBvTgPrnK_TdQPerVE9Moxnt=u9CWPpq8V04GJtfUw@mail.gmail.com>
	<CY1PR0201MB1563A30C3B9C4D8EE65FAD4390150@CY1PR0201MB1563.namprd02.prod.outlook.com>
	<CAGEe17ZVrag9yFkLgPF-kfgDPDT_nJETkei_Uwv47mohbAwyxg@mail.gmail.com>
Message-ID: <CY1PR0201MB156325107DAA32BF9480667B90150@CY1PR0201MB1563.namprd02.prod.outlook.com>

Kosala,

The error you're seeing suggests that the request is timing out between Bono and Sprout.  This could be due to poor performance on the all-in-one node (as I said previously, the all-in-one node is not intended for running stress), or it could be due to a more general misconfiguration.  Are all REGISTERs failing, or just some?

Regarding getting CPU statistics etc., we normally use Cacti.  There are instructions for setting this up at http://clearwater.readthedocs.io/en/latest/Cacti.html.  However, I doubt this will work as-is with your all-in-one node.  Since you only have one node, maybe you're best just looking at top?

Matt

From: Kosala [mailto:kosalayb at gmail.com]
Sent: 18 August 2016 14:13
To: Matt Williams (projectclearwater.org) <matt at projectclearwater.org>
Cc: clearwater at lists.projectclearwater.org
Subject: Re: [Project Clearwater] Clearwater Digest, Vol 40, Issue 24

Hi Matt,
Now for the numbers I have in Cassandra, at SP node, I am getting "SIP/2.0 504 Server Timeout"
2016-08-18      11:49:03:189    1471520943.189039: Aborting call on unexpected message for Call-Id '1073-27637 at 10.0.22.193<mailto:1073-27637 at 10.0.22.193>': while expecting '401' (index 3), received 'SIP/2.0 504 Server Timeout^M
Via: SIP/2.0/TCP 10.0.22.193:5060;rport=32939;received=10.0.22.193;branch=z9hG4bK-27637-1073-2-2010000854-^M
Record-Route: <sip:scscf.cwaio:5054;transport=TCP;lr;service=scscf;billing-role=charge-orig>^M
Call-ID: 2010000854///1073-27637 at 10.0.22.193<mailto:1073-27637 at 10.0.22.193>^M
From: <sip:2010000854 at example.com<mailto:sip%3A2010000854 at example.com>>;tag=27637SIPpTag001073^M
To: <sip:2010000854 at example.com<mailto:sip%3A2010000854 at example.com>>;tag=z9hG4bKPjuN16eRA0bDott9z6ZA-fwIYe3VA-KMkQ^M
CSeq: 1 REGISTER^M
Content-Length:  0^M
^M
'.
2016-08-18      11:49:04:185    1471520944.185945: Aborting call on unexpected message for Call-Id '1154-27637 at 10.0.22.193<mailto:1154-27637 at 10.0.22.193>': while expecting '401' (index 3), received 'SIP/2.0 504 Server Timeout^M
Via: SIP/2.0/TCP 10.0.22.193:5060;rport=32940;received=10.0.22.193;branch=z9hG4bK-27637-1154-2-2010000692-^M
Record-Route: <sip:scscf.cwaio:5054;transport=TCP;lr;service=scscf;billing-role=charge-orig>^M
Call-ID: 2010000692///1154-27637 at 10.0.22.193<mailto:1154-27637 at 10.0.22.193>^M
From: <sip:2010000692 at example.com<mailto:sip%3A2010000692 at example.com>>;tag=27637SIPpTag001154^M
To: <sip:2010000692 at example.com<mailto:sip%3A2010000692 at example.com>>;tag=z9hG4bKPjk-5lYhadbnX7rqNirT8tjwQdDjLAQo0j^M
CSeq: 1 REGISTER^M
Content-Length:  0^M

How do I know, stress tests are running properly? Can I see statistics such as memory usage, cpu time,  etc ?
Thanks
Kosala


On Thu, Aug 18, 2016 at 12:38 PM, Matt Williams (projectclearwater.org<http://projectclearwater.org>) <matt at projectclearwater.org<mailto:matt at projectclearwater.org>> wrote:
Kosala,

Thanks!  I'm very confused about your software version, though, as the latest all-in-one image has

?         crest 1.0-160811.103635 (i.e. older than yours)

?         homestead 1.0-160814.205535 (i.e. slightly newer than yours)

?         sprout 1.0-160814.205701 (i.e. much newer than yours)

?         the logging.bash script fix already applied.
It looks as though your might have taken the previous all-in-one image, and then upgraded some of the packages.  Please can you confirm: have you upgraded any packages?

On the issue you're seeing, I think you're saying that

?         you're running clearwater-sip-stress (which defaults to using numbers in the range above 2010000000)

?         you've deleted all these numbers from Homestead's Cassandra

?         you see errors in clearwater-sip-stress's log file saying that registration are failing with "404 Not Found".
I think this is expected - you need to provision numbers in Homestead's Cassandra that match the numbers that clearwater-sip-stress is expecting to register as.  Please let me know if I've misunderstood.

Thanks,

Matt

From: Kosala [mailto:kosalayb at gmail.com<mailto:kosalayb at gmail.com>]
Sent: 18 August 2016 11:46

To: Matt Williams (projectclearwater.org<http://projectclearwater.org>) <matt at projectclearwater.org<mailto:matt at projectclearwater.org>>
Subject: Re: [Project Clearwater] Clearwater Digest, Vol 40, Issue 24


Hi Matt,
I am running the latest version all-in-one which i downloaded from http://vm-images.cw-ngv.com/cw-aio.ova.

[cw-aio]ubuntu at cwaio:~$ sudo dpkg-query -s crest
[sudo] password for ubuntu:
Package: crest
Status: install ok installed
Priority: optional
Section: network
Installed-Size: 40102
Maintainer: Project Clearwater Maintainers <maintainers at projectclearwater.org<mailto:maintainers at projectclearwater.org>>
Architecture: amd64
Version: 1.0-160818.091648
homestead
Version: 1.0-160812.164051
sprout
Version: 1.0-160726.101022
And one strange thing is:
I deleted all the records in tables from homestead_cache and homestead_provisioning. Then when I check the SIP node for logs, sip-stress_14320_errors.log still has records with sip: ids which are not in Cassandra. For example, sip:2010021460 at example.com<mailto:sip%3A2010021460 at example.com>
2016-08-18      10:26:08:288    1471515968.288189: Aborting call on unexpected message for Call-Id '4270-14320 at 10.0.22.193<mailto:4270-14320 at 10.0.22.193>': while expecting '401' (index 3), received 'SIP/2.0 404 Not Found^M
Via: SIP/2.0/TCP 10.0.22.193:5060;rport=35233;received=10.0.22.193;branch=z9hG4bK-14320-4270-2-2010021460-^M
Record-Route: <sip:scscf.cwaio:5054;transport=TCP;lr;service=scscf;billing-role=charge-orig>^M
Call-ID: 2010021460///4270-14320 at 10.0.22.193<mailto:4270-14320 at 10.0.22.193>^M
From: <sip:2010021460 at example.com<mailto:sip%3A2010021460 at example.com>>;tag=14320SIPpTag004270^M
To: <sip:2010021460 at example.com<mailto:sip%3A2010021460 at example.com>>;tag=z9hG4bKPjVe2he9j28lou.0Dl9NmKGS7ypUMLjMJv^M
CSeq: 1 REGISTER^M
Content-Length:  0^M
Thanks
Kosala

On Thu, Aug 18, 2016 at 10:47 AM, Matt Williams (projectclearwater.org<http://projectclearwater.org>) <matt at projectclearwater.org<mailto:matt at projectclearwater.org>> wrote:
Kosala,

The fix is not to copy this to /usr/share/clearwater/utils, but to move it.  However, since the error is benign, I'd suggest just ignoring it while we get this working.

As I asked below, please can you confirm what version you're running?  I'm concerned that it's going to be very hard to troubleshoot problems if you have an all-in-one image from a few weeks ago, with some packages updated to more recent versions and then some further fixes manually applied.

Thanks,

Matt


From: Kosala [mailto:kosalayb at gmail.com<mailto:kosalayb at gmail.com>]
Sent: 18 August 2016 10:34

To: Matt Williams (projectclearwater.org<http://projectclearwater.org>) <matt at projectclearwater.org<mailto:matt at projectclearwater.org>>
Cc: clearwater at lists.projectclearwater.org<mailto:clearwater at lists.projectclearwater.org>
Subject: Re: [Project Clearwater] Clearwater Digest, Vol 40, Issue 24

Hi Matt,
Yeah, Manual calls are working fine.
As it is said in the big fix, https://github.com/Metaswitch/clearwater-infrastructure/issues/355 , I copied logging.bash to /usr/share/clearwater/utils
but I am still getting

/etc/init.d/clearwater-infrastructure: 76: /etc/init.d/clearwater-infrastructure: /usr/share/clearwater/infrastructure/scripts/logging.bash: Permission denied
Configuring monit for only localhost access
Kosala


On Thu, Aug 18, 2016 at 10:01 AM, Matt Williams (projectclearwater.org<http://projectclearwater.org>) <matt at projectclearwater.org<mailto:matt at projectclearwater.org>> wrote:
Kosala,

Yes, it's https://github.com/Metaswitch/clearwater-infrastructure/issues/355 and it should be benign.

However, this was fixed about 2 weeks ago.  Please can you confirm when you downloaded the all-in-one image, and whether you've upgraded it all?  (As I observed earlier, your crest release was from only a few days ago.)

Have you got manual calls working?

Thanks,

Matt


From: Kosala [mailto:kosalayb at gmail.com<mailto:kosalayb at gmail.com>]
Sent: 18 August 2016 09:56
To: Matt Williams (projectclearwater.org<http://projectclearwater.org>) <matt at projectclearwater.org<mailto:matt at projectclearwater.org>>
Cc: clearwater at lists.projectclearwater.org<mailto:clearwater at lists.projectclearwater.org>

Subject: Re: [Project Clearwater] Clearwater Digest, Vol 40, Issue 24

Hi Matt,
In SIP node, when I am trying to execute "sudo service clearwater-sip-stress restart", I am getting an error

/etc/init.d/clearwater-infrastructure: 76: /etc/init.d/clearwater-infrastructure: /usr/share/clearwater/infrastructure/scripts/logging.bash: Permission denied
Configuring monit for only localhost access
Any clue about this error?
Thanks
Kosala


On Wed, Aug 17, 2016 at 2:29 PM, Matt Williams (projectclearwater.org<http://projectclearwater.org>) <matt at projectclearwater.org<mailto:matt at projectclearwater.org>> wrote:
Kosala,

Yes, that's the correct screen, and you're correct that it shows that stress is being attempted but failing.

Do regular (non-stress) calls work through this deployment?

You can look at what message the stress node is receiving in the log files in the /var/log/clearwater-sip-stress/ directory - I think there are "errors" logs that contain the unexpected messages.

You can obviously also look at what's happening on the all-in-one node itself, using the /var/log/bono/*, /var/log/sprout/* and /var/log/homestead/* files, as described at http://clearwater.readthedocs.io/en/latest/Troubleshooting_and_Recovery.html.

I hope that helps.

Cheers,

Matt

From: Kosala [mailto:kosalayb at gmail.com<mailto:kosalayb at gmail.com>]
Sent: 17 August 2016 14:20

To: Matt Williams (projectclearwater.org<http://projectclearwater.org>) <matt at projectclearwater.org<mailto:matt at projectclearwater.org>>
Subject: Re: [Project Clearwater] Clearwater Digest, Vol 40, Issue 24

Hi Matt,
I can see this scenario screen from sip-stress.1.out. I hope this will be the stress test output results.

------------------------------ Scenario Screen -------- [1-9]: Change Screen --
     Users (length)   Port   Total-time  Total-calls  Remote-host
        2500 (0 ms)   5060      77.15 s         2500  10.0.21.192:5060(TCP)

  Call limit reached (-m 2500), 1.002 s period  1 ms scheduler resolution
  2175 calls (limit 2500)                Peak was 2499 calls, after 0 s
  0 Running, 2177 Paused, 8 Woken up
  0 dead call msg (discarded)            0 out-of-call msg (discarded)
  3 open sockets

                                 Messages  Retrans   Timeout   Unexpected-Msg
       Pause [0ms/10:00]         2500                          0
    REGISTER ---------->         326       0
         401 <----------         0         0         0         325
    REGISTER ---------->         0         0
         200 <----------         0         0         0         0
    REGISTER ---------->         0         0
         401 <----------         0         0         0         0
    REGISTER ---------->         0         0
         200 <----------         0         0         0         0
       Pause [     4:50]         0                             0
    REGISTER ---------->  B-RTD1 0         0
         200 <----------  E-RTD1 0         0         0         0
    REGISTER ---------->  B-RTD1 0         0
         200 <----------  E-RTD1 0         0         0         0
       Pause [     4:50]         0                             0
       Pause [$pre_call_delay]   0                             0
      INVITE ---------->  B-RTD2 0         0
         100 <----------         0         0         0         0
      INVITE <----------         0         0         0         0
         100 <----------         0         0         0         0
      INVITE <----------         0         0         0         0
         100 ---------->         0         0
         180 ---------->         0         0
         180 <----------         0         0         0         0
       Pause [   6000ms]         0                             0
         200 ---------->         0         0
         200 <----------         0         0         0         0
         ACK ---------->         0         0
         ACK <----------         0         0         0         0
      UPDATE ---------->         0         0
      UPDATE <----------         0         0         0         0
         200 ---------->         0         0
         200 <----------  E-RTD2 0         0         0         0
       Pause [    24.0s]         0                             0
         BYE ---------->  B-RTD3 0         0
         BYE <----------         0         0         0         0
         200 ---------->         0         0
         200 <----------  E-RTD3 0         0         0         0
       Pause [$post_call_delay]  0                             0
------- Waiting for active calls to end. Press [q] again to force exit. -------
Last Error: Aborting call on unexpected message for Call-Id '1079-13729 at ...
However there is an unexpected message error at the end.
Thanks
Kosala


On Wed, Aug 17, 2016 at 12:40 PM, Matt Williams (projectclearwater.org<http://projectclearwater.org>) <matt at projectclearwater.org<mailto:matt at projectclearwater.org>> wrote:
Kosala,

They should log to /var/log/clearwater-sip-stress - in particular, the *.1.out file is a log of the output from sipp.  Do you see anything there?

Matt

From: Kosala [mailto:kosalayb at gmail.com<mailto:kosalayb at gmail.com>]
Sent: 17 August 2016 12:33
To: Matt Williams (projectclearwater.org<http://projectclearwater.org>) <matt at projectclearwater.org<mailto:matt at projectclearwater.org>>; clearwater at lists.projectclearwater.org<mailto:clearwater at lists.projectclearwater.org>

Subject: Re: [Project Clearwater] Clearwater Digest, Vol 40, Issue 24

Hi Matt,
I followed above steps and run sudo apt-get install clearwater-sip-stress.
How do I know stress tests are running? Is is said, stress tests start automatically but I cannot see it.
Thanks
Kosala



On Tue, Aug 16, 2016 at 2:01 PM, Matt Williams (projectclearwater.org<http://projectclearwater.org>) <matt at projectclearwater.org<mailto:matt at projectclearwater.org>> wrote:
Kosala,

I'm glad you've made progress on this.

I had a look at the crest package version, but it seems to be later than the most recent all-in-one image uses (1.0-160811.103635).  When did you download the all-in-one image, and did you apply any patches to it?

Regarding making calls for stress testing, this is where http://clearwater.readthedocs.io/en/latest/Clearwater_stress_testing.html#manual-i-e-non-chef-stress-runs comes in - you need to

?         create a separate VM

?         set the bono_hostname and count parameters in /etc/clearwater/shared_config

?         install the clearwater-sip-stress package.
I hope that helps.

BTW, please remember to copy in clearwater at lists.projectclearwater.org<mailto:clearwater at lists.projectclearwater.org> - that means that other people can see and comment on your posts.

Thanks,

Matt


From: Kosala [mailto:kosalayb at gmail.com<mailto:kosalayb at gmail.com>]
Sent: 16 August 2016 10:48
To: Matt Williams (projectclearwater.org<http://projectclearwater.org>) <matt at projectclearwater.org<mailto:matt at projectclearwater.org>>
Subject: Re: [Project Clearwater] Clearwater Digest, Vol 40, Issue 24

Hi Matt,
Bulk provisioning for all in one image is done using https://github.com/Metaswitch/crest/blob/dev/docs/Bulk-Provisioning%20Numbers.md.
I have records in tables in homestead_cache and homer.
Now How to make calls for stress testing?
Is there any guideline?
Many Thanks,
Kosala




On Tue, Aug 16, 2016 at 9:04 AM, Kosala <kosalayb at gmail.com<mailto:kosalayb at gmail.com>> wrote:
Hi Matt,
TBH, The document in https://github.com/Metaswitch/crest/blob/dev/docs/Bulk-Provisioning%20Numbers.md is not clear to me.
Step 1. Homestead node in deployment. I do not know where is that node in all in one image. It will be helpful the location of that folder from the root.
Step 2. A simple example will be helpful.
Thanks
Kosala


On Tue, Aug 16, 2016 at 8:50 AM, Kosala <kosalayb at gmail.com<mailto:kosalayb at gmail.com>> wrote:
Hi Matt,
I downloaded the all in one package from http://clearwater.readthedocs.io/en/stable/All_in_one_OVF_Installation.html
and imported using oracle virtual box on ubuntu 14.04,
Crest version
[cw-aio]ubuntu at cwaio:~$ sudo dpkg-query -s crest
Package: crest
Status: install ok installed
Priority: optional
Section: network
Installed-Size: 40098
Maintainer: Project Clearwater Maintainers <maintainers at projectclearwater.org<mailto:maintainers at projectclearwater.org>>
Architecture: amd64
Version: 1.0-160815.145007
Thanks
Kosala


On Mon, Aug 15, 2016 at 5:56 PM, Matt Williams (projectclearwater.org<http://projectclearwater.org>) <matt at projectclearwater.org<mailto:matt at projectclearwater.org>> wrote:
Kosala,

That's odd - I don't see that failure on my all-in-one image (spun up just now from the latest image) - which version of all-in-one-image are you running, and which version of crest does it include ("sudo dpkg-query -s crest")?

You may be able to work-around this either by taking the latest all-in-one image or by following the simpler bulk-provisioning process at https://github.com/Metaswitch/crest/blob/dev/docs/Bulk-Provisioning%20Numbers.md (when this doc talks about using the sstables_provisioning process for very large sets of numbers, we mean 1M+ numbers - the 9000 you're provisioning are well within the capabilities of this process).

I hope that helps - please let me know how you get on.

Cheers,

Matt


From: Clearwater [mailto:clearwater-bounces at lists.projectclearwater.org<mailto:clearwater-bounces at lists.projectclearwater.org>] On Behalf Of Kosala
Sent: 15 August 2016 16:58
To: clearwater at lists.projectclearwater.org<mailto:clearwater at lists.projectclearwater.org>
Subject: Re: [Project Clearwater] Clearwater Digest, Vol 40, Issue 24

HI Matt,
Thanks.

I am trying to follow https://github.com/Metaswitch/crest/blob/dev/src/metaswitch/crest/tools/sstable_provisioning/README.md for bulk provisioning.

When I am trying to execute sudo ./BulkProvision homer 21000 29999 example.com<http://example.com> 7kkzTyGW in all-in-one image,
I am getting an error  java.lang.UnsupportedClassVersionError: ClearwaterBulkProvisioner : Unsupported major.minor version 52.0
Java version info in all-in-one image:
[cw-aio]ubuntu at cwaio:/usr/share/clearwater/crest/tools/sstable_provisioning$ java -version
java version "1.7.0_101"
OpenJDK Runtime Environment (IcedTea 2.6.6) (7u101-2.6.6-0ubuntu0.14.04.1)
OpenJDK 64-Bit Server VM (build 24.95-b01, mixed mode)
Thanks
Kosala



On Mon, Aug 15, 2016 at 2:17 PM, <clearwater-request at lists.projectclearwater.org<mailto:clearwater-request at lists.projectclearwater.org>> wrote:
Send Clearwater mailing list submissions to
        clearwater at lists.projectclearwater.org<mailto:clearwater at lists.projectclearwater.org>

To subscribe or unsubscribe via the World Wide Web, visit
        http://lists.projectclearwater.org/mailman/listinfo/clearwater_lists.projectclearwater.org

or, via email, send a message with subject or body 'help' to
        clearwater-request at lists.projectclearwater.org<mailto:clearwater-request at lists.projectclearwater.org>

You can reach the person managing the list at
        clearwater-owner at lists.projectclearwater.org<mailto:clearwater-owner at lists.projectclearwater.org>

When replying, please edit your Subject line so it is more specific
than "Re: Contents of Clearwater digest..."


Today's Topics:

   1. Stress Testing (Kosala)
   2. Re: Stress Testing (Matt Williams (projectclearwater.org<http://projectclearwater.org>))
   3. Re: Stress Testing (Matt Williams (projectclearwater.org<http://projectclearwater.org>))


----------------------------------------------------------------------

Message: 1
Date: Mon, 15 Aug 2016 10:38:57 +0100
From: Kosala <kosalayb at gmail.com<mailto:kosalayb at gmail.com>>
To: clearwater at lists.projectclearwater.org<mailto:clearwater at lists.projectclearwater.org>
Subject: [Project Clearwater] Stress Testing
Message-ID:
        <CAGEe17an2B_bGj8NfKFwms+nU=vJURyhT5CE+mcY1pjcm4YF+A at mail.gmail.com<mailto:vJURyhT5CE%2BmcY1pjcm4YF%2BA at mail.gmail.com>>
Content-Type: text/plain; charset="utf-8"

Hi Team,

I installed clearwater "all-in-one" image on Oracle Virtual Box.
1. Can I do stress testing ?
2. How to do that?

I am trying to follow Stress Testing on
http://clearwater.readthedocs.io/en/stable/Clearwater_stress_testing.html#configuring-udp-stress
.

Using chef - > It seems chef/knife install only supports in the Cloud
approach (The automated install is only supported for deployments running
in Amazon?s EC2 cloud).

Manual approach, It looks not supporting all in one image.

Many Thanks
Kosala
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.projectclearwater.org/pipermail/clearwater_lists.projectclearwater.org/attachments/20160815/15fc3b07/attachment-0001.html>

------------------------------

Message: 2
Date: Mon, 15 Aug 2016 09:54:02 +0000
From: "Matt Williams (projectclearwater.org<http://projectclearwater.org>)"
        <matt at projectclearwater.org<mailto:matt at projectclearwater.org>>
To: Kosala <kosalayb at gmail.com<mailto:kosalayb at gmail.com>>
Cc: "clearwater at lists.projectclearwater.org<mailto:clearwater at lists.projectclearwater.org>"
        <clearwater at lists.projectclearwater.org<mailto:clearwater at lists.projectclearwater.org>>
Subject: Re: [Project Clearwater] Stress Testing
Message-ID:
        <CY1PR0201MB15636F1F20EB91BB180F053390120 at CY1PR0201MB1563.namprd02.prod.outlook.com<mailto:CY1PR0201MB15636F1F20EB91BB180F053390120 at CY1PR0201MB1563.namprd02.prod.outlook.com>>

Content-Type: text/plain; charset="utf-8"

Kosala,

While it's theoretically possible to do stress testing against an all-in-one image, I'd recommend against it - the all-in-one image has been squeezed down a lot to fit on a single VM and we'd expect very low performance out of it, and I could believe that overload behavior might be suboptimal.  If you're looking to stress test for performance reasons, I'd strongly recommend running a full deployment as this will give you much more reliable numbers.  If you're looking to stress test for other reasons, please can you share a bit more about what you're trying to achieve, and we can have a think about what would work best?

If you do really want to run stress testing against an all-in-one image, it should probably work, even though http://clearwater.readthedocs.io/en/latest/Clearwater_stress_testing.html#manual-i-e-non-chef-stress-runs only talks about Chef and manual installs.  You'd need to set the "bono_servers" option in /etc/clearwater/shared_config to point to your all-in-one node, and I suspect you'd need to reduce the "count" option to something a lot lower - I'd start around 5000 and see how that goes.

I hope that helps.  Please let me know how you get on.

Thanks,

Matt

From: Clearwater [mailto:clearwater-bounces at lists.projectclearwater.org<mailto:clearwater-bounces at lists.projectclearwater.org>] On Behalf Of Kosala
Sent: 15 August 2016 10:39
To: clearwater at lists.projectclearwater.org<mailto:clearwater at lists.projectclearwater.org>
Subject: [Project Clearwater] Stress Testing

Hi Team,
I installed clearwater "all-in-one" image on Oracle Virtual Box.
1. Can I do stress testing ?
2. How to do that?
I am trying to follow Stress Testing on http://clearwater.readthedocs.io/en/stable/Clearwater_stress_testing.html#configuring-udp-stress.
Using chef - > It seems chef/knife install only supports in the Cloud approach (The automated install is only supported for deployments running in Amazon?s EC2 cloud).
Manual approach, It looks not supporting all in one image.
Many Thanks
Kosala

-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.projectclearwater.org/pipermail/clearwater_lists.projectclearwater.org/attachments/20160815/29d6328d/attachment-0001.html>

------------------------------

Message: 3
Date: Mon, 15 Aug 2016 13:16:47 +0000
From: "Matt Williams (projectclearwater.org<http://projectclearwater.org>)"
        <matt at projectclearwater.org<mailto:matt at projectclearwater.org>>
To: "clearwater at lists.projectclearwater.org<mailto:clearwater at lists.projectclearwater.org>"
        <clearwater at lists.projectclearwater.org<mailto:clearwater at lists.projectclearwater.org>>
Subject: Re: [Project Clearwater] Stress Testing
Message-ID:
        <CY1PR0201MB156372246DC5A77B11839F9D90120 at CY1PR0201MB1563.namprd02.prod.outlook.com<mailto:CY1PR0201MB156372246DC5A77B11839F9D90120 at CY1PR0201MB1563.namprd02.prod.outlook.com>>

Content-Type: text/plain; charset="utf-8"

Kosala,

You'll need to follow all the steps in http://clearwater.readthedocs.io/en/latest/Clearwater_stress_testing.html#manual-i-e-non-chef-stress-runs, i.e. bulk provisioning subscribers and installing clearwater-sip-stress, but that should be it.

Just to be clear, though, you'll need to set the configuration and install the clearwater-sip-stress package on a separate VM, not on the all-in-one image itself - the all-in-one image almost certainly opens up ports that conflict with those that clearwater-sip-stress tries to use.

This isn't a very well-trodden path, though, so you may hit further issues - let me know if so, and we can try to work through them.

Cheers,

Matt

From: Kosala [mailto:kosalayb at gmail.com<mailto:kosalayb at gmail.com>]
Sent: 15 August 2016 13:41
To: Matt Williams (projectclearwater.org<http://projectclearwater.org>) <matt at projectclearwater.org<mailto:matt at projectclearwater.org>>
Subject: Re: [Project Clearwater] Stress Testing

Hi Matt,
Thanks. I set the bono_servers option. Should I add count =5000 to /etc/clearwater/shared_config ?

Do I need other changes to run stress tests on all-in-one image?
Thanks
Kosala



On Mon, Aug 15, 2016 at 10:54 AM, Matt Williams (projectclearwater.org<http://projectclearwater.org><http://projectclearwater.org>) <matt at projectclearwater.org<mailto:matt at projectclearwater.org><mailto:matt at projectclearwater.org<mailto:matt at projectclearwater.org>>> wrote:
Kosala,

While it's theoretically possible to do stress testing against an all-in-one image, I'd recommend against it - the all-in-one image has been squeezed down a lot to fit on a single VM and we'd expect very low performance out of it, and I could believe that overload behavior might be suboptimal.  If you're looking to stress test for performance reasons, I'd strongly recommend running a full deployment as this will give you much more reliable numbers.  If you're looking to stress test for other reasons, please can you share a bit more about what you're trying to achieve, and we can have a think about what would work best?

If you do really want to run stress testing against an all-in-one image, it should probably work, even though http://clearwater.readthedocs.io/en/latest/Clearwater_stress_testing.html#manual-i-e-non-chef-stress-runs only talks about Chef and manual installs.  You'd need to set the "bono_servers" option in /etc/clearwater/shared_config to point to your all-in-one node, and I suspect you'd need to reduce the "count" option to something a lot lower - I'd start around 5000 and see how that goes.

I hope that helps.  Please let me know how you get on.

Thanks,

Matt

From: Clearwater [mailto:clearwater-bounces at lists.projectclearwater.org<mailto:clearwater-bounces at lists.projectclearwater.org><mailto:clearwater-bounces at lists.projectclearwater.org<mailto:clearwater-bounces at lists.projectclearwater.org>>] On Behalf Of Kosala
Sent: 15 August 2016 10:39
To: clearwater at lists.projectclearwater.org<mailto:clearwater at lists.projectclearwater.org><mailto:clearwater at lists.projectclearwater.org<mailto:clearwater at lists.projectclearwater.org>>
Subject: [Project Clearwater] Stress Testing

Hi Team,
I installed clearwater "all-in-one" image on Oracle Virtual Box.
1. Can I do stress testing ?
2. How to do that?
I am trying to follow Stress Testing on http://clearwater.readthedocs.io/en/stable/Clearwater_stress_testing.html#configuring-udp-stress.
Using chef - > It seems chef/knife install only supports in the Cloud approach (The automated install is only supported for deployments running in Amazon?s EC2 cloud).
Manual approach, It looks not supporting all in one image.
Many Thanks
Kosala


-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.projectclearwater.org/pipermail/clearwater_lists.projectclearwater.org/attachments/20160815/11781755/attachment.html>

------------------------------

Subject: Digest Footer

_______________________________________________
Clearwater mailing list
Clearwater at lists.projectclearwater.org<mailto:Clearwater at lists.projectclearwater.org>
http://lists.projectclearwater.org/mailman/listinfo/clearwater_lists.projectclearwater.org


------------------------------

End of Clearwater Digest, Vol 40, Issue 24
******************************************










-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.projectclearwater.org/pipermail/clearwater_lists.projectclearwater.org/attachments/20160818/5704353f/attachment.html>

From kosalayb at gmail.com  Thu Aug 18 10:20:11 2016
From: kosalayb at gmail.com (Kosala)
Date: Thu, 18 Aug 2016 15:20:11 +0100
Subject: [Project Clearwater] Clearwater Digest, Vol 40, Issue 24
In-Reply-To: <CY1PR0201MB156325107DAA32BF9480667B90150@CY1PR0201MB1563.namprd02.prod.outlook.com>
References: <mailman.20.1471267072.11502.clearwater_lists.projectclearwater.org@lists.projectclearwater.org>
	<CAGEe17ZLnypQfbzxEwxj9EaB20MUBVpY+YdN-Obv=gHpZmG0KA@mail.gmail.com>
	<CY1PR0201MB1563F9A706F3EC7BE7F9C11590120@CY1PR0201MB1563.namprd02.prod.outlook.com>
	<CAGEe17bfTu1Kpwx=ipqtEbShvWtP+C6pJEEGHi0GSwBR5Dqw8w@mail.gmail.com>
	<CAGEe17aY077tLtotRe1X8k1qU_4otBdHDMJjqDH_g02Zs676Jg@mail.gmail.com>
	<CAGEe17ZeNPPy7AmMz=LCWnHqLm=v9Q7CuLT+AOVKWJTdg8m7Eg@mail.gmail.com>
	<CY1PR0201MB1563CE17983225B985B19D7390130@CY1PR0201MB1563.namprd02.prod.outlook.com>
	<CAGEe17b2M2uqvbOuqH7t4xM41FbfBYk0xR3zWqiFh+EkSfUzUQ@mail.gmail.com>
	<CY1PR0201MB1563CD5DDDD6E7B5A0B2DB7290140@CY1PR0201MB1563.namprd02.prod.outlook.com>
	<CAGEe17YGnaY1Kqc65gyiVO1sBBuTx=-YzfD9HY3M6QBD2t9AkA@mail.gmail.com>
	<CY1PR0201MB156349F26A0A7670BE7382A890140@CY1PR0201MB1563.namprd02.prod.outlook.com>
	<CAGEe17ZkY2ESNzwQYddrv6=jUJ5fPHu3gJXT7R1UjQmBd+eFUg@mail.gmail.com>
	<CY1PR0201MB1563C979B2D641DA59F1945A90150@CY1PR0201MB1563.namprd02.prod.outlook.com>
	<CAGEe17bC+xmhP3D7w768r0svzBAxdBedVXhis1Z33Yqdq4THgA@mail.gmail.com>
	<CY1PR0201MB1563F865DFBF86128118AC5290150@CY1PR0201MB1563.namprd02.prod.outlook.com>
	<CAGEe17Z2wBvTgPrnK_TdQPerVE9Moxnt=u9CWPpq8V04GJtfUw@mail.gmail.com>
	<CY1PR0201MB1563A30C3B9C4D8EE65FAD4390150@CY1PR0201MB1563.namprd02.prod.outlook.com>
	<CAGEe17ZVrag9yFkLgPF-kfgDPDT_nJETkei_Uwv47mohbAwyxg@mail.gmail.com>
	<CY1PR0201MB156325107DAA32BF9480667B90150@CY1PR0201MB1563.namprd02.prod.outlook.com>
Message-ID: <CAGEe17bWEkdYazAcTOTq2+7kxwR=yYx04MT-QzjsHQ5HWPAD5Q@mail.gmail.com>

Hi Matt,

Thanks. SIP node is calling numbers in a larger range starting from 2010000000.
Can I restrict SIP call invoke from
2010000000 to 2010000099?
I can do bulk provision 100 numbers. I do not know how to restrict SIP node
to call only these 100 numbers?

Thanks
Kosala



On Thu, Aug 18, 2016 at 2:59 PM, Matt Williams (projectclearwater.org) <
matt at projectclearwater.org> wrote:

> Kosala,
>
>
>
> The error you're seeing suggests that the request is timing out between
> Bono and Sprout.  This could be due to poor performance on the all-in-one
> node (as I said previously, the all-in-one node is not intended for running
> stress), or it could be due to a more general misconfiguration.  Are all
> REGISTERs failing, or just some?
>
>
>
> Regarding getting CPU statistics etc., we normally use Cacti.  There are
> instructions for setting this up at http://clearwater.readthedocs.
> io/en/latest/Cacti.html.  However, I doubt this will work as-is with your
> all-in-one node.  Since you only have one node, maybe you're best just
> looking at top?
>
>
>
> Matt
>
>
>
> *From:* Kosala [mailto:kosalayb at gmail.com]
> *Sent:* 18 August 2016 14:13
>
> *To:* Matt Williams (projectclearwater.org) <matt at projectclearwater.org>
> *Cc:* clearwater at lists.projectclearwater.org
> *Subject:* Re: [Project Clearwater] Clearwater Digest, Vol 40, Issue 24
>
>
>
> Hi Matt,
>
> Now for the numbers I have in Cassandra, at SP node, I am getting "SIP/2.0
> 504 Server Timeout"
>
> 2016-08-18      11:49:03:189    1471520943.189039: Aborting call on
> unexpected message for Call-Id '1073-27637 at 10.0.22.193': while expecting
> '401' (index 3), received 'SIP/2.0 504 Server Timeout^M
> Via: SIP/2.0/TCP 10.0.22.193:5060;rport=32939;received=10.0.22.193;branch=
> z9hG4bK-27637-1073-2-2010000854-^M
> Record-Route: <sip:scscf.cwaio:5054;transport=TCP;lr;service=
> scscf;billing-role=charge-orig>^M
> Call-ID: 2010000854///1073-27637 at 10.0.22.193^M
> From: <sip:2010000854 at example.com>;tag=27637SIPpTag001073^M
> To: <sip:2010000854 at example.com>;tag=z9hG4bKPjuN16eRA0bDott9z6ZA-
> fwIYe3VA-KMkQ^M
> CSeq: 1 REGISTER^M
> Content-Length:  0^M
> ^M
> '.
> 2016-08-18      11:49:04:185    1471520944.185945: Aborting call on
> unexpected message for Call-Id '1154-27637 at 10.0.22.193': while expecting
> '401' (index 3), received 'SIP/2.0 504 Server Timeout^M
> Via: SIP/2.0/TCP 10.0.22.193:5060;rport=32940;received=10.0.22.193;branch=
> z9hG4bK-27637-1154-2-2010000692-^M
> Record-Route: <sip:scscf.cwaio:5054;transport=TCP;lr;service=
> scscf;billing-role=charge-orig>^M
> Call-ID: 2010000692///1154-27637 at 10.0.22.193^M
> From: <sip:2010000692 at example.com>;tag=27637SIPpTag001154^M
> To: <sip:2010000692 at example.com>;tag=z9hG4bKPjk-
> 5lYhadbnX7rqNirT8tjwQdDjLAQo0j^M
> CSeq: 1 REGISTER^M
> Content-Length:  0^M
>
> How do I know, stress tests are running properly? Can I see statistics
> such as memory usage, cpu time,  etc ?
>
> Thanks
>
> Kosala
>
>
>
>
>
> On Thu, Aug 18, 2016 at 12:38 PM, Matt Williams (projectclearwater.org) <
> matt at projectclearwater.org> wrote:
>
> Kosala,
>
>
>
> Thanks!  I'm very confused about your software version, though, as the
> latest all-in-one image has
>
> ?         crest 1.0-160811.103635 (i.e. older than yours)
>
> ?         homestead 1.0-160814.205535 (i.e. slightly newer than yours)
>
> ?         sprout 1.0-160814.205701 (i.e. much newer than yours)
>
> ?         the logging.bash script fix already applied.
>
> It looks as though your might have taken the previous all-in-one image,
> and then upgraded some of the packages.  Please can you confirm: have you
> upgraded any packages?
>
>
>
> On the issue you're seeing, I think you're saying that
>
> ?         you're running clearwater-sip-stress (which defaults to using
> numbers in the range above 2010000000)
>
> ?         you've deleted all these numbers from Homestead's Cassandra
>
> ?         you see errors in clearwater-sip-stress's log file saying that
> registration are failing with "404 Not Found".
>
> I think this is expected - you need to provision numbers in Homestead's
> Cassandra that match the numbers that clearwater-sip-stress is expecting to
> register as.  Please let me know if I've misunderstood.
>
>
>
> Thanks,
>
>
>
> Matt
>
>
>
> *From:* Kosala [mailto:kosalayb at gmail.com]
> *Sent:* 18 August 2016 11:46
>
>
> *To:* Matt Williams (projectclearwater.org) <matt at projectclearwater.org>
> *Subject:* Re: [Project Clearwater] Clearwater Digest, Vol 40, Issue 24
>
>
>
>
>
> Hi Matt,
>
> I am running the latest version all-in-one which i downloaded from
> http://vm-images.cw-ngv.com/cw-aio.ova.
>
> [cw-aio]ubuntu at cwaio:~$ sudo dpkg-query -s crest
> [sudo] password for ubuntu:
> Package: crest
> Status: install ok installed
> Priority: optional
> Section: network
> Installed-Size: 40102
> Maintainer: Project Clearwater Maintainers <maintainers@
> projectclearwater.org>
> Architecture: amd64
> Version: 1.0-160818.091648
>
> homestead
> Version: 1.0-160812.164051
>
> sprout
> Version: 1.0-160726.101022
>
> And one strange thing is:
>
> I deleted all the records in tables from homestead_cache and
> homestead_provisioning. Then when I check the SIP node for logs,
> sip-stress_14320_errors.log still has records with sip: ids which are not
> in Cassandra. For example, sip:2010021460 at example.com
>
> 2016-08-18      10:26:08:288    1471515968.288189: Aborting call on
> unexpected message for Call-Id '4270-14320 at 10.0.22.193': while expecting
> '401' (index 3), received 'SIP/2.0 404 Not Found^M
> Via: SIP/2.0/TCP 10.0.22.193:5060;rport=35233;received=10.0.22.193;branch=
> z9hG4bK-14320-4270-2-2010021460-^M
> Record-Route: <sip:scscf.cwaio:5054;transport=TCP;lr;service=
> scscf;billing-role=charge-orig>^M
> Call-ID: 2010021460///4270-14320 at 10.0.22.193^M
> From: <sip:2010021460 at example.com>;tag=14320SIPpTag004270^M
> To: <sip:2010021460 at example.com>;tag=z9hG4bKPjVe2he9j28lou.
> 0Dl9NmKGS7ypUMLjMJv^M
> CSeq: 1 REGISTER^M
> Content-Length:  0^M
>
> Thanks
>
> Kosala
>
>
>
> On Thu, Aug 18, 2016 at 10:47 AM, Matt Williams (projectclearwater.org) <
> matt at projectclearwater.org> wrote:
>
> Kosala,
>
>
>
> The fix is not to *copy* this to /usr/share/clearwater/utils, but to
> *move* it.  However, since the error is benign, I'd suggest just ignoring
> it while we get this working.
>
>
>
> As I asked below, please can you confirm what version you're running?  I'm
> concerned that it's going to be very hard to troubleshoot problems if you
> have an all-in-one image from a few weeks ago, with some packages updated
> to more recent versions and then some further fixes manually applied.
>
>
>
> Thanks,
>
>
>
> Matt
>
>
>
>
>
> *From:* Kosala [mailto:kosalayb at gmail.com]
> *Sent:* 18 August 2016 10:34
>
>
> *To:* Matt Williams (projectclearwater.org) <matt at projectclearwater.org>
> *Cc:* clearwater at lists.projectclearwater.org
> *Subject:* Re: [Project Clearwater] Clearwater Digest, Vol 40, Issue 24
>
>
>
> Hi Matt,
>
> Yeah, Manual calls are working fine.
>
> As it is said in the big fix, https://github.com/Metaswitch/
> clearwater-infrastructure/issues/355 , I copied logging.bash to
> /usr/share/clearwater/utils
>
> but I am still getting
>
> /etc/init.d/clearwater-infrastructure: 76: /etc/init.d/clearwater-infrastructure:
> /usr/share/clearwater/infrastructure/scripts/logging.bash: Permission
> denied
> Configuring monit for only localhost access
>
> Kosala
>
>
>
>
>
> On Thu, Aug 18, 2016 at 10:01 AM, Matt Williams (projectclearwater.org) <
> matt at projectclearwater.org> wrote:
>
> Kosala,
>
>
>
> Yes, it's https://github.com/Metaswitch/clearwater-infrastructure/
> issues/355 and it should be benign.
>
>
>
> However, this was fixed about 2 weeks ago.  Please can you confirm when
> you downloaded the all-in-one image, and whether you've upgraded it all?
> (As I observed earlier, your crest release was from only a few days ago.)
>
>
>
> Have you got manual calls working?
>
>
>
> Thanks,
>
>
>
> Matt
>
>
>
>
>
> *From:* Kosala [mailto:kosalayb at gmail.com]
> *Sent:* 18 August 2016 09:56
> *To:* Matt Williams (projectclearwater.org) <matt at projectclearwater.org>
> *Cc:* clearwater at lists.projectclearwater.org
>
>
> *Subject:* Re: [Project Clearwater] Clearwater Digest, Vol 40, Issue 24
>
>
>
> Hi Matt,
>
> In SIP node, when I am trying to execute "sudo service
> clearwater-sip-stress restart", I am getting an error
>
>
> /etc/init.d/clearwater-infrastructure: 76: /etc/init.d/clearwater-infrastructure:
> /usr/share/clearwater/infrastructure/scripts/logging.bash: Permission
> denied
> Configuring monit for only localhost access
>
> Any clue about this error?
>
> Thanks
>
> Kosala
>
>
>
>
>
> On Wed, Aug 17, 2016 at 2:29 PM, Matt Williams (projectclearwater.org) <
> matt at projectclearwater.org> wrote:
>
> Kosala,
>
>
>
> Yes, that's the correct screen, and you're correct that it shows that
> stress is being attempted but failing.
>
>
>
> Do regular (non-stress) calls work through this deployment?
>
>
>
> You can look at what message the stress node is receiving in the log files
> in the /var/log/clearwater-sip-stress/ directory - I think there are
> "errors" logs that contain the unexpected messages.
>
>
>
> You can obviously also look at what's happening on the all-in-one node
> itself, using the /var/log/bono/*, /var/log/sprout/* and
> /var/log/homestead/* files, as described at http://clearwater.readthedocs.
> io/en/latest/Troubleshooting_and_Recovery.html.
>
>
>
> I hope that helps.
>
>
>
> Cheers,
>
>
>
> Matt
>
>
>
> *From:* Kosala [mailto:kosalayb at gmail.com]
> *Sent:* 17 August 2016 14:20
>
>
> *To:* Matt Williams (projectclearwater.org) <matt at projectclearwater.org>
> *Subject:* Re: [Project Clearwater] Clearwater Digest, Vol 40, Issue 24
>
>
>
> Hi Matt,
>
> I can see this scenario screen from sip-stress.1.out. I hope this will be
> the stress test output results.
>
>
> ------------------------------ Scenario Screen -------- [1-9]: Change
> Screen --
>      Users (length)   Port   Total-time  Total-calls  Remote-host
>         2500 (0 ms)   5060      77.15 s         2500  10.0.21.192:5060
> (TCP)
>
>   Call limit reached (-m 2500), 1.002 s period  1 ms scheduler resolution
>   2175 calls (limit 2500)                Peak was 2499 calls, after 0 s
>   0 Running, 2177 Paused, 8 Woken up
>   0 dead call msg (discarded)            0 out-of-call msg
> (discarded)
>   3 open sockets
>
>                                  Messages  Retrans   Timeout
> Unexpected-Msg
>        Pause [0ms/10:00]         2500                          0
>     REGISTER ---------->         326       0
>          401 <----------         0         0         0         325
>     REGISTER ---------->         0         0
>          200 <----------         0         0         0         0
>     REGISTER ---------->         0         0
>          401 <----------         0         0         0         0
>     REGISTER ---------->         0         0
>          200 <----------         0         0         0         0
>        Pause [     4:50]         0                             0
>     REGISTER ---------->  B-RTD1 0         0
>          200 <----------  E-RTD1 0         0         0         0
>     REGISTER ---------->  B-RTD1 0         0
>          200 <----------  E-RTD1 0         0         0         0
>        Pause [     4:50]         0                             0
>        Pause [$pre_call_delay]   0                             0
>       INVITE ---------->  B-RTD2 0         0
>          100 <----------         0         0         0         0
>       INVITE <----------         0         0         0         0
>          100 <----------         0         0         0         0
>       INVITE <----------         0         0         0         0
>          100 ---------->         0         0
>          180 ---------->         0         0
>          180 <----------         0         0         0         0
>        Pause [   6000ms]         0                             0
>          200 ---------->         0         0
>          200 <----------         0         0         0         0
>          ACK ---------->         0         0
>          ACK <----------         0         0         0         0
>       UPDATE ---------->         0         0
>       UPDATE <----------         0         0         0         0
>          200 ---------->         0         0
>          200 <----------  E-RTD2 0         0         0         0
>        Pause [    24.0s]         0                             0
>          BYE ---------->  B-RTD3 0         0
>          BYE <----------         0         0         0         0
>          200 ---------->         0         0
>          200 <----------  E-RTD3 0         0         0         0
>        Pause [$post_call_delay]  0                             0
> ------- Waiting for active calls to end. Press [q] again to force exit.
> -------
> Last Error: Aborting call on unexpected message for Call-Id '1079-13729@
> ...
>
> However there is an unexpected message error at the end.
>
> Thanks
>
> Kosala
>
>
>
>
>
> On Wed, Aug 17, 2016 at 12:40 PM, Matt Williams (projectclearwater.org) <
> matt at projectclearwater.org> wrote:
>
> Kosala,
>
>
>
> They should log to /var/log/clearwater-sip-stress - in particular, the
> *.1.out file is a log of the output from sipp.  Do you see anything there?
>
>
>
> Matt
>
>
>
> *From:* Kosala [mailto:kosalayb at gmail.com]
> *Sent:* 17 August 2016 12:33
> *To:* Matt Williams (projectclearwater.org) <matt at projectclearwater.org>;
> clearwater at lists.projectclearwater.org
>
>
> *Subject:* Re: [Project Clearwater] Clearwater Digest, Vol 40, Issue 24
>
>
>
> Hi Matt,
>
> I followed above steps and run sudo apt-get install clearwater-sip-stress.
>
> How do I know stress tests are running? Is is said, stress tests start
> automatically but I cannot see it.
>
> Thanks
>
> Kosala
>
>
>
>
>
>
> On Tue, Aug 16, 2016 at 2:01 PM, Matt Williams (projectclearwater.org) <
> matt at projectclearwater.org> wrote:
>
> Kosala,
>
>
>
> I'm glad you've made progress on this.
>
>
>
> I had a look at the crest package version, but it seems to be later than
> the most recent all-in-one image uses (1.0-160811.103635).  When did you
> download the all-in-one image, and did you apply any patches to it?
>
>
>
> Regarding making calls for stress testing, this is where
> http://clearwater.readthedocs.io/en/latest/Clearwater_
> stress_testing.html#manual-i-e-non-chef-stress-runs comes in - you need to
>
> ?         create a separate VM
>
> ?         set the bono_hostname and count parameters in
> /etc/clearwater/shared_config
>
> ?         install the clearwater-sip-stress package.
>
> I hope that helps.
>
>
>
> BTW, please remember to copy in clearwater at lists.projectclearwater.org -
> that means that other people can see and comment on your posts.
>
>
>
> Thanks,
>
>
>
> Matt
>
>
>
>
>
> *From:* Kosala [mailto:kosalayb at gmail.com]
> *Sent:* 16 August 2016 10:48
> *To:* Matt Williams (projectclearwater.org) <matt at projectclearwater.org>
>
> *Subject:* Re: [Project Clearwater] Clearwater Digest, Vol 40, Issue 24
>
>
>
> Hi Matt,
>
> Bulk provisioning for all in one image is done using
> https://github.com/Metaswitch/crest/blob/dev/docs/Bulk-
> Provisioning%20Numbers.md.
>
> I have records in tables in homestead_cache and homer.
>
> Now How to make calls for stress testing?
>
> Is there any guideline?
>
> Many Thanks,
>
> Kosala
>
>
>
>
>
>
>
>
>
> On Tue, Aug 16, 2016 at 9:04 AM, Kosala <kosalayb at gmail.com> wrote:
>
> Hi Matt,
>
> TBH, The document in https://github.com/Metaswitch/
> crest/blob/dev/docs/Bulk-Provisioning%20Numbers.md is not clear to me.
>
> Step 1. Homestead node in deployment. I do not know where is that node in
> all in one image. It will be helpful the location of that folder from the
> root.
>
> Step 2. A simple example will be helpful.
>
> Thanks
>
> Kosala
>
>
>
>
>
> On Tue, Aug 16, 2016 at 8:50 AM, Kosala <kosalayb at gmail.com> wrote:
>
> Hi Matt,
>
> I downloaded the all in one package from http://clearwater.readthedocs.
> io/en/stable/All_in_one_OVF_Installation.html
>
> and imported using oracle virtual box on ubuntu 14.04,
>
> Crest version
>
> [cw-aio]ubuntu at cwaio:~$ sudo dpkg-query -s crest
> Package: crest
> Status: install ok installed
> Priority: optional
> Section: network
> Installed-Size: 40098
> Maintainer: Project Clearwater Maintainers <maintainers@
> projectclearwater.org>
> Architecture: amd64
> Version: 1.0-160815.145007
>
> Thanks
>
> Kosala
>
>
>
>
>
> On Mon, Aug 15, 2016 at 5:56 PM, Matt Williams (projectclearwater.org) <
> matt at projectclearwater.org> wrote:
>
> Kosala,
>
>
>
> That's odd - I don't see that failure on my all-in-one image (spun up just
> now from the latest image) - which version of all-in-one-image are you
> running, and which version of crest does it include ("sudo dpkg-query -s
> crest")?
>
>
>
> You may be able to work-around this either by taking the latest all-in-one
> image or by following the simpler bulk-provisioning process at
> https://github.com/Metaswitch/crest/blob/dev/docs/Bulk-
> Provisioning%20Numbers.md (when this doc talks about using the
> sstables_provisioning process for very large sets of numbers, we mean 1M+
> numbers - the 9000 you're provisioning are well within the capabilities of
> this process).
>
>
>
> I hope that helps - please let me know how you get on.
>
>
>
> Cheers,
>
>
>
> Matt
>
>
>
>
>
> *From:* Clearwater [mailto:clearwater-bounces at lists.projectclearwater.org]
> *On Behalf Of *Kosala
> *Sent:* 15 August 2016 16:58
> *To:* clearwater at lists.projectclearwater.org
> *Subject:* Re: [Project Clearwater] Clearwater Digest, Vol 40, Issue 24
>
>
>
> HI Matt,
>
> Thanks.
>
>
> I am trying to follow https://github.com/Metaswitch/
> crest/blob/dev/src/metaswitch/crest/tools/sstable_provisioning/README.md
> for bulk provisioning.
>
>
> When I am trying to execute sudo ./BulkProvision homer 21000 29999
> example.com 7kkzTyGW in all-in-one image,
> I am getting an error  java.lang.UnsupportedClassVersionError:
> ClearwaterBulkProvisioner : Unsupported major.minor version 52.0
>
> Java version info in all-in-one image:
> [cw-aio]ubuntu at cwaio:/usr/share/clearwater/crest/tools/sstable_provisioning$
> java -version
> java version "1.7.0_101"
> OpenJDK Runtime Environment (IcedTea 2.6.6) (7u101-2.6.6-0ubuntu0.14.04.1)
> OpenJDK 64-Bit Server VM (build 24.95-b01, mixed mode)
>
> Thanks
>
> Kosala
>
>
>
>
>
>
> On Mon, Aug 15, 2016 at 2:17 PM, <clearwater-request at lists.
> projectclearwater.org> wrote:
>
> Send Clearwater mailing list submissions to
>         clearwater at lists.projectclearwater.org
>
> To subscribe or unsubscribe via the World Wide Web, visit
>         http://lists.projectclearwater.org/mailman/
> listinfo/clearwater_lists.projectclearwater.org
>
> or, via email, send a message with subject or body 'help' to
>         clearwater-request at lists.projectclearwater.org
>
> You can reach the person managing the list at
>         clearwater-owner at lists.projectclearwater.org
>
> When replying, please edit your Subject line so it is more specific
> than "Re: Contents of Clearwater digest..."
>
>
> Today's Topics:
>
>    1. Stress Testing (Kosala)
>    2. Re: Stress Testing (Matt Williams (projectclearwater.org))
>    3. Re: Stress Testing (Matt Williams (projectclearwater.org))
>
>
> ----------------------------------------------------------------------
>
> Message: 1
> Date: Mon, 15 Aug 2016 10:38:57 +0100
> From: Kosala <kosalayb at gmail.com>
> To: clearwater at lists.projectclearwater.org
> Subject: [Project Clearwater] Stress Testing
> Message-ID:
>         <CAGEe17an2B_bGj8NfKFwms+nU=vJURyhT5CE+mcY1pjcm4YF+A at mail.
> gmail.com>
> Content-Type: text/plain; charset="utf-8"
>
> Hi Team,
>
> I installed clearwater "all-in-one" image on Oracle Virtual Box.
> 1. Can I do stress testing ?
> 2. How to do that?
>
> I am trying to follow Stress Testing on
> http://clearwater.readthedocs.io/en/stable/Clearwater_stress_testing.html#
> configuring-udp-stress
> .
>
> Using chef - > It seems chef/knife install only supports in the Cloud
> approach (The automated install is only supported for deployments running
> in Amazon?s EC2 cloud).
>
> Manual approach, It looks not supporting all in one image.
>
> Many Thanks
> Kosala
> -------------- next part --------------
> An HTML attachment was scrubbed...
> URL: <http://lists.projectclearwater.org/pipermail/clearwater_lists.
> projectclearwater.org/attachments/20160815/15fc3b07/attachment-0001.html>
>
> ------------------------------
>
> Message: 2
> Date: Mon, 15 Aug 2016 09:54:02 +0000
> From: "Matt Williams (projectclearwater.org)"
>         <matt at projectclearwater.org>
> To: Kosala <kosalayb at gmail.com>
> Cc: "clearwater at lists.projectclearwater.org"
>         <clearwater at lists.projectclearwater.org>
> Subject: Re: [Project Clearwater] Stress Testing
> Message-ID:
>         <CY1PR0201MB15636F1F20EB91BB180F053390120 at CY1PR0201MB1563.
> namprd02.prod.outlook.com>
>
> Content-Type: text/plain; charset="utf-8"
>
> Kosala,
>
> While it's theoretically possible to do stress testing against an
> all-in-one image, I'd recommend against it - the all-in-one image has been
> squeezed down a lot to fit on a single VM and we'd expect very low
> performance out of it, and I could believe that overload behavior might be
> suboptimal.  If you're looking to stress test for performance reasons, I'd
> strongly recommend running a full deployment as this will give you much
> more reliable numbers.  If you're looking to stress test for other reasons,
> please can you share a bit more about what you're trying to achieve, and we
> can have a think about what would work best?
>
> If you do really want to run stress testing against an all-in-one image,
> it should probably work, even though http://clearwater.readthedocs.
> io/en/latest/Clearwater_stress_testing.html#manual-i-
> e-non-chef-stress-runs only talks about Chef and manual installs.  You'd
> need to set the "bono_servers" option in /etc/clearwater/shared_config to
> point to your all-in-one node, and I suspect you'd need to reduce the
> "count" option to something a lot lower - I'd start around 5000 and see how
> that goes.
>
> I hope that helps.  Please let me know how you get on.
>
> Thanks,
>
> Matt
>
> From: Clearwater [mailto:clearwater-bounces at lists.projectclearwater.org]
> On Behalf Of Kosala
> Sent: 15 August 2016 10:39
> To: clearwater at lists.projectclearwater.org
> Subject: [Project Clearwater] Stress Testing
>
> Hi Team,
> I installed clearwater "all-in-one" image on Oracle Virtual Box.
> 1. Can I do stress testing ?
> 2. How to do that?
> I am trying to follow Stress Testing on http://clearwater.readthedocs.
> io/en/stable/Clearwater_stress_testing.html#configuring-udp-stress.
> Using chef - > It seems chef/knife install only supports in the Cloud
> approach (The automated install is only supported for deployments running
> in Amazon?s EC2 cloud).
> Manual approach, It looks not supporting all in one image.
> Many Thanks
> Kosala
>
> -------------- next part --------------
> An HTML attachment was scrubbed...
> URL: <http://lists.projectclearwater.org/pipermail/clearwater_lists.
> projectclearwater.org/attachments/20160815/29d6328d/attachment-0001.html>
>
> ------------------------------
>
> Message: 3
> Date: Mon, 15 Aug 2016 13:16:47 +0000
> From: "Matt Williams (projectclearwater.org)"
>         <matt at projectclearwater.org>
> To: "clearwater at lists.projectclearwater.org"
>         <clearwater at lists.projectclearwater.org>
> Subject: Re: [Project Clearwater] Stress Testing
> Message-ID:
>         <CY1PR0201MB156372246DC5A77B11839F9D90120 at CY1PR0201MB1563.
> namprd02.prod.outlook.com>
>
> Content-Type: text/plain; charset="utf-8"
>
> Kosala,
>
> You'll need to follow all the steps in http://clearwater.readthedocs.
> io/en/latest/Clearwater_stress_testing.html#manual-i-
> e-non-chef-stress-runs, i.e. bulk provisioning subscribers and installing
> clearwater-sip-stress, but that should be it.
>
> Just to be clear, though, you'll need to set the configuration and install
> the clearwater-sip-stress package on a separate VM, not on the all-in-one
> image itself - the all-in-one image almost certainly opens up ports that
> conflict with those that clearwater-sip-stress tries to use.
>
> This isn't a very well-trodden path, though, so you may hit further issues
> - let me know if so, and we can try to work through them.
>
> Cheers,
>
> Matt
>
> From: Kosala [mailto:kosalayb at gmail.com]
> Sent: 15 August 2016 13:41
> To: Matt Williams (projectclearwater.org) <matt at projectclearwater.org>
> Subject: Re: [Project Clearwater] Stress Testing
>
> Hi Matt,
> Thanks. I set the bono_servers option. Should I add count =5000 to
> /etc/clearwater/shared_config ?
>
> Do I need other changes to run stress tests on all-in-one image?
> Thanks
> Kosala
>
>
>
> On Mon, Aug 15, 2016 at 10:54 AM, Matt Williams (projectclearwater.org<
> http://projectclearwater.org>) <matt at projectclearwater.org<mailto:
> matt at projectclearwater.org>> wrote:
> Kosala,
>
> While it's theoretically possible to do stress testing against an
> all-in-one image, I'd recommend against it - the all-in-one image has been
> squeezed down a lot to fit on a single VM and we'd expect very low
> performance out of it, and I could believe that overload behavior might be
> suboptimal.  If you're looking to stress test for performance reasons, I'd
> strongly recommend running a full deployment as this will give you much
> more reliable numbers.  If you're looking to stress test for other reasons,
> please can you share a bit more about what you're trying to achieve, and we
> can have a think about what would work best?
>
> If you do really want to run stress testing against an all-in-one image,
> it should probably work, even though http://clearwater.readthedocs.
> io/en/latest/Clearwater_stress_testing.html#manual-i-
> e-non-chef-stress-runs only talks about Chef and manual installs.  You'd
> need to set the "bono_servers" option in /etc/clearwater/shared_config to
> point to your all-in-one node, and I suspect you'd need to reduce the
> "count" option to something a lot lower - I'd start around 5000 and see how
> that goes.
>
> I hope that helps.  Please let me know how you get on.
>
> Thanks,
>
> Matt
>
> From: Clearwater [mailto:clearwater-bounces at lists.projectclearwater.org<
> mailto:clearwater-bounces at lists.projectclearwater.org>] On Behalf Of
> Kosala
> Sent: 15 August 2016 10:39
> To: clearwater at lists.projectclearwater.org<mailto:clearwater at lists.
> projectclearwater.org>
> Subject: [Project Clearwater] Stress Testing
>
> Hi Team,
> I installed clearwater "all-in-one" image on Oracle Virtual Box.
> 1. Can I do stress testing ?
> 2. How to do that?
> I am trying to follow Stress Testing on http://clearwater.readthedocs.
> io/en/stable/Clearwater_stress_testing.html#configuring-udp-stress.
> Using chef - > It seems chef/knife install only supports in the Cloud
> approach (The automated install is only supported for deployments running
> in Amazon?s EC2 cloud).
> Manual approach, It looks not supporting all in one image.
> Many Thanks
> Kosala
>
>
> -------------- next part --------------
> An HTML attachment was scrubbed...
> URL: <http://lists.projectclearwater.org/pipermail/clearwater_lists.
> projectclearwater.org/attachments/20160815/11781755/attachment.html>
>
> ------------------------------
>
> Subject: Digest Footer
>
> _______________________________________________
> Clearwater mailing list
> Clearwater at lists.projectclearwater.org
> http://lists.projectclearwater.org/mailman/listinfo/clearwater_lists.
> projectclearwater.org
>
>
> ------------------------------
>
> End of Clearwater Digest, Vol 40, Issue 24
> ******************************************
>
>
>
>
>
>
>
>
>
>
>
>
>
>
>
>
>
>
>
>
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.projectclearwater.org/pipermail/clearwater_lists.projectclearwater.org/attachments/20160818/87e286b1/attachment.html>

From matt at projectclearwater.org  Thu Aug 18 10:53:49 2016
From: matt at projectclearwater.org (Matt Williams (projectclearwater.org))
Date: Thu, 18 Aug 2016 14:53:49 +0000
Subject: [Project Clearwater] Clearwater Digest, Vol 40, Issue 24
In-Reply-To: <CAGEe17bWEkdYazAcTOTq2+7kxwR=yYx04MT-QzjsHQ5HWPAD5Q@mail.gmail.com>
References: <mailman.20.1471267072.11502.clearwater_lists.projectclearwater.org@lists.projectclearwater.org>
	<CAGEe17ZLnypQfbzxEwxj9EaB20MUBVpY+YdN-Obv=gHpZmG0KA@mail.gmail.com>
	<CY1PR0201MB1563F9A706F3EC7BE7F9C11590120@CY1PR0201MB1563.namprd02.prod.outlook.com>
	<CAGEe17bfTu1Kpwx=ipqtEbShvWtP+C6pJEEGHi0GSwBR5Dqw8w@mail.gmail.com>
	<CAGEe17aY077tLtotRe1X8k1qU_4otBdHDMJjqDH_g02Zs676Jg@mail.gmail.com>
	<CAGEe17ZeNPPy7AmMz=LCWnHqLm=v9Q7CuLT+AOVKWJTdg8m7Eg@mail.gmail.com>
	<CY1PR0201MB1563CE17983225B985B19D7390130@CY1PR0201MB1563.namprd02.prod.outlook.com>
	<CAGEe17b2M2uqvbOuqH7t4xM41FbfBYk0xR3zWqiFh+EkSfUzUQ@mail.gmail.com>
	<CY1PR0201MB1563CD5DDDD6E7B5A0B2DB7290140@CY1PR0201MB1563.namprd02.prod.outlook.com>
	<CAGEe17YGnaY1Kqc65gyiVO1sBBuTx=-YzfD9HY3M6QBD2t9AkA@mail.gmail.com>
	<CY1PR0201MB156349F26A0A7670BE7382A890140@CY1PR0201MB1563.namprd02.prod.outlook.com>
	<CAGEe17ZkY2ESNzwQYddrv6=jUJ5fPHu3gJXT7R1UjQmBd+eFUg@mail.gmail.com>
	<CY1PR0201MB1563C979B2D641DA59F1945A90150@CY1PR0201MB1563.namprd02.prod.outlook.com>
	<CAGEe17bC+xmhP3D7w768r0svzBAxdBedVXhis1Z33Yqdq4THgA@mail.gmail.com>
	<CY1PR0201MB1563F865DFBF86128118AC5290150@CY1PR0201MB1563.namprd02.prod.outlook.com>
	<CAGEe17Z2wBvTgPrnK_TdQPerVE9Moxnt=u9CWPpq8V04GJtfUw@mail.gmail.com>
	<CY1PR0201MB1563A30C3B9C4D8EE65FAD4390150@CY1PR0201MB1563.namprd02.prod.outlook.com>
	<CAGEe17ZVrag9yFkLgPF-kfgDPDT_nJETkei_Uwv47mohbAwyxg@mail.gmail.com>
	<CY1PR0201MB156325107DAA32BF9480667B90150@CY1PR0201MB1563.namprd02.prod.outlook.com>
	<CAGEe17bWEkdYazAcTOTq2+7kxwR=yYx04MT-QzjsHQ5HWPAD5Q@mail.gmail.com>
Message-ID: <CY1PR0201MB15630493B218F47026930AF490150@CY1PR0201MB1563.namprd02.prod.outlook.com>

Kosala,

This is what the "count" option on the stress node controls (see http://clearwater.readthedocs.io/en/latest/Clearwater_stress_testing.html#manual-i-e-non-chef-stress-runs for details).  If you only want to make calls to/from the first 100 numbers, set this to 100.

Are these calls going through successfully, then?

Matt

From: Kosala [mailto:kosalayb at gmail.com]
Sent: 18 August 2016 15:20
To: Matt Williams (projectclearwater.org) <matt at projectclearwater.org>
Cc: clearwater at lists.projectclearwater.org
Subject: Re: [Project Clearwater] Clearwater Digest, Vol 40, Issue 24

Hi Matt,
Thanks. SIP node is calling numbers in a larger range starting from 2010000000. Can I restrict SIP call invoke from
2010000000 to 2010000099?
I can do bulk provision 100 numbers. I do not know how to restrict SIP node to call only these 100 numbers?
Thanks
Kosala


On Thu, Aug 18, 2016 at 2:59 PM, Matt Williams (projectclearwater.org<http://projectclearwater.org>) <matt at projectclearwater.org<mailto:matt at projectclearwater.org>> wrote:
Kosala,

The error you're seeing suggests that the request is timing out between Bono and Sprout.  This could be due to poor performance on the all-in-one node (as I said previously, the all-in-one node is not intended for running stress), or it could be due to a more general misconfiguration.  Are all REGISTERs failing, or just some?

Regarding getting CPU statistics etc., we normally use Cacti.  There are instructions for setting this up at http://clearwater.readthedocs.io/en/latest/Cacti.html.  However, I doubt this will work as-is with your all-in-one node.  Since you only have one node, maybe you're best just looking at top?

Matt

From: Kosala [mailto:kosalayb at gmail.com<mailto:kosalayb at gmail.com>]
Sent: 18 August 2016 14:13

To: Matt Williams (projectclearwater.org<http://projectclearwater.org>) <matt at projectclearwater.org<mailto:matt at projectclearwater.org>>
Cc: clearwater at lists.projectclearwater.org<mailto:clearwater at lists.projectclearwater.org>
Subject: Re: [Project Clearwater] Clearwater Digest, Vol 40, Issue 24

Hi Matt,
Now for the numbers I have in Cassandra, at SP node, I am getting "SIP/2.0 504 Server Timeout"
2016-08-18      11:49:03:189    1471520943.189039: Aborting call on unexpected message for Call-Id '1073-27637 at 10.0.22.193<mailto:1073-27637 at 10.0.22.193>': while expecting '401' (index 3), received 'SIP/2.0 504 Server Timeout^M
Via: SIP/2.0/TCP 10.0.22.193:5060;rport=32939;received=10.0.22.193;branch=z9hG4bK-27637-1073-2-2010000854-^M
Record-Route: <sip:scscf.cwaio:5054;transport=TCP;lr;service=scscf;billing-role=charge-orig>^M
Call-ID: 2010000854///1073-27637 at 10.0.22.193<mailto:1073-27637 at 10.0.22.193>^M
From: <sip:2010000854 at example.com<mailto:sip%3A2010000854 at example.com>>;tag=27637SIPpTag001073^M
To: <sip:2010000854 at example.com<mailto:sip%3A2010000854 at example.com>>;tag=z9hG4bKPjuN16eRA0bDott9z6ZA-fwIYe3VA-KMkQ^M
CSeq: 1 REGISTER^M
Content-Length:  0^M
^M
'.
2016-08-18      11:49:04:185    1471520944.185945: Aborting call on unexpected message for Call-Id '1154-27637 at 10.0.22.193<mailto:1154-27637 at 10.0.22.193>': while expecting '401' (index 3), received 'SIP/2.0 504 Server Timeout^M
Via: SIP/2.0/TCP 10.0.22.193:5060;rport=32940;received=10.0.22.193;branch=z9hG4bK-27637-1154-2-2010000692-^M
Record-Route: <sip:scscf.cwaio:5054;transport=TCP;lr;service=scscf;billing-role=charge-orig>^M
Call-ID: 2010000692///1154-27637 at 10.0.22.193<mailto:1154-27637 at 10.0.22.193>^M
From: <sip:2010000692 at example.com<mailto:sip%3A2010000692 at example.com>>;tag=27637SIPpTag001154^M
To: <sip:2010000692 at example.com<mailto:sip%3A2010000692 at example.com>>;tag=z9hG4bKPjk-5lYhadbnX7rqNirT8tjwQdDjLAQo0j^M
CSeq: 1 REGISTER^M
Content-Length:  0^M

How do I know, stress tests are running properly? Can I see statistics such as memory usage, cpu time,  etc ?
Thanks
Kosala


On Thu, Aug 18, 2016 at 12:38 PM, Matt Williams (projectclearwater.org<http://projectclearwater.org>) <matt at projectclearwater.org<mailto:matt at projectclearwater.org>> wrote:
Kosala,

Thanks!  I'm very confused about your software version, though, as the latest all-in-one image has

?         crest 1.0-160811.103635 (i.e. older than yours)

?         homestead 1.0-160814.205535 (i.e. slightly newer than yours)

?         sprout 1.0-160814.205701 (i.e. much newer than yours)

?         the logging.bash script fix already applied.
It looks as though your might have taken the previous all-in-one image, and then upgraded some of the packages.  Please can you confirm: have you upgraded any packages?

On the issue you're seeing, I think you're saying that

?         you're running clearwater-sip-stress (which defaults to using numbers in the range above 2010000000)

?         you've deleted all these numbers from Homestead's Cassandra

?         you see errors in clearwater-sip-stress's log file saying that registration are failing with "404 Not Found".
I think this is expected - you need to provision numbers in Homestead's Cassandra that match the numbers that clearwater-sip-stress is expecting to register as.  Please let me know if I've misunderstood.

Thanks,

Matt

From: Kosala [mailto:kosalayb at gmail.com<mailto:kosalayb at gmail.com>]
Sent: 18 August 2016 11:46

To: Matt Williams (projectclearwater.org<http://projectclearwater.org>) <matt at projectclearwater.org<mailto:matt at projectclearwater.org>>
Subject: Re: [Project Clearwater] Clearwater Digest, Vol 40, Issue 24


Hi Matt,
I am running the latest version all-in-one which i downloaded from http://vm-images.cw-ngv.com/cw-aio.ova.

[cw-aio]ubuntu at cwaio:~$ sudo dpkg-query -s crest
[sudo] password for ubuntu:
Package: crest
Status: install ok installed
Priority: optional
Section: network
Installed-Size: 40102
Maintainer: Project Clearwater Maintainers <maintainers at projectclearwater.org<mailto:maintainers at projectclearwater.org>>
Architecture: amd64
Version: 1.0-160818.091648
homestead
Version: 1.0-160812.164051
sprout
Version: 1.0-160726.101022
And one strange thing is:
I deleted all the records in tables from homestead_cache and homestead_provisioning. Then when I check the SIP node for logs, sip-stress_14320_errors.log still has records with sip: ids which are not in Cassandra. For example, sip:2010021460 at example.com<mailto:sip%3A2010021460 at example.com>
2016-08-18      10:26:08:288    1471515968.288189: Aborting call on unexpected message for Call-Id '4270-14320 at 10.0.22.193<mailto:4270-14320 at 10.0.22.193>': while expecting '401' (index 3), received 'SIP/2.0 404 Not Found^M
Via: SIP/2.0/TCP 10.0.22.193:5060;rport=35233;received=10.0.22.193;branch=z9hG4bK-14320-4270-2-2010021460-^M
Record-Route: <sip:scscf.cwaio:5054;transport=TCP;lr;service=scscf;billing-role=charge-orig>^M
Call-ID: 2010021460///4270-14320 at 10.0.22.193<mailto:4270-14320 at 10.0.22.193>^M
From: <sip:2010021460 at example.com<mailto:sip%3A2010021460 at example.com>>;tag=14320SIPpTag004270^M
To: <sip:2010021460 at example.com<mailto:sip%3A2010021460 at example.com>>;tag=z9hG4bKPjVe2he9j28lou.0Dl9NmKGS7ypUMLjMJv^M
CSeq: 1 REGISTER^M
Content-Length:  0^M
Thanks
Kosala

On Thu, Aug 18, 2016 at 10:47 AM, Matt Williams (projectclearwater.org<http://projectclearwater.org>) <matt at projectclearwater.org<mailto:matt at projectclearwater.org>> wrote:
Kosala,

The fix is not to copy this to /usr/share/clearwater/utils, but to move it.  However, since the error is benign, I'd suggest just ignoring it while we get this working.

As I asked below, please can you confirm what version you're running?  I'm concerned that it's going to be very hard to troubleshoot problems if you have an all-in-one image from a few weeks ago, with some packages updated to more recent versions and then some further fixes manually applied.

Thanks,

Matt


From: Kosala [mailto:kosalayb at gmail.com<mailto:kosalayb at gmail.com>]
Sent: 18 August 2016 10:34

To: Matt Williams (projectclearwater.org<http://projectclearwater.org>) <matt at projectclearwater.org<mailto:matt at projectclearwater.org>>
Cc: clearwater at lists.projectclearwater.org<mailto:clearwater at lists.projectclearwater.org>
Subject: Re: [Project Clearwater] Clearwater Digest, Vol 40, Issue 24

Hi Matt,
Yeah, Manual calls are working fine.
As it is said in the big fix, https://github.com/Metaswitch/clearwater-infrastructure/issues/355 , I copied logging.bash to /usr/share/clearwater/utils
but I am still getting

/etc/init.d/clearwater-infrastructure: 76: /etc/init.d/clearwater-infrastructure: /usr/share/clearwater/infrastructure/scripts/logging.bash: Permission denied
Configuring monit for only localhost access
Kosala


On Thu, Aug 18, 2016 at 10:01 AM, Matt Williams (projectclearwater.org<http://projectclearwater.org>) <matt at projectclearwater.org<mailto:matt at projectclearwater.org>> wrote:
Kosala,

Yes, it's https://github.com/Metaswitch/clearwater-infrastructure/issues/355 and it should be benign.

However, this was fixed about 2 weeks ago.  Please can you confirm when you downloaded the all-in-one image, and whether you've upgraded it all?  (As I observed earlier, your crest release was from only a few days ago.)

Have you got manual calls working?

Thanks,

Matt


From: Kosala [mailto:kosalayb at gmail.com<mailto:kosalayb at gmail.com>]
Sent: 18 August 2016 09:56
To: Matt Williams (projectclearwater.org<http://projectclearwater.org>) <matt at projectclearwater.org<mailto:matt at projectclearwater.org>>
Cc: clearwater at lists.projectclearwater.org<mailto:clearwater at lists.projectclearwater.org>

Subject: Re: [Project Clearwater] Clearwater Digest, Vol 40, Issue 24

Hi Matt,
In SIP node, when I am trying to execute "sudo service clearwater-sip-stress restart", I am getting an error

/etc/init.d/clearwater-infrastructure: 76: /etc/init.d/clearwater-infrastructure: /usr/share/clearwater/infrastructure/scripts/logging.bash: Permission denied
Configuring monit for only localhost access
Any clue about this error?
Thanks
Kosala


On Wed, Aug 17, 2016 at 2:29 PM, Matt Williams (projectclearwater.org<http://projectclearwater.org>) <matt at projectclearwater.org<mailto:matt at projectclearwater.org>> wrote:
Kosala,

Yes, that's the correct screen, and you're correct that it shows that stress is being attempted but failing.

Do regular (non-stress) calls work through this deployment?

You can look at what message the stress node is receiving in the log files in the /var/log/clearwater-sip-stress/ directory - I think there are "errors" logs that contain the unexpected messages.

You can obviously also look at what's happening on the all-in-one node itself, using the /var/log/bono/*, /var/log/sprout/* and /var/log/homestead/* files, as described at http://clearwater.readthedocs.io/en/latest/Troubleshooting_and_Recovery.html.

I hope that helps.

Cheers,

Matt

From: Kosala [mailto:kosalayb at gmail.com<mailto:kosalayb at gmail.com>]
Sent: 17 August 2016 14:20

To: Matt Williams (projectclearwater.org<http://projectclearwater.org>) <matt at projectclearwater.org<mailto:matt at projectclearwater.org>>
Subject: Re: [Project Clearwater] Clearwater Digest, Vol 40, Issue 24

Hi Matt,
I can see this scenario screen from sip-stress.1.out. I hope this will be the stress test output results.

------------------------------ Scenario Screen -------- [1-9]: Change Screen --
     Users (length)   Port   Total-time  Total-calls  Remote-host
        2500 (0 ms)   5060      77.15 s         2500  10.0.21.192:5060(TCP)

  Call limit reached (-m 2500), 1.002 s period  1 ms scheduler resolution
  2175 calls (limit 2500)                Peak was 2499 calls, after 0 s
  0 Running, 2177 Paused, 8 Woken up
  0 dead call msg (discarded)            0 out-of-call msg (discarded)
  3 open sockets

                                 Messages  Retrans   Timeout   Unexpected-Msg
       Pause [0ms/10:00]         2500                          0
    REGISTER ---------->         326       0
         401 <----------         0         0         0         325
    REGISTER ---------->         0         0
         200 <----------         0         0         0         0
    REGISTER ---------->         0         0
         401 <----------         0         0         0         0
    REGISTER ---------->         0         0
         200 <----------         0         0         0         0
       Pause [     4:50]         0                             0
    REGISTER ---------->  B-RTD1 0         0
         200 <----------  E-RTD1 0         0         0         0
    REGISTER ---------->  B-RTD1 0         0
         200 <----------  E-RTD1 0         0         0         0
       Pause [     4:50]         0                             0
       Pause [$pre_call_delay]   0                             0
      INVITE ---------->  B-RTD2 0         0
         100 <----------         0         0         0         0
      INVITE <----------         0         0         0         0
         100 <----------         0         0         0         0
      INVITE <----------         0         0         0         0
         100 ---------->         0         0
         180 ---------->         0         0
         180 <----------         0         0         0         0
       Pause [   6000ms]         0                             0
         200 ---------->         0         0
         200 <----------         0         0         0         0
         ACK ---------->         0         0
         ACK <----------         0         0         0         0
      UPDATE ---------->         0         0
      UPDATE <----------         0         0         0         0
         200 ---------->         0         0
         200 <----------  E-RTD2 0         0         0         0
       Pause [    24.0s]         0                             0
         BYE ---------->  B-RTD3 0         0
         BYE <----------         0         0         0         0
         200 ---------->         0         0
         200 <----------  E-RTD3 0         0         0         0
       Pause [$post_call_delay]  0                             0
------- Waiting for active calls to end. Press [q] again to force exit. -------
Last Error: Aborting call on unexpected message for Call-Id '1079-13729 at ...
However there is an unexpected message error at the end.
Thanks
Kosala


On Wed, Aug 17, 2016 at 12:40 PM, Matt Williams (projectclearwater.org<http://projectclearwater.org>) <matt at projectclearwater.org<mailto:matt at projectclearwater.org>> wrote:
Kosala,

They should log to /var/log/clearwater-sip-stress - in particular, the *.1.out file is a log of the output from sipp.  Do you see anything there?

Matt

From: Kosala [mailto:kosalayb at gmail.com<mailto:kosalayb at gmail.com>]
Sent: 17 August 2016 12:33
To: Matt Williams (projectclearwater.org<http://projectclearwater.org>) <matt at projectclearwater.org<mailto:matt at projectclearwater.org>>; clearwater at lists.projectclearwater.org<mailto:clearwater at lists.projectclearwater.org>

Subject: Re: [Project Clearwater] Clearwater Digest, Vol 40, Issue 24

Hi Matt,
I followed above steps and run sudo apt-get install clearwater-sip-stress.
How do I know stress tests are running? Is is said, stress tests start automatically but I cannot see it.
Thanks
Kosala



On Tue, Aug 16, 2016 at 2:01 PM, Matt Williams (projectclearwater.org<http://projectclearwater.org>) <matt at projectclearwater.org<mailto:matt at projectclearwater.org>> wrote:
Kosala,

I'm glad you've made progress on this.

I had a look at the crest package version, but it seems to be later than the most recent all-in-one image uses (1.0-160811.103635).  When did you download the all-in-one image, and did you apply any patches to it?

Regarding making calls for stress testing, this is where http://clearwater.readthedocs.io/en/latest/Clearwater_stress_testing.html#manual-i-e-non-chef-stress-runs comes in - you need to

?         create a separate VM

?         set the bono_hostname and count parameters in /etc/clearwater/shared_config

?         install the clearwater-sip-stress package.
I hope that helps.

BTW, please remember to copy in clearwater at lists.projectclearwater.org<mailto:clearwater at lists.projectclearwater.org> - that means that other people can see and comment on your posts.

Thanks,

Matt


From: Kosala [mailto:kosalayb at gmail.com<mailto:kosalayb at gmail.com>]
Sent: 16 August 2016 10:48
To: Matt Williams (projectclearwater.org<http://projectclearwater.org>) <matt at projectclearwater.org<mailto:matt at projectclearwater.org>>
Subject: Re: [Project Clearwater] Clearwater Digest, Vol 40, Issue 24

Hi Matt,
Bulk provisioning for all in one image is done using https://github.com/Metaswitch/crest/blob/dev/docs/Bulk-Provisioning%20Numbers.md.
I have records in tables in homestead_cache and homer.
Now How to make calls for stress testing?
Is there any guideline?
Many Thanks,
Kosala




On Tue, Aug 16, 2016 at 9:04 AM, Kosala <kosalayb at gmail.com<mailto:kosalayb at gmail.com>> wrote:
Hi Matt,
TBH, The document in https://github.com/Metaswitch/crest/blob/dev/docs/Bulk-Provisioning%20Numbers.md is not clear to me.
Step 1. Homestead node in deployment. I do not know where is that node in all in one image. It will be helpful the location of that folder from the root.
Step 2. A simple example will be helpful.
Thanks
Kosala


On Tue, Aug 16, 2016 at 8:50 AM, Kosala <kosalayb at gmail.com<mailto:kosalayb at gmail.com>> wrote:
Hi Matt,
I downloaded the all in one package from http://clearwater.readthedocs.io/en/stable/All_in_one_OVF_Installation.html
and imported using oracle virtual box on ubuntu 14.04,
Crest version
[cw-aio]ubuntu at cwaio:~$ sudo dpkg-query -s crest
Package: crest
Status: install ok installed
Priority: optional
Section: network
Installed-Size: 40098
Maintainer: Project Clearwater Maintainers <maintainers at projectclearwater.org<mailto:maintainers at projectclearwater.org>>
Architecture: amd64
Version: 1.0-160815.145007
Thanks
Kosala


On Mon, Aug 15, 2016 at 5:56 PM, Matt Williams (projectclearwater.org<http://projectclearwater.org>) <matt at projectclearwater.org<mailto:matt at projectclearwater.org>> wrote:
Kosala,

That's odd - I don't see that failure on my all-in-one image (spun up just now from the latest image) - which version of all-in-one-image are you running, and which version of crest does it include ("sudo dpkg-query -s crest")?

You may be able to work-around this either by taking the latest all-in-one image or by following the simpler bulk-provisioning process at https://github.com/Metaswitch/crest/blob/dev/docs/Bulk-Provisioning%20Numbers.md (when this doc talks about using the sstables_provisioning process for very large sets of numbers, we mean 1M+ numbers - the 9000 you're provisioning are well within the capabilities of this process).

I hope that helps - please let me know how you get on.

Cheers,

Matt


From: Clearwater [mailto:clearwater-bounces at lists.projectclearwater.org<mailto:clearwater-bounces at lists.projectclearwater.org>] On Behalf Of Kosala
Sent: 15 August 2016 16:58
To: clearwater at lists.projectclearwater.org<mailto:clearwater at lists.projectclearwater.org>
Subject: Re: [Project Clearwater] Clearwater Digest, Vol 40, Issue 24

HI Matt,
Thanks.

I am trying to follow https://github.com/Metaswitch/crest/blob/dev/src/metaswitch/crest/tools/sstable_provisioning/README.md for bulk provisioning.

When I am trying to execute sudo ./BulkProvision homer 21000 29999 example.com<http://example.com> 7kkzTyGW in all-in-one image,
I am getting an error  java.lang.UnsupportedClassVersionError: ClearwaterBulkProvisioner : Unsupported major.minor version 52.0
Java version info in all-in-one image:
[cw-aio]ubuntu at cwaio:/usr/share/clearwater/crest/tools/sstable_provisioning$ java -version
java version "1.7.0_101"
OpenJDK Runtime Environment (IcedTea 2.6.6) (7u101-2.6.6-0ubuntu0.14.04.1)
OpenJDK 64-Bit Server VM (build 24.95-b01, mixed mode)
Thanks
Kosala



On Mon, Aug 15, 2016 at 2:17 PM, <clearwater-request at lists.projectclearwater.org<mailto:clearwater-request at lists.projectclearwater.org>> wrote:
Send Clearwater mailing list submissions to
        clearwater at lists.projectclearwater.org<mailto:clearwater at lists.projectclearwater.org>

To subscribe or unsubscribe via the World Wide Web, visit
        http://lists.projectclearwater.org/mailman/listinfo/clearwater_lists.projectclearwater.org

or, via email, send a message with subject or body 'help' to
        clearwater-request at lists.projectclearwater.org<mailto:clearwater-request at lists.projectclearwater.org>

You can reach the person managing the list at
        clearwater-owner at lists.projectclearwater.org<mailto:clearwater-owner at lists.projectclearwater.org>

When replying, please edit your Subject line so it is more specific
than "Re: Contents of Clearwater digest..."


Today's Topics:

   1. Stress Testing (Kosala)
   2. Re: Stress Testing (Matt Williams (projectclearwater.org<http://projectclearwater.org>))
   3. Re: Stress Testing (Matt Williams (projectclearwater.org<http://projectclearwater.org>))


----------------------------------------------------------------------

Message: 1
Date: Mon, 15 Aug 2016 10:38:57 +0100
From: Kosala <kosalayb at gmail.com<mailto:kosalayb at gmail.com>>
To: clearwater at lists.projectclearwater.org<mailto:clearwater at lists.projectclearwater.org>
Subject: [Project Clearwater] Stress Testing
Message-ID:
        <CAGEe17an2B_bGj8NfKFwms+nU=vJURyhT5CE+mcY1pjcm4YF+A at mail.gmail.com<mailto:vJURyhT5CE%2BmcY1pjcm4YF%2BA at mail.gmail.com>>
Content-Type: text/plain; charset="utf-8"

Hi Team,

I installed clearwater "all-in-one" image on Oracle Virtual Box.
1. Can I do stress testing ?
2. How to do that?

I am trying to follow Stress Testing on
http://clearwater.readthedocs.io/en/stable/Clearwater_stress_testing.html#configuring-udp-stress
.

Using chef - > It seems chef/knife install only supports in the Cloud
approach (The automated install is only supported for deployments running
in Amazon?s EC2 cloud).

Manual approach, It looks not supporting all in one image.

Many Thanks
Kosala
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.projectclearwater.org/pipermail/clearwater_lists.projectclearwater.org/attachments/20160815/15fc3b07/attachment-0001.html>

------------------------------

Message: 2
Date: Mon, 15 Aug 2016 09:54:02 +0000
From: "Matt Williams (projectclearwater.org<http://projectclearwater.org>)"
        <matt at projectclearwater.org<mailto:matt at projectclearwater.org>>
To: Kosala <kosalayb at gmail.com<mailto:kosalayb at gmail.com>>
Cc: "clearwater at lists.projectclearwater.org<mailto:clearwater at lists.projectclearwater.org>"
        <clearwater at lists.projectclearwater.org<mailto:clearwater at lists.projectclearwater.org>>
Subject: Re: [Project Clearwater] Stress Testing
Message-ID:
        <CY1PR0201MB15636F1F20EB91BB180F053390120 at CY1PR0201MB1563.namprd02.prod.outlook.com<mailto:CY1PR0201MB15636F1F20EB91BB180F053390120 at CY1PR0201MB1563.namprd02.prod.outlook.com>>

Content-Type: text/plain; charset="utf-8"

Kosala,

While it's theoretically possible to do stress testing against an all-in-one image, I'd recommend against it - the all-in-one image has been squeezed down a lot to fit on a single VM and we'd expect very low performance out of it, and I could believe that overload behavior might be suboptimal.  If you're looking to stress test for performance reasons, I'd strongly recommend running a full deployment as this will give you much more reliable numbers.  If you're looking to stress test for other reasons, please can you share a bit more about what you're trying to achieve, and we can have a think about what would work best?

If you do really want to run stress testing against an all-in-one image, it should probably work, even though http://clearwater.readthedocs.io/en/latest/Clearwater_stress_testing.html#manual-i-e-non-chef-stress-runs only talks about Chef and manual installs.  You'd need to set the "bono_servers" option in /etc/clearwater/shared_config to point to your all-in-one node, and I suspect you'd need to reduce the "count" option to something a lot lower - I'd start around 5000 and see how that goes.

I hope that helps.  Please let me know how you get on.

Thanks,

Matt

From: Clearwater [mailto:clearwater-bounces at lists.projectclearwater.org<mailto:clearwater-bounces at lists.projectclearwater.org>] On Behalf Of Kosala
Sent: 15 August 2016 10:39
To: clearwater at lists.projectclearwater.org<mailto:clearwater at lists.projectclearwater.org>
Subject: [Project Clearwater] Stress Testing

Hi Team,
I installed clearwater "all-in-one" image on Oracle Virtual Box.
1. Can I do stress testing ?
2. How to do that?
I am trying to follow Stress Testing on http://clearwater.readthedocs.io/en/stable/Clearwater_stress_testing.html#configuring-udp-stress.
Using chef - > It seems chef/knife install only supports in the Cloud approach (The automated install is only supported for deployments running in Amazon?s EC2 cloud).
Manual approach, It looks not supporting all in one image.
Many Thanks
Kosala

-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.projectclearwater.org/pipermail/clearwater_lists.projectclearwater.org/attachments/20160815/29d6328d/attachment-0001.html>

------------------------------

Message: 3
Date: Mon, 15 Aug 2016 13:16:47 +0000
From: "Matt Williams (projectclearwater.org<http://projectclearwater.org>)"
        <matt at projectclearwater.org<mailto:matt at projectclearwater.org>>
To: "clearwater at lists.projectclearwater.org<mailto:clearwater at lists.projectclearwater.org>"
        <clearwater at lists.projectclearwater.org<mailto:clearwater at lists.projectclearwater.org>>
Subject: Re: [Project Clearwater] Stress Testing
Message-ID:
        <CY1PR0201MB156372246DC5A77B11839F9D90120 at CY1PR0201MB1563.namprd02.prod.outlook.com<mailto:CY1PR0201MB156372246DC5A77B11839F9D90120 at CY1PR0201MB1563.namprd02.prod.outlook.com>>

Content-Type: text/plain; charset="utf-8"

Kosala,

You'll need to follow all the steps in http://clearwater.readthedocs.io/en/latest/Clearwater_stress_testing.html#manual-i-e-non-chef-stress-runs, i.e. bulk provisioning subscribers and installing clearwater-sip-stress, but that should be it.

Just to be clear, though, you'll need to set the configuration and install the clearwater-sip-stress package on a separate VM, not on the all-in-one image itself - the all-in-one image almost certainly opens up ports that conflict with those that clearwater-sip-stress tries to use.

This isn't a very well-trodden path, though, so you may hit further issues - let me know if so, and we can try to work through them.

Cheers,

Matt

From: Kosala [mailto:kosalayb at gmail.com<mailto:kosalayb at gmail.com>]
Sent: 15 August 2016 13:41
To: Matt Williams (projectclearwater.org<http://projectclearwater.org>) <matt at projectclearwater.org<mailto:matt at projectclearwater.org>>
Subject: Re: [Project Clearwater] Stress Testing

Hi Matt,
Thanks. I set the bono_servers option. Should I add count =5000 to /etc/clearwater/shared_config ?

Do I need other changes to run stress tests on all-in-one image?
Thanks
Kosala



On Mon, Aug 15, 2016 at 10:54 AM, Matt Williams (projectclearwater.org<http://projectclearwater.org><http://projectclearwater.org>) <matt at projectclearwater.org<mailto:matt at projectclearwater.org><mailto:matt at projectclearwater.org<mailto:matt at projectclearwater.org>>> wrote:
Kosala,

While it's theoretically possible to do stress testing against an all-in-one image, I'd recommend against it - the all-in-one image has been squeezed down a lot to fit on a single VM and we'd expect very low performance out of it, and I could believe that overload behavior might be suboptimal.  If you're looking to stress test for performance reasons, I'd strongly recommend running a full deployment as this will give you much more reliable numbers.  If you're looking to stress test for other reasons, please can you share a bit more about what you're trying to achieve, and we can have a think about what would work best?

If you do really want to run stress testing against an all-in-one image, it should probably work, even though http://clearwater.readthedocs.io/en/latest/Clearwater_stress_testing.html#manual-i-e-non-chef-stress-runs only talks about Chef and manual installs.  You'd need to set the "bono_servers" option in /etc/clearwater/shared_config to point to your all-in-one node, and I suspect you'd need to reduce the "count" option to something a lot lower - I'd start around 5000 and see how that goes.

I hope that helps.  Please let me know how you get on.

Thanks,

Matt

From: Clearwater [mailto:clearwater-bounces at lists.projectclearwater.org<mailto:clearwater-bounces at lists.projectclearwater.org><mailto:clearwater-bounces at lists.projectclearwater.org<mailto:clearwater-bounces at lists.projectclearwater.org>>] On Behalf Of Kosala
Sent: 15 August 2016 10:39
To: clearwater at lists.projectclearwater.org<mailto:clearwater at lists.projectclearwater.org><mailto:clearwater at lists.projectclearwater.org<mailto:clearwater at lists.projectclearwater.org>>
Subject: [Project Clearwater] Stress Testing

Hi Team,
I installed clearwater "all-in-one" image on Oracle Virtual Box.
1. Can I do stress testing ?
2. How to do that?
I am trying to follow Stress Testing on http://clearwater.readthedocs.io/en/stable/Clearwater_stress_testing.html#configuring-udp-stress.
Using chef - > It seems chef/knife install only supports in the Cloud approach (The automated install is only supported for deployments running in Amazon?s EC2 cloud).
Manual approach, It looks not supporting all in one image.
Many Thanks
Kosala


-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.projectclearwater.org/pipermail/clearwater_lists.projectclearwater.org/attachments/20160815/11781755/attachment.html>

------------------------------

Subject: Digest Footer

_______________________________________________
Clearwater mailing list
Clearwater at lists.projectclearwater.org<mailto:Clearwater at lists.projectclearwater.org>
http://lists.projectclearwater.org/mailman/listinfo/clearwater_lists.projectclearwater.org


------------------------------

End of Clearwater Digest, Vol 40, Issue 24
******************************************











-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.projectclearwater.org/pipermail/clearwater_lists.projectclearwater.org/attachments/20160818/c049c80e/attachment.html>

From kosalayb at gmail.com  Thu Aug 18 11:25:46 2016
From: kosalayb at gmail.com (Kosala)
Date: Thu, 18 Aug 2016 16:25:46 +0100
Subject: [Project Clearwater] Clearwater Digest, Vol 40, Issue 24
In-Reply-To: <CY1PR0201MB15630493B218F47026930AF490150@CY1PR0201MB1563.namprd02.prod.outlook.com>
References: <mailman.20.1471267072.11502.clearwater_lists.projectclearwater.org@lists.projectclearwater.org>
	<CAGEe17ZLnypQfbzxEwxj9EaB20MUBVpY+YdN-Obv=gHpZmG0KA@mail.gmail.com>
	<CY1PR0201MB1563F9A706F3EC7BE7F9C11590120@CY1PR0201MB1563.namprd02.prod.outlook.com>
	<CAGEe17bfTu1Kpwx=ipqtEbShvWtP+C6pJEEGHi0GSwBR5Dqw8w@mail.gmail.com>
	<CAGEe17aY077tLtotRe1X8k1qU_4otBdHDMJjqDH_g02Zs676Jg@mail.gmail.com>
	<CAGEe17ZeNPPy7AmMz=LCWnHqLm=v9Q7CuLT+AOVKWJTdg8m7Eg@mail.gmail.com>
	<CY1PR0201MB1563CE17983225B985B19D7390130@CY1PR0201MB1563.namprd02.prod.outlook.com>
	<CAGEe17b2M2uqvbOuqH7t4xM41FbfBYk0xR3zWqiFh+EkSfUzUQ@mail.gmail.com>
	<CY1PR0201MB1563CD5DDDD6E7B5A0B2DB7290140@CY1PR0201MB1563.namprd02.prod.outlook.com>
	<CAGEe17YGnaY1Kqc65gyiVO1sBBuTx=-YzfD9HY3M6QBD2t9AkA@mail.gmail.com>
	<CY1PR0201MB156349F26A0A7670BE7382A890140@CY1PR0201MB1563.namprd02.prod.outlook.com>
	<CAGEe17ZkY2ESNzwQYddrv6=jUJ5fPHu3gJXT7R1UjQmBd+eFUg@mail.gmail.com>
	<CY1PR0201MB1563C979B2D641DA59F1945A90150@CY1PR0201MB1563.namprd02.prod.outlook.com>
	<CAGEe17bC+xmhP3D7w768r0svzBAxdBedVXhis1Z33Yqdq4THgA@mail.gmail.com>
	<CY1PR0201MB1563F865DFBF86128118AC5290150@CY1PR0201MB1563.namprd02.prod.outlook.com>
	<CAGEe17Z2wBvTgPrnK_TdQPerVE9Moxnt=u9CWPpq8V04GJtfUw@mail.gmail.com>
	<CY1PR0201MB1563A30C3B9C4D8EE65FAD4390150@CY1PR0201MB1563.namprd02.prod.outlook.com>
	<CAGEe17ZVrag9yFkLgPF-kfgDPDT_nJETkei_Uwv47mohbAwyxg@mail.gmail.com>
	<CY1PR0201MB156325107DAA32BF9480667B90150@CY1PR0201MB1563.namprd02.prod.outlook.com>
	<CAGEe17bWEkdYazAcTOTq2+7kxwR=yYx04MT-QzjsHQ5HWPAD5Q@mail.gmail.com>
	<CY1PR0201MB15630493B218F47026930AF490150@CY1PR0201MB1563.namprd02.prod.outlook.com>
Message-ID: <CAGEe17YcA6fMx-gL8H_h4MUFmsOGYA7O3N+nYjJ83BYz6SgrPQ@mail.gmail.com>

No I am getting server Timeout

sipp: The following events occured:
2016-08-18      15:22:10:886    1471533730.886591: Aborting call on
unexpected message for Call-Id '2-16183 at 10.0.22.193': while expecting '401'
(index 3), received 'SIP/2.0 504 Server Timeout^M
Via: SIP/2.0/TCP 10.0.22.193:5060
;rport=9471;received=10.0.22.193;branch=z9hG4bK-16183-2-2-2010000096-^M
Record-Route:
<sip:scscf.cwaio:5054;transport=TCP;lr;service=scscf;billing-role=charge-orig>^M
Call-ID: 2010000096///2-16183 at 10.0.22.193^M
From: <sip:2010000096 at example.com>;tag=16183SIPpTag002^M
To: <sip:2010000096 at example.com
>;tag=z9hG4bKPjmTtF24BomE1irtWVZnxim6jKcUfYxxow^M
CSeq: 1 REGISTER^M
Content-Length:  0^M
^M
'.
2016-08-18      15:22:14:043    1471533734.043867: Aborting call on
unexpected message for Call-Id '23-16183 at 10.0.22.193': while expecting
'401' (index 3), received 'SIP/2.0 504 Server Timeout^M
Via: SIP/2.0/TCP 10.0.22.193:5060
;rport=9480;received=10.0.22.193;branch=z9hG4bK-16183-23-2-2010000054-^M
Record-Route:
<sip:scscf.cwaio:5054;transport=TCP;lr;service=scscf;billing-role=charge-orig>^M
Call-ID: 2010000054///23-16183 at 10.0.22.193^M
From: <sip:2010000054 at example.com>;tag=16183SIPpTag0023^M
To: <sip:2010000054 at example.com
>;tag=z9hG4bKPjGLvFZz93Nq8VVQLuNznXDdHoOn3ILBWs^M
CSeq: 1 REGISTER^M
Content-Length:  0^M
^M

Kosala



On Thu, Aug 18, 2016 at 3:53 PM, Matt Williams (projectclearwater.org) <
matt at projectclearwater.org> wrote:

> Kosala,
>
>
>
> This is what the "count" option on the stress node controls (see
> http://clearwater.readthedocs.io/en/latest/Clearwater_
> stress_testing.html#manual-i-e-non-chef-stress-runs for details).  If you
> only want to make calls to/from the first 100 numbers, set this to 100.
>
>
>
> Are these calls going through successfully, then?
>
>
>
> Matt
>
>
>
> *From:* Kosala [mailto:kosalayb at gmail.com]
> *Sent:* 18 August 2016 15:20
> *To:* Matt Williams (projectclearwater.org) <matt at projectclearwater.org>
> *Cc:* clearwater at lists.projectclearwater.org
> *Subject:* Re: [Project Clearwater] Clearwater Digest, Vol 40, Issue 24
>
>
>
> Hi Matt,
>
> Thanks. SIP node is calling numbers in a larger range starting from 2010000000.
> Can I restrict SIP call invoke from
>
> 2010000000 to 2010000099?
>
> I can do bulk provision 100 numbers. I do not know how to restrict SIP
> node to call only these 100 numbers?
>
> Thanks
>
> Kosala
>
>
>
>
>
> On Thu, Aug 18, 2016 at 2:59 PM, Matt Williams (projectclearwater.org) <
> matt at projectclearwater.org> wrote:
>
> Kosala,
>
>
>
> The error you're seeing suggests that the request is timing out between
> Bono and Sprout.  This could be due to poor performance on the all-in-one
> node (as I said previously, the all-in-one node is not intended for running
> stress), or it could be due to a more general misconfiguration.  Are all
> REGISTERs failing, or just some?
>
>
>
> Regarding getting CPU statistics etc., we normally use Cacti.  There are
> instructions for setting this up at http://clearwater.readthedocs.
> io/en/latest/Cacti.html.  However, I doubt this will work as-is with your
> all-in-one node.  Since you only have one node, maybe you're best just
> looking at top?
>
>
>
> Matt
>
>
>
> *From:* Kosala [mailto:kosalayb at gmail.com]
> *Sent:* 18 August 2016 14:13
>
>
> *To:* Matt Williams (projectclearwater.org) <matt at projectclearwater.org>
> *Cc:* clearwater at lists.projectclearwater.org
> *Subject:* Re: [Project Clearwater] Clearwater Digest, Vol 40, Issue 24
>
>
>
> Hi Matt,
>
> Now for the numbers I have in Cassandra, at SP node, I am getting "SIP/2.0
> 504 Server Timeout"
>
> 2016-08-18      11:49:03:189    1471520943.189039: Aborting call on
> unexpected message for Call-Id '1073-27637 at 10.0.22.193': while expecting
> '401' (index 3), received 'SIP/2.0 504 Server Timeout^M
> Via: SIP/2.0/TCP 10.0.22.193:5060;rport=32939;received=10.0.22.193;branch=
> z9hG4bK-27637-1073-2-2010000854-^M
> Record-Route: <sip:scscf.cwaio:5054;transport=TCP;lr;service=
> scscf;billing-role=charge-orig>^M
> Call-ID: 2010000854///1073-27637 at 10.0.22.193^M
> From: <sip:2010000854 at example.com>;tag=27637SIPpTag001073^M
> To: <sip:2010000854 at example.com>;tag=z9hG4bKPjuN16eRA0bDott9z6ZA-
> fwIYe3VA-KMkQ^M
> CSeq: 1 REGISTER^M
> Content-Length:  0^M
> ^M
> '.
> 2016-08-18      11:49:04:185    1471520944.185945: Aborting call on
> unexpected message for Call-Id '1154-27637 at 10.0.22.193': while expecting
> '401' (index 3), received 'SIP/2.0 504 Server Timeout^M
> Via: SIP/2.0/TCP 10.0.22.193:5060;rport=32940;received=10.0.22.193;branch=
> z9hG4bK-27637-1154-2-2010000692-^M
> Record-Route: <sip:scscf.cwaio:5054;transport=TCP;lr;service=
> scscf;billing-role=charge-orig>^M
> Call-ID: 2010000692///1154-27637 at 10.0.22.193^M
> From: <sip:2010000692 at example.com>;tag=27637SIPpTag001154^M
> To: <sip:2010000692 at example.com>;tag=z9hG4bKPjk-
> 5lYhadbnX7rqNirT8tjwQdDjLAQo0j^M
> CSeq: 1 REGISTER^M
> Content-Length:  0^M
>
> How do I know, stress tests are running properly? Can I see statistics
> such as memory usage, cpu time,  etc ?
>
> Thanks
>
> Kosala
>
>
>
>
>
> On Thu, Aug 18, 2016 at 12:38 PM, Matt Williams (projectclearwater.org) <
> matt at projectclearwater.org> wrote:
>
> Kosala,
>
>
>
> Thanks!  I'm very confused about your software version, though, as the
> latest all-in-one image has
>
> ?         crest 1.0-160811.103635 (i.e. older than yours)
>
> ?         homestead 1.0-160814.205535 (i.e. slightly newer than yours)
>
> ?         sprout 1.0-160814.205701 (i.e. much newer than yours)
>
> ?         the logging.bash script fix already applied.
>
> It looks as though your might have taken the previous all-in-one image,
> and then upgraded some of the packages.  Please can you confirm: have you
> upgraded any packages?
>
>
>
> On the issue you're seeing, I think you're saying that
>
> ?         you're running clearwater-sip-stress (which defaults to using
> numbers in the range above 2010000000)
>
> ?         you've deleted all these numbers from Homestead's Cassandra
>
> ?         you see errors in clearwater-sip-stress's log file saying that
> registration are failing with "404 Not Found".
>
> I think this is expected - you need to provision numbers in Homestead's
> Cassandra that match the numbers that clearwater-sip-stress is expecting to
> register as.  Please let me know if I've misunderstood.
>
>
>
> Thanks,
>
>
>
> Matt
>
>
>
> *From:* Kosala [mailto:kosalayb at gmail.com]
> *Sent:* 18 August 2016 11:46
>
>
> *To:* Matt Williams (projectclearwater.org) <matt at projectclearwater.org>
> *Subject:* Re: [Project Clearwater] Clearwater Digest, Vol 40, Issue 24
>
>
>
>
>
> Hi Matt,
>
> I am running the latest version all-in-one which i downloaded from
> http://vm-images.cw-ngv.com/cw-aio.ova.
>
> [cw-aio]ubuntu at cwaio:~$ sudo dpkg-query -s crest
> [sudo] password for ubuntu:
> Package: crest
> Status: install ok installed
> Priority: optional
> Section: network
> Installed-Size: 40102
> Maintainer: Project Clearwater Maintainers <maintainers@
> projectclearwater.org>
> Architecture: amd64
> Version: 1.0-160818.091648
>
> homestead
> Version: 1.0-160812.164051
>
> sprout
> Version: 1.0-160726.101022
>
> And one strange thing is:
>
> I deleted all the records in tables from homestead_cache and
> homestead_provisioning. Then when I check the SIP node for logs,
> sip-stress_14320_errors.log still has records with sip: ids which are not
> in Cassandra. For example, sip:2010021460 at example.com
>
> 2016-08-18      10:26:08:288    1471515968.288189: Aborting call on
> unexpected message for Call-Id '4270-14320 at 10.0.22.193': while expecting
> '401' (index 3), received 'SIP/2.0 404 Not Found^M
> Via: SIP/2.0/TCP 10.0.22.193:5060;rport=35233;received=10.0.22.193;branch=
> z9hG4bK-14320-4270-2-2010021460-^M
> Record-Route: <sip:scscf.cwaio:5054;transport=TCP;lr;service=
> scscf;billing-role=charge-orig>^M
> Call-ID: 2010021460///4270-14320 at 10.0.22.193^M
> From: <sip:2010021460 at example.com>;tag=14320SIPpTag004270^M
> To: <sip:2010021460 at example.com>;tag=z9hG4bKPjVe2he9j28lou.
> 0Dl9NmKGS7ypUMLjMJv^M
> CSeq: 1 REGISTER^M
> Content-Length:  0^M
>
> Thanks
>
> Kosala
>
>
>
> On Thu, Aug 18, 2016 at 10:47 AM, Matt Williams (projectclearwater.org) <
> matt at projectclearwater.org> wrote:
>
> Kosala,
>
>
>
> The fix is not to *copy* this to /usr/share/clearwater/utils, but to
> *move* it.  However, since the error is benign, I'd suggest just ignoring
> it while we get this working.
>
>
>
> As I asked below, please can you confirm what version you're running?  I'm
> concerned that it's going to be very hard to troubleshoot problems if you
> have an all-in-one image from a few weeks ago, with some packages updated
> to more recent versions and then some further fixes manually applied.
>
>
>
> Thanks,
>
>
>
> Matt
>
>
>
>
>
> *From:* Kosala [mailto:kosalayb at gmail.com]
> *Sent:* 18 August 2016 10:34
>
>
> *To:* Matt Williams (projectclearwater.org) <matt at projectclearwater.org>
> *Cc:* clearwater at lists.projectclearwater.org
> *Subject:* Re: [Project Clearwater] Clearwater Digest, Vol 40, Issue 24
>
>
>
> Hi Matt,
>
> Yeah, Manual calls are working fine.
>
> As it is said in the big fix, https://github.com/Metaswitch/
> clearwater-infrastructure/issues/355 , I copied logging.bash to
> /usr/share/clearwater/utils
>
> but I am still getting
>
> /etc/init.d/clearwater-infrastructure: 76: /etc/init.d/clearwater-infrastructure:
> /usr/share/clearwater/infrastructure/scripts/logging.bash: Permission
> denied
> Configuring monit for only localhost access
>
> Kosala
>
>
>
>
>
> On Thu, Aug 18, 2016 at 10:01 AM, Matt Williams (projectclearwater.org) <
> matt at projectclearwater.org> wrote:
>
> Kosala,
>
>
>
> Yes, it's https://github.com/Metaswitch/clearwater-infrastructure/
> issues/355 and it should be benign.
>
>
>
> However, this was fixed about 2 weeks ago.  Please can you confirm when
> you downloaded the all-in-one image, and whether you've upgraded it all?
> (As I observed earlier, your crest release was from only a few days ago.)
>
>
>
> Have you got manual calls working?
>
>
>
> Thanks,
>
>
>
> Matt
>
>
>
>
>
> *From:* Kosala [mailto:kosalayb at gmail.com]
> *Sent:* 18 August 2016 09:56
> *To:* Matt Williams (projectclearwater.org) <matt at projectclearwater.org>
> *Cc:* clearwater at lists.projectclearwater.org
>
>
> *Subject:* Re: [Project Clearwater] Clearwater Digest, Vol 40, Issue 24
>
>
>
> Hi Matt,
>
> In SIP node, when I am trying to execute "sudo service
> clearwater-sip-stress restart", I am getting an error
>
>
> /etc/init.d/clearwater-infrastructure: 76: /etc/init.d/clearwater-infrastructure:
> /usr/share/clearwater/infrastructure/scripts/logging.bash: Permission
> denied
> Configuring monit for only localhost access
>
> Any clue about this error?
>
> Thanks
>
> Kosala
>
>
>
>
>
> On Wed, Aug 17, 2016 at 2:29 PM, Matt Williams (projectclearwater.org) <
> matt at projectclearwater.org> wrote:
>
> Kosala,
>
>
>
> Yes, that's the correct screen, and you're correct that it shows that
> stress is being attempted but failing.
>
>
>
> Do regular (non-stress) calls work through this deployment?
>
>
>
> You can look at what message the stress node is receiving in the log files
> in the /var/log/clearwater-sip-stress/ directory - I think there are
> "errors" logs that contain the unexpected messages.
>
>
>
> You can obviously also look at what's happening on the all-in-one node
> itself, using the /var/log/bono/*, /var/log/sprout/* and
> /var/log/homestead/* files, as described at http://clearwater.readthedocs.
> io/en/latest/Troubleshooting_and_Recovery.html.
>
>
>
> I hope that helps.
>
>
>
> Cheers,
>
>
>
> Matt
>
>
>
> *From:* Kosala [mailto:kosalayb at gmail.com]
> *Sent:* 17 August 2016 14:20
>
>
> *To:* Matt Williams (projectclearwater.org) <matt at projectclearwater.org>
> *Subject:* Re: [Project Clearwater] Clearwater Digest, Vol 40, Issue 24
>
>
>
> Hi Matt,
>
> I can see this scenario screen from sip-stress.1.out. I hope this will be
> the stress test output results.
>
>
> ------------------------------ Scenario Screen -------- [1-9]: Change
> Screen --
>      Users (length)   Port   Total-time  Total-calls  Remote-host
>         2500 (0 ms)   5060      77.15 s         2500  10.0.21.192:5060
> (TCP)
>
>   Call limit reached (-m 2500), 1.002 s period  1 ms scheduler resolution
>   2175 calls (limit 2500)                Peak was 2499 calls, after 0 s
>   0 Running, 2177 Paused, 8 Woken up
>   0 dead call msg (discarded)            0 out-of-call msg
> (discarded)
>   3 open sockets
>
>                                  Messages  Retrans   Timeout
> Unexpected-Msg
>        Pause [0ms/10:00]         2500                          0
>     REGISTER ---------->         326       0
>          401 <----------         0         0         0         325
>     REGISTER ---------->         0         0
>          200 <----------         0         0         0         0
>     REGISTER ---------->         0         0
>          401 <----------         0         0         0         0
>     REGISTER ---------->         0         0
>          200 <----------         0         0         0         0
>        Pause [     4:50]         0                             0
>     REGISTER ---------->  B-RTD1 0         0
>          200 <----------  E-RTD1 0         0         0         0
>     REGISTER ---------->  B-RTD1 0         0
>          200 <----------  E-RTD1 0         0         0         0
>        Pause [     4:50]         0                             0
>        Pause [$pre_call_delay]   0                             0
>       INVITE ---------->  B-RTD2 0         0
>          100 <----------         0         0         0         0
>       INVITE <----------         0         0         0         0
>          100 <----------         0         0         0         0
>       INVITE <----------         0         0         0         0
>          100 ---------->         0         0
>          180 ---------->         0         0
>          180 <----------         0         0         0         0
>        Pause [   6000ms]         0                             0
>          200 ---------->         0         0
>          200 <----------         0         0         0         0
>          ACK ---------->         0         0
>          ACK <----------         0         0         0         0
>       UPDATE ---------->         0         0
>       UPDATE <----------         0         0         0         0
>          200 ---------->         0         0
>          200 <----------  E-RTD2 0         0         0         0
>        Pause [    24.0s]         0                             0
>          BYE ---------->  B-RTD3 0         0
>          BYE <----------         0         0         0         0
>          200 ---------->         0         0
>          200 <----------  E-RTD3 0         0         0         0
>        Pause [$post_call_delay]  0                             0
> ------- Waiting for active calls to end. Press [q] again to force exit.
> -------
> Last Error: Aborting call on unexpected message for Call-Id '1079-13729@
> ...
>
> However there is an unexpected message error at the end.
>
> Thanks
>
> Kosala
>
>
>
>
>
> On Wed, Aug 17, 2016 at 12:40 PM, Matt Williams (projectclearwater.org) <
> matt at projectclearwater.org> wrote:
>
> Kosala,
>
>
>
> They should log to /var/log/clearwater-sip-stress - in particular, the
> *.1.out file is a log of the output from sipp.  Do you see anything there?
>
>
>
> Matt
>
>
>
> *From:* Kosala [mailto:kosalayb at gmail.com]
> *Sent:* 17 August 2016 12:33
> *To:* Matt Williams (projectclearwater.org) <matt at projectclearwater.org>;
> clearwater at lists.projectclearwater.org
>
>
> *Subject:* Re: [Project Clearwater] Clearwater Digest, Vol 40, Issue 24
>
>
>
> Hi Matt,
>
> I followed above steps and run sudo apt-get install clearwater-sip-stress.
>
> How do I know stress tests are running? Is is said, stress tests start
> automatically but I cannot see it.
>
> Thanks
>
> Kosala
>
>
>
>
>
>
> On Tue, Aug 16, 2016 at 2:01 PM, Matt Williams (projectclearwater.org) <
> matt at projectclearwater.org> wrote:
>
> Kosala,
>
>
>
> I'm glad you've made progress on this.
>
>
>
> I had a look at the crest package version, but it seems to be later than
> the most recent all-in-one image uses (1.0-160811.103635).  When did you
> download the all-in-one image, and did you apply any patches to it?
>
>
>
> Regarding making calls for stress testing, this is where
> http://clearwater.readthedocs.io/en/latest/Clearwater_
> stress_testing.html#manual-i-e-non-chef-stress-runs comes in - you need to
>
> ?         create a separate VM
>
> ?         set the bono_hostname and count parameters in
> /etc/clearwater/shared_config
>
> ?         install the clearwater-sip-stress package.
>
> I hope that helps.
>
>
>
> BTW, please remember to copy in clearwater at lists.projectclearwater.org -
> that means that other people can see and comment on your posts.
>
>
>
> Thanks,
>
>
>
> Matt
>
>
>
>
>
> *From:* Kosala [mailto:kosalayb at gmail.com]
> *Sent:* 16 August 2016 10:48
> *To:* Matt Williams (projectclearwater.org) <matt at projectclearwater.org>
>
> *Subject:* Re: [Project Clearwater] Clearwater Digest, Vol 40, Issue 24
>
>
>
> Hi Matt,
>
> Bulk provisioning for all in one image is done using
> https://github.com/Metaswitch/crest/blob/dev/docs/Bulk-
> Provisioning%20Numbers.md.
>
> I have records in tables in homestead_cache and homer.
>
> Now How to make calls for stress testing?
>
> Is there any guideline?
>
> Many Thanks,
>
> Kosala
>
>
>
>
>
>
>
>
>
> On Tue, Aug 16, 2016 at 9:04 AM, Kosala <kosalayb at gmail.com> wrote:
>
> Hi Matt,
>
> TBH, The document in https://github.com/Metaswitch/
> crest/blob/dev/docs/Bulk-Provisioning%20Numbers.md is not clear to me.
>
> Step 1. Homestead node in deployment. I do not know where is that node in
> all in one image. It will be helpful the location of that folder from the
> root.
>
> Step 2. A simple example will be helpful.
>
> Thanks
>
> Kosala
>
>
>
>
>
> On Tue, Aug 16, 2016 at 8:50 AM, Kosala <kosalayb at gmail.com> wrote:
>
> Hi Matt,
>
> I downloaded the all in one package from http://clearwater.readthedocs.
> io/en/stable/All_in_one_OVF_Installation.html
>
> and imported using oracle virtual box on ubuntu 14.04,
>
> Crest version
>
> [cw-aio]ubuntu at cwaio:~$ sudo dpkg-query -s crest
> Package: crest
> Status: install ok installed
> Priority: optional
> Section: network
> Installed-Size: 40098
> Maintainer: Project Clearwater Maintainers <maintainers@
> projectclearwater.org>
> Architecture: amd64
> Version: 1.0-160815.145007
>
> Thanks
>
> Kosala
>
>
>
>
>
> On Mon, Aug 15, 2016 at 5:56 PM, Matt Williams (projectclearwater.org) <
> matt at projectclearwater.org> wrote:
>
> Kosala,
>
>
>
> That's odd - I don't see that failure on my all-in-one image (spun up just
> now from the latest image) - which version of all-in-one-image are you
> running, and which version of crest does it include ("sudo dpkg-query -s
> crest")?
>
>
>
> You may be able to work-around this either by taking the latest all-in-one
> image or by following the simpler bulk-provisioning process at
> https://github.com/Metaswitch/crest/blob/dev/docs/Bulk-
> Provisioning%20Numbers.md (when this doc talks about using the
> sstables_provisioning process for very large sets of numbers, we mean 1M+
> numbers - the 9000 you're provisioning are well within the capabilities of
> this process).
>
>
>
> I hope that helps - please let me know how you get on.
>
>
>
> Cheers,
>
>
>
> Matt
>
>
>
>
>
> *From:* Clearwater [mailto:clearwater-bounces at lists.projectclearwater.org]
> *On Behalf Of *Kosala
> *Sent:* 15 August 2016 16:58
> *To:* clearwater at lists.projectclearwater.org
> *Subject:* Re: [Project Clearwater] Clearwater Digest, Vol 40, Issue 24
>
>
>
> HI Matt,
>
> Thanks.
>
>
> I am trying to follow https://github.com/Metaswitch/
> crest/blob/dev/src/metaswitch/crest/tools/sstable_provisioning/README.md
> for bulk provisioning.
>
>
> When I am trying to execute sudo ./BulkProvision homer 21000 29999
> example.com 7kkzTyGW in all-in-one image,
> I am getting an error  java.lang.UnsupportedClassVersionError:
> ClearwaterBulkProvisioner : Unsupported major.minor version 52.0
>
> Java version info in all-in-one image:
> [cw-aio]ubuntu at cwaio:/usr/share/clearwater/crest/tools/sstable_provisioning$
> java -version
> java version "1.7.0_101"
> OpenJDK Runtime Environment (IcedTea 2.6.6) (7u101-2.6.6-0ubuntu0.14.04.1)
> OpenJDK 64-Bit Server VM (build 24.95-b01, mixed mode)
>
> Thanks
>
> Kosala
>
>
>
>
>
>
> On Mon, Aug 15, 2016 at 2:17 PM, <clearwater-request at lists.
> projectclearwater.org> wrote:
>
> Send Clearwater mailing list submissions to
>         clearwater at lists.projectclearwater.org
>
> To subscribe or unsubscribe via the World Wide Web, visit
>         http://lists.projectclearwater.org/mailman/
> listinfo/clearwater_lists.projectclearwater.org
>
> or, via email, send a message with subject or body 'help' to
>         clearwater-request at lists.projectclearwater.org
>
> You can reach the person managing the list at
>         clearwater-owner at lists.projectclearwater.org
>
> When replying, please edit your Subject line so it is more specific
> than "Re: Contents of Clearwater digest..."
>
>
> Today's Topics:
>
>    1. Stress Testing (Kosala)
>    2. Re: Stress Testing (Matt Williams (projectclearwater.org))
>    3. Re: Stress Testing (Matt Williams (projectclearwater.org))
>
>
> ----------------------------------------------------------------------
>
> Message: 1
> Date: Mon, 15 Aug 2016 10:38:57 +0100
> From: Kosala <kosalayb at gmail.com>
> To: clearwater at lists.projectclearwater.org
> Subject: [Project Clearwater] Stress Testing
> Message-ID:
>         <CAGEe17an2B_bGj8NfKFwms+nU=vJURyhT5CE+mcY1pjcm4YF+A at mail.
> gmail.com>
> Content-Type: text/plain; charset="utf-8"
>
> Hi Team,
>
> I installed clearwater "all-in-one" image on Oracle Virtual Box.
> 1. Can I do stress testing ?
> 2. How to do that?
>
> I am trying to follow Stress Testing on
> http://clearwater.readthedocs.io/en/stable/Clearwater_stress_testing.html#
> configuring-udp-stress
> .
>
> Using chef - > It seems chef/knife install only supports in the Cloud
> approach (The automated install is only supported for deployments running
> in Amazon?s EC2 cloud).
>
> Manual approach, It looks not supporting all in one image.
>
> Many Thanks
> Kosala
> -------------- next part --------------
> An HTML attachment was scrubbed...
> URL: <http://lists.projectclearwater.org/pipermail/clearwater_lists.
> projectclearwater.org/attachments/20160815/15fc3b07/attachment-0001.html>
>
> ------------------------------
>
> Message: 2
> Date: Mon, 15 Aug 2016 09:54:02 +0000
> From: "Matt Williams (projectclearwater.org)"
>         <matt at projectclearwater.org>
> To: Kosala <kosalayb at gmail.com>
> Cc: "clearwater at lists.projectclearwater.org"
>         <clearwater at lists.projectclearwater.org>
> Subject: Re: [Project Clearwater] Stress Testing
> Message-ID:
>         <CY1PR0201MB15636F1F20EB91BB180F053390120 at CY1PR0201MB1563.
> namprd02.prod.outlook.com>
>
> Content-Type: text/plain; charset="utf-8"
>
> Kosala,
>
> While it's theoretically possible to do stress testing against an
> all-in-one image, I'd recommend against it - the all-in-one image has been
> squeezed down a lot to fit on a single VM and we'd expect very low
> performance out of it, and I could believe that overload behavior might be
> suboptimal.  If you're looking to stress test for performance reasons, I'd
> strongly recommend running a full deployment as this will give you much
> more reliable numbers.  If you're looking to stress test for other reasons,
> please can you share a bit more about what you're trying to achieve, and we
> can have a think about what would work best?
>
> If you do really want to run stress testing against an all-in-one image,
> it should probably work, even though http://clearwater.readthedocs.
> io/en/latest/Clearwater_stress_testing.html#manual-i-
> e-non-chef-stress-runs only talks about Chef and manual installs.  You'd
> need to set the "bono_servers" option in /etc/clearwater/shared_config to
> point to your all-in-one node, and I suspect you'd need to reduce the
> "count" option to something a lot lower - I'd start around 5000 and see how
> that goes.
>
> I hope that helps.  Please let me know how you get on.
>
> Thanks,
>
> Matt
>
> From: Clearwater [mailto:clearwater-bounces at lists.projectclearwater.org]
> On Behalf Of Kosala
> Sent: 15 August 2016 10:39
> To: clearwater at lists.projectclearwater.org
> Subject: [Project Clearwater] Stress Testing
>
> Hi Team,
> I installed clearwater "all-in-one" image on Oracle Virtual Box.
> 1. Can I do stress testing ?
> 2. How to do that?
> I am trying to follow Stress Testing on http://clearwater.readthedocs.
> io/en/stable/Clearwater_stress_testing.html#configuring-udp-stress.
> Using chef - > It seems chef/knife install only supports in the Cloud
> approach (The automated install is only supported for deployments running
> in Amazon?s EC2 cloud).
> Manual approach, It looks not supporting all in one image.
> Many Thanks
> Kosala
>
> -------------- next part --------------
> An HTML attachment was scrubbed...
> URL: <http://lists.projectclearwater.org/pipermail/clearwater_lists.
> projectclearwater.org/attachments/20160815/29d6328d/attachment-0001.html>
>
> ------------------------------
>
> Message: 3
> Date: Mon, 15 Aug 2016 13:16:47 +0000
> From: "Matt Williams (projectclearwater.org)"
>         <matt at projectclearwater.org>
> To: "clearwater at lists.projectclearwater.org"
>         <clearwater at lists.projectclearwater.org>
> Subject: Re: [Project Clearwater] Stress Testing
> Message-ID:
>         <CY1PR0201MB156372246DC5A77B11839F9D90120 at CY1PR0201MB1563.
> namprd02.prod.outlook.com>
>
> Content-Type: text/plain; charset="utf-8"
>
> Kosala,
>
> You'll need to follow all the steps in http://clearwater.readthedocs.
> io/en/latest/Clearwater_stress_testing.html#manual-i-
> e-non-chef-stress-runs, i.e. bulk provisioning subscribers and installing
> clearwater-sip-stress, but that should be it.
>
> Just to be clear, though, you'll need to set the configuration and install
> the clearwater-sip-stress package on a separate VM, not on the all-in-one
> image itself - the all-in-one image almost certainly opens up ports that
> conflict with those that clearwater-sip-stress tries to use.
>
> This isn't a very well-trodden path, though, so you may hit further issues
> - let me know if so, and we can try to work through them.
>
> Cheers,
>
> Matt
>
> From: Kosala [mailto:kosalayb at gmail.com]
> Sent: 15 August 2016 13:41
> To: Matt Williams (projectclearwater.org) <matt at projectclearwater.org>
> Subject: Re: [Project Clearwater] Stress Testing
>
> Hi Matt,
> Thanks. I set the bono_servers option. Should I add count =5000 to
> /etc/clearwater/shared_config ?
>
> Do I need other changes to run stress tests on all-in-one image?
> Thanks
> Kosala
>
>
>
> On Mon, Aug 15, 2016 at 10:54 AM, Matt Williams (projectclearwater.org<
> http://projectclearwater.org>) <matt at projectclearwater.org<mailto:
> matt at projectclearwater.org>> wrote:
> Kosala,
>
> While it's theoretically possible to do stress testing against an
> all-in-one image, I'd recommend against it - the all-in-one image has been
> squeezed down a lot to fit on a single VM and we'd expect very low
> performance out of it, and I could believe that overload behavior might be
> suboptimal.  If you're looking to stress test for performance reasons, I'd
> strongly recommend running a full deployment as this will give you much
> more reliable numbers.  If you're looking to stress test for other reasons,
> please can you share a bit more about what you're trying to achieve, and we
> can have a think about what would work best?
>
> If you do really want to run stress testing against an all-in-one image,
> it should probably work, even though http://clearwater.readthedocs.
> io/en/latest/Clearwater_stress_testing.html#manual-i-
> e-non-chef-stress-runs only talks about Chef and manual installs.  You'd
> need to set the "bono_servers" option in /etc/clearwater/shared_config to
> point to your all-in-one node, and I suspect you'd need to reduce the
> "count" option to something a lot lower - I'd start around 5000 and see how
> that goes.
>
> I hope that helps.  Please let me know how you get on.
>
> Thanks,
>
> Matt
>
> From: Clearwater [mailto:clearwater-bounces at lists.projectclearwater.org<
> mailto:clearwater-bounces at lists.projectclearwater.org>] On Behalf Of
> Kosala
> Sent: 15 August 2016 10:39
> To: clearwater at lists.projectclearwater.org<mailto:clearwater at lists.
> projectclearwater.org>
> Subject: [Project Clearwater] Stress Testing
>
> Hi Team,
> I installed clearwater "all-in-one" image on Oracle Virtual Box.
> 1. Can I do stress testing ?
> 2. How to do that?
> I am trying to follow Stress Testing on http://clearwater.readthedocs.
> io/en/stable/Clearwater_stress_testing.html#configuring-udp-stress.
> Using chef - > It seems chef/knife install only supports in the Cloud
> approach (The automated install is only supported for deployments running
> in Amazon?s EC2 cloud).
> Manual approach, It looks not supporting all in one image.
> Many Thanks
> Kosala
>
>
> -------------- next part --------------
> An HTML attachment was scrubbed...
> URL: <http://lists.projectclearwater.org/pipermail/clearwater_lists.
> projectclearwater.org/attachments/20160815/11781755/attachment.html>
>
> ------------------------------
>
> Subject: Digest Footer
>
> _______________________________________________
> Clearwater mailing list
> Clearwater at lists.projectclearwater.org
> http://lists.projectclearwater.org/mailman/listinfo/clearwater_lists.
> projectclearwater.org
>
>
> ------------------------------
>
> End of Clearwater Digest, Vol 40, Issue 24
> ******************************************
>
>
>
>
>
>
>
>
>
>
>
>
>
>
>
>
>
>
>
>
>
>
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.projectclearwater.org/pipermail/clearwater_lists.projectclearwater.org/attachments/20160818/6ee25ea6/attachment.html>

From kosalayb at gmail.com  Thu Aug 18 11:43:03 2016
From: kosalayb at gmail.com (Kosala)
Date: Thu, 18 Aug 2016 16:43:03 +0100
Subject: [Project Clearwater] Clearwater Digest, Vol 40, Issue 24
In-Reply-To: <CY1PR0201MB15630493B218F47026930AF490150@CY1PR0201MB1563.namprd02.prod.outlook.com>
References: <mailman.20.1471267072.11502.clearwater_lists.projectclearwater.org@lists.projectclearwater.org>
	<CAGEe17ZLnypQfbzxEwxj9EaB20MUBVpY+YdN-Obv=gHpZmG0KA@mail.gmail.com>
	<CY1PR0201MB1563F9A706F3EC7BE7F9C11590120@CY1PR0201MB1563.namprd02.prod.outlook.com>
	<CAGEe17bfTu1Kpwx=ipqtEbShvWtP+C6pJEEGHi0GSwBR5Dqw8w@mail.gmail.com>
	<CAGEe17aY077tLtotRe1X8k1qU_4otBdHDMJjqDH_g02Zs676Jg@mail.gmail.com>
	<CAGEe17ZeNPPy7AmMz=LCWnHqLm=v9Q7CuLT+AOVKWJTdg8m7Eg@mail.gmail.com>
	<CY1PR0201MB1563CE17983225B985B19D7390130@CY1PR0201MB1563.namprd02.prod.outlook.com>
	<CAGEe17b2M2uqvbOuqH7t4xM41FbfBYk0xR3zWqiFh+EkSfUzUQ@mail.gmail.com>
	<CY1PR0201MB1563CD5DDDD6E7B5A0B2DB7290140@CY1PR0201MB1563.namprd02.prod.outlook.com>
	<CAGEe17YGnaY1Kqc65gyiVO1sBBuTx=-YzfD9HY3M6QBD2t9AkA@mail.gmail.com>
	<CY1PR0201MB156349F26A0A7670BE7382A890140@CY1PR0201MB1563.namprd02.prod.outlook.com>
	<CAGEe17ZkY2ESNzwQYddrv6=jUJ5fPHu3gJXT7R1UjQmBd+eFUg@mail.gmail.com>
	<CY1PR0201MB1563C979B2D641DA59F1945A90150@CY1PR0201MB1563.namprd02.prod.outlook.com>
	<CAGEe17bC+xmhP3D7w768r0svzBAxdBedVXhis1Z33Yqdq4THgA@mail.gmail.com>
	<CY1PR0201MB1563F865DFBF86128118AC5290150@CY1PR0201MB1563.namprd02.prod.outlook.com>
	<CAGEe17Z2wBvTgPrnK_TdQPerVE9Moxnt=u9CWPpq8V04GJtfUw@mail.gmail.com>
	<CY1PR0201MB1563A30C3B9C4D8EE65FAD4390150@CY1PR0201MB1563.namprd02.prod.outlook.com>
	<CAGEe17ZVrag9yFkLgPF-kfgDPDT_nJETkei_Uwv47mohbAwyxg@mail.gmail.com>
	<CY1PR0201MB156325107DAA32BF9480667B90150@CY1PR0201MB1563.namprd02.prod.outlook.com>
	<CAGEe17bWEkdYazAcTOTq2+7kxwR=yYx04MT-QzjsHQ5HWPAD5Q@mail.gmail.com>
	<CY1PR0201MB15630493B218F47026930AF490150@CY1PR0201MB1563.namprd02.prod.outlook.com>
Message-ID: <CAGEe17bpA32DECgJWrwvAHE1EO2XkfeweJR3JEQgw7TrmzAzdA@mail.gmail.com>

HI Matt,

I could get it working for 5 numbers. I will increase and see how far i can
increase numbers. Then I like to see how to find statistics such as memory
usage, cpu time per call etc.

Kosala

On Thu, Aug 18, 2016 at 3:53 PM, Matt Williams (projectclearwater.org) <
matt at projectclearwater.org> wrote:

> Kosala,
>
>
>
> This is what the "count" option on the stress node controls (see
> http://clearwater.readthedocs.io/en/latest/Clearwater_
> stress_testing.html#manual-i-e-non-chef-stress-runs for details).  If you
> only want to make calls to/from the first 100 numbers, set this to 100.
>
>
>
> Are these calls going through successfully, then?
>
>
>
> Matt
>
>
>
> *From:* Kosala [mailto:kosalayb at gmail.com]
> *Sent:* 18 August 2016 15:20
> *To:* Matt Williams (projectclearwater.org) <matt at projectclearwater.org>
> *Cc:* clearwater at lists.projectclearwater.org
> *Subject:* Re: [Project Clearwater] Clearwater Digest, Vol 40, Issue 24
>
>
>
> Hi Matt,
>
> Thanks. SIP node is calling numbers in a larger range starting from 2010000000.
> Can I restrict SIP call invoke from
>
> 2010000000 to 2010000099?
>
> I can do bulk provision 100 numbers. I do not know how to restrict SIP
> node to call only these 100 numbers?
>
> Thanks
>
> Kosala
>
>
>
>
>
> On Thu, Aug 18, 2016 at 2:59 PM, Matt Williams (projectclearwater.org) <
> matt at projectclearwater.org> wrote:
>
> Kosala,
>
>
>
> The error you're seeing suggests that the request is timing out between
> Bono and Sprout.  This could be due to poor performance on the all-in-one
> node (as I said previously, the all-in-one node is not intended for running
> stress), or it could be due to a more general misconfiguration.  Are all
> REGISTERs failing, or just some?
>
>
>
> Regarding getting CPU statistics etc., we normally use Cacti.  There are
> instructions for setting this up at http://clearwater.readthedocs.
> io/en/latest/Cacti.html.  However, I doubt this will work as-is with your
> all-in-one node.  Since you only have one node, maybe you're best just
> looking at top?
>
>
>
> Matt
>
>
>
> *From:* Kosala [mailto:kosalayb at gmail.com]
> *Sent:* 18 August 2016 14:13
>
>
> *To:* Matt Williams (projectclearwater.org) <matt at projectclearwater.org>
> *Cc:* clearwater at lists.projectclearwater.org
> *Subject:* Re: [Project Clearwater] Clearwater Digest, Vol 40, Issue 24
>
>
>
> Hi Matt,
>
> Now for the numbers I have in Cassandra, at SP node, I am getting "SIP/2.0
> 504 Server Timeout"
>
> 2016-08-18      11:49:03:189    1471520943.189039: Aborting call on
> unexpected message for Call-Id '1073-27637 at 10.0.22.193': while expecting
> '401' (index 3), received 'SIP/2.0 504 Server Timeout^M
> Via: SIP/2.0/TCP 10.0.22.193:5060;rport=32939;received=10.0.22.193;branch=
> z9hG4bK-27637-1073-2-2010000854-^M
> Record-Route: <sip:scscf.cwaio:5054;transport=TCP;lr;service=
> scscf;billing-role=charge-orig>^M
> Call-ID: 2010000854///1073-27637 at 10.0.22.193^M
> From: <sip:2010000854 at example.com>;tag=27637SIPpTag001073^M
> To: <sip:2010000854 at example.com>;tag=z9hG4bKPjuN16eRA0bDott9z6ZA-
> fwIYe3VA-KMkQ^M
> CSeq: 1 REGISTER^M
> Content-Length:  0^M
> ^M
> '.
> 2016-08-18      11:49:04:185    1471520944.185945: Aborting call on
> unexpected message for Call-Id '1154-27637 at 10.0.22.193': while expecting
> '401' (index 3), received 'SIP/2.0 504 Server Timeout^M
> Via: SIP/2.0/TCP 10.0.22.193:5060;rport=32940;received=10.0.22.193;branch=
> z9hG4bK-27637-1154-2-2010000692-^M
> Record-Route: <sip:scscf.cwaio:5054;transport=TCP;lr;service=
> scscf;billing-role=charge-orig>^M
> Call-ID: 2010000692///1154-27637 at 10.0.22.193^M
> From: <sip:2010000692 at example.com>;tag=27637SIPpTag001154^M
> To: <sip:2010000692 at example.com>;tag=z9hG4bKPjk-
> 5lYhadbnX7rqNirT8tjwQdDjLAQo0j^M
> CSeq: 1 REGISTER^M
> Content-Length:  0^M
>
> How do I know, stress tests are running properly? Can I see statistics
> such as memory usage, cpu time,  etc ?
>
> Thanks
>
> Kosala
>
>
>
>
>
> On Thu, Aug 18, 2016 at 12:38 PM, Matt Williams (projectclearwater.org) <
> matt at projectclearwater.org> wrote:
>
> Kosala,
>
>
>
> Thanks!  I'm very confused about your software version, though, as the
> latest all-in-one image has
>
> ?         crest 1.0-160811.103635 (i.e. older than yours)
>
> ?         homestead 1.0-160814.205535 (i.e. slightly newer than yours)
>
> ?         sprout 1.0-160814.205701 (i.e. much newer than yours)
>
> ?         the logging.bash script fix already applied.
>
> It looks as though your might have taken the previous all-in-one image,
> and then upgraded some of the packages.  Please can you confirm: have you
> upgraded any packages?
>
>
>
> On the issue you're seeing, I think you're saying that
>
> ?         you're running clearwater-sip-stress (which defaults to using
> numbers in the range above 2010000000)
>
> ?         you've deleted all these numbers from Homestead's Cassandra
>
> ?         you see errors in clearwater-sip-stress's log file saying that
> registration are failing with "404 Not Found".
>
> I think this is expected - you need to provision numbers in Homestead's
> Cassandra that match the numbers that clearwater-sip-stress is expecting to
> register as.  Please let me know if I've misunderstood.
>
>
>
> Thanks,
>
>
>
> Matt
>
>
>
> *From:* Kosala [mailto:kosalayb at gmail.com]
> *Sent:* 18 August 2016 11:46
>
>
> *To:* Matt Williams (projectclearwater.org) <matt at projectclearwater.org>
> *Subject:* Re: [Project Clearwater] Clearwater Digest, Vol 40, Issue 24
>
>
>
>
>
> Hi Matt,
>
> I am running the latest version all-in-one which i downloaded from
> http://vm-images.cw-ngv.com/cw-aio.ova.
>
> [cw-aio]ubuntu at cwaio:~$ sudo dpkg-query -s crest
> [sudo] password for ubuntu:
> Package: crest
> Status: install ok installed
> Priority: optional
> Section: network
> Installed-Size: 40102
> Maintainer: Project Clearwater Maintainers <maintainers@
> projectclearwater.org>
> Architecture: amd64
> Version: 1.0-160818.091648
>
> homestead
> Version: 1.0-160812.164051
>
> sprout
> Version: 1.0-160726.101022
>
> And one strange thing is:
>
> I deleted all the records in tables from homestead_cache and
> homestead_provisioning. Then when I check the SIP node for logs,
> sip-stress_14320_errors.log still has records with sip: ids which are not
> in Cassandra. For example, sip:2010021460 at example.com
>
> 2016-08-18      10:26:08:288    1471515968.288189: Aborting call on
> unexpected message for Call-Id '4270-14320 at 10.0.22.193': while expecting
> '401' (index 3), received 'SIP/2.0 404 Not Found^M
> Via: SIP/2.0/TCP 10.0.22.193:5060;rport=35233;received=10.0.22.193;branch=
> z9hG4bK-14320-4270-2-2010021460-^M
> Record-Route: <sip:scscf.cwaio:5054;transport=TCP;lr;service=
> scscf;billing-role=charge-orig>^M
> Call-ID: 2010021460///4270-14320 at 10.0.22.193^M
> From: <sip:2010021460 at example.com>;tag=14320SIPpTag004270^M
> To: <sip:2010021460 at example.com>;tag=z9hG4bKPjVe2he9j28lou.
> 0Dl9NmKGS7ypUMLjMJv^M
> CSeq: 1 REGISTER^M
> Content-Length:  0^M
>
> Thanks
>
> Kosala
>
>
>
> On Thu, Aug 18, 2016 at 10:47 AM, Matt Williams (projectclearwater.org) <
> matt at projectclearwater.org> wrote:
>
> Kosala,
>
>
>
> The fix is not to *copy* this to /usr/share/clearwater/utils, but to
> *move* it.  However, since the error is benign, I'd suggest just ignoring
> it while we get this working.
>
>
>
> As I asked below, please can you confirm what version you're running?  I'm
> concerned that it's going to be very hard to troubleshoot problems if you
> have an all-in-one image from a few weeks ago, with some packages updated
> to more recent versions and then some further fixes manually applied.
>
>
>
> Thanks,
>
>
>
> Matt
>
>
>
>
>
> *From:* Kosala [mailto:kosalayb at gmail.com]
> *Sent:* 18 August 2016 10:34
>
>
> *To:* Matt Williams (projectclearwater.org) <matt at projectclearwater.org>
> *Cc:* clearwater at lists.projectclearwater.org
> *Subject:* Re: [Project Clearwater] Clearwater Digest, Vol 40, Issue 24
>
>
>
> Hi Matt,
>
> Yeah, Manual calls are working fine.
>
> As it is said in the big fix, https://github.com/Metaswitch/
> clearwater-infrastructure/issues/355 , I copied logging.bash to
> /usr/share/clearwater/utils
>
> but I am still getting
>
> /etc/init.d/clearwater-infrastructure: 76: /etc/init.d/clearwater-infrastructure:
> /usr/share/clearwater/infrastructure/scripts/logging.bash: Permission
> denied
> Configuring monit for only localhost access
>
> Kosala
>
>
>
>
>
> On Thu, Aug 18, 2016 at 10:01 AM, Matt Williams (projectclearwater.org) <
> matt at projectclearwater.org> wrote:
>
> Kosala,
>
>
>
> Yes, it's https://github.com/Metaswitch/clearwater-infrastructure/
> issues/355 and it should be benign.
>
>
>
> However, this was fixed about 2 weeks ago.  Please can you confirm when
> you downloaded the all-in-one image, and whether you've upgraded it all?
> (As I observed earlier, your crest release was from only a few days ago.)
>
>
>
> Have you got manual calls working?
>
>
>
> Thanks,
>
>
>
> Matt
>
>
>
>
>
> *From:* Kosala [mailto:kosalayb at gmail.com]
> *Sent:* 18 August 2016 09:56
> *To:* Matt Williams (projectclearwater.org) <matt at projectclearwater.org>
> *Cc:* clearwater at lists.projectclearwater.org
>
>
> *Subject:* Re: [Project Clearwater] Clearwater Digest, Vol 40, Issue 24
>
>
>
> Hi Matt,
>
> In SIP node, when I am trying to execute "sudo service
> clearwater-sip-stress restart", I am getting an error
>
>
> /etc/init.d/clearwater-infrastructure: 76: /etc/init.d/clearwater-infrastructure:
> /usr/share/clearwater/infrastructure/scripts/logging.bash: Permission
> denied
> Configuring monit for only localhost access
>
> Any clue about this error?
>
> Thanks
>
> Kosala
>
>
>
>
>
> On Wed, Aug 17, 2016 at 2:29 PM, Matt Williams (projectclearwater.org) <
> matt at projectclearwater.org> wrote:
>
> Kosala,
>
>
>
> Yes, that's the correct screen, and you're correct that it shows that
> stress is being attempted but failing.
>
>
>
> Do regular (non-stress) calls work through this deployment?
>
>
>
> You can look at what message the stress node is receiving in the log files
> in the /var/log/clearwater-sip-stress/ directory - I think there are
> "errors" logs that contain the unexpected messages.
>
>
>
> You can obviously also look at what's happening on the all-in-one node
> itself, using the /var/log/bono/*, /var/log/sprout/* and
> /var/log/homestead/* files, as described at http://clearwater.readthedocs.
> io/en/latest/Troubleshooting_and_Recovery.html.
>
>
>
> I hope that helps.
>
>
>
> Cheers,
>
>
>
> Matt
>
>
>
> *From:* Kosala [mailto:kosalayb at gmail.com]
> *Sent:* 17 August 2016 14:20
>
>
> *To:* Matt Williams (projectclearwater.org) <matt at projectclearwater.org>
> *Subject:* Re: [Project Clearwater] Clearwater Digest, Vol 40, Issue 24
>
>
>
> Hi Matt,
>
> I can see this scenario screen from sip-stress.1.out. I hope this will be
> the stress test output results.
>
>
> ------------------------------ Scenario Screen -------- [1-9]: Change
> Screen --
>      Users (length)   Port   Total-time  Total-calls  Remote-host
>         2500 (0 ms)   5060      77.15 s         2500  10.0.21.192:5060
> (TCP)
>
>   Call limit reached (-m 2500), 1.002 s period  1 ms scheduler resolution
>   2175 calls (limit 2500)                Peak was 2499 calls, after 0 s
>   0 Running, 2177 Paused, 8 Woken up
>   0 dead call msg (discarded)            0 out-of-call msg
> (discarded)
>   3 open sockets
>
>                                  Messages  Retrans   Timeout
> Unexpected-Msg
>        Pause [0ms/10:00]         2500                          0
>     REGISTER ---------->         326       0
>          401 <----------         0         0         0         325
>     REGISTER ---------->         0         0
>          200 <----------         0         0         0         0
>     REGISTER ---------->         0         0
>          401 <----------         0         0         0         0
>     REGISTER ---------->         0         0
>          200 <----------         0         0         0         0
>        Pause [     4:50]         0                             0
>     REGISTER ---------->  B-RTD1 0         0
>          200 <----------  E-RTD1 0         0         0         0
>     REGISTER ---------->  B-RTD1 0         0
>          200 <----------  E-RTD1 0         0         0         0
>        Pause [     4:50]         0                             0
>        Pause [$pre_call_delay]   0                             0
>       INVITE ---------->  B-RTD2 0         0
>          100 <----------         0         0         0         0
>       INVITE <----------         0         0         0         0
>          100 <----------         0         0         0         0
>       INVITE <----------         0         0         0         0
>          100 ---------->         0         0
>          180 ---------->         0         0
>          180 <----------         0         0         0         0
>        Pause [   6000ms]         0                             0
>          200 ---------->         0         0
>          200 <----------         0         0         0         0
>          ACK ---------->         0         0
>          ACK <----------         0         0         0         0
>       UPDATE ---------->         0         0
>       UPDATE <----------         0         0         0         0
>          200 ---------->         0         0
>          200 <----------  E-RTD2 0         0         0         0
>        Pause [    24.0s]         0                             0
>          BYE ---------->  B-RTD3 0         0
>          BYE <----------         0         0         0         0
>          200 ---------->         0         0
>          200 <----------  E-RTD3 0         0         0         0
>        Pause [$post_call_delay]  0                             0
> ------- Waiting for active calls to end. Press [q] again to force exit.
> -------
> Last Error: Aborting call on unexpected message for Call-Id '1079-13729@
> ...
>
> However there is an unexpected message error at the end.
>
> Thanks
>
> Kosala
>
>
>
>
>
> On Wed, Aug 17, 2016 at 12:40 PM, Matt Williams (projectclearwater.org) <
> matt at projectclearwater.org> wrote:
>
> Kosala,
>
>
>
> They should log to /var/log/clearwater-sip-stress - in particular, the
> *.1.out file is a log of the output from sipp.  Do you see anything there?
>
>
>
> Matt
>
>
>
> *From:* Kosala [mailto:kosalayb at gmail.com]
> *Sent:* 17 August 2016 12:33
> *To:* Matt Williams (projectclearwater.org) <matt at projectclearwater.org>;
> clearwater at lists.projectclearwater.org
>
>
> *Subject:* Re: [Project Clearwater] Clearwater Digest, Vol 40, Issue 24
>
>
>
> Hi Matt,
>
> I followed above steps and run sudo apt-get install clearwater-sip-stress.
>
> How do I know stress tests are running? Is is said, stress tests start
> automatically but I cannot see it.
>
> Thanks
>
> Kosala
>
>
>
>
>
>
> On Tue, Aug 16, 2016 at 2:01 PM, Matt Williams (projectclearwater.org) <
> matt at projectclearwater.org> wrote:
>
> Kosala,
>
>
>
> I'm glad you've made progress on this.
>
>
>
> I had a look at the crest package version, but it seems to be later than
> the most recent all-in-one image uses (1.0-160811.103635).  When did you
> download the all-in-one image, and did you apply any patches to it?
>
>
>
> Regarding making calls for stress testing, this is where
> http://clearwater.readthedocs.io/en/latest/Clearwater_
> stress_testing.html#manual-i-e-non-chef-stress-runs comes in - you need to
>
> ?         create a separate VM
>
> ?         set the bono_hostname and count parameters in
> /etc/clearwater/shared_config
>
> ?         install the clearwater-sip-stress package.
>
> I hope that helps.
>
>
>
> BTW, please remember to copy in clearwater at lists.projectclearwater.org -
> that means that other people can see and comment on your posts.
>
>
>
> Thanks,
>
>
>
> Matt
>
>
>
>
>
> *From:* Kosala [mailto:kosalayb at gmail.com]
> *Sent:* 16 August 2016 10:48
> *To:* Matt Williams (projectclearwater.org) <matt at projectclearwater.org>
>
> *Subject:* Re: [Project Clearwater] Clearwater Digest, Vol 40, Issue 24
>
>
>
> Hi Matt,
>
> Bulk provisioning for all in one image is done using
> https://github.com/Metaswitch/crest/blob/dev/docs/Bulk-
> Provisioning%20Numbers.md.
>
> I have records in tables in homestead_cache and homer.
>
> Now How to make calls for stress testing?
>
> Is there any guideline?
>
> Many Thanks,
>
> Kosala
>
>
>
>
>
>
>
>
>
> On Tue, Aug 16, 2016 at 9:04 AM, Kosala <kosalayb at gmail.com> wrote:
>
> Hi Matt,
>
> TBH, The document in https://github.com/Metaswitch/
> crest/blob/dev/docs/Bulk-Provisioning%20Numbers.md is not clear to me.
>
> Step 1. Homestead node in deployment. I do not know where is that node in
> all in one image. It will be helpful the location of that folder from the
> root.
>
> Step 2. A simple example will be helpful.
>
> Thanks
>
> Kosala
>
>
>
>
>
> On Tue, Aug 16, 2016 at 8:50 AM, Kosala <kosalayb at gmail.com> wrote:
>
> Hi Matt,
>
> I downloaded the all in one package from http://clearwater.readthedocs.
> io/en/stable/All_in_one_OVF_Installation.html
>
> and imported using oracle virtual box on ubuntu 14.04,
>
> Crest version
>
> [cw-aio]ubuntu at cwaio:~$ sudo dpkg-query -s crest
> Package: crest
> Status: install ok installed
> Priority: optional
> Section: network
> Installed-Size: 40098
> Maintainer: Project Clearwater Maintainers <maintainers@
> projectclearwater.org>
> Architecture: amd64
> Version: 1.0-160815.145007
>
> Thanks
>
> Kosala
>
>
>
>
>
> On Mon, Aug 15, 2016 at 5:56 PM, Matt Williams (projectclearwater.org) <
> matt at projectclearwater.org> wrote:
>
> Kosala,
>
>
>
> That's odd - I don't see that failure on my all-in-one image (spun up just
> now from the latest image) - which version of all-in-one-image are you
> running, and which version of crest does it include ("sudo dpkg-query -s
> crest")?
>
>
>
> You may be able to work-around this either by taking the latest all-in-one
> image or by following the simpler bulk-provisioning process at
> https://github.com/Metaswitch/crest/blob/dev/docs/Bulk-
> Provisioning%20Numbers.md (when this doc talks about using the
> sstables_provisioning process for very large sets of numbers, we mean 1M+
> numbers - the 9000 you're provisioning are well within the capabilities of
> this process).
>
>
>
> I hope that helps - please let me know how you get on.
>
>
>
> Cheers,
>
>
>
> Matt
>
>
>
>
>
> *From:* Clearwater [mailto:clearwater-bounces at lists.projectclearwater.org]
> *On Behalf Of *Kosala
> *Sent:* 15 August 2016 16:58
> *To:* clearwater at lists.projectclearwater.org
> *Subject:* Re: [Project Clearwater] Clearwater Digest, Vol 40, Issue 24
>
>
>
> HI Matt,
>
> Thanks.
>
>
> I am trying to follow https://github.com/Metaswitch/
> crest/blob/dev/src/metaswitch/crest/tools/sstable_provisioning/README.md
> for bulk provisioning.
>
>
> When I am trying to execute sudo ./BulkProvision homer 21000 29999
> example.com 7kkzTyGW in all-in-one image,
> I am getting an error  java.lang.UnsupportedClassVersionError:
> ClearwaterBulkProvisioner : Unsupported major.minor version 52.0
>
> Java version info in all-in-one image:
> [cw-aio]ubuntu at cwaio:/usr/share/clearwater/crest/tools/sstable_provisioning$
> java -version
> java version "1.7.0_101"
> OpenJDK Runtime Environment (IcedTea 2.6.6) (7u101-2.6.6-0ubuntu0.14.04.1)
> OpenJDK 64-Bit Server VM (build 24.95-b01, mixed mode)
>
> Thanks
>
> Kosala
>
>
>
>
>
>
> On Mon, Aug 15, 2016 at 2:17 PM, <clearwater-request at lists.
> projectclearwater.org> wrote:
>
> Send Clearwater mailing list submissions to
>         clearwater at lists.projectclearwater.org
>
> To subscribe or unsubscribe via the World Wide Web, visit
>         http://lists.projectclearwater.org/mailman/
> listinfo/clearwater_lists.projectclearwater.org
>
> or, via email, send a message with subject or body 'help' to
>         clearwater-request at lists.projectclearwater.org
>
> You can reach the person managing the list at
>         clearwater-owner at lists.projectclearwater.org
>
> When replying, please edit your Subject line so it is more specific
> than "Re: Contents of Clearwater digest..."
>
>
> Today's Topics:
>
>    1. Stress Testing (Kosala)
>    2. Re: Stress Testing (Matt Williams (projectclearwater.org))
>    3. Re: Stress Testing (Matt Williams (projectclearwater.org))
>
>
> ----------------------------------------------------------------------
>
> Message: 1
> Date: Mon, 15 Aug 2016 10:38:57 +0100
> From: Kosala <kosalayb at gmail.com>
> To: clearwater at lists.projectclearwater.org
> Subject: [Project Clearwater] Stress Testing
> Message-ID:
>         <CAGEe17an2B_bGj8NfKFwms+nU=vJURyhT5CE+mcY1pjcm4YF+A at mail.
> gmail.com>
> Content-Type: text/plain; charset="utf-8"
>
> Hi Team,
>
> I installed clearwater "all-in-one" image on Oracle Virtual Box.
> 1. Can I do stress testing ?
> 2. How to do that?
>
> I am trying to follow Stress Testing on
> http://clearwater.readthedocs.io/en/stable/Clearwater_stress_testing.html#
> configuring-udp-stress
> .
>
> Using chef - > It seems chef/knife install only supports in the Cloud
> approach (The automated install is only supported for deployments running
> in Amazon?s EC2 cloud).
>
> Manual approach, It looks not supporting all in one image.
>
> Many Thanks
> Kosala
> -------------- next part --------------
> An HTML attachment was scrubbed...
> URL: <http://lists.projectclearwater.org/pipermail/clearwater_lists.
> projectclearwater.org/attachments/20160815/15fc3b07/attachment-0001.html>
>
> ------------------------------
>
> Message: 2
> Date: Mon, 15 Aug 2016 09:54:02 +0000
> From: "Matt Williams (projectclearwater.org)"
>         <matt at projectclearwater.org>
> To: Kosala <kosalayb at gmail.com>
> Cc: "clearwater at lists.projectclearwater.org"
>         <clearwater at lists.projectclearwater.org>
> Subject: Re: [Project Clearwater] Stress Testing
> Message-ID:
>         <CY1PR0201MB15636F1F20EB91BB180F053390120 at CY1PR0201MB1563.
> namprd02.prod.outlook.com>
>
> Content-Type: text/plain; charset="utf-8"
>
> Kosala,
>
> While it's theoretically possible to do stress testing against an
> all-in-one image, I'd recommend against it - the all-in-one image has been
> squeezed down a lot to fit on a single VM and we'd expect very low
> performance out of it, and I could believe that overload behavior might be
> suboptimal.  If you're looking to stress test for performance reasons, I'd
> strongly recommend running a full deployment as this will give you much
> more reliable numbers.  If you're looking to stress test for other reasons,
> please can you share a bit more about what you're trying to achieve, and we
> can have a think about what would work best?
>
> If you do really want to run stress testing against an all-in-one image,
> it should probably work, even though http://clearwater.readthedocs.
> io/en/latest/Clearwater_stress_testing.html#manual-i-
> e-non-chef-stress-runs only talks about Chef and manual installs.  You'd
> need to set the "bono_servers" option in /etc/clearwater/shared_config to
> point to your all-in-one node, and I suspect you'd need to reduce the
> "count" option to something a lot lower - I'd start around 5000 and see how
> that goes.
>
> I hope that helps.  Please let me know how you get on.
>
> Thanks,
>
> Matt
>
> From: Clearwater [mailto:clearwater-bounces at lists.projectclearwater.org]
> On Behalf Of Kosala
> Sent: 15 August 2016 10:39
> To: clearwater at lists.projectclearwater.org
> Subject: [Project Clearwater] Stress Testing
>
> Hi Team,
> I installed clearwater "all-in-one" image on Oracle Virtual Box.
> 1. Can I do stress testing ?
> 2. How to do that?
> I am trying to follow Stress Testing on http://clearwater.readthedocs.
> io/en/stable/Clearwater_stress_testing.html#configuring-udp-stress.
> Using chef - > It seems chef/knife install only supports in the Cloud
> approach (The automated install is only supported for deployments running
> in Amazon?s EC2 cloud).
> Manual approach, It looks not supporting all in one image.
> Many Thanks
> Kosala
>
> -------------- next part --------------
> An HTML attachment was scrubbed...
> URL: <http://lists.projectclearwater.org/pipermail/clearwater_lists.
> projectclearwater.org/attachments/20160815/29d6328d/attachment-0001.html>
>
> ------------------------------
>
> Message: 3
> Date: Mon, 15 Aug 2016 13:16:47 +0000
> From: "Matt Williams (projectclearwater.org)"
>         <matt at projectclearwater.org>
> To: "clearwater at lists.projectclearwater.org"
>         <clearwater at lists.projectclearwater.org>
> Subject: Re: [Project Clearwater] Stress Testing
> Message-ID:
>         <CY1PR0201MB156372246DC5A77B11839F9D90120 at CY1PR0201MB1563.
> namprd02.prod.outlook.com>
>
> Content-Type: text/plain; charset="utf-8"
>
> Kosala,
>
> You'll need to follow all the steps in http://clearwater.readthedocs.
> io/en/latest/Clearwater_stress_testing.html#manual-i-
> e-non-chef-stress-runs, i.e. bulk provisioning subscribers and installing
> clearwater-sip-stress, but that should be it.
>
> Just to be clear, though, you'll need to set the configuration and install
> the clearwater-sip-stress package on a separate VM, not on the all-in-one
> image itself - the all-in-one image almost certainly opens up ports that
> conflict with those that clearwater-sip-stress tries to use.
>
> This isn't a very well-trodden path, though, so you may hit further issues
> - let me know if so, and we can try to work through them.
>
> Cheers,
>
> Matt
>
> From: Kosala [mailto:kosalayb at gmail.com]
> Sent: 15 August 2016 13:41
> To: Matt Williams (projectclearwater.org) <matt at projectclearwater.org>
> Subject: Re: [Project Clearwater] Stress Testing
>
> Hi Matt,
> Thanks. I set the bono_servers option. Should I add count =5000 to
> /etc/clearwater/shared_config ?
>
> Do I need other changes to run stress tests on all-in-one image?
> Thanks
> Kosala
>
>
>
> On Mon, Aug 15, 2016 at 10:54 AM, Matt Williams (projectclearwater.org<
> http://projectclearwater.org>) <matt at projectclearwater.org<mailto:
> matt at projectclearwater.org>> wrote:
> Kosala,
>
> While it's theoretically possible to do stress testing against an
> all-in-one image, I'd recommend against it - the all-in-one image has been
> squeezed down a lot to fit on a single VM and we'd expect very low
> performance out of it, and I could believe that overload behavior might be
> suboptimal.  If you're looking to stress test for performance reasons, I'd
> strongly recommend running a full deployment as this will give you much
> more reliable numbers.  If you're looking to stress test for other reasons,
> please can you share a bit more about what you're trying to achieve, and we
> can have a think about what would work best?
>
> If you do really want to run stress testing against an all-in-one image,
> it should probably work, even though http://clearwater.readthedocs.
> io/en/latest/Clearwater_stress_testing.html#manual-i-
> e-non-chef-stress-runs only talks about Chef and manual installs.  You'd
> need to set the "bono_servers" option in /etc/clearwater/shared_config to
> point to your all-in-one node, and I suspect you'd need to reduce the
> "count" option to something a lot lower - I'd start around 5000 and see how
> that goes.
>
> I hope that helps.  Please let me know how you get on.
>
> Thanks,
>
> Matt
>
> From: Clearwater [mailto:clearwater-bounces at lists.projectclearwater.org<
> mailto:clearwater-bounces at lists.projectclearwater.org>] On Behalf Of
> Kosala
> Sent: 15 August 2016 10:39
> To: clearwater at lists.projectclearwater.org<mailto:clearwater at lists.
> projectclearwater.org>
> Subject: [Project Clearwater] Stress Testing
>
> Hi Team,
> I installed clearwater "all-in-one" image on Oracle Virtual Box.
> 1. Can I do stress testing ?
> 2. How to do that?
> I am trying to follow Stress Testing on http://clearwater.readthedocs.
> io/en/stable/Clearwater_stress_testing.html#configuring-udp-stress.
> Using chef - > It seems chef/knife install only supports in the Cloud
> approach (The automated install is only supported for deployments running
> in Amazon?s EC2 cloud).
> Manual approach, It looks not supporting all in one image.
> Many Thanks
> Kosala
>
>
> -------------- next part --------------
> An HTML attachment was scrubbed...
> URL: <http://lists.projectclearwater.org/pipermail/clearwater_lists.
> projectclearwater.org/attachments/20160815/11781755/attachment.html>
>
> ------------------------------
>
> Subject: Digest Footer
>
> _______________________________________________
> Clearwater mailing list
> Clearwater at lists.projectclearwater.org
> http://lists.projectclearwater.org/mailman/listinfo/clearwater_lists.
> projectclearwater.org
>
>
> ------------------------------
>
> End of Clearwater Digest, Vol 40, Issue 24
> ******************************************
>
>
>
>
>
>
>
>
>
>
>
>
>
>
>
>
>
>
>
>
>
>
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.projectclearwater.org/pipermail/clearwater_lists.projectclearwater.org/attachments/20160818/30923c90/attachment.html>

From matt at projectclearwater.org  Thu Aug 18 11:44:47 2016
From: matt at projectclearwater.org (Matt Williams (projectclearwater.org))
Date: Thu, 18 Aug 2016 15:44:47 +0000
Subject: [Project Clearwater] Clearwater Digest, Vol 40, Issue 24
In-Reply-To: <CAGEe17YcA6fMx-gL8H_h4MUFmsOGYA7O3N+nYjJ83BYz6SgrPQ@mail.gmail.com>
References: <mailman.20.1471267072.11502.clearwater_lists.projectclearwater.org@lists.projectclearwater.org>
	<CAGEe17ZLnypQfbzxEwxj9EaB20MUBVpY+YdN-Obv=gHpZmG0KA@mail.gmail.com>
	<CY1PR0201MB1563F9A706F3EC7BE7F9C11590120@CY1PR0201MB1563.namprd02.prod.outlook.com>
	<CAGEe17bfTu1Kpwx=ipqtEbShvWtP+C6pJEEGHi0GSwBR5Dqw8w@mail.gmail.com>
	<CAGEe17aY077tLtotRe1X8k1qU_4otBdHDMJjqDH_g02Zs676Jg@mail.gmail.com>
	<CAGEe17ZeNPPy7AmMz=LCWnHqLm=v9Q7CuLT+AOVKWJTdg8m7Eg@mail.gmail.com>
	<CY1PR0201MB1563CE17983225B985B19D7390130@CY1PR0201MB1563.namprd02.prod.outlook.com>
	<CAGEe17b2M2uqvbOuqH7t4xM41FbfBYk0xR3zWqiFh+EkSfUzUQ@mail.gmail.com>
	<CY1PR0201MB1563CD5DDDD6E7B5A0B2DB7290140@CY1PR0201MB1563.namprd02.prod.outlook.com>
	<CAGEe17YGnaY1Kqc65gyiVO1sBBuTx=-YzfD9HY3M6QBD2t9AkA@mail.gmail.com>
	<CY1PR0201MB156349F26A0A7670BE7382A890140@CY1PR0201MB1563.namprd02.prod.outlook.com>
	<CAGEe17ZkY2ESNzwQYddrv6=jUJ5fPHu3gJXT7R1UjQmBd+eFUg@mail.gmail.com>
	<CY1PR0201MB1563C979B2D641DA59F1945A90150@CY1PR0201MB1563.namprd02.prod.outlook.com>
	<CAGEe17bC+xmhP3D7w768r0svzBAxdBedVXhis1Z33Yqdq4THgA@mail.gmail.com>
	<CY1PR0201MB1563F865DFBF86128118AC5290150@CY1PR0201MB1563.namprd02.prod.outlook.com>
	<CAGEe17Z2wBvTgPrnK_TdQPerVE9Moxnt=u9CWPpq8V04GJtfUw@mail.gmail.com>
	<CY1PR0201MB1563A30C3B9C4D8EE65FAD4390150@CY1PR0201MB1563.namprd02.prod.outlook.com>
	<CAGEe17ZVrag9yFkLgPF-kfgDPDT_nJETkei_Uwv47mohbAwyxg@mail.gmail.com>
	<CY1PR0201MB156325107DAA32BF9480667B90150@CY1PR0201MB1563.namprd02.prod.outlook.com>
	<CAGEe17bWEkdYazAcTOTq2+7kxwR=yYx04MT-QzjsHQ5HWPAD5Q@mail.gmail.com>
	<CY1PR0201MB15630493B218F47026930AF490150@CY1PR0201MB1563.namprd02.prod.outlook.com>
	<CAGEe17YcA6fMx-gL8H_h4MUFmsOGYA7O3N+nYjJ83BYz6SgrPQ@mail.gmail.com>
Message-ID: <CY1PR0201MB1563812CC87CB72B96D296A190150@CY1PR0201MB1563.namprd02.prod.outlook.com>

Kosala,

In that case, I would suggest

?         stopping stress

?         turning on debug logging and restarting bono and sprout - see http://clearwater.readthedocs.io/en/latest/Troubleshooting_and_Recovery.html for details on how to do this

?         making a manual call, and gathering the /var/log/bono/bono*.txt and /var/log/sprout/sprout*.txt

?         lowering your stress load even lower (maybe down to 10) by changing the "count" option

?         running stress until you see the traffic appear in /var/log/bono/bono*.txt and /var/log/sprout/sprout*.txt, then stopping stress and gathering these log files again.

Hopefully, the log files will tell you what's going wrong.

If you can't see the problem, please share both the working and failed logs with me, along with the time at which you ran the tests.

Thanks,
Matt

From: Kosala [mailto:kosalayb at gmail.com]
Sent: 18 August 2016 16:26
To: Matt Williams (projectclearwater.org) <matt at projectclearwater.org>
Cc: clearwater at lists.projectclearwater.org
Subject: Re: [Project Clearwater] Clearwater Digest, Vol 40, Issue 24

No I am getting server Timeout

sipp: The following events occured:
2016-08-18      15:22:10:886    1471533730.886591: Aborting call on unexpected message for Call-Id '2-16183 at 10.0.22.193<mailto:2-16183 at 10.0.22.193>': while expecting '401' (index 3), received 'SIP/2.0 504 Server Timeout^M
Via: SIP/2.0/TCP 10.0.22.193:5060;rport=9471;received=10.0.22.193;branch=z9hG4bK-16183-2-2-2010000096-^M
Record-Route: <sip:scscf.cwaio:5054;transport=TCP;lr;service=scscf;billing-role=charge-orig>^M
Call-ID: 2010000096///2-16183 at 10.0.22.193<mailto:2-16183 at 10.0.22.193>^M
From: <sip:2010000096 at example.com<mailto:sip%3A2010000096 at example.com>>;tag=16183SIPpTag002^M
To: <sip:2010000096 at example.com<mailto:sip%3A2010000096 at example.com>>;tag=z9hG4bKPjmTtF24BomE1irtWVZnxim6jKcUfYxxow^M
CSeq: 1 REGISTER^M
Content-Length:  0^M
^M
'.
2016-08-18      15:22:14:043    1471533734.043867: Aborting call on unexpected message for Call-Id '23-16183 at 10.0.22.193<mailto:23-16183 at 10.0.22.193>': while expecting '401' (index 3), received 'SIP/2.0 504 Server Timeout^M
Via: SIP/2.0/TCP 10.0.22.193:5060;rport=9480;received=10.0.22.193;branch=z9hG4bK-16183-23-2-2010000054-^M
Record-Route: <sip:scscf.cwaio:5054;transport=TCP;lr;service=scscf;billing-role=charge-orig>^M
Call-ID: 2010000054///23-16183 at 10.0.22.193<mailto:23-16183 at 10.0.22.193>^M
From: <sip:2010000054 at example.com<mailto:sip%3A2010000054 at example.com>>;tag=16183SIPpTag0023^M
To: <sip:2010000054 at example.com<mailto:sip%3A2010000054 at example.com>>;tag=z9hG4bKPjGLvFZz93Nq8VVQLuNznXDdHoOn3ILBWs^M
CSeq: 1 REGISTER^M
Content-Length:  0^M
^M
Kosala



On Thu, Aug 18, 2016 at 3:53 PM, Matt Williams (projectclearwater.org<http://projectclearwater.org>) <matt at projectclearwater.org<mailto:matt at projectclearwater.org>> wrote:
Kosala,

This is what the "count" option on the stress node controls (see http://clearwater.readthedocs.io/en/latest/Clearwater_stress_testing.html#manual-i-e-non-chef-stress-runs for details).  If you only want to make calls to/from the first 100 numbers, set this to 100.

Are these calls going through successfully, then?

Matt

From: Kosala [mailto:kosalayb at gmail.com<mailto:kosalayb at gmail.com>]
Sent: 18 August 2016 15:20
To: Matt Williams (projectclearwater.org<http://projectclearwater.org>) <matt at projectclearwater.org<mailto:matt at projectclearwater.org>>
Cc: clearwater at lists.projectclearwater.org<mailto:clearwater at lists.projectclearwater.org>
Subject: Re: [Project Clearwater] Clearwater Digest, Vol 40, Issue 24

Hi Matt,
Thanks. SIP node is calling numbers in a larger range starting from 2010000000. Can I restrict SIP call invoke from
2010000000 to 2010000099?
I can do bulk provision 100 numbers. I do not know how to restrict SIP node to call only these 100 numbers?
Thanks
Kosala


On Thu, Aug 18, 2016 at 2:59 PM, Matt Williams (projectclearwater.org<http://projectclearwater.org>) <matt at projectclearwater.org<mailto:matt at projectclearwater.org>> wrote:
Kosala,

The error you're seeing suggests that the request is timing out between Bono and Sprout.  This could be due to poor performance on the all-in-one node (as I said previously, the all-in-one node is not intended for running stress), or it could be due to a more general misconfiguration.  Are all REGISTERs failing, or just some?

Regarding getting CPU statistics etc., we normally use Cacti.  There are instructions for setting this up at http://clearwater.readthedocs.io/en/latest/Cacti.html.  However, I doubt this will work as-is with your all-in-one node.  Since you only have one node, maybe you're best just looking at top?

Matt

From: Kosala [mailto:kosalayb at gmail.com<mailto:kosalayb at gmail.com>]
Sent: 18 August 2016 14:13

To: Matt Williams (projectclearwater.org<http://projectclearwater.org>) <matt at projectclearwater.org<mailto:matt at projectclearwater.org>>
Cc: clearwater at lists.projectclearwater.org<mailto:clearwater at lists.projectclearwater.org>
Subject: Re: [Project Clearwater] Clearwater Digest, Vol 40, Issue 24

Hi Matt,
Now for the numbers I have in Cassandra, at SP node, I am getting "SIP/2.0 504 Server Timeout"
2016-08-18      11:49:03:189    1471520943.189039: Aborting call on unexpected message for Call-Id '1073-27637 at 10.0.22.193<mailto:1073-27637 at 10.0.22.193>': while expecting '401' (index 3), received 'SIP/2.0 504 Server Timeout^M
Via: SIP/2.0/TCP 10.0.22.193:5060;rport=32939;received=10.0.22.193;branch=z9hG4bK-27637-1073-2-2010000854-^M
Record-Route: <sip:scscf.cwaio:5054;transport=TCP;lr;service=scscf;billing-role=charge-orig>^M
Call-ID: 2010000854///1073-27637 at 10.0.22.193<mailto:1073-27637 at 10.0.22.193>^M
From: <sip:2010000854 at example.com<mailto:sip%3A2010000854 at example.com>>;tag=27637SIPpTag001073^M
To: <sip:2010000854 at example.com<mailto:sip%3A2010000854 at example.com>>;tag=z9hG4bKPjuN16eRA0bDott9z6ZA-fwIYe3VA-KMkQ^M
CSeq: 1 REGISTER^M
Content-Length:  0^M
^M
'.
2016-08-18      11:49:04:185    1471520944.185945: Aborting call on unexpected message for Call-Id '1154-27637 at 10.0.22.193<mailto:1154-27637 at 10.0.22.193>': while expecting '401' (index 3), received 'SIP/2.0 504 Server Timeout^M
Via: SIP/2.0/TCP 10.0.22.193:5060;rport=32940;received=10.0.22.193;branch=z9hG4bK-27637-1154-2-2010000692-^M
Record-Route: <sip:scscf.cwaio:5054;transport=TCP;lr;service=scscf;billing-role=charge-orig>^M
Call-ID: 2010000692///1154-27637 at 10.0.22.193<mailto:1154-27637 at 10.0.22.193>^M
From: <sip:2010000692 at example.com<mailto:sip%3A2010000692 at example.com>>;tag=27637SIPpTag001154^M
To: <sip:2010000692 at example.com<mailto:sip%3A2010000692 at example.com>>;tag=z9hG4bKPjk-5lYhadbnX7rqNirT8tjwQdDjLAQo0j^M
CSeq: 1 REGISTER^M
Content-Length:  0^M

How do I know, stress tests are running properly? Can I see statistics such as memory usage, cpu time,  etc ?
Thanks
Kosala


On Thu, Aug 18, 2016 at 12:38 PM, Matt Williams (projectclearwater.org<http://projectclearwater.org>) <matt at projectclearwater.org<mailto:matt at projectclearwater.org>> wrote:
Kosala,

Thanks!  I'm very confused about your software version, though, as the latest all-in-one image has

?         crest 1.0-160811.103635 (i.e. older than yours)

?         homestead 1.0-160814.205535 (i.e. slightly newer than yours)

?         sprout 1.0-160814.205701 (i.e. much newer than yours)

?         the logging.bash script fix already applied.
It looks as though your might have taken the previous all-in-one image, and then upgraded some of the packages.  Please can you confirm: have you upgraded any packages?

On the issue you're seeing, I think you're saying that

?         you're running clearwater-sip-stress (which defaults to using numbers in the range above 2010000000)

?         you've deleted all these numbers from Homestead's Cassandra

?         you see errors in clearwater-sip-stress's log file saying that registration are failing with "404 Not Found".
I think this is expected - you need to provision numbers in Homestead's Cassandra that match the numbers that clearwater-sip-stress is expecting to register as.  Please let me know if I've misunderstood.

Thanks,

Matt

From: Kosala [mailto:kosalayb at gmail.com<mailto:kosalayb at gmail.com>]
Sent: 18 August 2016 11:46

To: Matt Williams (projectclearwater.org<http://projectclearwater.org>) <matt at projectclearwater.org<mailto:matt at projectclearwater.org>>
Subject: Re: [Project Clearwater] Clearwater Digest, Vol 40, Issue 24


Hi Matt,
I am running the latest version all-in-one which i downloaded from http://vm-images.cw-ngv.com/cw-aio.ova.

[cw-aio]ubuntu at cwaio:~$ sudo dpkg-query -s crest
[sudo] password for ubuntu:
Package: crest
Status: install ok installed
Priority: optional
Section: network
Installed-Size: 40102
Maintainer: Project Clearwater Maintainers <maintainers at projectclearwater.org<mailto:maintainers at projectclearwater.org>>
Architecture: amd64
Version: 1.0-160818.091648
homestead
Version: 1.0-160812.164051
sprout
Version: 1.0-160726.101022
And one strange thing is:
I deleted all the records in tables from homestead_cache and homestead_provisioning. Then when I check the SIP node for logs, sip-stress_14320_errors.log still has records with sip: ids which are not in Cassandra. For example, sip:2010021460 at example.com<mailto:sip%3A2010021460 at example.com>
2016-08-18      10:26:08:288    1471515968.288189: Aborting call on unexpected message for Call-Id '4270-14320 at 10.0.22.193<mailto:4270-14320 at 10.0.22.193>': while expecting '401' (index 3), received 'SIP/2.0 404 Not Found^M
Via: SIP/2.0/TCP 10.0.22.193:5060;rport=35233;received=10.0.22.193;branch=z9hG4bK-14320-4270-2-2010021460-^M
Record-Route: <sip:scscf.cwaio:5054;transport=TCP;lr;service=scscf;billing-role=charge-orig>^M
Call-ID: 2010021460///4270-14320 at 10.0.22.193<mailto:4270-14320 at 10.0.22.193>^M
From: <sip:2010021460 at example.com<mailto:sip%3A2010021460 at example.com>>;tag=14320SIPpTag004270^M
To: <sip:2010021460 at example.com<mailto:sip%3A2010021460 at example.com>>;tag=z9hG4bKPjVe2he9j28lou.0Dl9NmKGS7ypUMLjMJv^M
CSeq: 1 REGISTER^M
Content-Length:  0^M
Thanks
Kosala

On Thu, Aug 18, 2016 at 10:47 AM, Matt Williams (projectclearwater.org<http://projectclearwater.org>) <matt at projectclearwater.org<mailto:matt at projectclearwater.org>> wrote:
Kosala,

The fix is not to copy this to /usr/share/clearwater/utils, but to move it.  However, since the error is benign, I'd suggest just ignoring it while we get this working.

As I asked below, please can you confirm what version you're running?  I'm concerned that it's going to be very hard to troubleshoot problems if you have an all-in-one image from a few weeks ago, with some packages updated to more recent versions and then some further fixes manually applied.

Thanks,

Matt


From: Kosala [mailto:kosalayb at gmail.com<mailto:kosalayb at gmail.com>]
Sent: 18 August 2016 10:34

To: Matt Williams (projectclearwater.org<http://projectclearwater.org>) <matt at projectclearwater.org<mailto:matt at projectclearwater.org>>
Cc: clearwater at lists.projectclearwater.org<mailto:clearwater at lists.projectclearwater.org>
Subject: Re: [Project Clearwater] Clearwater Digest, Vol 40, Issue 24

Hi Matt,
Yeah, Manual calls are working fine.
As it is said in the big fix, https://github.com/Metaswitch/clearwater-infrastructure/issues/355 , I copied logging.bash to /usr/share/clearwater/utils
but I am still getting

/etc/init.d/clearwater-infrastructure: 76: /etc/init.d/clearwater-infrastructure: /usr/share/clearwater/infrastructure/scripts/logging.bash: Permission denied
Configuring monit for only localhost access
Kosala


On Thu, Aug 18, 2016 at 10:01 AM, Matt Williams (projectclearwater.org<http://projectclearwater.org>) <matt at projectclearwater.org<mailto:matt at projectclearwater.org>> wrote:
Kosala,

Yes, it's https://github.com/Metaswitch/clearwater-infrastructure/issues/355 and it should be benign.

However, this was fixed about 2 weeks ago.  Please can you confirm when you downloaded the all-in-one image, and whether you've upgraded it all?  (As I observed earlier, your crest release was from only a few days ago.)

Have you got manual calls working?

Thanks,

Matt


From: Kosala [mailto:kosalayb at gmail.com<mailto:kosalayb at gmail.com>]
Sent: 18 August 2016 09:56
To: Matt Williams (projectclearwater.org<http://projectclearwater.org>) <matt at projectclearwater.org<mailto:matt at projectclearwater.org>>
Cc: clearwater at lists.projectclearwater.org<mailto:clearwater at lists.projectclearwater.org>

Subject: Re: [Project Clearwater] Clearwater Digest, Vol 40, Issue 24

Hi Matt,
In SIP node, when I am trying to execute "sudo service clearwater-sip-stress restart", I am getting an error

/etc/init.d/clearwater-infrastructure: 76: /etc/init.d/clearwater-infrastructure: /usr/share/clearwater/infrastructure/scripts/logging.bash: Permission denied
Configuring monit for only localhost access
Any clue about this error?
Thanks
Kosala


On Wed, Aug 17, 2016 at 2:29 PM, Matt Williams (projectclearwater.org<http://projectclearwater.org>) <matt at projectclearwater.org<mailto:matt at projectclearwater.org>> wrote:
Kosala,

Yes, that's the correct screen, and you're correct that it shows that stress is being attempted but failing.

Do regular (non-stress) calls work through this deployment?

You can look at what message the stress node is receiving in the log files in the /var/log/clearwater-sip-stress/ directory - I think there are "errors" logs that contain the unexpected messages.

You can obviously also look at what's happening on the all-in-one node itself, using the /var/log/bono/*, /var/log/sprout/* and /var/log/homestead/* files, as described at http://clearwater.readthedocs.io/en/latest/Troubleshooting_and_Recovery.html.

I hope that helps.

Cheers,

Matt

From: Kosala [mailto:kosalayb at gmail.com<mailto:kosalayb at gmail.com>]
Sent: 17 August 2016 14:20

To: Matt Williams (projectclearwater.org<http://projectclearwater.org>) <matt at projectclearwater.org<mailto:matt at projectclearwater.org>>
Subject: Re: [Project Clearwater] Clearwater Digest, Vol 40, Issue 24

Hi Matt,
I can see this scenario screen from sip-stress.1.out. I hope this will be the stress test output results.

------------------------------ Scenario Screen -------- [1-9]: Change Screen --
     Users (length)   Port   Total-time  Total-calls  Remote-host
        2500 (0 ms)   5060      77.15 s         2500  10.0.21.192:5060(TCP)

  Call limit reached (-m 2500), 1.002 s period  1 ms scheduler resolution
  2175 calls (limit 2500)                Peak was 2499 calls, after 0 s
  0 Running, 2177 Paused, 8 Woken up
  0 dead call msg (discarded)            0 out-of-call msg (discarded)
  3 open sockets

                                 Messages  Retrans   Timeout   Unexpected-Msg
       Pause [0ms/10:00]         2500                          0
    REGISTER ---------->         326       0
         401 <----------         0         0         0         325
    REGISTER ---------->         0         0
         200 <----------         0         0         0         0
    REGISTER ---------->         0         0
         401 <----------         0         0         0         0
    REGISTER ---------->         0         0
         200 <----------         0         0         0         0
       Pause [     4:50]         0                             0
    REGISTER ---------->  B-RTD1 0         0
         200 <----------  E-RTD1 0         0         0         0
    REGISTER ---------->  B-RTD1 0         0
         200 <----------  E-RTD1 0         0         0         0
       Pause [     4:50]         0                             0
       Pause [$pre_call_delay]   0                             0
      INVITE ---------->  B-RTD2 0         0
         100 <----------         0         0         0         0
      INVITE <----------         0         0         0         0
         100 <----------         0         0         0         0
      INVITE <----------         0         0         0         0
         100 ---------->         0         0
         180 ---------->         0         0
         180 <----------         0         0         0         0
       Pause [   6000ms]         0                             0
         200 ---------->         0         0
         200 <----------         0         0         0         0
         ACK ---------->         0         0
         ACK <----------         0         0         0         0
      UPDATE ---------->         0         0
      UPDATE <----------         0         0         0         0
         200 ---------->         0         0
         200 <----------  E-RTD2 0         0         0         0
       Pause [    24.0s]         0                             0
         BYE ---------->  B-RTD3 0         0
         BYE <----------         0         0         0         0
         200 ---------->         0         0
         200 <----------  E-RTD3 0         0         0         0
       Pause [$post_call_delay]  0                             0
------- Waiting for active calls to end. Press [q] again to force exit. -------
Last Error: Aborting call on unexpected message for Call-Id '1079-13729 at ...
However there is an unexpected message error at the end.
Thanks
Kosala


On Wed, Aug 17, 2016 at 12:40 PM, Matt Williams (projectclearwater.org<http://projectclearwater.org>) <matt at projectclearwater.org<mailto:matt at projectclearwater.org>> wrote:
Kosala,

They should log to /var/log/clearwater-sip-stress - in particular, the *.1.out file is a log of the output from sipp.  Do you see anything there?

Matt

From: Kosala [mailto:kosalayb at gmail.com<mailto:kosalayb at gmail.com>]
Sent: 17 August 2016 12:33
To: Matt Williams (projectclearwater.org<http://projectclearwater.org>) <matt at projectclearwater.org<mailto:matt at projectclearwater.org>>; clearwater at lists.projectclearwater.org<mailto:clearwater at lists.projectclearwater.org>

Subject: Re: [Project Clearwater] Clearwater Digest, Vol 40, Issue 24

Hi Matt,
I followed above steps and run sudo apt-get install clearwater-sip-stress.
How do I know stress tests are running? Is is said, stress tests start automatically but I cannot see it.
Thanks
Kosala



On Tue, Aug 16, 2016 at 2:01 PM, Matt Williams (projectclearwater.org<http://projectclearwater.org>) <matt at projectclearwater.org<mailto:matt at projectclearwater.org>> wrote:
Kosala,

I'm glad you've made progress on this.

I had a look at the crest package version, but it seems to be later than the most recent all-in-one image uses (1.0-160811.103635).  When did you download the all-in-one image, and did you apply any patches to it?

Regarding making calls for stress testing, this is where http://clearwater.readthedocs.io/en/latest/Clearwater_stress_testing.html#manual-i-e-non-chef-stress-runs comes in - you need to

?         create a separate VM

?         set the bono_hostname and count parameters in /etc/clearwater/shared_config

?         install the clearwater-sip-stress package.
I hope that helps.

BTW, please remember to copy in clearwater at lists.projectclearwater.org<mailto:clearwater at lists.projectclearwater.org> - that means that other people can see and comment on your posts.

Thanks,

Matt


From: Kosala [mailto:kosalayb at gmail.com<mailto:kosalayb at gmail.com>]
Sent: 16 August 2016 10:48
To: Matt Williams (projectclearwater.org<http://projectclearwater.org>) <matt at projectclearwater.org<mailto:matt at projectclearwater.org>>
Subject: Re: [Project Clearwater] Clearwater Digest, Vol 40, Issue 24

Hi Matt,
Bulk provisioning for all in one image is done using https://github.com/Metaswitch/crest/blob/dev/docs/Bulk-Provisioning%20Numbers.md.
I have records in tables in homestead_cache and homer.
Now How to make calls for stress testing?
Is there any guideline?
Many Thanks,
Kosala




On Tue, Aug 16, 2016 at 9:04 AM, Kosala <kosalayb at gmail.com<mailto:kosalayb at gmail.com>> wrote:
Hi Matt,
TBH, The document in https://github.com/Metaswitch/crest/blob/dev/docs/Bulk-Provisioning%20Numbers.md is not clear to me.
Step 1. Homestead node in deployment. I do not know where is that node in all in one image. It will be helpful the location of that folder from the root.
Step 2. A simple example will be helpful.
Thanks
Kosala


On Tue, Aug 16, 2016 at 8:50 AM, Kosala <kosalayb at gmail.com<mailto:kosalayb at gmail.com>> wrote:
Hi Matt,
I downloaded the all in one package from http://clearwater.readthedocs.io/en/stable/All_in_one_OVF_Installation.html
and imported using oracle virtual box on ubuntu 14.04,
Crest version
[cw-aio]ubuntu at cwaio:~$ sudo dpkg-query -s crest
Package: crest
Status: install ok installed
Priority: optional
Section: network
Installed-Size: 40098
Maintainer: Project Clearwater Maintainers <maintainers at projectclearwater.org<mailto:maintainers at projectclearwater.org>>
Architecture: amd64
Version: 1.0-160815.145007
Thanks
Kosala


On Mon, Aug 15, 2016 at 5:56 PM, Matt Williams (projectclearwater.org<http://projectclearwater.org>) <matt at projectclearwater.org<mailto:matt at projectclearwater.org>> wrote:
Kosala,

That's odd - I don't see that failure on my all-in-one image (spun up just now from the latest image) - which version of all-in-one-image are you running, and which version of crest does it include ("sudo dpkg-query -s crest")?

You may be able to work-around this either by taking the latest all-in-one image or by following the simpler bulk-provisioning process at https://github.com/Metaswitch/crest/blob/dev/docs/Bulk-Provisioning%20Numbers.md (when this doc talks about using the sstables_provisioning process for very large sets of numbers, we mean 1M+ numbers - the 9000 you're provisioning are well within the capabilities of this process).

I hope that helps - please let me know how you get on.

Cheers,

Matt


From: Clearwater [mailto:clearwater-bounces at lists.projectclearwater.org<mailto:clearwater-bounces at lists.projectclearwater.org>] On Behalf Of Kosala
Sent: 15 August 2016 16:58
To: clearwater at lists.projectclearwater.org<mailto:clearwater at lists.projectclearwater.org>
Subject: Re: [Project Clearwater] Clearwater Digest, Vol 40, Issue 24

HI Matt,
Thanks.

I am trying to follow https://github.com/Metaswitch/crest/blob/dev/src/metaswitch/crest/tools/sstable_provisioning/README.md for bulk provisioning.

When I am trying to execute sudo ./BulkProvision homer 21000 29999 example.com<http://example.com> 7kkzTyGW in all-in-one image,
I am getting an error  java.lang.UnsupportedClassVersionError: ClearwaterBulkProvisioner : Unsupported major.minor version 52.0
Java version info in all-in-one image:
[cw-aio]ubuntu at cwaio:/usr/share/clearwater/crest/tools/sstable_provisioning$ java -version
java version "1.7.0_101"
OpenJDK Runtime Environment (IcedTea 2.6.6) (7u101-2.6.6-0ubuntu0.14.04.1)
OpenJDK 64-Bit Server VM (build 24.95-b01, mixed mode)
Thanks
Kosala



On Mon, Aug 15, 2016 at 2:17 PM, <clearwater-request at lists.projectclearwater.org<mailto:clearwater-request at lists.projectclearwater.org>> wrote:
Send Clearwater mailing list submissions to
        clearwater at lists.projectclearwater.org<mailto:clearwater at lists.projectclearwater.org>

To subscribe or unsubscribe via the World Wide Web, visit
        http://lists.projectclearwater.org/mailman/listinfo/clearwater_lists.projectclearwater.org

or, via email, send a message with subject or body 'help' to
        clearwater-request at lists.projectclearwater.org<mailto:clearwater-request at lists.projectclearwater.org>

You can reach the person managing the list at
        clearwater-owner at lists.projectclearwater.org<mailto:clearwater-owner at lists.projectclearwater.org>

When replying, please edit your Subject line so it is more specific
than "Re: Contents of Clearwater digest..."


Today's Topics:

   1. Stress Testing (Kosala)
   2. Re: Stress Testing (Matt Williams (projectclearwater.org<http://projectclearwater.org>))
   3. Re: Stress Testing (Matt Williams (projectclearwater.org<http://projectclearwater.org>))


----------------------------------------------------------------------

Message: 1
Date: Mon, 15 Aug 2016 10:38:57 +0100
From: Kosala <kosalayb at gmail.com<mailto:kosalayb at gmail.com>>
To: clearwater at lists.projectclearwater.org<mailto:clearwater at lists.projectclearwater.org>
Subject: [Project Clearwater] Stress Testing
Message-ID:
        <CAGEe17an2B_bGj8NfKFwms+nU=vJURyhT5CE+mcY1pjcm4YF+A at mail.gmail.com<mailto:vJURyhT5CE%2BmcY1pjcm4YF%2BA at mail.gmail.com>>
Content-Type: text/plain; charset="utf-8"

Hi Team,

I installed clearwater "all-in-one" image on Oracle Virtual Box.
1. Can I do stress testing ?
2. How to do that?

I am trying to follow Stress Testing on
http://clearwater.readthedocs.io/en/stable/Clearwater_stress_testing.html#configuring-udp-stress
.

Using chef - > It seems chef/knife install only supports in the Cloud
approach (The automated install is only supported for deployments running
in Amazon?s EC2 cloud).

Manual approach, It looks not supporting all in one image.

Many Thanks
Kosala
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.projectclearwater.org/pipermail/clearwater_lists.projectclearwater.org/attachments/20160815/15fc3b07/attachment-0001.html>

------------------------------

Message: 2
Date: Mon, 15 Aug 2016 09:54:02 +0000
From: "Matt Williams (projectclearwater.org<http://projectclearwater.org>)"
        <matt at projectclearwater.org<mailto:matt at projectclearwater.org>>
To: Kosala <kosalayb at gmail.com<mailto:kosalayb at gmail.com>>
Cc: "clearwater at lists.projectclearwater.org<mailto:clearwater at lists.projectclearwater.org>"
        <clearwater at lists.projectclearwater.org<mailto:clearwater at lists.projectclearwater.org>>
Subject: Re: [Project Clearwater] Stress Testing
Message-ID:
        <CY1PR0201MB15636F1F20EB91BB180F053390120 at CY1PR0201MB1563.namprd02.prod.outlook.com<mailto:CY1PR0201MB15636F1F20EB91BB180F053390120 at CY1PR0201MB1563.namprd02.prod.outlook.com>>

Content-Type: text/plain; charset="utf-8"

Kosala,

While it's theoretically possible to do stress testing against an all-in-one image, I'd recommend against it - the all-in-one image has been squeezed down a lot to fit on a single VM and we'd expect very low performance out of it, and I could believe that overload behavior might be suboptimal.  If you're looking to stress test for performance reasons, I'd strongly recommend running a full deployment as this will give you much more reliable numbers.  If you're looking to stress test for other reasons, please can you share a bit more about what you're trying to achieve, and we can have a think about what would work best?

If you do really want to run stress testing against an all-in-one image, it should probably work, even though http://clearwater.readthedocs.io/en/latest/Clearwater_stress_testing.html#manual-i-e-non-chef-stress-runs only talks about Chef and manual installs.  You'd need to set the "bono_servers" option in /etc/clearwater/shared_config to point to your all-in-one node, and I suspect you'd need to reduce the "count" option to something a lot lower - I'd start around 5000 and see how that goes.

I hope that helps.  Please let me know how you get on.

Thanks,

Matt

From: Clearwater [mailto:clearwater-bounces at lists.projectclearwater.org<mailto:clearwater-bounces at lists.projectclearwater.org>] On Behalf Of Kosala
Sent: 15 August 2016 10:39
To: clearwater at lists.projectclearwater.org<mailto:clearwater at lists.projectclearwater.org>
Subject: [Project Clearwater] Stress Testing

Hi Team,
I installed clearwater "all-in-one" image on Oracle Virtual Box.
1. Can I do stress testing ?
2. How to do that?
I am trying to follow Stress Testing on http://clearwater.readthedocs.io/en/stable/Clearwater_stress_testing.html#configuring-udp-stress.
Using chef - > It seems chef/knife install only supports in the Cloud approach (The automated install is only supported for deployments running in Amazon?s EC2 cloud).
Manual approach, It looks not supporting all in one image.
Many Thanks
Kosala

-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.projectclearwater.org/pipermail/clearwater_lists.projectclearwater.org/attachments/20160815/29d6328d/attachment-0001.html>

------------------------------

Message: 3
Date: Mon, 15 Aug 2016 13:16:47 +0000
From: "Matt Williams (projectclearwater.org<http://projectclearwater.org>)"
        <matt at projectclearwater.org<mailto:matt at projectclearwater.org>>
To: "clearwater at lists.projectclearwater.org<mailto:clearwater at lists.projectclearwater.org>"
        <clearwater at lists.projectclearwater.org<mailto:clearwater at lists.projectclearwater.org>>
Subject: Re: [Project Clearwater] Stress Testing
Message-ID:
        <CY1PR0201MB156372246DC5A77B11839F9D90120 at CY1PR0201MB1563.namprd02.prod.outlook.com<mailto:CY1PR0201MB156372246DC5A77B11839F9D90120 at CY1PR0201MB1563.namprd02.prod.outlook.com>>

Content-Type: text/plain; charset="utf-8"

Kosala,

You'll need to follow all the steps in http://clearwater.readthedocs.io/en/latest/Clearwater_stress_testing.html#manual-i-e-non-chef-stress-runs, i.e. bulk provisioning subscribers and installing clearwater-sip-stress, but that should be it.

Just to be clear, though, you'll need to set the configuration and install the clearwater-sip-stress package on a separate VM, not on the all-in-one image itself - the all-in-one image almost certainly opens up ports that conflict with those that clearwater-sip-stress tries to use.

This isn't a very well-trodden path, though, so you may hit further issues - let me know if so, and we can try to work through them.

Cheers,

Matt

From: Kosala [mailto:kosalayb at gmail.com<mailto:kosalayb at gmail.com>]
Sent: 15 August 2016 13:41
To: Matt Williams (projectclearwater.org<http://projectclearwater.org>) <matt at projectclearwater.org<mailto:matt at projectclearwater.org>>
Subject: Re: [Project Clearwater] Stress Testing

Hi Matt,
Thanks. I set the bono_servers option. Should I add count =5000 to /etc/clearwater/shared_config ?

Do I need other changes to run stress tests on all-in-one image?
Thanks
Kosala



On Mon, Aug 15, 2016 at 10:54 AM, Matt Williams (projectclearwater.org<http://projectclearwater.org><http://projectclearwater.org>) <matt at projectclearwater.org<mailto:matt at projectclearwater.org><mailto:matt at projectclearwater.org<mailto:matt at projectclearwater.org>>> wrote:
Kosala,

While it's theoretically possible to do stress testing against an all-in-one image, I'd recommend against it - the all-in-one image has been squeezed down a lot to fit on a single VM and we'd expect very low performance out of it, and I could believe that overload behavior might be suboptimal.  If you're looking to stress test for performance reasons, I'd strongly recommend running a full deployment as this will give you much more reliable numbers.  If you're looking to stress test for other reasons, please can you share a bit more about what you're trying to achieve, and we can have a think about what would work best?

If you do really want to run stress testing against an all-in-one image, it should probably work, even though http://clearwater.readthedocs.io/en/latest/Clearwater_stress_testing.html#manual-i-e-non-chef-stress-runs only talks about Chef and manual installs.  You'd need to set the "bono_servers" option in /etc/clearwater/shared_config to point to your all-in-one node, and I suspect you'd need to reduce the "count" option to something a lot lower - I'd start around 5000 and see how that goes.

I hope that helps.  Please let me know how you get on.

Thanks,

Matt

From: Clearwater [mailto:clearwater-bounces at lists.projectclearwater.org<mailto:clearwater-bounces at lists.projectclearwater.org><mailto:clearwater-bounces at lists.projectclearwater.org<mailto:clearwater-bounces at lists.projectclearwater.org>>] On Behalf Of Kosala
Sent: 15 August 2016 10:39
To: clearwater at lists.projectclearwater.org<mailto:clearwater at lists.projectclearwater.org><mailto:clearwater at lists.projectclearwater.org<mailto:clearwater at lists.projectclearwater.org>>
Subject: [Project Clearwater] Stress Testing

Hi Team,
I installed clearwater "all-in-one" image on Oracle Virtual Box.
1. Can I do stress testing ?
2. How to do that?
I am trying to follow Stress Testing on http://clearwater.readthedocs.io/en/stable/Clearwater_stress_testing.html#configuring-udp-stress.
Using chef - > It seems chef/knife install only supports in the Cloud approach (The automated install is only supported for deployments running in Amazon?s EC2 cloud).
Manual approach, It looks not supporting all in one image.
Many Thanks
Kosala


-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.projectclearwater.org/pipermail/clearwater_lists.projectclearwater.org/attachments/20160815/11781755/attachment.html>

------------------------------

Subject: Digest Footer

_______________________________________________
Clearwater mailing list
Clearwater at lists.projectclearwater.org<mailto:Clearwater at lists.projectclearwater.org>
http://lists.projectclearwater.org/mailman/listinfo/clearwater_lists.projectclearwater.org


------------------------------

End of Clearwater Digest, Vol 40, Issue 24
******************************************












-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.projectclearwater.org/pipermail/clearwater_lists.projectclearwater.org/attachments/20160818/4c1dcad2/attachment.html>

From matt at projectclearwater.org  Thu Aug 18 11:57:25 2016
From: matt at projectclearwater.org (Matt Williams (projectclearwater.org))
Date: Thu, 18 Aug 2016 15:57:25 +0000
Subject: [Project Clearwater] Clearwater Digest, Vol 40, Issue 24
In-Reply-To: <CAGEe17bpA32DECgJWrwvAHE1EO2XkfeweJR3JEQgw7TrmzAzdA@mail.gmail.com>
References: <mailman.20.1471267072.11502.clearwater_lists.projectclearwater.org@lists.projectclearwater.org>
	<CAGEe17ZLnypQfbzxEwxj9EaB20MUBVpY+YdN-Obv=gHpZmG0KA@mail.gmail.com>
	<CY1PR0201MB1563F9A706F3EC7BE7F9C11590120@CY1PR0201MB1563.namprd02.prod.outlook.com>
	<CAGEe17bfTu1Kpwx=ipqtEbShvWtP+C6pJEEGHi0GSwBR5Dqw8w@mail.gmail.com>
	<CAGEe17aY077tLtotRe1X8k1qU_4otBdHDMJjqDH_g02Zs676Jg@mail.gmail.com>
	<CAGEe17ZeNPPy7AmMz=LCWnHqLm=v9Q7CuLT+AOVKWJTdg8m7Eg@mail.gmail.com>
	<CY1PR0201MB1563CE17983225B985B19D7390130@CY1PR0201MB1563.namprd02.prod.outlook.com>
	<CAGEe17b2M2uqvbOuqH7t4xM41FbfBYk0xR3zWqiFh+EkSfUzUQ@mail.gmail.com>
	<CY1PR0201MB1563CD5DDDD6E7B5A0B2DB7290140@CY1PR0201MB1563.namprd02.prod.outlook.com>
	<CAGEe17YGnaY1Kqc65gyiVO1sBBuTx=-YzfD9HY3M6QBD2t9AkA@mail.gmail.com>
	<CY1PR0201MB156349F26A0A7670BE7382A890140@CY1PR0201MB1563.namprd02.prod.outlook.com>
	<CAGEe17ZkY2ESNzwQYddrv6=jUJ5fPHu3gJXT7R1UjQmBd+eFUg@mail.gmail.com>
	<CY1PR0201MB1563C979B2D641DA59F1945A90150@CY1PR0201MB1563.namprd02.prod.outlook.com>
	<CAGEe17bC+xmhP3D7w768r0svzBAxdBedVXhis1Z33Yqdq4THgA@mail.gmail.com>
	<CY1PR0201MB1563F865DFBF86128118AC5290150@CY1PR0201MB1563.namprd02.prod.outlook.com>
	<CAGEe17Z2wBvTgPrnK_TdQPerVE9Moxnt=u9CWPpq8V04GJtfUw@mail.gmail.com>
	<CY1PR0201MB1563A30C3B9C4D8EE65FAD4390150@CY1PR0201MB1563.namprd02.prod.outlook.com>
	<CAGEe17ZVrag9yFkLgPF-kfgDPDT_nJETkei_Uwv47mohbAwyxg@mail.gmail.com>
	<CY1PR0201MB156325107DAA32BF9480667B90150@CY1PR0201MB1563.namprd02.prod.outlook.com>
	<CAGEe17bWEkdYazAcTOTq2+7kxwR=yYx04MT-QzjsHQ5HWPAD5Q@mail.gmail.com>
	<CY1PR0201MB15630493B218F47026930AF490150@CY1PR0201MB1563.namprd02.prod.outlook.com>
	<CAGEe17bpA32DECgJWrwvAHE1EO2XkfeweJR3JEQgw7TrmzAzdA@mail.gmail.com>
Message-ID: <CY1PR0201MB1563E75F9D52ED36CB03D96F90150@CY1PR0201MB1563.namprd02.prod.outlook.com>

Kosala,

It's good that you've got this working.

You asked again about finding statistics for CPU time and memory usage per call.  As I said at the beginning of the trail, the all-in-one node is not set up for stress and any numbers you get out of this on all-in-one node will be far higher than you would see in practice and probably very noisy too.  Unfortunately, if you want numbers like this, you will need to set up a full deployment.

Matt

From: Kosala [mailto:kosalayb at gmail.com]
Sent: 18 August 2016 16:43
To: Matt Williams (projectclearwater.org) <matt at projectclearwater.org>
Cc: clearwater at lists.projectclearwater.org
Subject: Re: [Project Clearwater] Clearwater Digest, Vol 40, Issue 24

HI Matt,
I could get it working for 5 numbers. I will increase and see how far i can increase numbers. Then I like to see how to find statistics such as memory usage, cpu time per call etc.

Kosala

On Thu, Aug 18, 2016 at 3:53 PM, Matt Williams (projectclearwater.org<http://projectclearwater.org>) <matt at projectclearwater.org<mailto:matt at projectclearwater.org>> wrote:
Kosala,

This is what the "count" option on the stress node controls (see http://clearwater.readthedocs.io/en/latest/Clearwater_stress_testing.html#manual-i-e-non-chef-stress-runs for details).  If you only want to make calls to/from the first 100 numbers, set this to 100.

Are these calls going through successfully, then?

Matt

From: Kosala [mailto:kosalayb at gmail.com<mailto:kosalayb at gmail.com>]
Sent: 18 August 2016 15:20
To: Matt Williams (projectclearwater.org<http://projectclearwater.org>) <matt at projectclearwater.org<mailto:matt at projectclearwater.org>>
Cc: clearwater at lists.projectclearwater.org<mailto:clearwater at lists.projectclearwater.org>
Subject: Re: [Project Clearwater] Clearwater Digest, Vol 40, Issue 24

Hi Matt,
Thanks. SIP node is calling numbers in a larger range starting from 2010000000. Can I restrict SIP call invoke from
2010000000 to 2010000099?
I can do bulk provision 100 numbers. I do not know how to restrict SIP node to call only these 100 numbers?
Thanks
Kosala


On Thu, Aug 18, 2016 at 2:59 PM, Matt Williams (projectclearwater.org<http://projectclearwater.org>) <matt at projectclearwater.org<mailto:matt at projectclearwater.org>> wrote:
Kosala,

The error you're seeing suggests that the request is timing out between Bono and Sprout.  This could be due to poor performance on the all-in-one node (as I said previously, the all-in-one node is not intended for running stress), or it could be due to a more general misconfiguration.  Are all REGISTERs failing, or just some?

Regarding getting CPU statistics etc., we normally use Cacti.  There are instructions for setting this up at http://clearwater.readthedocs.io/en/latest/Cacti.html.  However, I doubt this will work as-is with your all-in-one node.  Since you only have one node, maybe you're best just looking at top?

Matt

From: Kosala [mailto:kosalayb at gmail.com<mailto:kosalayb at gmail.com>]
Sent: 18 August 2016 14:13

To: Matt Williams (projectclearwater.org<http://projectclearwater.org>) <matt at projectclearwater.org<mailto:matt at projectclearwater.org>>
Cc: clearwater at lists.projectclearwater.org<mailto:clearwater at lists.projectclearwater.org>
Subject: Re: [Project Clearwater] Clearwater Digest, Vol 40, Issue 24

Hi Matt,
Now for the numbers I have in Cassandra, at SP node, I am getting "SIP/2.0 504 Server Timeout"
2016-08-18      11:49:03:189    1471520943.189039: Aborting call on unexpected message for Call-Id '1073-27637 at 10.0.22.193<mailto:1073-27637 at 10.0.22.193>': while expecting '401' (index 3), received 'SIP/2.0 504 Server Timeout^M
Via: SIP/2.0/TCP 10.0.22.193:5060;rport=32939;received=10.0.22.193;branch=z9hG4bK-27637-1073-2-2010000854-^M
Record-Route: <sip:scscf.cwaio:5054;transport=TCP;lr;service=scscf;billing-role=charge-orig>^M
Call-ID: 2010000854///1073-27637 at 10.0.22.193<mailto:1073-27637 at 10.0.22.193>^M
From: <sip:2010000854 at example.com<mailto:sip%3A2010000854 at example.com>>;tag=27637SIPpTag001073^M
To: <sip:2010000854 at example.com<mailto:sip%3A2010000854 at example.com>>;tag=z9hG4bKPjuN16eRA0bDott9z6ZA-fwIYe3VA-KMkQ^M
CSeq: 1 REGISTER^M
Content-Length:  0^M
^M
'.
2016-08-18      11:49:04:185    1471520944.185945: Aborting call on unexpected message for Call-Id '1154-27637 at 10.0.22.193<mailto:1154-27637 at 10.0.22.193>': while expecting '401' (index 3), received 'SIP/2.0 504 Server Timeout^M
Via: SIP/2.0/TCP 10.0.22.193:5060;rport=32940;received=10.0.22.193;branch=z9hG4bK-27637-1154-2-2010000692-^M
Record-Route: <sip:scscf.cwaio:5054;transport=TCP;lr;service=scscf;billing-role=charge-orig>^M
Call-ID: 2010000692///1154-27637 at 10.0.22.193<mailto:1154-27637 at 10.0.22.193>^M
From: <sip:2010000692 at example.com<mailto:sip%3A2010000692 at example.com>>;tag=27637SIPpTag001154^M
To: <sip:2010000692 at example.com<mailto:sip%3A2010000692 at example.com>>;tag=z9hG4bKPjk-5lYhadbnX7rqNirT8tjwQdDjLAQo0j^M
CSeq: 1 REGISTER^M
Content-Length:  0^M

How do I know, stress tests are running properly? Can I see statistics such as memory usage, cpu time,  etc ?
Thanks
Kosala


On Thu, Aug 18, 2016 at 12:38 PM, Matt Williams (projectclearwater.org<http://projectclearwater.org>) <matt at projectclearwater.org<mailto:matt at projectclearwater.org>> wrote:
Kosala,

Thanks!  I'm very confused about your software version, though, as the latest all-in-one image has

?         crest 1.0-160811.103635 (i.e. older than yours)

?         homestead 1.0-160814.205535 (i.e. slightly newer than yours)

?         sprout 1.0-160814.205701 (i.e. much newer than yours)

?         the logging.bash script fix already applied.
It looks as though your might have taken the previous all-in-one image, and then upgraded some of the packages.  Please can you confirm: have you upgraded any packages?

On the issue you're seeing, I think you're saying that

?         you're running clearwater-sip-stress (which defaults to using numbers in the range above 2010000000)

?         you've deleted all these numbers from Homestead's Cassandra

?         you see errors in clearwater-sip-stress's log file saying that registration are failing with "404 Not Found".
I think this is expected - you need to provision numbers in Homestead's Cassandra that match the numbers that clearwater-sip-stress is expecting to register as.  Please let me know if I've misunderstood.

Thanks,

Matt

From: Kosala [mailto:kosalayb at gmail.com<mailto:kosalayb at gmail.com>]
Sent: 18 August 2016 11:46

To: Matt Williams (projectclearwater.org<http://projectclearwater.org>) <matt at projectclearwater.org<mailto:matt at projectclearwater.org>>
Subject: Re: [Project Clearwater] Clearwater Digest, Vol 40, Issue 24


Hi Matt,
I am running the latest version all-in-one which i downloaded from http://vm-images.cw-ngv.com/cw-aio.ova.

[cw-aio]ubuntu at cwaio:~$ sudo dpkg-query -s crest
[sudo] password for ubuntu:
Package: crest
Status: install ok installed
Priority: optional
Section: network
Installed-Size: 40102
Maintainer: Project Clearwater Maintainers <maintainers at projectclearwater.org<mailto:maintainers at projectclearwater.org>>
Architecture: amd64
Version: 1.0-160818.091648
homestead
Version: 1.0-160812.164051
sprout
Version: 1.0-160726.101022
And one strange thing is:
I deleted all the records in tables from homestead_cache and homestead_provisioning. Then when I check the SIP node for logs, sip-stress_14320_errors.log still has records with sip: ids which are not in Cassandra. For example, sip:2010021460 at example.com<mailto:sip%3A2010021460 at example.com>
2016-08-18      10:26:08:288    1471515968.288189: Aborting call on unexpected message for Call-Id '4270-14320 at 10.0.22.193<mailto:4270-14320 at 10.0.22.193>': while expecting '401' (index 3), received 'SIP/2.0 404 Not Found^M
Via: SIP/2.0/TCP 10.0.22.193:5060;rport=35233;received=10.0.22.193;branch=z9hG4bK-14320-4270-2-2010021460-^M
Record-Route: <sip:scscf.cwaio:5054;transport=TCP;lr;service=scscf;billing-role=charge-orig>^M
Call-ID: 2010021460///4270-14320 at 10.0.22.193<mailto:4270-14320 at 10.0.22.193>^M
From: <sip:2010021460 at example.com<mailto:sip%3A2010021460 at example.com>>;tag=14320SIPpTag004270^M
To: <sip:2010021460 at example.com<mailto:sip%3A2010021460 at example.com>>;tag=z9hG4bKPjVe2he9j28lou.0Dl9NmKGS7ypUMLjMJv^M
CSeq: 1 REGISTER^M
Content-Length:  0^M
Thanks
Kosala

On Thu, Aug 18, 2016 at 10:47 AM, Matt Williams (projectclearwater.org<http://projectclearwater.org>) <matt at projectclearwater.org<mailto:matt at projectclearwater.org>> wrote:
Kosala,

The fix is not to copy this to /usr/share/clearwater/utils, but to move it.  However, since the error is benign, I'd suggest just ignoring it while we get this working.

As I asked below, please can you confirm what version you're running?  I'm concerned that it's going to be very hard to troubleshoot problems if you have an all-in-one image from a few weeks ago, with some packages updated to more recent versions and then some further fixes manually applied.

Thanks,

Matt


From: Kosala [mailto:kosalayb at gmail.com<mailto:kosalayb at gmail.com>]
Sent: 18 August 2016 10:34

To: Matt Williams (projectclearwater.org<http://projectclearwater.org>) <matt at projectclearwater.org<mailto:matt at projectclearwater.org>>
Cc: clearwater at lists.projectclearwater.org<mailto:clearwater at lists.projectclearwater.org>
Subject: Re: [Project Clearwater] Clearwater Digest, Vol 40, Issue 24

Hi Matt,
Yeah, Manual calls are working fine.
As it is said in the big fix, https://github.com/Metaswitch/clearwater-infrastructure/issues/355 , I copied logging.bash to /usr/share/clearwater/utils
but I am still getting

/etc/init.d/clearwater-infrastructure: 76: /etc/init.d/clearwater-infrastructure: /usr/share/clearwater/infrastructure/scripts/logging.bash: Permission denied
Configuring monit for only localhost access
Kosala


On Thu, Aug 18, 2016 at 10:01 AM, Matt Williams (projectclearwater.org<http://projectclearwater.org>) <matt at projectclearwater.org<mailto:matt at projectclearwater.org>> wrote:
Kosala,

Yes, it's https://github.com/Metaswitch/clearwater-infrastructure/issues/355 and it should be benign.

However, this was fixed about 2 weeks ago.  Please can you confirm when you downloaded the all-in-one image, and whether you've upgraded it all?  (As I observed earlier, your crest release was from only a few days ago.)

Have you got manual calls working?

Thanks,

Matt


From: Kosala [mailto:kosalayb at gmail.com<mailto:kosalayb at gmail.com>]
Sent: 18 August 2016 09:56
To: Matt Williams (projectclearwater.org<http://projectclearwater.org>) <matt at projectclearwater.org<mailto:matt at projectclearwater.org>>
Cc: clearwater at lists.projectclearwater.org<mailto:clearwater at lists.projectclearwater.org>

Subject: Re: [Project Clearwater] Clearwater Digest, Vol 40, Issue 24

Hi Matt,
In SIP node, when I am trying to execute "sudo service clearwater-sip-stress restart", I am getting an error

/etc/init.d/clearwater-infrastructure: 76: /etc/init.d/clearwater-infrastructure: /usr/share/clearwater/infrastructure/scripts/logging.bash: Permission denied
Configuring monit for only localhost access
Any clue about this error?
Thanks
Kosala


On Wed, Aug 17, 2016 at 2:29 PM, Matt Williams (projectclearwater.org<http://projectclearwater.org>) <matt at projectclearwater.org<mailto:matt at projectclearwater.org>> wrote:
Kosala,

Yes, that's the correct screen, and you're correct that it shows that stress is being attempted but failing.

Do regular (non-stress) calls work through this deployment?

You can look at what message the stress node is receiving in the log files in the /var/log/clearwater-sip-stress/ directory - I think there are "errors" logs that contain the unexpected messages.

You can obviously also look at what's happening on the all-in-one node itself, using the /var/log/bono/*, /var/log/sprout/* and /var/log/homestead/* files, as described at http://clearwater.readthedocs.io/en/latest/Troubleshooting_and_Recovery.html.

I hope that helps.

Cheers,

Matt

From: Kosala [mailto:kosalayb at gmail.com<mailto:kosalayb at gmail.com>]
Sent: 17 August 2016 14:20

To: Matt Williams (projectclearwater.org<http://projectclearwater.org>) <matt at projectclearwater.org<mailto:matt at projectclearwater.org>>
Subject: Re: [Project Clearwater] Clearwater Digest, Vol 40, Issue 24

Hi Matt,
I can see this scenario screen from sip-stress.1.out. I hope this will be the stress test output results.

------------------------------ Scenario Screen -------- [1-9]: Change Screen --
     Users (length)   Port   Total-time  Total-calls  Remote-host
        2500 (0 ms)   5060      77.15 s         2500  10.0.21.192:5060(TCP)

  Call limit reached (-m 2500), 1.002 s period  1 ms scheduler resolution
  2175 calls (limit 2500)                Peak was 2499 calls, after 0 s
  0 Running, 2177 Paused, 8 Woken up
  0 dead call msg (discarded)            0 out-of-call msg (discarded)
  3 open sockets

                                 Messages  Retrans   Timeout   Unexpected-Msg
       Pause [0ms/10:00]         2500                          0
    REGISTER ---------->         326       0
         401 <----------         0         0         0         325
    REGISTER ---------->         0         0
         200 <----------         0         0         0         0
    REGISTER ---------->         0         0
         401 <----------         0         0         0         0
    REGISTER ---------->         0         0
         200 <----------         0         0         0         0
       Pause [     4:50]         0                             0
    REGISTER ---------->  B-RTD1 0         0
         200 <----------  E-RTD1 0         0         0         0
    REGISTER ---------->  B-RTD1 0         0
         200 <----------  E-RTD1 0         0         0         0
       Pause [     4:50]         0                             0
       Pause [$pre_call_delay]   0                             0
      INVITE ---------->  B-RTD2 0         0
         100 <----------         0         0         0         0
      INVITE <----------         0         0         0         0
         100 <----------         0         0         0         0
      INVITE <----------         0         0         0         0
         100 ---------->         0         0
         180 ---------->         0         0
         180 <----------         0         0         0         0
       Pause [   6000ms]         0                             0
         200 ---------->         0         0
         200 <----------         0         0         0         0
         ACK ---------->         0         0
         ACK <----------         0         0         0         0
      UPDATE ---------->         0         0
      UPDATE <----------         0         0         0         0
         200 ---------->         0         0
         200 <----------  E-RTD2 0         0         0         0
       Pause [    24.0s]         0                             0
         BYE ---------->  B-RTD3 0         0
         BYE <----------         0         0         0         0
         200 ---------->         0         0
         200 <----------  E-RTD3 0         0         0         0
       Pause [$post_call_delay]  0                             0
------- Waiting for active calls to end. Press [q] again to force exit. -------
Last Error: Aborting call on unexpected message for Call-Id '1079-13729 at ...
However there is an unexpected message error at the end.
Thanks
Kosala


On Wed, Aug 17, 2016 at 12:40 PM, Matt Williams (projectclearwater.org<http://projectclearwater.org>) <matt at projectclearwater.org<mailto:matt at projectclearwater.org>> wrote:
Kosala,

They should log to /var/log/clearwater-sip-stress - in particular, the *.1.out file is a log of the output from sipp.  Do you see anything there?

Matt

From: Kosala [mailto:kosalayb at gmail.com<mailto:kosalayb at gmail.com>]
Sent: 17 August 2016 12:33
To: Matt Williams (projectclearwater.org<http://projectclearwater.org>) <matt at projectclearwater.org<mailto:matt at projectclearwater.org>>; clearwater at lists.projectclearwater.org<mailto:clearwater at lists.projectclearwater.org>

Subject: Re: [Project Clearwater] Clearwater Digest, Vol 40, Issue 24

Hi Matt,
I followed above steps and run sudo apt-get install clearwater-sip-stress.
How do I know stress tests are running? Is is said, stress tests start automatically but I cannot see it.
Thanks
Kosala



On Tue, Aug 16, 2016 at 2:01 PM, Matt Williams (projectclearwater.org<http://projectclearwater.org>) <matt at projectclearwater.org<mailto:matt at projectclearwater.org>> wrote:
Kosala,

I'm glad you've made progress on this.

I had a look at the crest package version, but it seems to be later than the most recent all-in-one image uses (1.0-160811.103635).  When did you download the all-in-one image, and did you apply any patches to it?

Regarding making calls for stress testing, this is where http://clearwater.readthedocs.io/en/latest/Clearwater_stress_testing.html#manual-i-e-non-chef-stress-runs comes in - you need to

?         create a separate VM

?         set the bono_hostname and count parameters in /etc/clearwater/shared_config

?         install the clearwater-sip-stress package.
I hope that helps.

BTW, please remember to copy in clearwater at lists.projectclearwater.org<mailto:clearwater at lists.projectclearwater.org> - that means that other people can see and comment on your posts.

Thanks,

Matt


From: Kosala [mailto:kosalayb at gmail.com<mailto:kosalayb at gmail.com>]
Sent: 16 August 2016 10:48
To: Matt Williams (projectclearwater.org<http://projectclearwater.org>) <matt at projectclearwater.org<mailto:matt at projectclearwater.org>>
Subject: Re: [Project Clearwater] Clearwater Digest, Vol 40, Issue 24

Hi Matt,
Bulk provisioning for all in one image is done using https://github.com/Metaswitch/crest/blob/dev/docs/Bulk-Provisioning%20Numbers.md.
I have records in tables in homestead_cache and homer.
Now How to make calls for stress testing?
Is there any guideline?
Many Thanks,
Kosala




On Tue, Aug 16, 2016 at 9:04 AM, Kosala <kosalayb at gmail.com<mailto:kosalayb at gmail.com>> wrote:
Hi Matt,
TBH, The document in https://github.com/Metaswitch/crest/blob/dev/docs/Bulk-Provisioning%20Numbers.md is not clear to me.
Step 1. Homestead node in deployment. I do not know where is that node in all in one image. It will be helpful the location of that folder from the root.
Step 2. A simple example will be helpful.
Thanks
Kosala


On Tue, Aug 16, 2016 at 8:50 AM, Kosala <kosalayb at gmail.com<mailto:kosalayb at gmail.com>> wrote:
Hi Matt,
I downloaded the all in one package from http://clearwater.readthedocs.io/en/stable/All_in_one_OVF_Installation.html
and imported using oracle virtual box on ubuntu 14.04,
Crest version
[cw-aio]ubuntu at cwaio:~$ sudo dpkg-query -s crest
Package: crest
Status: install ok installed
Priority: optional
Section: network
Installed-Size: 40098
Maintainer: Project Clearwater Maintainers <maintainers at projectclearwater.org<mailto:maintainers at projectclearwater.org>>
Architecture: amd64
Version: 1.0-160815.145007
Thanks
Kosala


On Mon, Aug 15, 2016 at 5:56 PM, Matt Williams (projectclearwater.org<http://projectclearwater.org>) <matt at projectclearwater.org<mailto:matt at projectclearwater.org>> wrote:
Kosala,

That's odd - I don't see that failure on my all-in-one image (spun up just now from the latest image) - which version of all-in-one-image are you running, and which version of crest does it include ("sudo dpkg-query -s crest")?

You may be able to work-around this either by taking the latest all-in-one image or by following the simpler bulk-provisioning process at https://github.com/Metaswitch/crest/blob/dev/docs/Bulk-Provisioning%20Numbers.md (when this doc talks about using the sstables_provisioning process for very large sets of numbers, we mean 1M+ numbers - the 9000 you're provisioning are well within the capabilities of this process).

I hope that helps - please let me know how you get on.

Cheers,

Matt


From: Clearwater [mailto:clearwater-bounces at lists.projectclearwater.org<mailto:clearwater-bounces at lists.projectclearwater.org>] On Behalf Of Kosala
Sent: 15 August 2016 16:58
To: clearwater at lists.projectclearwater.org<mailto:clearwater at lists.projectclearwater.org>
Subject: Re: [Project Clearwater] Clearwater Digest, Vol 40, Issue 24

HI Matt,
Thanks.

I am trying to follow https://github.com/Metaswitch/crest/blob/dev/src/metaswitch/crest/tools/sstable_provisioning/README.md for bulk provisioning.

When I am trying to execute sudo ./BulkProvision homer 21000 29999 example.com<http://example.com> 7kkzTyGW in all-in-one image,
I am getting an error  java.lang.UnsupportedClassVersionError: ClearwaterBulkProvisioner : Unsupported major.minor version 52.0
Java version info in all-in-one image:
[cw-aio]ubuntu at cwaio:/usr/share/clearwater/crest/tools/sstable_provisioning$ java -version
java version "1.7.0_101"
OpenJDK Runtime Environment (IcedTea 2.6.6) (7u101-2.6.6-0ubuntu0.14.04.1)
OpenJDK 64-Bit Server VM (build 24.95-b01, mixed mode)
Thanks
Kosala



On Mon, Aug 15, 2016 at 2:17 PM, <clearwater-request at lists.projectclearwater.org<mailto:clearwater-request at lists.projectclearwater.org>> wrote:
Send Clearwater mailing list submissions to
        clearwater at lists.projectclearwater.org<mailto:clearwater at lists.projectclearwater.org>

To subscribe or unsubscribe via the World Wide Web, visit
        http://lists.projectclearwater.org/mailman/listinfo/clearwater_lists.projectclearwater.org

or, via email, send a message with subject or body 'help' to
        clearwater-request at lists.projectclearwater.org<mailto:clearwater-request at lists.projectclearwater.org>

You can reach the person managing the list at
        clearwater-owner at lists.projectclearwater.org<mailto:clearwater-owner at lists.projectclearwater.org>

When replying, please edit your Subject line so it is more specific
than "Re: Contents of Clearwater digest..."


Today's Topics:

   1. Stress Testing (Kosala)
   2. Re: Stress Testing (Matt Williams (projectclearwater.org<http://projectclearwater.org>))
   3. Re: Stress Testing (Matt Williams (projectclearwater.org<http://projectclearwater.org>))


----------------------------------------------------------------------

Message: 1
Date: Mon, 15 Aug 2016 10:38:57 +0100
From: Kosala <kosalayb at gmail.com<mailto:kosalayb at gmail.com>>
To: clearwater at lists.projectclearwater.org<mailto:clearwater at lists.projectclearwater.org>
Subject: [Project Clearwater] Stress Testing
Message-ID:
        <CAGEe17an2B_bGj8NfKFwms+nU=vJURyhT5CE+mcY1pjcm4YF+A at mail.gmail.com<mailto:vJURyhT5CE%2BmcY1pjcm4YF%2BA at mail.gmail.com>>
Content-Type: text/plain; charset="utf-8"

Hi Team,

I installed clearwater "all-in-one" image on Oracle Virtual Box.
1. Can I do stress testing ?
2. How to do that?

I am trying to follow Stress Testing on
http://clearwater.readthedocs.io/en/stable/Clearwater_stress_testing.html#configuring-udp-stress
.

Using chef - > It seems chef/knife install only supports in the Cloud
approach (The automated install is only supported for deployments running
in Amazon?s EC2 cloud).

Manual approach, It looks not supporting all in one image.

Many Thanks
Kosala
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.projectclearwater.org/pipermail/clearwater_lists.projectclearwater.org/attachments/20160815/15fc3b07/attachment-0001.html>

------------------------------

Message: 2
Date: Mon, 15 Aug 2016 09:54:02 +0000
From: "Matt Williams (projectclearwater.org<http://projectclearwater.org>)"
        <matt at projectclearwater.org<mailto:matt at projectclearwater.org>>
To: Kosala <kosalayb at gmail.com<mailto:kosalayb at gmail.com>>
Cc: "clearwater at lists.projectclearwater.org<mailto:clearwater at lists.projectclearwater.org>"
        <clearwater at lists.projectclearwater.org<mailto:clearwater at lists.projectclearwater.org>>
Subject: Re: [Project Clearwater] Stress Testing
Message-ID:
        <CY1PR0201MB15636F1F20EB91BB180F053390120 at CY1PR0201MB1563.namprd02.prod.outlook.com<mailto:CY1PR0201MB15636F1F20EB91BB180F053390120 at CY1PR0201MB1563.namprd02.prod.outlook.com>>

Content-Type: text/plain; charset="utf-8"

Kosala,

While it's theoretically possible to do stress testing against an all-in-one image, I'd recommend against it - the all-in-one image has been squeezed down a lot to fit on a single VM and we'd expect very low performance out of it, and I could believe that overload behavior might be suboptimal.  If you're looking to stress test for performance reasons, I'd strongly recommend running a full deployment as this will give you much more reliable numbers.  If you're looking to stress test for other reasons, please can you share a bit more about what you're trying to achieve, and we can have a think about what would work best?

If you do really want to run stress testing against an all-in-one image, it should probably work, even though http://clearwater.readthedocs.io/en/latest/Clearwater_stress_testing.html#manual-i-e-non-chef-stress-runs only talks about Chef and manual installs.  You'd need to set the "bono_servers" option in /etc/clearwater/shared_config to point to your all-in-one node, and I suspect you'd need to reduce the "count" option to something a lot lower - I'd start around 5000 and see how that goes.

I hope that helps.  Please let me know how you get on.

Thanks,

Matt

From: Clearwater [mailto:clearwater-bounces at lists.projectclearwater.org<mailto:clearwater-bounces at lists.projectclearwater.org>] On Behalf Of Kosala
Sent: 15 August 2016 10:39
To: clearwater at lists.projectclearwater.org<mailto:clearwater at lists.projectclearwater.org>
Subject: [Project Clearwater] Stress Testing

Hi Team,
I installed clearwater "all-in-one" image on Oracle Virtual Box.
1. Can I do stress testing ?
2. How to do that?
I am trying to follow Stress Testing on http://clearwater.readthedocs.io/en/stable/Clearwater_stress_testing.html#configuring-udp-stress.
Using chef - > It seems chef/knife install only supports in the Cloud approach (The automated install is only supported for deployments running in Amazon?s EC2 cloud).
Manual approach, It looks not supporting all in one image.
Many Thanks
Kosala

-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.projectclearwater.org/pipermail/clearwater_lists.projectclearwater.org/attachments/20160815/29d6328d/attachment-0001.html>

------------------------------

Message: 3
Date: Mon, 15 Aug 2016 13:16:47 +0000
From: "Matt Williams (projectclearwater.org<http://projectclearwater.org>)"
        <matt at projectclearwater.org<mailto:matt at projectclearwater.org>>
To: "clearwater at lists.projectclearwater.org<mailto:clearwater at lists.projectclearwater.org>"
        <clearwater at lists.projectclearwater.org<mailto:clearwater at lists.projectclearwater.org>>
Subject: Re: [Project Clearwater] Stress Testing
Message-ID:
        <CY1PR0201MB156372246DC5A77B11839F9D90120 at CY1PR0201MB1563.namprd02.prod.outlook.com<mailto:CY1PR0201MB156372246DC5A77B11839F9D90120 at CY1PR0201MB1563.namprd02.prod.outlook.com>>

Content-Type: text/plain; charset="utf-8"

Kosala,

You'll need to follow all the steps in http://clearwater.readthedocs.io/en/latest/Clearwater_stress_testing.html#manual-i-e-non-chef-stress-runs, i.e. bulk provisioning subscribers and installing clearwater-sip-stress, but that should be it.

Just to be clear, though, you'll need to set the configuration and install the clearwater-sip-stress package on a separate VM, not on the all-in-one image itself - the all-in-one image almost certainly opens up ports that conflict with those that clearwater-sip-stress tries to use.

This isn't a very well-trodden path, though, so you may hit further issues - let me know if so, and we can try to work through them.

Cheers,

Matt

From: Kosala [mailto:kosalayb at gmail.com<mailto:kosalayb at gmail.com>]
Sent: 15 August 2016 13:41
To: Matt Williams (projectclearwater.org<http://projectclearwater.org>) <matt at projectclearwater.org<mailto:matt at projectclearwater.org>>
Subject: Re: [Project Clearwater] Stress Testing

Hi Matt,
Thanks. I set the bono_servers option. Should I add count =5000 to /etc/clearwater/shared_config ?

Do I need other changes to run stress tests on all-in-one image?
Thanks
Kosala



On Mon, Aug 15, 2016 at 10:54 AM, Matt Williams (projectclearwater.org<http://projectclearwater.org><http://projectclearwater.org>) <matt at projectclearwater.org<mailto:matt at projectclearwater.org><mailto:matt at projectclearwater.org<mailto:matt at projectclearwater.org>>> wrote:
Kosala,

While it's theoretically possible to do stress testing against an all-in-one image, I'd recommend against it - the all-in-one image has been squeezed down a lot to fit on a single VM and we'd expect very low performance out of it, and I could believe that overload behavior might be suboptimal.  If you're looking to stress test for performance reasons, I'd strongly recommend running a full deployment as this will give you much more reliable numbers.  If you're looking to stress test for other reasons, please can you share a bit more about what you're trying to achieve, and we can have a think about what would work best?

If you do really want to run stress testing against an all-in-one image, it should probably work, even though http://clearwater.readthedocs.io/en/latest/Clearwater_stress_testing.html#manual-i-e-non-chef-stress-runs only talks about Chef and manual installs.  You'd need to set the "bono_servers" option in /etc/clearwater/shared_config to point to your all-in-one node, and I suspect you'd need to reduce the "count" option to something a lot lower - I'd start around 5000 and see how that goes.

I hope that helps.  Please let me know how you get on.

Thanks,

Matt

From: Clearwater [mailto:clearwater-bounces at lists.projectclearwater.org<mailto:clearwater-bounces at lists.projectclearwater.org><mailto:clearwater-bounces at lists.projectclearwater.org<mailto:clearwater-bounces at lists.projectclearwater.org>>] On Behalf Of Kosala
Sent: 15 August 2016 10:39
To: clearwater at lists.projectclearwater.org<mailto:clearwater at lists.projectclearwater.org><mailto:clearwater at lists.projectclearwater.org<mailto:clearwater at lists.projectclearwater.org>>
Subject: [Project Clearwater] Stress Testing

Hi Team,
I installed clearwater "all-in-one" image on Oracle Virtual Box.
1. Can I do stress testing ?
2. How to do that?
I am trying to follow Stress Testing on http://clearwater.readthedocs.io/en/stable/Clearwater_stress_testing.html#configuring-udp-stress.
Using chef - > It seems chef/knife install only supports in the Cloud approach (The automated install is only supported for deployments running in Amazon?s EC2 cloud).
Manual approach, It looks not supporting all in one image.
Many Thanks
Kosala


-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.projectclearwater.org/pipermail/clearwater_lists.projectclearwater.org/attachments/20160815/11781755/attachment.html>

------------------------------

Subject: Digest Footer

_______________________________________________
Clearwater mailing list
Clearwater at lists.projectclearwater.org<mailto:Clearwater at lists.projectclearwater.org>
http://lists.projectclearwater.org/mailman/listinfo/clearwater_lists.projectclearwater.org


------------------------------

End of Clearwater Digest, Vol 40, Issue 24
******************************************












-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.projectclearwater.org/pipermail/clearwater_lists.projectclearwater.org/attachments/20160818/c9cd08a1/attachment.html>

From kosalayb at gmail.com  Thu Aug 18 12:01:08 2016
From: kosalayb at gmail.com (Kosala)
Date: Thu, 18 Aug 2016 17:01:08 +0100
Subject: [Project Clearwater] Clearwater Digest, Vol 40, Issue 24
In-Reply-To: <CY1PR0201MB1563812CC87CB72B96D296A190150@CY1PR0201MB1563.namprd02.prod.outlook.com>
References: <mailman.20.1471267072.11502.clearwater_lists.projectclearwater.org@lists.projectclearwater.org>
	<CAGEe17ZLnypQfbzxEwxj9EaB20MUBVpY+YdN-Obv=gHpZmG0KA@mail.gmail.com>
	<CY1PR0201MB1563F9A706F3EC7BE7F9C11590120@CY1PR0201MB1563.namprd02.prod.outlook.com>
	<CAGEe17bfTu1Kpwx=ipqtEbShvWtP+C6pJEEGHi0GSwBR5Dqw8w@mail.gmail.com>
	<CAGEe17aY077tLtotRe1X8k1qU_4otBdHDMJjqDH_g02Zs676Jg@mail.gmail.com>
	<CAGEe17ZeNPPy7AmMz=LCWnHqLm=v9Q7CuLT+AOVKWJTdg8m7Eg@mail.gmail.com>
	<CY1PR0201MB1563CE17983225B985B19D7390130@CY1PR0201MB1563.namprd02.prod.outlook.com>
	<CAGEe17b2M2uqvbOuqH7t4xM41FbfBYk0xR3zWqiFh+EkSfUzUQ@mail.gmail.com>
	<CY1PR0201MB1563CD5DDDD6E7B5A0B2DB7290140@CY1PR0201MB1563.namprd02.prod.outlook.com>
	<CAGEe17YGnaY1Kqc65gyiVO1sBBuTx=-YzfD9HY3M6QBD2t9AkA@mail.gmail.com>
	<CY1PR0201MB156349F26A0A7670BE7382A890140@CY1PR0201MB1563.namprd02.prod.outlook.com>
	<CAGEe17ZkY2ESNzwQYddrv6=jUJ5fPHu3gJXT7R1UjQmBd+eFUg@mail.gmail.com>
	<CY1PR0201MB1563C979B2D641DA59F1945A90150@CY1PR0201MB1563.namprd02.prod.outlook.com>
	<CAGEe17bC+xmhP3D7w768r0svzBAxdBedVXhis1Z33Yqdq4THgA@mail.gmail.com>
	<CY1PR0201MB1563F865DFBF86128118AC5290150@CY1PR0201MB1563.namprd02.prod.outlook.com>
	<CAGEe17Z2wBvTgPrnK_TdQPerVE9Moxnt=u9CWPpq8V04GJtfUw@mail.gmail.com>
	<CY1PR0201MB1563A30C3B9C4D8EE65FAD4390150@CY1PR0201MB1563.namprd02.prod.outlook.com>
	<CAGEe17ZVrag9yFkLgPF-kfgDPDT_nJETkei_Uwv47mohbAwyxg@mail.gmail.com>
	<CY1PR0201MB156325107DAA32BF9480667B90150@CY1PR0201MB1563.namprd02.prod.outlook.com>
	<CAGEe17bWEkdYazAcTOTq2+7kxwR=yYx04MT-QzjsHQ5HWPAD5Q@mail.gmail.com>
	<CY1PR0201MB15630493B218F47026930AF490150@CY1PR0201MB1563.namprd02.prod.outlook.com>
	<CAGEe17YcA6fMx-gL8H_h4MUFmsOGYA7O3N+nYjJ83BYz6SgrPQ@mail.gmail.com>
	<CY1PR0201MB1563812CC87CB72B96D296A190150@CY1PR0201MB1563.namprd02.prod.outlook.com>
Message-ID: <CAGEe17adwdk2ybxRAfE=fDf79wnha4U964TxxejyPyiJVnp05w@mail.gmail.com>

Hi Matt,

Thanks. I will try.

In stress testing, can i stop stress testing after testing for a fixed
number. for example after 20 numbers ?. It seems stress testing is
continuously running.
If I set count to 5, it will run 0 to 5, then again 0 to 5. I am not sure
if i am right?

Thanks
Kosala


On Thu, Aug 18, 2016 at 4:44 PM, Matt Williams (projectclearwater.org) <
matt at projectclearwater.org> wrote:

> Kosala,
>
>
>
> In that case, I would suggest
>
> ?         stopping stress
>
> ?         turning on debug logging and restarting bono and sprout - see
> http://clearwater.readthedocs.io/en/latest/Troubleshooting_
> and_Recovery.html for details on how to do this
>
> ?         making a manual call, and gathering the /var/log/bono/bono*.txt
> and /var/log/sprout/sprout*.txt
>
> ?         lowering your stress load even lower (maybe down to 10) by
> changing the "count" option
>
> ?         running stress until you see the traffic appear in
> /var/log/bono/bono*.txt and /var/log/sprout/sprout*.txt, then stopping
> stress and gathering these log files again.
>
>
>
> Hopefully, the log files will tell you what's going wrong.
>
>
>
> If you can't see the problem, please share *both* the working and failed
> logs with me, along with the time at which you ran the tests.
>
>
>
> Thanks,
>
> Matt
>
>
>
> *From:* Kosala [mailto:kosalayb at gmail.com]
> *Sent:* 18 August 2016 16:26
> *To:* Matt Williams (projectclearwater.org) <matt at projectclearwater.org>
> *Cc:* clearwater at lists.projectclearwater.org
> *Subject:* Re: [Project Clearwater] Clearwater Digest, Vol 40, Issue 24
>
>
>
> No I am getting server Timeout
>
> sipp: The following events occured:
> 2016-08-18      15:22:10:886    1471533730.886591: Aborting call on
> unexpected message for Call-Id '2-16183 at 10.0.22.193': while expecting
> '401' (index 3), received 'SIP/2.0 504 Server Timeout^M
> Via: SIP/2.0/TCP 10.0.22.193:5060;rport=9471;received=10.0.22.193;branch=
> z9hG4bK-16183-2-2-2010000096-^M
> Record-Route: <sip:scscf.cwaio:5054;transport=TCP;lr;service=
> scscf;billing-role=charge-orig>^M
> Call-ID: 2010000096///2-16183 at 10.0.22.193^M
> From: <sip:2010000096 at example.com>;tag=16183SIPpTag002^M
> To: <sip:2010000096 at example.com>;tag=z9hG4bKPjmTtF24BomE1irtWVZnxim
> 6jKcUfYxxow^M
> CSeq: 1 REGISTER^M
> Content-Length:  0^M
> ^M
> '.
> 2016-08-18      15:22:14:043    1471533734.043867: Aborting call on
> unexpected message for Call-Id '23-16183 at 10.0.22.193': while expecting
> '401' (index 3), received 'SIP/2.0 504 Server Timeout^M
> Via: SIP/2.0/TCP 10.0.22.193:5060;rport=9480;received=10.0.22.193;branch=
> z9hG4bK-16183-23-2-2010000054-^M
> Record-Route: <sip:scscf.cwaio:5054;transport=TCP;lr;service=
> scscf;billing-role=charge-orig>^M
> Call-ID: 2010000054///23-16183 at 10.0.22.193^M
> From: <sip:2010000054 at example.com>;tag=16183SIPpTag0023^M
> To: <sip:2010000054 at example.com>;tag=z9hG4bKPjGLvFZz93Nq8VVQLuNznXD
> dHoOn3ILBWs^M
> CSeq: 1 REGISTER^M
> Content-Length:  0^M
> ^M
>
> Kosala
>
>
>
>
>
>
>
> On Thu, Aug 18, 2016 at 3:53 PM, Matt Williams (projectclearwater.org) <
> matt at projectclearwater.org> wrote:
>
> Kosala,
>
>
>
> This is what the "count" option on the stress node controls (see
> http://clearwater.readthedocs.io/en/latest/Clearwater_
> stress_testing.html#manual-i-e-non-chef-stress-runs for details).  If you
> only want to make calls to/from the first 100 numbers, set this to 100.
>
>
>
> Are these calls going through successfully, then?
>
>
>
> Matt
>
>
>
> *From:* Kosala [mailto:kosalayb at gmail.com]
> *Sent:* 18 August 2016 15:20
> *To:* Matt Williams (projectclearwater.org) <matt at projectclearwater.org>
>
> *Cc:* clearwater at lists.projectclearwater.org
> *Subject:* Re: [Project Clearwater] Clearwater Digest, Vol 40, Issue 24
>
>
>
> Hi Matt,
>
> Thanks. SIP node is calling numbers in a larger range starting from 2010000000.
> Can I restrict SIP call invoke from
>
> 2010000000 to 2010000099?
>
> I can do bulk provision 100 numbers. I do not know how to restrict SIP
> node to call only these 100 numbers?
>
> Thanks
>
> Kosala
>
>
>
>
>
> On Thu, Aug 18, 2016 at 2:59 PM, Matt Williams (projectclearwater.org) <
> matt at projectclearwater.org> wrote:
>
> Kosala,
>
>
>
> The error you're seeing suggests that the request is timing out between
> Bono and Sprout.  This could be due to poor performance on the all-in-one
> node (as I said previously, the all-in-one node is not intended for running
> stress), or it could be due to a more general misconfiguration.  Are all
> REGISTERs failing, or just some?
>
>
>
> Regarding getting CPU statistics etc., we normally use Cacti.  There are
> instructions for setting this up at http://clearwater.readthedocs.
> io/en/latest/Cacti.html.  However, I doubt this will work as-is with your
> all-in-one node.  Since you only have one node, maybe you're best just
> looking at top?
>
>
>
> Matt
>
>
>
> *From:* Kosala [mailto:kosalayb at gmail.com]
> *Sent:* 18 August 2016 14:13
>
>
> *To:* Matt Williams (projectclearwater.org) <matt at projectclearwater.org>
> *Cc:* clearwater at lists.projectclearwater.org
> *Subject:* Re: [Project Clearwater] Clearwater Digest, Vol 40, Issue 24
>
>
>
> Hi Matt,
>
> Now for the numbers I have in Cassandra, at SP node, I am getting "SIP/2.0
> 504 Server Timeout"
>
> 2016-08-18      11:49:03:189    1471520943.189039: Aborting call on
> unexpected message for Call-Id '1073-27637 at 10.0.22.193': while expecting
> '401' (index 3), received 'SIP/2.0 504 Server Timeout^M
> Via: SIP/2.0/TCP 10.0.22.193:5060;rport=32939;received=10.0.22.193;branch=
> z9hG4bK-27637-1073-2-2010000854-^M
> Record-Route: <sip:scscf.cwaio:5054;transport=TCP;lr;service=
> scscf;billing-role=charge-orig>^M
> Call-ID: 2010000854///1073-27637 at 10.0.22.193^M
> From: <sip:2010000854 at example.com>;tag=27637SIPpTag001073^M
> To: <sip:2010000854 at example.com>;tag=z9hG4bKPjuN16eRA0bDott9z6ZA-
> fwIYe3VA-KMkQ^M
> CSeq: 1 REGISTER^M
> Content-Length:  0^M
> ^M
> '.
> 2016-08-18      11:49:04:185    1471520944.185945: Aborting call on
> unexpected message for Call-Id '1154-27637 at 10.0.22.193': while expecting
> '401' (index 3), received 'SIP/2.0 504 Server Timeout^M
> Via: SIP/2.0/TCP 10.0.22.193:5060;rport=32940;received=10.0.22.193;branch=
> z9hG4bK-27637-1154-2-2010000692-^M
> Record-Route: <sip:scscf.cwaio:5054;transport=TCP;lr;service=
> scscf;billing-role=charge-orig>^M
> Call-ID: 2010000692///1154-27637 at 10.0.22.193^M
> From: <sip:2010000692 at example.com>;tag=27637SIPpTag001154^M
> To: <sip:2010000692 at example.com>;tag=z9hG4bKPjk-
> 5lYhadbnX7rqNirT8tjwQdDjLAQo0j^M
> CSeq: 1 REGISTER^M
> Content-Length:  0^M
>
> How do I know, stress tests are running properly? Can I see statistics
> such as memory usage, cpu time,  etc ?
>
> Thanks
>
> Kosala
>
>
>
>
>
> On Thu, Aug 18, 2016 at 12:38 PM, Matt Williams (projectclearwater.org) <
> matt at projectclearwater.org> wrote:
>
> Kosala,
>
>
>
> Thanks!  I'm very confused about your software version, though, as the
> latest all-in-one image has
>
> ?         crest 1.0-160811.103635 (i.e. older than yours)
>
> ?         homestead 1.0-160814.205535 (i.e. slightly newer than yours)
>
> ?         sprout 1.0-160814.205701 (i.e. much newer than yours)
>
> ?         the logging.bash script fix already applied.
>
> It looks as though your might have taken the previous all-in-one image,
> and then upgraded some of the packages.  Please can you confirm: have you
> upgraded any packages?
>
>
>
> On the issue you're seeing, I think you're saying that
>
> ?         you're running clearwater-sip-stress (which defaults to using
> numbers in the range above 2010000000)
>
> ?         you've deleted all these numbers from Homestead's Cassandra
>
> ?         you see errors in clearwater-sip-stress's log file saying that
> registration are failing with "404 Not Found".
>
> I think this is expected - you need to provision numbers in Homestead's
> Cassandra that match the numbers that clearwater-sip-stress is expecting to
> register as.  Please let me know if I've misunderstood.
>
>
>
> Thanks,
>
>
>
> Matt
>
>
>
> *From:* Kosala [mailto:kosalayb at gmail.com]
> *Sent:* 18 August 2016 11:46
>
>
> *To:* Matt Williams (projectclearwater.org) <matt at projectclearwater.org>
> *Subject:* Re: [Project Clearwater] Clearwater Digest, Vol 40, Issue 24
>
>
>
>
>
> Hi Matt,
>
> I am running the latest version all-in-one which i downloaded from
> http://vm-images.cw-ngv.com/cw-aio.ova.
>
> [cw-aio]ubuntu at cwaio:~$ sudo dpkg-query -s crest
> [sudo] password for ubuntu:
> Package: crest
> Status: install ok installed
> Priority: optional
> Section: network
> Installed-Size: 40102
> Maintainer: Project Clearwater Maintainers <maintainers@
> projectclearwater.org>
> Architecture: amd64
> Version: 1.0-160818.091648
>
> homestead
> Version: 1.0-160812.164051
>
> sprout
> Version: 1.0-160726.101022
>
> And one strange thing is:
>
> I deleted all the records in tables from homestead_cache and
> homestead_provisioning. Then when I check the SIP node for logs,
> sip-stress_14320_errors.log still has records with sip: ids which are not
> in Cassandra. For example, sip:2010021460 at example.com
>
> 2016-08-18      10:26:08:288    1471515968.288189: Aborting call on
> unexpected message for Call-Id '4270-14320 at 10.0.22.193': while expecting
> '401' (index 3), received 'SIP/2.0 404 Not Found^M
> Via: SIP/2.0/TCP 10.0.22.193:5060;rport=35233;received=10.0.22.193;branch=
> z9hG4bK-14320-4270-2-2010021460-^M
> Record-Route: <sip:scscf.cwaio:5054;transport=TCP;lr;service=
> scscf;billing-role=charge-orig>^M
> Call-ID: 2010021460///4270-14320 at 10.0.22.193^M
> From: <sip:2010021460 at example.com>;tag=14320SIPpTag004270^M
> To: <sip:2010021460 at example.com>;tag=z9hG4bKPjVe2he9j28lou.
> 0Dl9NmKGS7ypUMLjMJv^M
> CSeq: 1 REGISTER^M
> Content-Length:  0^M
>
> Thanks
>
> Kosala
>
>
>
> On Thu, Aug 18, 2016 at 10:47 AM, Matt Williams (projectclearwater.org) <
> matt at projectclearwater.org> wrote:
>
> Kosala,
>
>
>
> The fix is not to *copy* this to /usr/share/clearwater/utils, but to
> *move* it.  However, since the error is benign, I'd suggest just ignoring
> it while we get this working.
>
>
>
> As I asked below, please can you confirm what version you're running?  I'm
> concerned that it's going to be very hard to troubleshoot problems if you
> have an all-in-one image from a few weeks ago, with some packages updated
> to more recent versions and then some further fixes manually applied.
>
>
>
> Thanks,
>
>
>
> Matt
>
>
>
>
>
> *From:* Kosala [mailto:kosalayb at gmail.com]
> *Sent:* 18 August 2016 10:34
>
>
> *To:* Matt Williams (projectclearwater.org) <matt at projectclearwater.org>
> *Cc:* clearwater at lists.projectclearwater.org
> *Subject:* Re: [Project Clearwater] Clearwater Digest, Vol 40, Issue 24
>
>
>
> Hi Matt,
>
> Yeah, Manual calls are working fine.
>
> As it is said in the big fix, https://github.com/Metaswitch/
> clearwater-infrastructure/issues/355 , I copied logging.bash to
> /usr/share/clearwater/utils
>
> but I am still getting
>
> /etc/init.d/clearwater-infrastructure: 76: /etc/init.d/clearwater-infrastructure:
> /usr/share/clearwater/infrastructure/scripts/logging.bash: Permission
> denied
> Configuring monit for only localhost access
>
> Kosala
>
>
>
>
>
> On Thu, Aug 18, 2016 at 10:01 AM, Matt Williams (projectclearwater.org) <
> matt at projectclearwater.org> wrote:
>
> Kosala,
>
>
>
> Yes, it's https://github.com/Metaswitch/clearwater-infrastructure/
> issues/355 and it should be benign.
>
>
>
> However, this was fixed about 2 weeks ago.  Please can you confirm when
> you downloaded the all-in-one image, and whether you've upgraded it all?
> (As I observed earlier, your crest release was from only a few days ago.)
>
>
>
> Have you got manual calls working?
>
>
>
> Thanks,
>
>
>
> Matt
>
>
>
>
>
> *From:* Kosala [mailto:kosalayb at gmail.com]
> *Sent:* 18 August 2016 09:56
> *To:* Matt Williams (projectclearwater.org) <matt at projectclearwater.org>
> *Cc:* clearwater at lists.projectclearwater.org
>
>
> *Subject:* Re: [Project Clearwater] Clearwater Digest, Vol 40, Issue 24
>
>
>
> Hi Matt,
>
> In SIP node, when I am trying to execute "sudo service
> clearwater-sip-stress restart", I am getting an error
>
>
> /etc/init.d/clearwater-infrastructure: 76: /etc/init.d/clearwater-infrastructure:
> /usr/share/clearwater/infrastructure/scripts/logging.bash: Permission
> denied
> Configuring monit for only localhost access
>
> Any clue about this error?
>
> Thanks
>
> Kosala
>
>
>
>
>
> On Wed, Aug 17, 2016 at 2:29 PM, Matt Williams (projectclearwater.org) <
> matt at projectclearwater.org> wrote:
>
> Kosala,
>
>
>
> Yes, that's the correct screen, and you're correct that it shows that
> stress is being attempted but failing.
>
>
>
> Do regular (non-stress) calls work through this deployment?
>
>
>
> You can look at what message the stress node is receiving in the log files
> in the /var/log/clearwater-sip-stress/ directory - I think there are
> "errors" logs that contain the unexpected messages.
>
>
>
> You can obviously also look at what's happening on the all-in-one node
> itself, using the /var/log/bono/*, /var/log/sprout/* and
> /var/log/homestead/* files, as described at http://clearwater.readthedocs.
> io/en/latest/Troubleshooting_and_Recovery.html.
>
>
>
> I hope that helps.
>
>
>
> Cheers,
>
>
>
> Matt
>
>
>
> *From:* Kosala [mailto:kosalayb at gmail.com]
> *Sent:* 17 August 2016 14:20
>
>
> *To:* Matt Williams (projectclearwater.org) <matt at projectclearwater.org>
> *Subject:* Re: [Project Clearwater] Clearwater Digest, Vol 40, Issue 24
>
>
>
> Hi Matt,
>
> I can see this scenario screen from sip-stress.1.out. I hope this will be
> the stress test output results.
>
>
> ------------------------------ Scenario Screen -------- [1-9]: Change
> Screen --
>      Users (length)   Port   Total-time  Total-calls  Remote-host
>         2500 (0 ms)   5060      77.15 s         2500  10.0.21.192:5060
> (TCP)
>
>   Call limit reached (-m 2500), 1.002 s period  1 ms scheduler resolution
>   2175 calls (limit 2500)                Peak was 2499 calls, after 0 s
>   0 Running, 2177 Paused, 8 Woken up
>   0 dead call msg (discarded)            0 out-of-call msg
> (discarded)
>   3 open sockets
>
>                                  Messages  Retrans   Timeout
> Unexpected-Msg
>        Pause [0ms/10:00]         2500                          0
>     REGISTER ---------->         326       0
>          401 <----------         0         0         0         325
>     REGISTER ---------->         0         0
>          200 <----------         0         0         0         0
>     REGISTER ---------->         0         0
>          401 <----------         0         0         0         0
>     REGISTER ---------->         0         0
>          200 <----------         0         0         0         0
>        Pause [     4:50]         0                             0
>     REGISTER ---------->  B-RTD1 0         0
>          200 <----------  E-RTD1 0         0         0         0
>     REGISTER ---------->  B-RTD1 0         0
>          200 <----------  E-RTD1 0         0         0         0
>        Pause [     4:50]         0                             0
>        Pause [$pre_call_delay]   0                             0
>       INVITE ---------->  B-RTD2 0         0
>          100 <----------         0         0         0         0
>       INVITE <----------         0         0         0         0
>          100 <----------         0         0         0         0
>       INVITE <----------         0         0         0         0
>          100 ---------->         0         0
>          180 ---------->         0         0
>          180 <----------         0         0         0         0
>        Pause [   6000ms]         0                             0
>          200 ---------->         0         0
>          200 <----------         0         0         0         0
>          ACK ---------->         0         0
>          ACK <----------         0         0         0         0
>       UPDATE ---------->         0         0
>       UPDATE <----------         0         0         0         0
>          200 ---------->         0         0
>          200 <----------  E-RTD2 0         0         0         0
>        Pause [    24.0s]         0                             0
>          BYE ---------->  B-RTD3 0         0
>          BYE <----------         0         0         0         0
>          200 ---------->         0         0
>          200 <----------  E-RTD3 0         0         0         0
>        Pause [$post_call_delay]  0                             0
> ------- Waiting for active calls to end. Press [q] again to force exit.
> -------
> Last Error: Aborting call on unexpected message for Call-Id '1079-13729@
> ...
>
> However there is an unexpected message error at the end.
>
> Thanks
>
> Kosala
>
>
>
>
>
> On Wed, Aug 17, 2016 at 12:40 PM, Matt Williams (projectclearwater.org) <
> matt at projectclearwater.org> wrote:
>
> Kosala,
>
>
>
> They should log to /var/log/clearwater-sip-stress - in particular, the
> *.1.out file is a log of the output from sipp.  Do you see anything there?
>
>
>
> Matt
>
>
>
> *From:* Kosala [mailto:kosalayb at gmail.com]
> *Sent:* 17 August 2016 12:33
> *To:* Matt Williams (projectclearwater.org) <matt at projectclearwater.org>;
> clearwater at lists.projectclearwater.org
>
>
> *Subject:* Re: [Project Clearwater] Clearwater Digest, Vol 40, Issue 24
>
>
>
> Hi Matt,
>
> I followed above steps and run sudo apt-get install clearwater-sip-stress.
>
> How do I know stress tests are running? Is is said, stress tests start
> automatically but I cannot see it.
>
> Thanks
>
> Kosala
>
>
>
>
>
>
> On Tue, Aug 16, 2016 at 2:01 PM, Matt Williams (projectclearwater.org) <
> matt at projectclearwater.org> wrote:
>
> Kosala,
>
>
>
> I'm glad you've made progress on this.
>
>
>
> I had a look at the crest package version, but it seems to be later than
> the most recent all-in-one image uses (1.0-160811.103635).  When did you
> download the all-in-one image, and did you apply any patches to it?
>
>
>
> Regarding making calls for stress testing, this is where
> http://clearwater.readthedocs.io/en/latest/Clearwater_
> stress_testing.html#manual-i-e-non-chef-stress-runs comes in - you need to
>
> ?         create a separate VM
>
> ?         set the bono_hostname and count parameters in
> /etc/clearwater/shared_config
>
> ?         install the clearwater-sip-stress package.
>
> I hope that helps.
>
>
>
> BTW, please remember to copy in clearwater at lists.projectclearwater.org -
> that means that other people can see and comment on your posts.
>
>
>
> Thanks,
>
>
>
> Matt
>
>
>
>
>
> *From:* Kosala [mailto:kosalayb at gmail.com]
> *Sent:* 16 August 2016 10:48
> *To:* Matt Williams (projectclearwater.org) <matt at projectclearwater.org>
>
> *Subject:* Re: [Project Clearwater] Clearwater Digest, Vol 40, Issue 24
>
>
>
> Hi Matt,
>
> Bulk provisioning for all in one image is done using
> https://github.com/Metaswitch/crest/blob/dev/docs/Bulk-
> Provisioning%20Numbers.md.
>
> I have records in tables in homestead_cache and homer.
>
> Now How to make calls for stress testing?
>
> Is there any guideline?
>
> Many Thanks,
>
> Kosala
>
>
>
>
>
>
>
>
>
> On Tue, Aug 16, 2016 at 9:04 AM, Kosala <kosalayb at gmail.com> wrote:
>
> Hi Matt,
>
> TBH, The document in https://github.com/Metaswitch/
> crest/blob/dev/docs/Bulk-Provisioning%20Numbers.md is not clear to me.
>
> Step 1. Homestead node in deployment. I do not know where is that node in
> all in one image. It will be helpful the location of that folder from the
> root.
>
> Step 2. A simple example will be helpful.
>
> Thanks
>
> Kosala
>
>
>
>
>
> On Tue, Aug 16, 2016 at 8:50 AM, Kosala <kosalayb at gmail.com> wrote:
>
> Hi Matt,
>
> I downloaded the all in one package from http://clearwater.readthedocs.
> io/en/stable/All_in_one_OVF_Installation.html
>
> and imported using oracle virtual box on ubuntu 14.04,
>
> Crest version
>
> [cw-aio]ubuntu at cwaio:~$ sudo dpkg-query -s crest
> Package: crest
> Status: install ok installed
> Priority: optional
> Section: network
> Installed-Size: 40098
> Maintainer: Project Clearwater Maintainers <maintainers@
> projectclearwater.org>
> Architecture: amd64
> Version: 1.0-160815.145007
>
> Thanks
>
> Kosala
>
>
>
>
>
> On Mon, Aug 15, 2016 at 5:56 PM, Matt Williams (projectclearwater.org) <
> matt at projectclearwater.org> wrote:
>
> Kosala,
>
>
>
> That's odd - I don't see that failure on my all-in-one image (spun up just
> now from the latest image) - which version of all-in-one-image are you
> running, and which version of crest does it include ("sudo dpkg-query -s
> crest")?
>
>
>
> You may be able to work-around this either by taking the latest all-in-one
> image or by following the simpler bulk-provisioning process at
> https://github.com/Metaswitch/crest/blob/dev/docs/Bulk-
> Provisioning%20Numbers.md (when this doc talks about using the
> sstables_provisioning process for very large sets of numbers, we mean 1M+
> numbers - the 9000 you're provisioning are well within the capabilities of
> this process).
>
>
>
> I hope that helps - please let me know how you get on.
>
>
>
> Cheers,
>
>
>
> Matt
>
>
>
>
>
> *From:* Clearwater [mailto:clearwater-bounces at lists.projectclearwater.org]
> *On Behalf Of *Kosala
> *Sent:* 15 August 2016 16:58
> *To:* clearwater at lists.projectclearwater.org
> *Subject:* Re: [Project Clearwater] Clearwater Digest, Vol 40, Issue 24
>
>
>
> HI Matt,
>
> Thanks.
>
>
> I am trying to follow https://github.com/Metaswitch/
> crest/blob/dev/src/metaswitch/crest/tools/sstable_provisioning/README.md
> for bulk provisioning.
>
>
> When I am trying to execute sudo ./BulkProvision homer 21000 29999
> example.com 7kkzTyGW in all-in-one image,
> I am getting an error  java.lang.UnsupportedClassVersionError:
> ClearwaterBulkProvisioner : Unsupported major.minor version 52.0
>
> Java version info in all-in-one image:
> [cw-aio]ubuntu at cwaio:/usr/share/clearwater/crest/tools/sstable_provisioning$
> java -version
> java version "1.7.0_101"
> OpenJDK Runtime Environment (IcedTea 2.6.6) (7u101-2.6.6-0ubuntu0.14.04.1)
> OpenJDK 64-Bit Server VM (build 24.95-b01, mixed mode)
>
> Thanks
>
> Kosala
>
>
>
>
>
>
> On Mon, Aug 15, 2016 at 2:17 PM, <clearwater-request at lists.
> projectclearwater.org> wrote:
>
> Send Clearwater mailing list submissions to
>         clearwater at lists.projectclearwater.org
>
> To subscribe or unsubscribe via the World Wide Web, visit
>         http://lists.projectclearwater.org/mailman/
> listinfo/clearwater_lists.projectclearwater.org
>
> or, via email, send a message with subject or body 'help' to
>         clearwater-request at lists.projectclearwater.org
>
> You can reach the person managing the list at
>         clearwater-owner at lists.projectclearwater.org
>
> When replying, please edit your Subject line so it is more specific
> than "Re: Contents of Clearwater digest..."
>
>
> Today's Topics:
>
>    1. Stress Testing (Kosala)
>    2. Re: Stress Testing (Matt Williams (projectclearwater.org))
>    3. Re: Stress Testing (Matt Williams (projectclearwater.org))
>
>
> ----------------------------------------------------------------------
>
> Message: 1
> Date: Mon, 15 Aug 2016 10:38:57 +0100
> From: Kosala <kosalayb at gmail.com>
> To: clearwater at lists.projectclearwater.org
> Subject: [Project Clearwater] Stress Testing
> Message-ID:
>         <CAGEe17an2B_bGj8NfKFwms+nU=vJURyhT5CE+mcY1pjcm4YF+A at mail.
> gmail.com>
> Content-Type: text/plain; charset="utf-8"
>
> Hi Team,
>
> I installed clearwater "all-in-one" image on Oracle Virtual Box.
> 1. Can I do stress testing ?
> 2. How to do that?
>
> I am trying to follow Stress Testing on
> http://clearwater.readthedocs.io/en/stable/Clearwater_stress_testing.html#
> configuring-udp-stress
> .
>
> Using chef - > It seems chef/knife install only supports in the Cloud
> approach (The automated install is only supported for deployments running
> in Amazon?s EC2 cloud).
>
> Manual approach, It looks not supporting all in one image.
>
> Many Thanks
> Kosala
> -------------- next part --------------
> An HTML attachment was scrubbed...
> URL: <http://lists.projectclearwater.org/pipermail/clearwater_lists.
> projectclearwater.org/attachments/20160815/15fc3b07/attachment-0001.html>
>
> ------------------------------
>
> Message: 2
> Date: Mon, 15 Aug 2016 09:54:02 +0000
> From: "Matt Williams (projectclearwater.org)"
>         <matt at projectclearwater.org>
> To: Kosala <kosalayb at gmail.com>
> Cc: "clearwater at lists.projectclearwater.org"
>         <clearwater at lists.projectclearwater.org>
> Subject: Re: [Project Clearwater] Stress Testing
> Message-ID:
>         <CY1PR0201MB15636F1F20EB91BB180F053390120 at CY1PR0201MB1563.
> namprd02.prod.outlook.com>
>
> Content-Type: text/plain; charset="utf-8"
>
> Kosala,
>
> While it's theoretically possible to do stress testing against an
> all-in-one image, I'd recommend against it - the all-in-one image has been
> squeezed down a lot to fit on a single VM and we'd expect very low
> performance out of it, and I could believe that overload behavior might be
> suboptimal.  If you're looking to stress test for performance reasons, I'd
> strongly recommend running a full deployment as this will give you much
> more reliable numbers.  If you're looking to stress test for other reasons,
> please can you share a bit more about what you're trying to achieve, and we
> can have a think about what would work best?
>
> If you do really want to run stress testing against an all-in-one image,
> it should probably work, even though http://clearwater.readthedocs.
> io/en/latest/Clearwater_stress_testing.html#manual-i-
> e-non-chef-stress-runs only talks about Chef and manual installs.  You'd
> need to set the "bono_servers" option in /etc/clearwater/shared_config to
> point to your all-in-one node, and I suspect you'd need to reduce the
> "count" option to something a lot lower - I'd start around 5000 and see how
> that goes.
>
> I hope that helps.  Please let me know how you get on.
>
> Thanks,
>
> Matt
>
> From: Clearwater [mailto:clearwater-bounces at lists.projectclearwater.org]
> On Behalf Of Kosala
> Sent: 15 August 2016 10:39
> To: clearwater at lists.projectclearwater.org
> Subject: [Project Clearwater] Stress Testing
>
> Hi Team,
> I installed clearwater "all-in-one" image on Oracle Virtual Box.
> 1. Can I do stress testing ?
> 2. How to do that?
> I am trying to follow Stress Testing on http://clearwater.readthedocs.
> io/en/stable/Clearwater_stress_testing.html#configuring-udp-stress.
> Using chef - > It seems chef/knife install only supports in the Cloud
> approach (The automated install is only supported for deployments running
> in Amazon?s EC2 cloud).
> Manual approach, It looks not supporting all in one image.
> Many Thanks
> Kosala
>
> -------------- next part --------------
> An HTML attachment was scrubbed...
> URL: <http://lists.projectclearwater.org/pipermail/clearwater_lists.
> projectclearwater.org/attachments/20160815/29d6328d/attachment-0001.html>
>
> ------------------------------
>
> Message: 3
> Date: Mon, 15 Aug 2016 13:16:47 +0000
> From: "Matt Williams (projectclearwater.org)"
>         <matt at projectclearwater.org>
> To: "clearwater at lists.projectclearwater.org"
>         <clearwater at lists.projectclearwater.org>
> Subject: Re: [Project Clearwater] Stress Testing
> Message-ID:
>         <CY1PR0201MB156372246DC5A77B11839F9D90120 at CY1PR0201MB1563.
> namprd02.prod.outlook.com>
>
> Content-Type: text/plain; charset="utf-8"
>
> Kosala,
>
> You'll need to follow all the steps in http://clearwater.readthedocs.
> io/en/latest/Clearwater_stress_testing.html#manual-i-
> e-non-chef-stress-runs, i.e. bulk provisioning subscribers and installing
> clearwater-sip-stress, but that should be it.
>
> Just to be clear, though, you'll need to set the configuration and install
> the clearwater-sip-stress package on a separate VM, not on the all-in-one
> image itself - the all-in-one image almost certainly opens up ports that
> conflict with those that clearwater-sip-stress tries to use.
>
> This isn't a very well-trodden path, though, so you may hit further issues
> - let me know if so, and we can try to work through them.
>
> Cheers,
>
> Matt
>
> From: Kosala [mailto:kosalayb at gmail.com]
> Sent: 15 August 2016 13:41
> To: Matt Williams (projectclearwater.org) <matt at projectclearwater.org>
> Subject: Re: [Project Clearwater] Stress Testing
>
> Hi Matt,
> Thanks. I set the bono_servers option. Should I add count =5000 to
> /etc/clearwater/shared_config ?
>
> Do I need other changes to run stress tests on all-in-one image?
> Thanks
> Kosala
>
>
>
> On Mon, Aug 15, 2016 at 10:54 AM, Matt Williams (projectclearwater.org<
> http://projectclearwater.org>) <matt at projectclearwater.org<mailto:
> matt at projectclearwater.org>> wrote:
> Kosala,
>
> While it's theoretically possible to do stress testing against an
> all-in-one image, I'd recommend against it - the all-in-one image has been
> squeezed down a lot to fit on a single VM and we'd expect very low
> performance out of it, and I could believe that overload behavior might be
> suboptimal.  If you're looking to stress test for performance reasons, I'd
> strongly recommend running a full deployment as this will give you much
> more reliable numbers.  If you're looking to stress test for other reasons,
> please can you share a bit more about what you're trying to achieve, and we
> can have a think about what would work best?
>
> If you do really want to run stress testing against an all-in-one image,
> it should probably work, even though http://clearwater.readthedocs.
> io/en/latest/Clearwater_stress_testing.html#manual-i-
> e-non-chef-stress-runs only talks about Chef and manual installs.  You'd
> need to set the "bono_servers" option in /etc/clearwater/shared_config to
> point to your all-in-one node, and I suspect you'd need to reduce the
> "count" option to something a lot lower - I'd start around 5000 and see how
> that goes.
>
> I hope that helps.  Please let me know how you get on.
>
> Thanks,
>
> Matt
>
> From: Clearwater [mailto:clearwater-bounces at lists.projectclearwater.org<
> mailto:clearwater-bounces at lists.projectclearwater.org>] On Behalf Of
> Kosala
> Sent: 15 August 2016 10:39
> To: clearwater at lists.projectclearwater.org<mailto:clearwater at lists.
> projectclearwater.org>
> Subject: [Project Clearwater] Stress Testing
>
> Hi Team,
> I installed clearwater "all-in-one" image on Oracle Virtual Box.
> 1. Can I do stress testing ?
> 2. How to do that?
> I am trying to follow Stress Testing on http://clearwater.readthedocs.
> io/en/stable/Clearwater_stress_testing.html#configuring-udp-stress.
> Using chef - > It seems chef/knife install only supports in the Cloud
> approach (The automated install is only supported for deployments running
> in Amazon?s EC2 cloud).
> Manual approach, It looks not supporting all in one image.
> Many Thanks
> Kosala
>
>
> -------------- next part --------------
> An HTML attachment was scrubbed...
> URL: <http://lists.projectclearwater.org/pipermail/clearwater_lists.
> projectclearwater.org/attachments/20160815/11781755/attachment.html>
>
> ------------------------------
>
> Subject: Digest Footer
>
> _______________________________________________
> Clearwater mailing list
> Clearwater at lists.projectclearwater.org
> http://lists.projectclearwater.org/mailman/listinfo/clearwater_lists.
> projectclearwater.org
>
>
> ------------------------------
>
> End of Clearwater Digest, Vol 40, Issue 24
> ******************************************
>
>
>
>
>
>
>
>
>
>
>
>
>
>
>
>
>
>
>
>
>
>
>
>
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.projectclearwater.org/pipermail/clearwater_lists.projectclearwater.org/attachments/20160818/9633a374/attachment.html>

From kosalayb at gmail.com  Thu Aug 18 12:13:53 2016
From: kosalayb at gmail.com (Kosala)
Date: Thu, 18 Aug 2016 17:13:53 +0100
Subject: [Project Clearwater] Clearwater Digest, Vol 40, Issue 24
In-Reply-To: <CY1PR0201MB1563E75F9D52ED36CB03D96F90150@CY1PR0201MB1563.namprd02.prod.outlook.com>
References: <mailman.20.1471267072.11502.clearwater_lists.projectclearwater.org@lists.projectclearwater.org>
	<CAGEe17ZLnypQfbzxEwxj9EaB20MUBVpY+YdN-Obv=gHpZmG0KA@mail.gmail.com>
	<CY1PR0201MB1563F9A706F3EC7BE7F9C11590120@CY1PR0201MB1563.namprd02.prod.outlook.com>
	<CAGEe17bfTu1Kpwx=ipqtEbShvWtP+C6pJEEGHi0GSwBR5Dqw8w@mail.gmail.com>
	<CAGEe17aY077tLtotRe1X8k1qU_4otBdHDMJjqDH_g02Zs676Jg@mail.gmail.com>
	<CAGEe17ZeNPPy7AmMz=LCWnHqLm=v9Q7CuLT+AOVKWJTdg8m7Eg@mail.gmail.com>
	<CY1PR0201MB1563CE17983225B985B19D7390130@CY1PR0201MB1563.namprd02.prod.outlook.com>
	<CAGEe17b2M2uqvbOuqH7t4xM41FbfBYk0xR3zWqiFh+EkSfUzUQ@mail.gmail.com>
	<CY1PR0201MB1563CD5DDDD6E7B5A0B2DB7290140@CY1PR0201MB1563.namprd02.prod.outlook.com>
	<CAGEe17YGnaY1Kqc65gyiVO1sBBuTx=-YzfD9HY3M6QBD2t9AkA@mail.gmail.com>
	<CY1PR0201MB156349F26A0A7670BE7382A890140@CY1PR0201MB1563.namprd02.prod.outlook.com>
	<CAGEe17ZkY2ESNzwQYddrv6=jUJ5fPHu3gJXT7R1UjQmBd+eFUg@mail.gmail.com>
	<CY1PR0201MB1563C979B2D641DA59F1945A90150@CY1PR0201MB1563.namprd02.prod.outlook.com>
	<CAGEe17bC+xmhP3D7w768r0svzBAxdBedVXhis1Z33Yqdq4THgA@mail.gmail.com>
	<CY1PR0201MB1563F865DFBF86128118AC5290150@CY1PR0201MB1563.namprd02.prod.outlook.com>
	<CAGEe17Z2wBvTgPrnK_TdQPerVE9Moxnt=u9CWPpq8V04GJtfUw@mail.gmail.com>
	<CY1PR0201MB1563A30C3B9C4D8EE65FAD4390150@CY1PR0201MB1563.namprd02.prod.outlook.com>
	<CAGEe17ZVrag9yFkLgPF-kfgDPDT_nJETkei_Uwv47mohbAwyxg@mail.gmail.com>
	<CY1PR0201MB156325107DAA32BF9480667B90150@CY1PR0201MB1563.namprd02.prod.outlook.com>
	<CAGEe17bWEkdYazAcTOTq2+7kxwR=yYx04MT-QzjsHQ5HWPAD5Q@mail.gmail.com>
	<CY1PR0201MB15630493B218F47026930AF490150@CY1PR0201MB1563.namprd02.prod.outlook.com>
	<CAGEe17bpA32DECgJWrwvAHE1EO2XkfeweJR3JEQgw7TrmzAzdA@mail.gmail.com>
	<CY1PR0201MB1563E75F9D52ED36CB03D96F90150@CY1PR0201MB1563.namprd02.prod.outlook.com>
Message-ID: <CAGEe17bXHHy=9CFtzWiqSGpqmL31bg5ck7PN1h1YVQ2r1YtosQ@mail.gmail.com>

Hi Matt,

In stress testing, can i stop stress testing after testing for a fixed
number. for example after 20 numbers ?. It seems stress testing is
continuously running at SIP node.
If I set count to 5, it will run 0 to 5, then again 0 to 5. I am not sure
if i am right?

Kosala



On Thu, Aug 18, 2016 at 4:57 PM, Matt Williams (projectclearwater.org) <
matt at projectclearwater.org> wrote:

> Kosala,
>
>
>
> It's good that you've got this working.
>
>
>
> You asked again about finding statistics for CPU time and memory usage per
> call.  As I said at the beginning of the trail, the all-in-one node is not
> set up for stress and any numbers you get out of this on all-in-one node
> will be far higher than you would see in practice and probably very noisy
> too.  Unfortunately, if you want numbers like this, you will need to set up
> a full deployment.
>
>
>
> Matt
>
>
>
> *From:* Kosala [mailto:kosalayb at gmail.com]
> *Sent:* 18 August 2016 16:43
>
> *To:* Matt Williams (projectclearwater.org) <matt at projectclearwater.org>
> *Cc:* clearwater at lists.projectclearwater.org
> *Subject:* Re: [Project Clearwater] Clearwater Digest, Vol 40, Issue 24
>
>
>
> HI Matt,
>
> I could get it working for 5 numbers. I will increase and see how far i
> can increase numbers. Then I like to see how to find statistics such as
> memory usage, cpu time per call etc.
>
>
>
> Kosala
>
>
>
> On Thu, Aug 18, 2016 at 3:53 PM, Matt Williams (projectclearwater.org) <
> matt at projectclearwater.org> wrote:
>
> Kosala,
>
>
>
> This is what the "count" option on the stress node controls (see
> http://clearwater.readthedocs.io/en/latest/Clearwater_
> stress_testing.html#manual-i-e-non-chef-stress-runs for details).  If you
> only want to make calls to/from the first 100 numbers, set this to 100.
>
>
>
> Are these calls going through successfully, then?
>
>
>
> Matt
>
>
>
> *From:* Kosala [mailto:kosalayb at gmail.com]
> *Sent:* 18 August 2016 15:20
> *To:* Matt Williams (projectclearwater.org) <matt at projectclearwater.org>
>
> *Cc:* clearwater at lists.projectclearwater.org
> *Subject:* Re: [Project Clearwater] Clearwater Digest, Vol 40, Issue 24
>
>
>
> Hi Matt,
>
> Thanks. SIP node is calling numbers in a larger range starting from 2010000000.
> Can I restrict SIP call invoke from
>
> 2010000000 to 2010000099?
>
> I can do bulk provision 100 numbers. I do not know how to restrict SIP
> node to call only these 100 numbers?
>
> Thanks
>
> Kosala
>
>
>
>
>
> On Thu, Aug 18, 2016 at 2:59 PM, Matt Williams (projectclearwater.org) <
> matt at projectclearwater.org> wrote:
>
> Kosala,
>
>
>
> The error you're seeing suggests that the request is timing out between
> Bono and Sprout.  This could be due to poor performance on the all-in-one
> node (as I said previously, the all-in-one node is not intended for running
> stress), or it could be due to a more general misconfiguration.  Are all
> REGISTERs failing, or just some?
>
>
>
> Regarding getting CPU statistics etc., we normally use Cacti.  There are
> instructions for setting this up at http://clearwater.readthedocs.
> io/en/latest/Cacti.html.  However, I doubt this will work as-is with your
> all-in-one node.  Since you only have one node, maybe you're best just
> looking at top?
>
>
>
> Matt
>
>
>
> *From:* Kosala [mailto:kosalayb at gmail.com]
> *Sent:* 18 August 2016 14:13
>
>
> *To:* Matt Williams (projectclearwater.org) <matt at projectclearwater.org>
> *Cc:* clearwater at lists.projectclearwater.org
> *Subject:* Re: [Project Clearwater] Clearwater Digest, Vol 40, Issue 24
>
>
>
> Hi Matt,
>
> Now for the numbers I have in Cassandra, at SP node, I am getting "SIP/2.0
> 504 Server Timeout"
>
> 2016-08-18      11:49:03:189    1471520943.189039: Aborting call on
> unexpected message for Call-Id '1073-27637 at 10.0.22.193': while expecting
> '401' (index 3), received 'SIP/2.0 504 Server Timeout^M
> Via: SIP/2.0/TCP 10.0.22.193:5060;rport=32939;received=10.0.22.193;branch=
> z9hG4bK-27637-1073-2-2010000854-^M
> Record-Route: <sip:scscf.cwaio:5054;transport=TCP;lr;service=
> scscf;billing-role=charge-orig>^M
> Call-ID: 2010000854///1073-27637 at 10.0.22.193^M
> From: <sip:2010000854 at example.com>;tag=27637SIPpTag001073^M
> To: <sip:2010000854 at example.com>;tag=z9hG4bKPjuN16eRA0bDott9z6ZA-
> fwIYe3VA-KMkQ^M
> CSeq: 1 REGISTER^M
> Content-Length:  0^M
> ^M
> '.
> 2016-08-18      11:49:04:185    1471520944.185945: Aborting call on
> unexpected message for Call-Id '1154-27637 at 10.0.22.193': while expecting
> '401' (index 3), received 'SIP/2.0 504 Server Timeout^M
> Via: SIP/2.0/TCP 10.0.22.193:5060;rport=32940;received=10.0.22.193;branch=
> z9hG4bK-27637-1154-2-2010000692-^M
> Record-Route: <sip:scscf.cwaio:5054;transport=TCP;lr;service=
> scscf;billing-role=charge-orig>^M
> Call-ID: 2010000692///1154-27637 at 10.0.22.193^M
> From: <sip:2010000692 at example.com>;tag=27637SIPpTag001154^M
> To: <sip:2010000692 at example.com>;tag=z9hG4bKPjk-
> 5lYhadbnX7rqNirT8tjwQdDjLAQo0j^M
> CSeq: 1 REGISTER^M
> Content-Length:  0^M
>
> How do I know, stress tests are running properly? Can I see statistics
> such as memory usage, cpu time,  etc ?
>
> Thanks
>
> Kosala
>
>
>
>
>
> On Thu, Aug 18, 2016 at 12:38 PM, Matt Williams (projectclearwater.org) <
> matt at projectclearwater.org> wrote:
>
> Kosala,
>
>
>
> Thanks!  I'm very confused about your software version, though, as the
> latest all-in-one image has
>
> ?         crest 1.0-160811.103635 (i.e. older than yours)
>
> ?         homestead 1.0-160814.205535 (i.e. slightly newer than yours)
>
> ?         sprout 1.0-160814.205701 (i.e. much newer than yours)
>
> ?         the logging.bash script fix already applied.
>
> It looks as though your might have taken the previous all-in-one image,
> and then upgraded some of the packages.  Please can you confirm: have you
> upgraded any packages?
>
>
>
> On the issue you're seeing, I think you're saying that
>
> ?         you're running clearwater-sip-stress (which defaults to using
> numbers in the range above 2010000000)
>
> ?         you've deleted all these numbers from Homestead's Cassandra
>
> ?         you see errors in clearwater-sip-stress's log file saying that
> registration are failing with "404 Not Found".
>
> I think this is expected - you need to provision numbers in Homestead's
> Cassandra that match the numbers that clearwater-sip-stress is expecting to
> register as.  Please let me know if I've misunderstood.
>
>
>
> Thanks,
>
>
>
> Matt
>
>
>
> *From:* Kosala [mailto:kosalayb at gmail.com]
> *Sent:* 18 August 2016 11:46
>
>
> *To:* Matt Williams (projectclearwater.org) <matt at projectclearwater.org>
> *Subject:* Re: [Project Clearwater] Clearwater Digest, Vol 40, Issue 24
>
>
>
>
>
> Hi Matt,
>
> I am running the latest version all-in-one which i downloaded from
> http://vm-images.cw-ngv.com/cw-aio.ova.
>
> [cw-aio]ubuntu at cwaio:~$ sudo dpkg-query -s crest
> [sudo] password for ubuntu:
> Package: crest
> Status: install ok installed
> Priority: optional
> Section: network
> Installed-Size: 40102
> Maintainer: Project Clearwater Maintainers <maintainers@
> projectclearwater.org>
> Architecture: amd64
> Version: 1.0-160818.091648
>
> homestead
> Version: 1.0-160812.164051
>
> sprout
> Version: 1.0-160726.101022
>
> And one strange thing is:
>
> I deleted all the records in tables from homestead_cache and
> homestead_provisioning. Then when I check the SIP node for logs,
> sip-stress_14320_errors.log still has records with sip: ids which are not
> in Cassandra. For example, sip:2010021460 at example.com
>
> 2016-08-18      10:26:08:288    1471515968.288189: Aborting call on
> unexpected message for Call-Id '4270-14320 at 10.0.22.193': while expecting
> '401' (index 3), received 'SIP/2.0 404 Not Found^M
> Via: SIP/2.0/TCP 10.0.22.193:5060;rport=35233;received=10.0.22.193;branch=
> z9hG4bK-14320-4270-2-2010021460-^M
> Record-Route: <sip:scscf.cwaio:5054;transport=TCP;lr;service=
> scscf;billing-role=charge-orig>^M
> Call-ID: 2010021460///4270-14320 at 10.0.22.193^M
> From: <sip:2010021460 at example.com>;tag=14320SIPpTag004270^M
> To: <sip:2010021460 at example.com>;tag=z9hG4bKPjVe2he9j28lou.
> 0Dl9NmKGS7ypUMLjMJv^M
> CSeq: 1 REGISTER^M
> Content-Length:  0^M
>
> Thanks
>
> Kosala
>
>
>
> On Thu, Aug 18, 2016 at 10:47 AM, Matt Williams (projectclearwater.org) <
> matt at projectclearwater.org> wrote:
>
> Kosala,
>
>
>
> The fix is not to *copy* this to /usr/share/clearwater/utils, but to
> *move* it.  However, since the error is benign, I'd suggest just ignoring
> it while we get this working.
>
>
>
> As I asked below, please can you confirm what version you're running?  I'm
> concerned that it's going to be very hard to troubleshoot problems if you
> have an all-in-one image from a few weeks ago, with some packages updated
> to more recent versions and then some further fixes manually applied.
>
>
>
> Thanks,
>
>
>
> Matt
>
>
>
>
>
> *From:* Kosala [mailto:kosalayb at gmail.com]
> *Sent:* 18 August 2016 10:34
>
>
> *To:* Matt Williams (projectclearwater.org) <matt at projectclearwater.org>
> *Cc:* clearwater at lists.projectclearwater.org
> *Subject:* Re: [Project Clearwater] Clearwater Digest, Vol 40, Issue 24
>
>
>
> Hi Matt,
>
> Yeah, Manual calls are working fine.
>
> As it is said in the big fix, https://github.com/Metaswitch/
> clearwater-infrastructure/issues/355 , I copied logging.bash to
> /usr/share/clearwater/utils
>
> but I am still getting
>
> /etc/init.d/clearwater-infrastructure: 76: /etc/init.d/clearwater-infrastructure:
> /usr/share/clearwater/infrastructure/scripts/logging.bash: Permission
> denied
> Configuring monit for only localhost access
>
> Kosala
>
>
>
>
>
> On Thu, Aug 18, 2016 at 10:01 AM, Matt Williams (projectclearwater.org) <
> matt at projectclearwater.org> wrote:
>
> Kosala,
>
>
>
> Yes, it's https://github.com/Metaswitch/clearwater-infrastructure/
> issues/355 and it should be benign.
>
>
>
> However, this was fixed about 2 weeks ago.  Please can you confirm when
> you downloaded the all-in-one image, and whether you've upgraded it all?
> (As I observed earlier, your crest release was from only a few days ago.)
>
>
>
> Have you got manual calls working?
>
>
>
> Thanks,
>
>
>
> Matt
>
>
>
>
>
> *From:* Kosala [mailto:kosalayb at gmail.com]
> *Sent:* 18 August 2016 09:56
> *To:* Matt Williams (projectclearwater.org) <matt at projectclearwater.org>
> *Cc:* clearwater at lists.projectclearwater.org
>
>
> *Subject:* Re: [Project Clearwater] Clearwater Digest, Vol 40, Issue 24
>
>
>
> Hi Matt,
>
> In SIP node, when I am trying to execute "sudo service
> clearwater-sip-stress restart", I am getting an error
>
>
> /etc/init.d/clearwater-infrastructure: 76: /etc/init.d/clearwater-infrastructure:
> /usr/share/clearwater/infrastructure/scripts/logging.bash: Permission
> denied
> Configuring monit for only localhost access
>
> Any clue about this error?
>
> Thanks
>
> Kosala
>
>
>
>
>
> On Wed, Aug 17, 2016 at 2:29 PM, Matt Williams (projectclearwater.org) <
> matt at projectclearwater.org> wrote:
>
> Kosala,
>
>
>
> Yes, that's the correct screen, and you're correct that it shows that
> stress is being attempted but failing.
>
>
>
> Do regular (non-stress) calls work through this deployment?
>
>
>
> You can look at what message the stress node is receiving in the log files
> in the /var/log/clearwater-sip-stress/ directory - I think there are
> "errors" logs that contain the unexpected messages.
>
>
>
> You can obviously also look at what's happening on the all-in-one node
> itself, using the /var/log/bono/*, /var/log/sprout/* and
> /var/log/homestead/* files, as described at http://clearwater.readthedocs.
> io/en/latest/Troubleshooting_and_Recovery.html.
>
>
>
> I hope that helps.
>
>
>
> Cheers,
>
>
>
> Matt
>
>
>
> *From:* Kosala [mailto:kosalayb at gmail.com]
> *Sent:* 17 August 2016 14:20
>
>
> *To:* Matt Williams (projectclearwater.org) <matt at projectclearwater.org>
> *Subject:* Re: [Project Clearwater] Clearwater Digest, Vol 40, Issue 24
>
>
>
> Hi Matt,
>
> I can see this scenario screen from sip-stress.1.out. I hope this will be
> the stress test output results.
>
>
> ------------------------------ Scenario Screen -------- [1-9]: Change
> Screen --
>      Users (length)   Port   Total-time  Total-calls  Remote-host
>         2500 (0 ms)   5060      77.15 s         2500  10.0.21.192:5060
> (TCP)
>
>   Call limit reached (-m 2500), 1.002 s period  1 ms scheduler resolution
>   2175 calls (limit 2500)                Peak was 2499 calls, after 0 s
>   0 Running, 2177 Paused, 8 Woken up
>   0 dead call msg (discarded)            0 out-of-call msg
> (discarded)
>   3 open sockets
>
>                                  Messages  Retrans   Timeout
> Unexpected-Msg
>        Pause [0ms/10:00]         2500                          0
>     REGISTER ---------->         326       0
>          401 <----------         0         0         0         325
>     REGISTER ---------->         0         0
>          200 <----------         0         0         0         0
>     REGISTER ---------->         0         0
>          401 <----------         0         0         0         0
>     REGISTER ---------->         0         0
>          200 <----------         0         0         0         0
>        Pause [     4:50]         0                             0
>     REGISTER ---------->  B-RTD1 0         0
>          200 <----------  E-RTD1 0         0         0         0
>     REGISTER ---------->  B-RTD1 0         0
>          200 <----------  E-RTD1 0         0         0         0
>        Pause [     4:50]         0                             0
>        Pause [$pre_call_delay]   0                             0
>       INVITE ---------->  B-RTD2 0         0
>          100 <----------         0         0         0         0
>       INVITE <----------         0         0         0         0
>          100 <----------         0         0         0         0
>       INVITE <----------         0         0         0         0
>          100 ---------->         0         0
>          180 ---------->         0         0
>          180 <----------         0         0         0         0
>        Pause [   6000ms]         0                             0
>          200 ---------->         0         0
>          200 <----------         0         0         0         0
>          ACK ---------->         0         0
>          ACK <----------         0         0         0         0
>       UPDATE ---------->         0         0
>       UPDATE <----------         0         0         0         0
>          200 ---------->         0         0
>          200 <----------  E-RTD2 0         0         0         0
>        Pause [    24.0s]         0                             0
>          BYE ---------->  B-RTD3 0         0
>          BYE <----------         0         0         0         0
>          200 ---------->         0         0
>          200 <----------  E-RTD3 0         0         0         0
>        Pause [$post_call_delay]  0                             0
> ------- Waiting for active calls to end. Press [q] again to force exit.
> -------
> Last Error: Aborting call on unexpected message for Call-Id '1079-13729@
> ...
>
> However there is an unexpected message error at the end.
>
> Thanks
>
> Kosala
>
>
>
>
>
> On Wed, Aug 17, 2016 at 12:40 PM, Matt Williams (projectclearwater.org) <
> matt at projectclearwater.org> wrote:
>
> Kosala,
>
>
>
> They should log to /var/log/clearwater-sip-stress - in particular, the
> *.1.out file is a log of the output from sipp.  Do you see anything there?
>
>
>
> Matt
>
>
>
> *From:* Kosala [mailto:kosalayb at gmail.com]
> *Sent:* 17 August 2016 12:33
> *To:* Matt Williams (projectclearwater.org) <matt at projectclearwater.org>;
> clearwater at lists.projectclearwater.org
>
>
> *Subject:* Re: [Project Clearwater] Clearwater Digest, Vol 40, Issue 24
>
>
>
> Hi Matt,
>
> I followed above steps and run sudo apt-get install clearwater-sip-stress.
>
> How do I know stress tests are running? Is is said, stress tests start
> automatically but I cannot see it.
>
> Thanks
>
> Kosala
>
>
>
>
>
>
> On Tue, Aug 16, 2016 at 2:01 PM, Matt Williams (projectclearwater.org) <
> matt at projectclearwater.org> wrote:
>
> Kosala,
>
>
>
> I'm glad you've made progress on this.
>
>
>
> I had a look at the crest package version, but it seems to be later than
> the most recent all-in-one image uses (1.0-160811.103635).  When did you
> download the all-in-one image, and did you apply any patches to it?
>
>
>
> Regarding making calls for stress testing, this is where
> http://clearwater.readthedocs.io/en/latest/Clearwater_
> stress_testing.html#manual-i-e-non-chef-stress-runs comes in - you need to
>
> ?         create a separate VM
>
> ?         set the bono_hostname and count parameters in
> /etc/clearwater/shared_config
>
> ?         install the clearwater-sip-stress package.
>
> I hope that helps.
>
>
>
> BTW, please remember to copy in clearwater at lists.projectclearwater.org -
> that means that other people can see and comment on your posts.
>
>
>
> Thanks,
>
>
>
> Matt
>
>
>
>
>
> *From:* Kosala [mailto:kosalayb at gmail.com]
> *Sent:* 16 August 2016 10:48
> *To:* Matt Williams (projectclearwater.org) <matt at projectclearwater.org>
>
> *Subject:* Re: [Project Clearwater] Clearwater Digest, Vol 40, Issue 24
>
>
>
> Hi Matt,
>
> Bulk provisioning for all in one image is done using
> https://github.com/Metaswitch/crest/blob/dev/docs/Bulk-
> Provisioning%20Numbers.md.
>
> I have records in tables in homestead_cache and homer.
>
> Now How to make calls for stress testing?
>
> Is there any guideline?
>
> Many Thanks,
>
> Kosala
>
>
>
>
>
>
>
>
>
> On Tue, Aug 16, 2016 at 9:04 AM, Kosala <kosalayb at gmail.com> wrote:
>
> Hi Matt,
>
> TBH, The document in https://github.com/Metaswitch/
> crest/blob/dev/docs/Bulk-Provisioning%20Numbers.md is not clear to me.
>
> Step 1. Homestead node in deployment. I do not know where is that node in
> all in one image. It will be helpful the location of that folder from the
> root.
>
> Step 2. A simple example will be helpful.
>
> Thanks
>
> Kosala
>
>
>
>
>
> On Tue, Aug 16, 2016 at 8:50 AM, Kosala <kosalayb at gmail.com> wrote:
>
> Hi Matt,
>
> I downloaded the all in one package from http://clearwater.readthedocs.
> io/en/stable/All_in_one_OVF_Installation.html
>
> and imported using oracle virtual box on ubuntu 14.04,
>
> Crest version
>
> [cw-aio]ubuntu at cwaio:~$ sudo dpkg-query -s crest
> Package: crest
> Status: install ok installed
> Priority: optional
> Section: network
> Installed-Size: 40098
> Maintainer: Project Clearwater Maintainers <maintainers@
> projectclearwater.org>
> Architecture: amd64
> Version: 1.0-160815.145007
>
> Thanks
>
> Kosala
>
>
>
>
>
> On Mon, Aug 15, 2016 at 5:56 PM, Matt Williams (projectclearwater.org) <
> matt at projectclearwater.org> wrote:
>
> Kosala,
>
>
>
> That's odd - I don't see that failure on my all-in-one image (spun up just
> now from the latest image) - which version of all-in-one-image are you
> running, and which version of crest does it include ("sudo dpkg-query -s
> crest")?
>
>
>
> You may be able to work-around this either by taking the latest all-in-one
> image or by following the simpler bulk-provisioning process at
> https://github.com/Metaswitch/crest/blob/dev/docs/Bulk-
> Provisioning%20Numbers.md (when this doc talks about using the
> sstables_provisioning process for very large sets of numbers, we mean 1M+
> numbers - the 9000 you're provisioning are well within the capabilities of
> this process).
>
>
>
> I hope that helps - please let me know how you get on.
>
>
>
> Cheers,
>
>
>
> Matt
>
>
>
>
>
> *From:* Clearwater [mailto:clearwater-bounces at lists.projectclearwater.org]
> *On Behalf Of *Kosala
> *Sent:* 15 August 2016 16:58
> *To:* clearwater at lists.projectclearwater.org
> *Subject:* Re: [Project Clearwater] Clearwater Digest, Vol 40, Issue 24
>
>
>
> HI Matt,
>
> Thanks.
>
>
> I am trying to follow https://github.com/Metaswitch/
> crest/blob/dev/src/metaswitch/crest/tools/sstable_provisioning/README.md
> for bulk provisioning.
>
>
> When I am trying to execute sudo ./BulkProvision homer 21000 29999
> example.com 7kkzTyGW in all-in-one image,
> I am getting an error  java.lang.UnsupportedClassVersionError:
> ClearwaterBulkProvisioner : Unsupported major.minor version 52.0
>
> Java version info in all-in-one image:
> [cw-aio]ubuntu at cwaio:/usr/share/clearwater/crest/tools/sstable_provisioning$
> java -version
> java version "1.7.0_101"
> OpenJDK Runtime Environment (IcedTea 2.6.6) (7u101-2.6.6-0ubuntu0.14.04.1)
> OpenJDK 64-Bit Server VM (build 24.95-b01, mixed mode)
>
> Thanks
>
> Kosala
>
>
>
>
>
>
> On Mon, Aug 15, 2016 at 2:17 PM, <clearwater-request at lists.
> projectclearwater.org> wrote:
>
> Send Clearwater mailing list submissions to
>         clearwater at lists.projectclearwater.org
>
> To subscribe or unsubscribe via the World Wide Web, visit
>         http://lists.projectclearwater.org/mailman/
> listinfo/clearwater_lists.projectclearwater.org
>
> or, via email, send a message with subject or body 'help' to
>         clearwater-request at lists.projectclearwater.org
>
> You can reach the person managing the list at
>         clearwater-owner at lists.projectclearwater.org
>
> When replying, please edit your Subject line so it is more specific
> than "Re: Contents of Clearwater digest..."
>
>
> Today's Topics:
>
>    1. Stress Testing (Kosala)
>    2. Re: Stress Testing (Matt Williams (projectclearwater.org))
>    3. Re: Stress Testing (Matt Williams (projectclearwater.org))
>
>
> ----------------------------------------------------------------------
>
> Message: 1
> Date: Mon, 15 Aug 2016 10:38:57 +0100
> From: Kosala <kosalayb at gmail.com>
> To: clearwater at lists.projectclearwater.org
> Subject: [Project Clearwater] Stress Testing
> Message-ID:
>         <CAGEe17an2B_bGj8NfKFwms+nU=vJURyhT5CE+mcY1pjcm4YF+A at mail.
> gmail.com>
> Content-Type: text/plain; charset="utf-8"
>
> Hi Team,
>
> I installed clearwater "all-in-one" image on Oracle Virtual Box.
> 1. Can I do stress testing ?
> 2. How to do that?
>
> I am trying to follow Stress Testing on
> http://clearwater.readthedocs.io/en/stable/Clearwater_stress_testing.html#
> configuring-udp-stress
> .
>
> Using chef - > It seems chef/knife install only supports in the Cloud
> approach (The automated install is only supported for deployments running
> in Amazon?s EC2 cloud).
>
> Manual approach, It looks not supporting all in one image.
>
> Many Thanks
> Kosala
> -------------- next part --------------
> An HTML attachment was scrubbed...
> URL: <http://lists.projectclearwater.org/pipermail/clearwater_lists.
> projectclearwater.org/attachments/20160815/15fc3b07/attachment-0001.html>
>
> ------------------------------
>
> Message: 2
> Date: Mon, 15 Aug 2016 09:54:02 +0000
> From: "Matt Williams (projectclearwater.org)"
>         <matt at projectclearwater.org>
> To: Kosala <kosalayb at gmail.com>
> Cc: "clearwater at lists.projectclearwater.org"
>         <clearwater at lists.projectclearwater.org>
> Subject: Re: [Project Clearwater] Stress Testing
> Message-ID:
>         <CY1PR0201MB15636F1F20EB91BB180F053390120 at CY1PR0201MB1563.
> namprd02.prod.outlook.com>
>
> Content-Type: text/plain; charset="utf-8"
>
> Kosala,
>
> While it's theoretically possible to do stress testing against an
> all-in-one image, I'd recommend against it - the all-in-one image has been
> squeezed down a lot to fit on a single VM and we'd expect very low
> performance out of it, and I could believe that overload behavior might be
> suboptimal.  If you're looking to stress test for performance reasons, I'd
> strongly recommend running a full deployment as this will give you much
> more reliable numbers.  If you're looking to stress test for other reasons,
> please can you share a bit more about what you're trying to achieve, and we
> can have a think about what would work best?
>
> If you do really want to run stress testing against an all-in-one image,
> it should probably work, even though http://clearwater.readthedocs.
> io/en/latest/Clearwater_stress_testing.html#manual-i-
> e-non-chef-stress-runs only talks about Chef and manual installs.  You'd
> need to set the "bono_servers" option in /etc/clearwater/shared_config to
> point to your all-in-one node, and I suspect you'd need to reduce the
> "count" option to something a lot lower - I'd start around 5000 and see how
> that goes.
>
> I hope that helps.  Please let me know how you get on.
>
> Thanks,
>
> Matt
>
> From: Clearwater [mailto:clearwater-bounces at lists.projectclearwater.org]
> On Behalf Of Kosala
> Sent: 15 August 2016 10:39
> To: clearwater at lists.projectclearwater.org
> Subject: [Project Clearwater] Stress Testing
>
> Hi Team,
> I installed clearwater "all-in-one" image on Oracle Virtual Box.
> 1. Can I do stress testing ?
> 2. How to do that?
> I am trying to follow Stress Testing on http://clearwater.readthedocs.
> io/en/stable/Clearwater_stress_testing.html#configuring-udp-stress.
> Using chef - > It seems chef/knife install only supports in the Cloud
> approach (The automated install is only supported for deployments running
> in Amazon?s EC2 cloud).
> Manual approach, It looks not supporting all in one image.
> Many Thanks
> Kosala
>
> -------------- next part --------------
> An HTML attachment was scrubbed...
> URL: <http://lists.projectclearwater.org/pipermail/clearwater_lists.
> projectclearwater.org/attachments/20160815/29d6328d/attachment-0001.html>
>
> ------------------------------
>
> Message: 3
> Date: Mon, 15 Aug 2016 13:16:47 +0000
> From: "Matt Williams (projectclearwater.org)"
>         <matt at projectclearwater.org>
> To: "clearwater at lists.projectclearwater.org"
>         <clearwater at lists.projectclearwater.org>
> Subject: Re: [Project Clearwater] Stress Testing
> Message-ID:
>         <CY1PR0201MB156372246DC5A77B11839F9D90120 at CY1PR0201MB1563.
> namprd02.prod.outlook.com>
>
> Content-Type: text/plain; charset="utf-8"
>
> Kosala,
>
> You'll need to follow all the steps in http://clearwater.readthedocs.
> io/en/latest/Clearwater_stress_testing.html#manual-i-
> e-non-chef-stress-runs, i.e. bulk provisioning subscribers and installing
> clearwater-sip-stress, but that should be it.
>
> Just to be clear, though, you'll need to set the configuration and install
> the clearwater-sip-stress package on a separate VM, not on the all-in-one
> image itself - the all-in-one image almost certainly opens up ports that
> conflict with those that clearwater-sip-stress tries to use.
>
> This isn't a very well-trodden path, though, so you may hit further issues
> - let me know if so, and we can try to work through them.
>
> Cheers,
>
> Matt
>
> From: Kosala [mailto:kosalayb at gmail.com]
> Sent: 15 August 2016 13:41
> To: Matt Williams (projectclearwater.org) <matt at projectclearwater.org>
> Subject: Re: [Project Clearwater] Stress Testing
>
> Hi Matt,
> Thanks. I set the bono_servers option. Should I add count =5000 to
> /etc/clearwater/shared_config ?
>
> Do I need other changes to run stress tests on all-in-one image?
> Thanks
> Kosala
>
>
>
> On Mon, Aug 15, 2016 at 10:54 AM, Matt Williams (projectclearwater.org<
> http://projectclearwater.org>) <matt at projectclearwater.org<mailto:
> matt at projectclearwater.org>> wrote:
> Kosala,
>
> While it's theoretically possible to do stress testing against an
> all-in-one image, I'd recommend against it - the all-in-one image has been
> squeezed down a lot to fit on a single VM and we'd expect very low
> performance out of it, and I could believe that overload behavior might be
> suboptimal.  If you're looking to stress test for performance reasons, I'd
> strongly recommend running a full deployment as this will give you much
> more reliable numbers.  If you're looking to stress test for other reasons,
> please can you share a bit more about what you're trying to achieve, and we
> can have a think about what would work best?
>
> If you do really want to run stress testing against an all-in-one image,
> it should probably work, even though http://clearwater.readthedocs.
> io/en/latest/Clearwater_stress_testing.html#manual-i-
> e-non-chef-stress-runs only talks about Chef and manual installs.  You'd
> need to set the "bono_servers" option in /etc/clearwater/shared_config to
> point to your all-in-one node, and I suspect you'd need to reduce the
> "count" option to something a lot lower - I'd start around 5000 and see how
> that goes.
>
> I hope that helps.  Please let me know how you get on.
>
> Thanks,
>
> Matt
>
> From: Clearwater [mailto:clearwater-bounces at lists.projectclearwater.org<
> mailto:clearwater-bounces at lists.projectclearwater.org>] On Behalf Of
> Kosala
> Sent: 15 August 2016 10:39
> To: clearwater at lists.projectclearwater.org<mailto:clearwater at lists.
> projectclearwater.org>
> Subject: [Project Clearwater] Stress Testing
>
> Hi Team,
> I installed clearwater "all-in-one" image on Oracle Virtual Box.
> 1. Can I do stress testing ?
> 2. How to do that?
> I am trying to follow Stress Testing on http://clearwater.readthedocs.
> io/en/stable/Clearwater_stress_testing.html#configuring-udp-stress.
> Using chef - > It seems chef/knife install only supports in the Cloud
> approach (The automated install is only supported for deployments running
> in Amazon?s EC2 cloud).
> Manual approach, It looks not supporting all in one image.
> Many Thanks
> Kosala
>
>
> -------------- next part --------------
> An HTML attachment was scrubbed...
> URL: <http://lists.projectclearwater.org/pipermail/clearwater_lists.
> projectclearwater.org/attachments/20160815/11781755/attachment.html>
>
> ------------------------------
>
> Subject: Digest Footer
>
> _______________________________________________
> Clearwater mailing list
> Clearwater at lists.projectclearwater.org
> http://lists.projectclearwater.org/mailman/listinfo/clearwater_lists.
> projectclearwater.org
>
>
> ------------------------------
>
> End of Clearwater Digest, Vol 40, Issue 24
> ******************************************
>
>
>
>
>
>
>
>
>
>
>
>
>
>
>
>
>
>
>
>
>
>
>
>
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.projectclearwater.org/pipermail/clearwater_lists.projectclearwater.org/attachments/20160818/703bc5ef/attachment.html>

From matt at projectclearwater.org  Fri Aug 19 04:17:05 2016
From: matt at projectclearwater.org (Matt Williams (projectclearwater.org))
Date: Fri, 19 Aug 2016 08:17:05 +0000
Subject: [Project Clearwater] Clearwater Digest, Vol 40, Issue 24
In-Reply-To: <CAGEe17bXHHy=9CFtzWiqSGpqmL31bg5ck7PN1h1YVQ2r1YtosQ@mail.gmail.com>
References: <mailman.20.1471267072.11502.clearwater_lists.projectclearwater.org@lists.projectclearwater.org>
	<CAGEe17ZLnypQfbzxEwxj9EaB20MUBVpY+YdN-Obv=gHpZmG0KA@mail.gmail.com>
	<CY1PR0201MB1563F9A706F3EC7BE7F9C11590120@CY1PR0201MB1563.namprd02.prod.outlook.com>
	<CAGEe17bfTu1Kpwx=ipqtEbShvWtP+C6pJEEGHi0GSwBR5Dqw8w@mail.gmail.com>
	<CAGEe17aY077tLtotRe1X8k1qU_4otBdHDMJjqDH_g02Zs676Jg@mail.gmail.com>
	<CAGEe17ZeNPPy7AmMz=LCWnHqLm=v9Q7CuLT+AOVKWJTdg8m7Eg@mail.gmail.com>
	<CY1PR0201MB1563CE17983225B985B19D7390130@CY1PR0201MB1563.namprd02.prod.outlook.com>
	<CAGEe17b2M2uqvbOuqH7t4xM41FbfBYk0xR3zWqiFh+EkSfUzUQ@mail.gmail.com>
	<CY1PR0201MB1563CD5DDDD6E7B5A0B2DB7290140@CY1PR0201MB1563.namprd02.prod.outlook.com>
	<CAGEe17YGnaY1Kqc65gyiVO1sBBuTx=-YzfD9HY3M6QBD2t9AkA@mail.gmail.com>
	<CY1PR0201MB156349F26A0A7670BE7382A890140@CY1PR0201MB1563.namprd02.prod.outlook.com>
	<CAGEe17ZkY2ESNzwQYddrv6=jUJ5fPHu3gJXT7R1UjQmBd+eFUg@mail.gmail.com>
	<CY1PR0201MB1563C979B2D641DA59F1945A90150@CY1PR0201MB1563.namprd02.prod.outlook.com>
	<CAGEe17bC+xmhP3D7w768r0svzBAxdBedVXhis1Z33Yqdq4THgA@mail.gmail.com>
	<CY1PR0201MB1563F865DFBF86128118AC5290150@CY1PR0201MB1563.namprd02.prod.outlook.com>
	<CAGEe17Z2wBvTgPrnK_TdQPerVE9Moxnt=u9CWPpq8V04GJtfUw@mail.gmail.com>
	<CY1PR0201MB1563A30C3B9C4D8EE65FAD4390150@CY1PR0201MB1563.namprd02.prod.outlook.com>
	<CAGEe17ZVrag9yFkLgPF-kfgDPDT_nJETkei_Uwv47mohbAwyxg@mail.gmail.com>
	<CY1PR0201MB156325107DAA32BF9480667B90150@CY1PR0201MB1563.namprd02.prod.outlook.com>
	<CAGEe17bWEkdYazAcTOTq2+7kxwR=yYx04MT-QzjsHQ5HWPAD5Q@mail.gmail.com>
	<CY1PR0201MB15630493B218F47026930AF490150@CY1PR0201MB1563.namprd02.prod.outlook.com>
	<CAGEe17bpA32DECgJWrwvAHE1EO2XkfeweJR3JEQgw7TrmzAzdA@mail.gmail.com>
	<CY1PR0201MB1563E75F9D52ED36CB03D96F90150@CY1PR0201MB1563.namprd02.prod.outlook.com>
	<CAGEe17bXHHy=9CFtzWiqSGpqmL31bg5ck7PN1h1YVQ2r1YtosQ@mail.gmail.com>
Message-ID: <CY1PR0201MB15636BFF26E9DC4A542D105A90160@CY1PR0201MB1563.namprd02.prod.outlook.com>

Kosala,

You are correct that stress runs continuously - there is no way of stopping it cleanly.  Obviously, if you just run "sudo service clearwater-sip-stress stop", this will stop it, but it will do so at an arbitrary point in the call.  FYI, when running stress, each number calls at a random time (we try to simulate a more realistic call pattern than just regular calling).

There may be ways to make progress here but unfortunately I can't be more helpful than this - as explained earlier, the all in one node simply isn?t intended for stress testing, and we recommend you switch over to a multi node deployment before doing this.

Matt

From: Kosala [mailto:kosalayb at gmail.com]
Sent: 18 August 2016 17:14
To: Matt Williams (projectclearwater.org) <matt at projectclearwater.org>
Cc: clearwater at lists.projectclearwater.org
Subject: Re: [Project Clearwater] Clearwater Digest, Vol 40, Issue 24

Hi Matt,

In stress testing, can i stop stress testing after testing for a fixed number. for example after 20 numbers ?. It seems stress testing is continuously running at SIP node.
If I set count to 5, it will run 0 to 5, then again 0 to 5. I am not sure if i am right?

Kosala


On Thu, Aug 18, 2016 at 4:57 PM, Matt Williams (projectclearwater.org<http://projectclearwater.org>) <matt at projectclearwater.org<mailto:matt at projectclearwater.org>> wrote:
Kosala,

It's good that you've got this working.

You asked again about finding statistics for CPU time and memory usage per call.  As I said at the beginning of the trail, the all-in-one node is not set up for stress and any numbers you get out of this on all-in-one node will be far higher than you would see in practice and probably very noisy too.  Unfortunately, if you want numbers like this, you will need to set up a full deployment.

Matt

From: Kosala [mailto:kosalayb at gmail.com<mailto:kosalayb at gmail.com>]
Sent: 18 August 2016 16:43

To: Matt Williams (projectclearwater.org<http://projectclearwater.org>) <matt at projectclearwater.org<mailto:matt at projectclearwater.org>>
Cc: clearwater at lists.projectclearwater.org<mailto:clearwater at lists.projectclearwater.org>
Subject: Re: [Project Clearwater] Clearwater Digest, Vol 40, Issue 24

HI Matt,
I could get it working for 5 numbers. I will increase and see how far i can increase numbers. Then I like to see how to find statistics such as memory usage, cpu time per call etc.

Kosala

On Thu, Aug 18, 2016 at 3:53 PM, Matt Williams (projectclearwater.org<http://projectclearwater.org>) <matt at projectclearwater.org<mailto:matt at projectclearwater.org>> wrote:
Kosala,

This is what the "count" option on the stress node controls (see http://clearwater.readthedocs.io/en/latest/Clearwater_stress_testing.html#manual-i-e-non-chef-stress-runs for details).  If you only want to make calls to/from the first 100 numbers, set this to 100.

Are these calls going through successfully, then?

Matt

From: Kosala [mailto:kosalayb at gmail.com<mailto:kosalayb at gmail.com>]
Sent: 18 August 2016 15:20
To: Matt Williams (projectclearwater.org<http://projectclearwater.org>) <matt at projectclearwater.org<mailto:matt at projectclearwater.org>>
Cc: clearwater at lists.projectclearwater.org<mailto:clearwater at lists.projectclearwater.org>
Subject: Re: [Project Clearwater] Clearwater Digest, Vol 40, Issue 24

Hi Matt,
Thanks. SIP node is calling numbers in a larger range starting from 2010000000. Can I restrict SIP call invoke from
2010000000 to 2010000099?
I can do bulk provision 100 numbers. I do not know how to restrict SIP node to call only these 100 numbers?
Thanks
Kosala


On Thu, Aug 18, 2016 at 2:59 PM, Matt Williams (projectclearwater.org<http://projectclearwater.org>) <matt at projectclearwater.org<mailto:matt at projectclearwater.org>> wrote:
Kosala,

The error you're seeing suggests that the request is timing out between Bono and Sprout.  This could be due to poor performance on the all-in-one node (as I said previously, the all-in-one node is not intended for running stress), or it could be due to a more general misconfiguration.  Are all REGISTERs failing, or just some?

Regarding getting CPU statistics etc., we normally use Cacti.  There are instructions for setting this up at http://clearwater.readthedocs.io/en/latest/Cacti.html.  However, I doubt this will work as-is with your all-in-one node.  Since you only have one node, maybe you're best just looking at top?

Matt

From: Kosala [mailto:kosalayb at gmail.com<mailto:kosalayb at gmail.com>]
Sent: 18 August 2016 14:13

To: Matt Williams (projectclearwater.org<http://projectclearwater.org>) <matt at projectclearwater.org<mailto:matt at projectclearwater.org>>
Cc: clearwater at lists.projectclearwater.org<mailto:clearwater at lists.projectclearwater.org>
Subject: Re: [Project Clearwater] Clearwater Digest, Vol 40, Issue 24

Hi Matt,
Now for the numbers I have in Cassandra, at SP node, I am getting "SIP/2.0 504 Server Timeout"
2016-08-18      11:49:03:189    1471520943.189039: Aborting call on unexpected message for Call-Id '1073-27637 at 10.0.22.193<mailto:1073-27637 at 10.0.22.193>': while expecting '401' (index 3), received 'SIP/2.0 504 Server Timeout^M
Via: SIP/2.0/TCP 10.0.22.193:5060;rport=32939;received=10.0.22.193;branch=z9hG4bK-27637-1073-2-2010000854-^M
Record-Route: <sip:scscf.cwaio:5054;transport=TCP;lr;service=scscf;billing-role=charge-orig>^M
Call-ID: 2010000854///1073-27637 at 10.0.22.193<mailto:1073-27637 at 10.0.22.193>^M
From: <sip:2010000854 at example.com<mailto:sip%3A2010000854 at example.com>>;tag=27637SIPpTag001073^M
To: <sip:2010000854 at example.com<mailto:sip%3A2010000854 at example.com>>;tag=z9hG4bKPjuN16eRA0bDott9z6ZA-fwIYe3VA-KMkQ^M
CSeq: 1 REGISTER^M
Content-Length:  0^M
^M
'.
2016-08-18      11:49:04:185    1471520944.185945: Aborting call on unexpected message for Call-Id '1154-27637 at 10.0.22.193<mailto:1154-27637 at 10.0.22.193>': while expecting '401' (index 3), received 'SIP/2.0 504 Server Timeout^M
Via: SIP/2.0/TCP 10.0.22.193:5060;rport=32940;received=10.0.22.193;branch=z9hG4bK-27637-1154-2-2010000692-^M
Record-Route: <sip:scscf.cwaio:5054;transport=TCP;lr;service=scscf;billing-role=charge-orig>^M
Call-ID: 2010000692///1154-27637 at 10.0.22.193<mailto:1154-27637 at 10.0.22.193>^M
From: <sip:2010000692 at example.com<mailto:sip%3A2010000692 at example.com>>;tag=27637SIPpTag001154^M
To: <sip:2010000692 at example.com<mailto:sip%3A2010000692 at example.com>>;tag=z9hG4bKPjk-5lYhadbnX7rqNirT8tjwQdDjLAQo0j^M
CSeq: 1 REGISTER^M
Content-Length:  0^M

How do I know, stress tests are running properly? Can I see statistics such as memory usage, cpu time,  etc ?
Thanks
Kosala


On Thu, Aug 18, 2016 at 12:38 PM, Matt Williams (projectclearwater.org<http://projectclearwater.org>) <matt at projectclearwater.org<mailto:matt at projectclearwater.org>> wrote:
Kosala,

Thanks!  I'm very confused about your software version, though, as the latest all-in-one image has

?         crest 1.0-160811.103635 (i.e. older than yours)

?         homestead 1.0-160814.205535 (i.e. slightly newer than yours)

?         sprout 1.0-160814.205701 (i.e. much newer than yours)

?         the logging.bash script fix already applied.
It looks as though your might have taken the previous all-in-one image, and then upgraded some of the packages.  Please can you confirm: have you upgraded any packages?

On the issue you're seeing, I think you're saying that

?         you're running clearwater-sip-stress (which defaults to using numbers in the range above 2010000000)

?         you've deleted all these numbers from Homestead's Cassandra

?         you see errors in clearwater-sip-stress's log file saying that registration are failing with "404 Not Found".
I think this is expected - you need to provision numbers in Homestead's Cassandra that match the numbers that clearwater-sip-stress is expecting to register as.  Please let me know if I've misunderstood.

Thanks,

Matt

From: Kosala [mailto:kosalayb at gmail.com<mailto:kosalayb at gmail.com>]
Sent: 18 August 2016 11:46

To: Matt Williams (projectclearwater.org<http://projectclearwater.org>) <matt at projectclearwater.org<mailto:matt at projectclearwater.org>>
Subject: Re: [Project Clearwater] Clearwater Digest, Vol 40, Issue 24


Hi Matt,
I am running the latest version all-in-one which i downloaded from http://vm-images.cw-ngv.com/cw-aio.ova.

[cw-aio]ubuntu at cwaio:~$ sudo dpkg-query -s crest
[sudo] password for ubuntu:
Package: crest
Status: install ok installed
Priority: optional
Section: network
Installed-Size: 40102
Maintainer: Project Clearwater Maintainers <maintainers at projectclearwater.org<mailto:maintainers at projectclearwater.org>>
Architecture: amd64
Version: 1.0-160818.091648
homestead
Version: 1.0-160812.164051
sprout
Version: 1.0-160726.101022
And one strange thing is:
I deleted all the records in tables from homestead_cache and homestead_provisioning. Then when I check the SIP node for logs, sip-stress_14320_errors.log still has records with sip: ids which are not in Cassandra. For example, sip:2010021460 at example.com<mailto:sip%3A2010021460 at example.com>
2016-08-18      10:26:08:288    1471515968.288189: Aborting call on unexpected message for Call-Id '4270-14320 at 10.0.22.193<mailto:4270-14320 at 10.0.22.193>': while expecting '401' (index 3), received 'SIP/2.0 404 Not Found^M
Via: SIP/2.0/TCP 10.0.22.193:5060;rport=35233;received=10.0.22.193;branch=z9hG4bK-14320-4270-2-2010021460-^M
Record-Route: <sip:scscf.cwaio:5054;transport=TCP;lr;service=scscf;billing-role=charge-orig>^M
Call-ID: 2010021460///4270-14320 at 10.0.22.193<mailto:4270-14320 at 10.0.22.193>^M
From: <sip:2010021460 at example.com<mailto:sip%3A2010021460 at example.com>>;tag=14320SIPpTag004270^M
To: <sip:2010021460 at example.com<mailto:sip%3A2010021460 at example.com>>;tag=z9hG4bKPjVe2he9j28lou.0Dl9NmKGS7ypUMLjMJv^M
CSeq: 1 REGISTER^M
Content-Length:  0^M
Thanks
Kosala

On Thu, Aug 18, 2016 at 10:47 AM, Matt Williams (projectclearwater.org<http://projectclearwater.org>) <matt at projectclearwater.org<mailto:matt at projectclearwater.org>> wrote:
Kosala,

The fix is not to copy this to /usr/share/clearwater/utils, but to move it.  However, since the error is benign, I'd suggest just ignoring it while we get this working.

As I asked below, please can you confirm what version you're running?  I'm concerned that it's going to be very hard to troubleshoot problems if you have an all-in-one image from a few weeks ago, with some packages updated to more recent versions and then some further fixes manually applied.

Thanks,

Matt


From: Kosala [mailto:kosalayb at gmail.com<mailto:kosalayb at gmail.com>]
Sent: 18 August 2016 10:34

To: Matt Williams (projectclearwater.org<http://projectclearwater.org>) <matt at projectclearwater.org<mailto:matt at projectclearwater.org>>
Cc: clearwater at lists.projectclearwater.org<mailto:clearwater at lists.projectclearwater.org>
Subject: Re: [Project Clearwater] Clearwater Digest, Vol 40, Issue 24

Hi Matt,
Yeah, Manual calls are working fine.
As it is said in the big fix, https://github.com/Metaswitch/clearwater-infrastructure/issues/355 , I copied logging.bash to /usr/share/clearwater/utils
but I am still getting

/etc/init.d/clearwater-infrastructure: 76: /etc/init.d/clearwater-infrastructure: /usr/share/clearwater/infrastructure/scripts/logging.bash: Permission denied
Configuring monit for only localhost access
Kosala


On Thu, Aug 18, 2016 at 10:01 AM, Matt Williams (projectclearwater.org<http://projectclearwater.org>) <matt at projectclearwater.org<mailto:matt at projectclearwater.org>> wrote:
Kosala,

Yes, it's https://github.com/Metaswitch/clearwater-infrastructure/issues/355 and it should be benign.

However, this was fixed about 2 weeks ago.  Please can you confirm when you downloaded the all-in-one image, and whether you've upgraded it all?  (As I observed earlier, your crest release was from only a few days ago.)

Have you got manual calls working?

Thanks,

Matt


From: Kosala [mailto:kosalayb at gmail.com<mailto:kosalayb at gmail.com>]
Sent: 18 August 2016 09:56
To: Matt Williams (projectclearwater.org<http://projectclearwater.org>) <matt at projectclearwater.org<mailto:matt at projectclearwater.org>>
Cc: clearwater at lists.projectclearwater.org<mailto:clearwater at lists.projectclearwater.org>

Subject: Re: [Project Clearwater] Clearwater Digest, Vol 40, Issue 24

Hi Matt,
In SIP node, when I am trying to execute "sudo service clearwater-sip-stress restart", I am getting an error

/etc/init.d/clearwater-infrastructure: 76: /etc/init.d/clearwater-infrastructure: /usr/share/clearwater/infrastructure/scripts/logging.bash: Permission denied
Configuring monit for only localhost access
Any clue about this error?
Thanks
Kosala


On Wed, Aug 17, 2016 at 2:29 PM, Matt Williams (projectclearwater.org<http://projectclearwater.org>) <matt at projectclearwater.org<mailto:matt at projectclearwater.org>> wrote:
Kosala,

Yes, that's the correct screen, and you're correct that it shows that stress is being attempted but failing.

Do regular (non-stress) calls work through this deployment?

You can look at what message the stress node is receiving in the log files in the /var/log/clearwater-sip-stress/ directory - I think there are "errors" logs that contain the unexpected messages.

You can obviously also look at what's happening on the all-in-one node itself, using the /var/log/bono/*, /var/log/sprout/* and /var/log/homestead/* files, as described at http://clearwater.readthedocs.io/en/latest/Troubleshooting_and_Recovery.html.

I hope that helps.

Cheers,

Matt

From: Kosala [mailto:kosalayb at gmail.com<mailto:kosalayb at gmail.com>]
Sent: 17 August 2016 14:20

To: Matt Williams (projectclearwater.org<http://projectclearwater.org>) <matt at projectclearwater.org<mailto:matt at projectclearwater.org>>
Subject: Re: [Project Clearwater] Clearwater Digest, Vol 40, Issue 24

Hi Matt,
I can see this scenario screen from sip-stress.1.out. I hope this will be the stress test output results.

------------------------------ Scenario Screen -------- [1-9]: Change Screen --
     Users (length)   Port   Total-time  Total-calls  Remote-host
        2500 (0 ms)   5060      77.15 s         2500  10.0.21.192:5060(TCP)

  Call limit reached (-m 2500), 1.002 s period  1 ms scheduler resolution
  2175 calls (limit 2500)                Peak was 2499 calls, after 0 s
  0 Running, 2177 Paused, 8 Woken up
  0 dead call msg (discarded)            0 out-of-call msg (discarded)
  3 open sockets

                                 Messages  Retrans   Timeout   Unexpected-Msg
       Pause [0ms/10:00]         2500                          0
    REGISTER ---------->         326       0
         401 <----------         0         0         0         325
    REGISTER ---------->         0         0
         200 <----------         0         0         0         0
    REGISTER ---------->         0         0
         401 <----------         0         0         0         0
    REGISTER ---------->         0         0
         200 <----------         0         0         0         0
       Pause [     4:50]         0                             0
    REGISTER ---------->  B-RTD1 0         0
         200 <----------  E-RTD1 0         0         0         0
    REGISTER ---------->  B-RTD1 0         0
         200 <----------  E-RTD1 0         0         0         0
       Pause [     4:50]         0                             0
       Pause [$pre_call_delay]   0                             0
      INVITE ---------->  B-RTD2 0         0
         100 <----------         0         0         0         0
      INVITE <----------         0         0         0         0
         100 <----------         0         0         0         0
      INVITE <----------         0         0         0         0
         100 ---------->         0         0
         180 ---------->         0         0
         180 <----------         0         0         0         0
       Pause [   6000ms]         0                             0
         200 ---------->         0         0
         200 <----------         0         0         0         0
         ACK ---------->         0         0
         ACK <----------         0         0         0         0
      UPDATE ---------->         0         0
      UPDATE <----------         0         0         0         0
         200 ---------->         0         0
         200 <----------  E-RTD2 0         0         0         0
       Pause [    24.0s]         0                             0
         BYE ---------->  B-RTD3 0         0
         BYE <----------         0         0         0         0
         200 ---------->         0         0
         200 <----------  E-RTD3 0         0         0         0
       Pause [$post_call_delay]  0                             0
------- Waiting for active calls to end. Press [q] again to force exit. -------
Last Error: Aborting call on unexpected message for Call-Id '1079-13729 at ...
However there is an unexpected message error at the end.
Thanks
Kosala


On Wed, Aug 17, 2016 at 12:40 PM, Matt Williams (projectclearwater.org<http://projectclearwater.org>) <matt at projectclearwater.org<mailto:matt at projectclearwater.org>> wrote:
Kosala,

They should log to /var/log/clearwater-sip-stress - in particular, the *.1.out file is a log of the output from sipp.  Do you see anything there?

Matt

From: Kosala [mailto:kosalayb at gmail.com<mailto:kosalayb at gmail.com>]
Sent: 17 August 2016 12:33
To: Matt Williams (projectclearwater.org<http://projectclearwater.org>) <matt at projectclearwater.org<mailto:matt at projectclearwater.org>>; clearwater at lists.projectclearwater.org<mailto:clearwater at lists.projectclearwater.org>

Subject: Re: [Project Clearwater] Clearwater Digest, Vol 40, Issue 24

Hi Matt,
I followed above steps and run sudo apt-get install clearwater-sip-stress.
How do I know stress tests are running? Is is said, stress tests start automatically but I cannot see it.
Thanks
Kosala



On Tue, Aug 16, 2016 at 2:01 PM, Matt Williams (projectclearwater.org<http://projectclearwater.org>) <matt at projectclearwater.org<mailto:matt at projectclearwater.org>> wrote:
Kosala,

I'm glad you've made progress on this.

I had a look at the crest package version, but it seems to be later than the most recent all-in-one image uses (1.0-160811.103635).  When did you download the all-in-one image, and did you apply any patches to it?

Regarding making calls for stress testing, this is where http://clearwater.readthedocs.io/en/latest/Clearwater_stress_testing.html#manual-i-e-non-chef-stress-runs comes in - you need to

?         create a separate VM

?         set the bono_hostname and count parameters in /etc/clearwater/shared_config

?         install the clearwater-sip-stress package.
I hope that helps.

BTW, please remember to copy in clearwater at lists.projectclearwater.org<mailto:clearwater at lists.projectclearwater.org> - that means that other people can see and comment on your posts.

Thanks,

Matt


From: Kosala [mailto:kosalayb at gmail.com<mailto:kosalayb at gmail.com>]
Sent: 16 August 2016 10:48
To: Matt Williams (projectclearwater.org<http://projectclearwater.org>) <matt at projectclearwater.org<mailto:matt at projectclearwater.org>>
Subject: Re: [Project Clearwater] Clearwater Digest, Vol 40, Issue 24

Hi Matt,
Bulk provisioning for all in one image is done using https://github.com/Metaswitch/crest/blob/dev/docs/Bulk-Provisioning%20Numbers.md.
I have records in tables in homestead_cache and homer.
Now How to make calls for stress testing?
Is there any guideline?
Many Thanks,
Kosala




On Tue, Aug 16, 2016 at 9:04 AM, Kosala <kosalayb at gmail.com<mailto:kosalayb at gmail.com>> wrote:
Hi Matt,
TBH, The document in https://github.com/Metaswitch/crest/blob/dev/docs/Bulk-Provisioning%20Numbers.md is not clear to me.
Step 1. Homestead node in deployment. I do not know where is that node in all in one image. It will be helpful the location of that folder from the root.
Step 2. A simple example will be helpful.
Thanks
Kosala


On Tue, Aug 16, 2016 at 8:50 AM, Kosala <kosalayb at gmail.com<mailto:kosalayb at gmail.com>> wrote:
Hi Matt,
I downloaded the all in one package from http://clearwater.readthedocs.io/en/stable/All_in_one_OVF_Installation.html
and imported using oracle virtual box on ubuntu 14.04,
Crest version
[cw-aio]ubuntu at cwaio:~$ sudo dpkg-query -s crest
Package: crest
Status: install ok installed
Priority: optional
Section: network
Installed-Size: 40098
Maintainer: Project Clearwater Maintainers <maintainers at projectclearwater.org<mailto:maintainers at projectclearwater.org>>
Architecture: amd64
Version: 1.0-160815.145007
Thanks
Kosala


On Mon, Aug 15, 2016 at 5:56 PM, Matt Williams (projectclearwater.org<http://projectclearwater.org>) <matt at projectclearwater.org<mailto:matt at projectclearwater.org>> wrote:
Kosala,

That's odd - I don't see that failure on my all-in-one image (spun up just now from the latest image) - which version of all-in-one-image are you running, and which version of crest does it include ("sudo dpkg-query -s crest")?

You may be able to work-around this either by taking the latest all-in-one image or by following the simpler bulk-provisioning process at https://github.com/Metaswitch/crest/blob/dev/docs/Bulk-Provisioning%20Numbers.md (when this doc talks about using the sstables_provisioning process for very large sets of numbers, we mean 1M+ numbers - the 9000 you're provisioning are well within the capabilities of this process).

I hope that helps - please let me know how you get on.

Cheers,

Matt


From: Clearwater [mailto:clearwater-bounces at lists.projectclearwater.org<mailto:clearwater-bounces at lists.projectclearwater.org>] On Behalf Of Kosala
Sent: 15 August 2016 16:58
To: clearwater at lists.projectclearwater.org<mailto:clearwater at lists.projectclearwater.org>
Subject: Re: [Project Clearwater] Clearwater Digest, Vol 40, Issue 24

HI Matt,
Thanks.

I am trying to follow https://github.com/Metaswitch/crest/blob/dev/src/metaswitch/crest/tools/sstable_provisioning/README.md for bulk provisioning.

When I am trying to execute sudo ./BulkProvision homer 21000 29999 example.com<http://example.com> 7kkzTyGW in all-in-one image,
I am getting an error  java.lang.UnsupportedClassVersionError: ClearwaterBulkProvisioner : Unsupported major.minor version 52.0
Java version info in all-in-one image:
[cw-aio]ubuntu at cwaio:/usr/share/clearwater/crest/tools/sstable_provisioning$ java -version
java version "1.7.0_101"
OpenJDK Runtime Environment (IcedTea 2.6.6) (7u101-2.6.6-0ubuntu0.14.04.1)
OpenJDK 64-Bit Server VM (build 24.95-b01, mixed mode)
Thanks
Kosala



On Mon, Aug 15, 2016 at 2:17 PM, <clearwater-request at lists.projectclearwater.org<mailto:clearwater-request at lists.projectclearwater.org>> wrote:
Send Clearwater mailing list submissions to
        clearwater at lists.projectclearwater.org<mailto:clearwater at lists.projectclearwater.org>

To subscribe or unsubscribe via the World Wide Web, visit
        http://lists.projectclearwater.org/mailman/listinfo/clearwater_lists.projectclearwater.org

or, via email, send a message with subject or body 'help' to
        clearwater-request at lists.projectclearwater.org<mailto:clearwater-request at lists.projectclearwater.org>

You can reach the person managing the list at
        clearwater-owner at lists.projectclearwater.org<mailto:clearwater-owner at lists.projectclearwater.org>

When replying, please edit your Subject line so it is more specific
than "Re: Contents of Clearwater digest..."


Today's Topics:

   1. Stress Testing (Kosala)
   2. Re: Stress Testing (Matt Williams (projectclearwater.org<http://projectclearwater.org>))
   3. Re: Stress Testing (Matt Williams (projectclearwater.org<http://projectclearwater.org>))


----------------------------------------------------------------------

Message: 1
Date: Mon, 15 Aug 2016 10:38:57 +0100
From: Kosala <kosalayb at gmail.com<mailto:kosalayb at gmail.com>>
To: clearwater at lists.projectclearwater.org<mailto:clearwater at lists.projectclearwater.org>
Subject: [Project Clearwater] Stress Testing
Message-ID:
        <CAGEe17an2B_bGj8NfKFwms+nU=vJURyhT5CE+mcY1pjcm4YF+A at mail.gmail.com<mailto:vJURyhT5CE%2BmcY1pjcm4YF%2BA at mail.gmail.com>>
Content-Type: text/plain; charset="utf-8"

Hi Team,

I installed clearwater "all-in-one" image on Oracle Virtual Box.
1. Can I do stress testing ?
2. How to do that?

I am trying to follow Stress Testing on
http://clearwater.readthedocs.io/en/stable/Clearwater_stress_testing.html#configuring-udp-stress
.

Using chef - > It seems chef/knife install only supports in the Cloud
approach (The automated install is only supported for deployments running
in Amazon?s EC2 cloud).

Manual approach, It looks not supporting all in one image.

Many Thanks
Kosala
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.projectclearwater.org/pipermail/clearwater_lists.projectclearwater.org/attachments/20160815/15fc3b07/attachment-0001.html>

------------------------------

Message: 2
Date: Mon, 15 Aug 2016 09:54:02 +0000
From: "Matt Williams (projectclearwater.org<http://projectclearwater.org>)"
        <matt at projectclearwater.org<mailto:matt at projectclearwater.org>>
To: Kosala <kosalayb at gmail.com<mailto:kosalayb at gmail.com>>
Cc: "clearwater at lists.projectclearwater.org<mailto:clearwater at lists.projectclearwater.org>"
        <clearwater at lists.projectclearwater.org<mailto:clearwater at lists.projectclearwater.org>>
Subject: Re: [Project Clearwater] Stress Testing
Message-ID:
        <CY1PR0201MB15636F1F20EB91BB180F053390120 at CY1PR0201MB1563.namprd02.prod.outlook.com<mailto:CY1PR0201MB15636F1F20EB91BB180F053390120 at CY1PR0201MB1563.namprd02.prod.outlook.com>>

Content-Type: text/plain; charset="utf-8"

Kosala,

While it's theoretically possible to do stress testing against an all-in-one image, I'd recommend against it - the all-in-one image has been squeezed down a lot to fit on a single VM and we'd expect very low performance out of it, and I could believe that overload behavior might be suboptimal.  If you're looking to stress test for performance reasons, I'd strongly recommend running a full deployment as this will give you much more reliable numbers.  If you're looking to stress test for other reasons, please can you share a bit more about what you're trying to achieve, and we can have a think about what would work best?

If you do really want to run stress testing against an all-in-one image, it should probably work, even though http://clearwater.readthedocs.io/en/latest/Clearwater_stress_testing.html#manual-i-e-non-chef-stress-runs only talks about Chef and manual installs.  You'd need to set the "bono_servers" option in /etc/clearwater/shared_config to point to your all-in-one node, and I suspect you'd need to reduce the "count" option to something a lot lower - I'd start around 5000 and see how that goes.

I hope that helps.  Please let me know how you get on.

Thanks,

Matt

From: Clearwater [mailto:clearwater-bounces at lists.projectclearwater.org<mailto:clearwater-bounces at lists.projectclearwater.org>] On Behalf Of Kosala
Sent: 15 August 2016 10:39
To: clearwater at lists.projectclearwater.org<mailto:clearwater at lists.projectclearwater.org>
Subject: [Project Clearwater] Stress Testing

Hi Team,
I installed clearwater "all-in-one" image on Oracle Virtual Box.
1. Can I do stress testing ?
2. How to do that?
I am trying to follow Stress Testing on http://clearwater.readthedocs.io/en/stable/Clearwater_stress_testing.html#configuring-udp-stress.
Using chef - > It seems chef/knife install only supports in the Cloud approach (The automated install is only supported for deployments running in Amazon?s EC2 cloud).
Manual approach, It looks not supporting all in one image.
Many Thanks
Kosala

-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.projectclearwater.org/pipermail/clearwater_lists.projectclearwater.org/attachments/20160815/29d6328d/attachment-0001.html>

------------------------------

Message: 3
Date: Mon, 15 Aug 2016 13:16:47 +0000
From: "Matt Williams (projectclearwater.org<http://projectclearwater.org>)"
        <matt at projectclearwater.org<mailto:matt at projectclearwater.org>>
To: "clearwater at lists.projectclearwater.org<mailto:clearwater at lists.projectclearwater.org>"
        <clearwater at lists.projectclearwater.org<mailto:clearwater at lists.projectclearwater.org>>
Subject: Re: [Project Clearwater] Stress Testing
Message-ID:
        <CY1PR0201MB156372246DC5A77B11839F9D90120 at CY1PR0201MB1563.namprd02.prod.outlook.com<mailto:CY1PR0201MB156372246DC5A77B11839F9D90120 at CY1PR0201MB1563.namprd02.prod.outlook.com>>

Content-Type: text/plain; charset="utf-8"

Kosala,

You'll need to follow all the steps in http://clearwater.readthedocs.io/en/latest/Clearwater_stress_testing.html#manual-i-e-non-chef-stress-runs, i.e. bulk provisioning subscribers and installing clearwater-sip-stress, but that should be it.

Just to be clear, though, you'll need to set the configuration and install the clearwater-sip-stress package on a separate VM, not on the all-in-one image itself - the all-in-one image almost certainly opens up ports that conflict with those that clearwater-sip-stress tries to use.

This isn't a very well-trodden path, though, so you may hit further issues - let me know if so, and we can try to work through them.

Cheers,

Matt

From: Kosala [mailto:kosalayb at gmail.com<mailto:kosalayb at gmail.com>]
Sent: 15 August 2016 13:41
To: Matt Williams (projectclearwater.org<http://projectclearwater.org>) <matt at projectclearwater.org<mailto:matt at projectclearwater.org>>
Subject: Re: [Project Clearwater] Stress Testing

Hi Matt,
Thanks. I set the bono_servers option. Should I add count =5000 to /etc/clearwater/shared_config ?

Do I need other changes to run stress tests on all-in-one image?
Thanks
Kosala



On Mon, Aug 15, 2016 at 10:54 AM, Matt Williams (projectclearwater.org<http://projectclearwater.org><http://projectclearwater.org>) <matt at projectclearwater.org<mailto:matt at projectclearwater.org><mailto:matt at projectclearwater.org<mailto:matt at projectclearwater.org>>> wrote:
Kosala,

While it's theoretically possible to do stress testing against an all-in-one image, I'd recommend against it - the all-in-one image has been squeezed down a lot to fit on a single VM and we'd expect very low performance out of it, and I could believe that overload behavior might be suboptimal.  If you're looking to stress test for performance reasons, I'd strongly recommend running a full deployment as this will give you much more reliable numbers.  If you're looking to stress test for other reasons, please can you share a bit more about what you're trying to achieve, and we can have a think about what would work best?

If you do really want to run stress testing against an all-in-one image, it should probably work, even though http://clearwater.readthedocs.io/en/latest/Clearwater_stress_testing.html#manual-i-e-non-chef-stress-runs only talks about Chef and manual installs.  You'd need to set the "bono_servers" option in /etc/clearwater/shared_config to point to your all-in-one node, and I suspect you'd need to reduce the "count" option to something a lot lower - I'd start around 5000 and see how that goes.

I hope that helps.  Please let me know how you get on.

Thanks,

Matt

From: Clearwater [mailto:clearwater-bounces at lists.projectclearwater.org<mailto:clearwater-bounces at lists.projectclearwater.org><mailto:clearwater-bounces at lists.projectclearwater.org<mailto:clearwater-bounces at lists.projectclearwater.org>>] On Behalf Of Kosala
Sent: 15 August 2016 10:39
To: clearwater at lists.projectclearwater.org<mailto:clearwater at lists.projectclearwater.org><mailto:clearwater at lists.projectclearwater.org<mailto:clearwater at lists.projectclearwater.org>>
Subject: [Project Clearwater] Stress Testing

Hi Team,
I installed clearwater "all-in-one" image on Oracle Virtual Box.
1. Can I do stress testing ?
2. How to do that?
I am trying to follow Stress Testing on http://clearwater.readthedocs.io/en/stable/Clearwater_stress_testing.html#configuring-udp-stress.
Using chef - > It seems chef/knife install only supports in the Cloud approach (The automated install is only supported for deployments running in Amazon?s EC2 cloud).
Manual approach, It looks not supporting all in one image.
Many Thanks
Kosala


-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.projectclearwater.org/pipermail/clearwater_lists.projectclearwater.org/attachments/20160815/11781755/attachment.html>

------------------------------

Subject: Digest Footer

_______________________________________________
Clearwater mailing list
Clearwater at lists.projectclearwater.org<mailto:Clearwater at lists.projectclearwater.org>
http://lists.projectclearwater.org/mailman/listinfo/clearwater_lists.projectclearwater.org


------------------------------

End of Clearwater Digest, Vol 40, Issue 24
******************************************













-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.projectclearwater.org/pipermail/clearwater_lists.projectclearwater.org/attachments/20160819/62631f90/attachment.html>

From kosalayb at gmail.com  Fri Aug 19 09:18:00 2016
From: kosalayb at gmail.com (Kosala)
Date: Fri, 19 Aug 2016 14:18:00 +0100
Subject: [Project Clearwater] Clearwater Digest, Vol 40, Issue 24
In-Reply-To: <CY1PR0201MB15636BFF26E9DC4A542D105A90160@CY1PR0201MB1563.namprd02.prod.outlook.com>
References: <mailman.20.1471267072.11502.clearwater_lists.projectclearwater.org@lists.projectclearwater.org>
	<CAGEe17ZLnypQfbzxEwxj9EaB20MUBVpY+YdN-Obv=gHpZmG0KA@mail.gmail.com>
	<CY1PR0201MB1563F9A706F3EC7BE7F9C11590120@CY1PR0201MB1563.namprd02.prod.outlook.com>
	<CAGEe17bfTu1Kpwx=ipqtEbShvWtP+C6pJEEGHi0GSwBR5Dqw8w@mail.gmail.com>
	<CAGEe17aY077tLtotRe1X8k1qU_4otBdHDMJjqDH_g02Zs676Jg@mail.gmail.com>
	<CAGEe17ZeNPPy7AmMz=LCWnHqLm=v9Q7CuLT+AOVKWJTdg8m7Eg@mail.gmail.com>
	<CY1PR0201MB1563CE17983225B985B19D7390130@CY1PR0201MB1563.namprd02.prod.outlook.com>
	<CAGEe17b2M2uqvbOuqH7t4xM41FbfBYk0xR3zWqiFh+EkSfUzUQ@mail.gmail.com>
	<CY1PR0201MB1563CD5DDDD6E7B5A0B2DB7290140@CY1PR0201MB1563.namprd02.prod.outlook.com>
	<CAGEe17YGnaY1Kqc65gyiVO1sBBuTx=-YzfD9HY3M6QBD2t9AkA@mail.gmail.com>
	<CY1PR0201MB156349F26A0A7670BE7382A890140@CY1PR0201MB1563.namprd02.prod.outlook.com>
	<CAGEe17ZkY2ESNzwQYddrv6=jUJ5fPHu3gJXT7R1UjQmBd+eFUg@mail.gmail.com>
	<CY1PR0201MB1563C979B2D641DA59F1945A90150@CY1PR0201MB1563.namprd02.prod.outlook.com>
	<CAGEe17bC+xmhP3D7w768r0svzBAxdBedVXhis1Z33Yqdq4THgA@mail.gmail.com>
	<CY1PR0201MB1563F865DFBF86128118AC5290150@CY1PR0201MB1563.namprd02.prod.outlook.com>
	<CAGEe17Z2wBvTgPrnK_TdQPerVE9Moxnt=u9CWPpq8V04GJtfUw@mail.gmail.com>
	<CY1PR0201MB1563A30C3B9C4D8EE65FAD4390150@CY1PR0201MB1563.namprd02.prod.outlook.com>
	<CAGEe17ZVrag9yFkLgPF-kfgDPDT_nJETkei_Uwv47mohbAwyxg@mail.gmail.com>
	<CY1PR0201MB156325107DAA32BF9480667B90150@CY1PR0201MB1563.namprd02.prod.outlook.com>
	<CAGEe17bWEkdYazAcTOTq2+7kxwR=yYx04MT-QzjsHQ5HWPAD5Q@mail.gmail.com>
	<CY1PR0201MB15630493B218F47026930AF490150@CY1PR0201MB1563.namprd02.prod.outlook.com>
	<CAGEe17bpA32DECgJWrwvAHE1EO2XkfeweJR3JEQgw7TrmzAzdA@mail.gmail.com>
	<CY1PR0201MB1563E75F9D52ED36CB03D96F90150@CY1PR0201MB1563.namprd02.prod.outlook.com>
	<CAGEe17bXHHy=9CFtzWiqSGpqmL31bg5ck7PN1h1YVQ2r1YtosQ@mail.gmail.com>
	<CY1PR0201MB15636BFF26E9DC4A542D105A90160@CY1PR0201MB1563.namprd02.prod.outlook.com>
Message-ID: <CAGEe17anLOCooyLj9LaX5RN2H8-dBsS7oMT9LvWz9E5mNjQ3Dg@mail.gmail.com>

Hi Matt,

Thanks a mil for the given support.

Kosala


On Fri, Aug 19, 2016 at 9:17 AM, Matt Williams (projectclearwater.org) <
matt at projectclearwater.org> wrote:

> Kosala,
>
>
>
> You are correct that stress runs continuously - there is no way of
> stopping it cleanly.  Obviously, if you just run "sudo service
> clearwater-sip-stress stop", this will stop it, but it will do so at an
> arbitrary point in the call.  FYI, when running stress, each number calls
> at a random time (we try to simulate a more realistic call pattern than
> just regular calling).
>
>
>
> There may be ways to make progress here but unfortunately I can't be more
> helpful than this - as explained earlier, the all in one node simply isn?t
> intended for stress testing, and we recommend you switch over to a multi
> node deployment before doing this.
>
>
>
> Matt
>
>
>
> *From:* Kosala [mailto:kosalayb at gmail.com]
> *Sent:* 18 August 2016 17:14
> *To:* Matt Williams (projectclearwater.org) <matt at projectclearwater.org>
> *Cc:* clearwater at lists.projectclearwater.org
> *Subject:* Re: [Project Clearwater] Clearwater Digest, Vol 40, Issue 24
>
>
>
> Hi Matt,
>
>
> In stress testing, can i stop stress testing after testing for a fixed
> number. for example after 20 numbers ?. It seems stress testing is
> continuously running at SIP node.
>
> If I set count to 5, it will run 0 to 5, then again 0 to 5. I am not sure
> if i am right?
>
>
> Kosala
>
>
>
>
>
> On Thu, Aug 18, 2016 at 4:57 PM, Matt Williams (projectclearwater.org) <
> matt at projectclearwater.org> wrote:
>
> Kosala,
>
>
>
> It's good that you've got this working.
>
>
>
> You asked again about finding statistics for CPU time and memory usage per
> call.  As I said at the beginning of the trail, the all-in-one node is not
> set up for stress and any numbers you get out of this on all-in-one node
> will be far higher than you would see in practice and probably very noisy
> too.  Unfortunately, if you want numbers like this, you will need to set up
> a full deployment.
>
>
>
> Matt
>
>
>
> *From:* Kosala [mailto:kosalayb at gmail.com]
> *Sent:* 18 August 2016 16:43
>
>
> *To:* Matt Williams (projectclearwater.org) <matt at projectclearwater.org>
> *Cc:* clearwater at lists.projectclearwater.org
> *Subject:* Re: [Project Clearwater] Clearwater Digest, Vol 40, Issue 24
>
>
>
> HI Matt,
>
> I could get it working for 5 numbers. I will increase and see how far i
> can increase numbers. Then I like to see how to find statistics such as
> memory usage, cpu time per call etc.
>
>
>
> Kosala
>
>
>
> On Thu, Aug 18, 2016 at 3:53 PM, Matt Williams (projectclearwater.org) <
> matt at projectclearwater.org> wrote:
>
> Kosala,
>
>
>
> This is what the "count" option on the stress node controls (see
> http://clearwater.readthedocs.io/en/latest/Clearwater_
> stress_testing.html#manual-i-e-non-chef-stress-runs for details).  If you
> only want to make calls to/from the first 100 numbers, set this to 100.
>
>
>
> Are these calls going through successfully, then?
>
>
>
> Matt
>
>
>
> *From:* Kosala [mailto:kosalayb at gmail.com]
> *Sent:* 18 August 2016 15:20
> *To:* Matt Williams (projectclearwater.org) <matt at projectclearwater.org>
>
> *Cc:* clearwater at lists.projectclearwater.org
> *Subject:* Re: [Project Clearwater] Clearwater Digest, Vol 40, Issue 24
>
>
>
> Hi Matt,
>
> Thanks. SIP node is calling numbers in a larger range starting from 2010000000.
> Can I restrict SIP call invoke from
>
> 2010000000 to 2010000099?
>
> I can do bulk provision 100 numbers. I do not know how to restrict SIP
> node to call only these 100 numbers?
>
> Thanks
>
> Kosala
>
>
>
>
>
> On Thu, Aug 18, 2016 at 2:59 PM, Matt Williams (projectclearwater.org) <
> matt at projectclearwater.org> wrote:
>
> Kosala,
>
>
>
> The error you're seeing suggests that the request is timing out between
> Bono and Sprout.  This could be due to poor performance on the all-in-one
> node (as I said previously, the all-in-one node is not intended for running
> stress), or it could be due to a more general misconfiguration.  Are all
> REGISTERs failing, or just some?
>
>
>
> Regarding getting CPU statistics etc., we normally use Cacti.  There are
> instructions for setting this up at http://clearwater.readthedocs.
> io/en/latest/Cacti.html.  However, I doubt this will work as-is with your
> all-in-one node.  Since you only have one node, maybe you're best just
> looking at top?
>
>
>
> Matt
>
>
>
> *From:* Kosala [mailto:kosalayb at gmail.com]
> *Sent:* 18 August 2016 14:13
>
>
> *To:* Matt Williams (projectclearwater.org) <matt at projectclearwater.org>
> *Cc:* clearwater at lists.projectclearwater.org
> *Subject:* Re: [Project Clearwater] Clearwater Digest, Vol 40, Issue 24
>
>
>
> Hi Matt,
>
> Now for the numbers I have in Cassandra, at SP node, I am getting "SIP/2.0
> 504 Server Timeout"
>
> 2016-08-18      11:49:03:189    1471520943.189039: Aborting call on
> unexpected message for Call-Id '1073-27637 at 10.0.22.193': while expecting
> '401' (index 3), received 'SIP/2.0 504 Server Timeout^M
> Via: SIP/2.0/TCP 10.0.22.193:5060;rport=32939;received=10.0.22.193;branch=
> z9hG4bK-27637-1073-2-2010000854-^M
> Record-Route: <sip:scscf.cwaio:5054;transport=TCP;lr;service=
> scscf;billing-role=charge-orig>^M
> Call-ID: 2010000854///1073-27637 at 10.0.22.193^M
> From: <sip:2010000854 at example.com>;tag=27637SIPpTag001073^M
> To: <sip:2010000854 at example.com>;tag=z9hG4bKPjuN16eRA0bDott9z6ZA-
> fwIYe3VA-KMkQ^M
> CSeq: 1 REGISTER^M
> Content-Length:  0^M
> ^M
> '.
> 2016-08-18      11:49:04:185    1471520944.185945: Aborting call on
> unexpected message for Call-Id '1154-27637 at 10.0.22.193': while expecting
> '401' (index 3), received 'SIP/2.0 504 Server Timeout^M
> Via: SIP/2.0/TCP 10.0.22.193:5060;rport=32940;received=10.0.22.193;branch=
> z9hG4bK-27637-1154-2-2010000692-^M
> Record-Route: <sip:scscf.cwaio:5054;transport=TCP;lr;service=
> scscf;billing-role=charge-orig>^M
> Call-ID: 2010000692///1154-27637 at 10.0.22.193^M
> From: <sip:2010000692 at example.com>;tag=27637SIPpTag001154^M
> To: <sip:2010000692 at example.com>;tag=z9hG4bKPjk-
> 5lYhadbnX7rqNirT8tjwQdDjLAQo0j^M
> CSeq: 1 REGISTER^M
> Content-Length:  0^M
>
> How do I know, stress tests are running properly? Can I see statistics
> such as memory usage, cpu time,  etc ?
>
> Thanks
>
> Kosala
>
>
>
>
>
> On Thu, Aug 18, 2016 at 12:38 PM, Matt Williams (projectclearwater.org) <
> matt at projectclearwater.org> wrote:
>
> Kosala,
>
>
>
> Thanks!  I'm very confused about your software version, though, as the
> latest all-in-one image has
>
> ?         crest 1.0-160811.103635 (i.e. older than yours)
>
> ?         homestead 1.0-160814.205535 (i.e. slightly newer than yours)
>
> ?         sprout 1.0-160814.205701 (i.e. much newer than yours)
>
> ?         the logging.bash script fix already applied.
>
> It looks as though your might have taken the previous all-in-one image,
> and then upgraded some of the packages.  Please can you confirm: have you
> upgraded any packages?
>
>
>
> On the issue you're seeing, I think you're saying that
>
> ?         you're running clearwater-sip-stress (which defaults to using
> numbers in the range above 2010000000)
>
> ?         you've deleted all these numbers from Homestead's Cassandra
>
> ?         you see errors in clearwater-sip-stress's log file saying that
> registration are failing with "404 Not Found".
>
> I think this is expected - you need to provision numbers in Homestead's
> Cassandra that match the numbers that clearwater-sip-stress is expecting to
> register as.  Please let me know if I've misunderstood.
>
>
>
> Thanks,
>
>
>
> Matt
>
>
>
> *From:* Kosala [mailto:kosalayb at gmail.com]
> *Sent:* 18 August 2016 11:46
>
>
> *To:* Matt Williams (projectclearwater.org) <matt at projectclearwater.org>
> *Subject:* Re: [Project Clearwater] Clearwater Digest, Vol 40, Issue 24
>
>
>
>
>
> Hi Matt,
>
> I am running the latest version all-in-one which i downloaded from
> http://vm-images.cw-ngv.com/cw-aio.ova.
>
> [cw-aio]ubuntu at cwaio:~$ sudo dpkg-query -s crest
> [sudo] password for ubuntu:
> Package: crest
> Status: install ok installed
> Priority: optional
> Section: network
> Installed-Size: 40102
> Maintainer: Project Clearwater Maintainers <maintainers@
> projectclearwater.org>
> Architecture: amd64
> Version: 1.0-160818.091648
>
> homestead
> Version: 1.0-160812.164051
>
> sprout
> Version: 1.0-160726.101022
>
> And one strange thing is:
>
> I deleted all the records in tables from homestead_cache and
> homestead_provisioning. Then when I check the SIP node for logs,
> sip-stress_14320_errors.log still has records with sip: ids which are not
> in Cassandra. For example, sip:2010021460 at example.com
>
> 2016-08-18      10:26:08:288    1471515968.288189: Aborting call on
> unexpected message for Call-Id '4270-14320 at 10.0.22.193': while expecting
> '401' (index 3), received 'SIP/2.0 404 Not Found^M
> Via: SIP/2.0/TCP 10.0.22.193:5060;rport=35233;received=10.0.22.193;branch=
> z9hG4bK-14320-4270-2-2010021460-^M
> Record-Route: <sip:scscf.cwaio:5054;transport=TCP;lr;service=
> scscf;billing-role=charge-orig>^M
> Call-ID: 2010021460///4270-14320 at 10.0.22.193^M
> From: <sip:2010021460 at example.com>;tag=14320SIPpTag004270^M
> To: <sip:2010021460 at example.com>;tag=z9hG4bKPjVe2he9j28lou.
> 0Dl9NmKGS7ypUMLjMJv^M
> CSeq: 1 REGISTER^M
> Content-Length:  0^M
>
> Thanks
>
> Kosala
>
>
>
> On Thu, Aug 18, 2016 at 10:47 AM, Matt Williams (projectclearwater.org) <
> matt at projectclearwater.org> wrote:
>
> Kosala,
>
>
>
> The fix is not to *copy* this to /usr/share/clearwater/utils, but to
> *move* it.  However, since the error is benign, I'd suggest just ignoring
> it while we get this working.
>
>
>
> As I asked below, please can you confirm what version you're running?  I'm
> concerned that it's going to be very hard to troubleshoot problems if you
> have an all-in-one image from a few weeks ago, with some packages updated
> to more recent versions and then some further fixes manually applied.
>
>
>
> Thanks,
>
>
>
> Matt
>
>
>
>
>
> *From:* Kosala [mailto:kosalayb at gmail.com]
> *Sent:* 18 August 2016 10:34
>
>
> *To:* Matt Williams (projectclearwater.org) <matt at projectclearwater.org>
> *Cc:* clearwater at lists.projectclearwater.org
> *Subject:* Re: [Project Clearwater] Clearwater Digest, Vol 40, Issue 24
>
>
>
> Hi Matt,
>
> Yeah, Manual calls are working fine.
>
> As it is said in the big fix, https://github.com/Metaswitch/
> clearwater-infrastructure/issues/355 , I copied logging.bash to
> /usr/share/clearwater/utils
>
> but I am still getting
>
> /etc/init.d/clearwater-infrastructure: 76: /etc/init.d/clearwater-infrastructure:
> /usr/share/clearwater/infrastructure/scripts/logging.bash: Permission
> denied
> Configuring monit for only localhost access
>
> Kosala
>
>
>
>
>
> On Thu, Aug 18, 2016 at 10:01 AM, Matt Williams (projectclearwater.org) <
> matt at projectclearwater.org> wrote:
>
> Kosala,
>
>
>
> Yes, it's https://github.com/Metaswitch/clearwater-infrastructure/
> issues/355 and it should be benign.
>
>
>
> However, this was fixed about 2 weeks ago.  Please can you confirm when
> you downloaded the all-in-one image, and whether you've upgraded it all?
> (As I observed earlier, your crest release was from only a few days ago.)
>
>
>
> Have you got manual calls working?
>
>
>
> Thanks,
>
>
>
> Matt
>
>
>
>
>
> *From:* Kosala [mailto:kosalayb at gmail.com]
> *Sent:* 18 August 2016 09:56
> *To:* Matt Williams (projectclearwater.org) <matt at projectclearwater.org>
> *Cc:* clearwater at lists.projectclearwater.org
>
>
> *Subject:* Re: [Project Clearwater] Clearwater Digest, Vol 40, Issue 24
>
>
>
> Hi Matt,
>
> In SIP node, when I am trying to execute "sudo service
> clearwater-sip-stress restart", I am getting an error
>
>
> /etc/init.d/clearwater-infrastructure: 76: /etc/init.d/clearwater-infrastructure:
> /usr/share/clearwater/infrastructure/scripts/logging.bash: Permission
> denied
> Configuring monit for only localhost access
>
> Any clue about this error?
>
> Thanks
>
> Kosala
>
>
>
>
>
> On Wed, Aug 17, 2016 at 2:29 PM, Matt Williams (projectclearwater.org) <
> matt at projectclearwater.org> wrote:
>
> Kosala,
>
>
>
> Yes, that's the correct screen, and you're correct that it shows that
> stress is being attempted but failing.
>
>
>
> Do regular (non-stress) calls work through this deployment?
>
>
>
> You can look at what message the stress node is receiving in the log files
> in the /var/log/clearwater-sip-stress/ directory - I think there are
> "errors" logs that contain the unexpected messages.
>
>
>
> You can obviously also look at what's happening on the all-in-one node
> itself, using the /var/log/bono/*, /var/log/sprout/* and
> /var/log/homestead/* files, as described at http://clearwater.readthedocs.
> io/en/latest/Troubleshooting_and_Recovery.html.
>
>
>
> I hope that helps.
>
>
>
> Cheers,
>
>
>
> Matt
>
>
>
> *From:* Kosala [mailto:kosalayb at gmail.com]
> *Sent:* 17 August 2016 14:20
>
>
> *To:* Matt Williams (projectclearwater.org) <matt at projectclearwater.org>
> *Subject:* Re: [Project Clearwater] Clearwater Digest, Vol 40, Issue 24
>
>
>
> Hi Matt,
>
> I can see this scenario screen from sip-stress.1.out. I hope this will be
> the stress test output results.
>
>
> ------------------------------ Scenario Screen -------- [1-9]: Change
> Screen --
>      Users (length)   Port   Total-time  Total-calls  Remote-host
>         2500 (0 ms)   5060      77.15 s         2500  10.0.21.192:5060
> (TCP)
>
>   Call limit reached (-m 2500), 1.002 s period  1 ms scheduler resolution
>   2175 calls (limit 2500)                Peak was 2499 calls, after 0 s
>   0 Running, 2177 Paused, 8 Woken up
>   0 dead call msg (discarded)            0 out-of-call msg
> (discarded)
>   3 open sockets
>
>                                  Messages  Retrans   Timeout
> Unexpected-Msg
>        Pause [0ms/10:00]         2500                          0
>     REGISTER ---------->         326       0
>          401 <----------         0         0         0         325
>     REGISTER ---------->         0         0
>          200 <----------         0         0         0         0
>     REGISTER ---------->         0         0
>          401 <----------         0         0         0         0
>     REGISTER ---------->         0         0
>          200 <----------         0         0         0         0
>        Pause [     4:50]         0                             0
>     REGISTER ---------->  B-RTD1 0         0
>          200 <----------  E-RTD1 0         0         0         0
>     REGISTER ---------->  B-RTD1 0         0
>          200 <----------  E-RTD1 0         0         0         0
>        Pause [     4:50]         0                             0
>        Pause [$pre_call_delay]   0                             0
>       INVITE ---------->  B-RTD2 0         0
>          100 <----------         0         0         0         0
>       INVITE <----------         0         0         0         0
>          100 <----------         0         0         0         0
>       INVITE <----------         0         0         0         0
>          100 ---------->         0         0
>          180 ---------->         0         0
>          180 <----------         0         0         0         0
>        Pause [   6000ms]         0                             0
>          200 ---------->         0         0
>          200 <----------         0         0         0         0
>          ACK ---------->         0         0
>          ACK <----------         0         0         0         0
>       UPDATE ---------->         0         0
>       UPDATE <----------         0         0         0         0
>          200 ---------->         0         0
>          200 <----------  E-RTD2 0         0         0         0
>        Pause [    24.0s]         0                             0
>          BYE ---------->  B-RTD3 0         0
>          BYE <----------         0         0         0         0
>          200 ---------->         0         0
>          200 <----------  E-RTD3 0         0         0         0
>        Pause [$post_call_delay]  0                             0
> ------- Waiting for active calls to end. Press [q] again to force exit.
> -------
> Last Error: Aborting call on unexpected message for Call-Id '1079-13729@
> ...
>
> However there is an unexpected message error at the end.
>
> Thanks
>
> Kosala
>
>
>
>
>
> On Wed, Aug 17, 2016 at 12:40 PM, Matt Williams (projectclearwater.org) <
> matt at projectclearwater.org> wrote:
>
> Kosala,
>
>
>
> They should log to /var/log/clearwater-sip-stress - in particular, the
> *.1.out file is a log of the output from sipp.  Do you see anything there?
>
>
>
> Matt
>
>
>
> *From:* Kosala [mailto:kosalayb at gmail.com]
> *Sent:* 17 August 2016 12:33
> *To:* Matt Williams (projectclearwater.org) <matt at projectclearwater.org>;
> clearwater at lists.projectclearwater.org
>
>
> *Subject:* Re: [Project Clearwater] Clearwater Digest, Vol 40, Issue 24
>
>
>
> Hi Matt,
>
> I followed above steps and run sudo apt-get install clearwater-sip-stress.
>
> How do I know stress tests are running? Is is said, stress tests start
> automatically but I cannot see it.
>
> Thanks
>
> Kosala
>
>
>
>
>
>
> On Tue, Aug 16, 2016 at 2:01 PM, Matt Williams (projectclearwater.org) <
> matt at projectclearwater.org> wrote:
>
> Kosala,
>
>
>
> I'm glad you've made progress on this.
>
>
>
> I had a look at the crest package version, but it seems to be later than
> the most recent all-in-one image uses (1.0-160811.103635).  When did you
> download the all-in-one image, and did you apply any patches to it?
>
>
>
> Regarding making calls for stress testing, this is where
> http://clearwater.readthedocs.io/en/latest/Clearwater_
> stress_testing.html#manual-i-e-non-chef-stress-runs comes in - you need to
>
> ?         create a separate VM
>
> ?         set the bono_hostname and count parameters in
> /etc/clearwater/shared_config
>
> ?         install the clearwater-sip-stress package.
>
> I hope that helps.
>
>
>
> BTW, please remember to copy in clearwater at lists.projectclearwater.org -
> that means that other people can see and comment on your posts.
>
>
>
> Thanks,
>
>
>
> Matt
>
>
>
>
>
> *From:* Kosala [mailto:kosalayb at gmail.com]
> *Sent:* 16 August 2016 10:48
> *To:* Matt Williams (projectclearwater.org) <matt at projectclearwater.org>
>
> *Subject:* Re: [Project Clearwater] Clearwater Digest, Vol 40, Issue 24
>
>
>
> Hi Matt,
>
> Bulk provisioning for all in one image is done using
> https://github.com/Metaswitch/crest/blob/dev/docs/Bulk-
> Provisioning%20Numbers.md.
>
> I have records in tables in homestead_cache and homer.
>
> Now How to make calls for stress testing?
>
> Is there any guideline?
>
> Many Thanks,
>
> Kosala
>
>
>
>
>
>
>
>
>
> On Tue, Aug 16, 2016 at 9:04 AM, Kosala <kosalayb at gmail.com> wrote:
>
> Hi Matt,
>
> TBH, The document in https://github.com/Metaswitch/
> crest/blob/dev/docs/Bulk-Provisioning%20Numbers.md is not clear to me.
>
> Step 1. Homestead node in deployment. I do not know where is that node in
> all in one image. It will be helpful the location of that folder from the
> root.
>
> Step 2. A simple example will be helpful.
>
> Thanks
>
> Kosala
>
>
>
>
>
> On Tue, Aug 16, 2016 at 8:50 AM, Kosala <kosalayb at gmail.com> wrote:
>
> Hi Matt,
>
> I downloaded the all in one package from http://clearwater.readthedocs.
> io/en/stable/All_in_one_OVF_Installation.html
>
> and imported using oracle virtual box on ubuntu 14.04,
>
> Crest version
>
> [cw-aio]ubuntu at cwaio:~$ sudo dpkg-query -s crest
> Package: crest
> Status: install ok installed
> Priority: optional
> Section: network
> Installed-Size: 40098
> Maintainer: Project Clearwater Maintainers <maintainers@
> projectclearwater.org>
> Architecture: amd64
> Version: 1.0-160815.145007
>
> Thanks
>
> Kosala
>
>
>
>
>
> On Mon, Aug 15, 2016 at 5:56 PM, Matt Williams (projectclearwater.org) <
> matt at projectclearwater.org> wrote:
>
> Kosala,
>
>
>
> That's odd - I don't see that failure on my all-in-one image (spun up just
> now from the latest image) - which version of all-in-one-image are you
> running, and which version of crest does it include ("sudo dpkg-query -s
> crest")?
>
>
>
> You may be able to work-around this either by taking the latest all-in-one
> image or by following the simpler bulk-provisioning process at
> https://github.com/Metaswitch/crest/blob/dev/docs/Bulk-
> Provisioning%20Numbers.md (when this doc talks about using the
> sstables_provisioning process for very large sets of numbers, we mean 1M+
> numbers - the 9000 you're provisioning are well within the capabilities of
> this process).
>
>
>
> I hope that helps - please let me know how you get on.
>
>
>
> Cheers,
>
>
>
> Matt
>
>
>
>
>
> *From:* Clearwater [mailto:clearwater-bounces at lists.projectclearwater.org]
> *On Behalf Of *Kosala
> *Sent:* 15 August 2016 16:58
> *To:* clearwater at lists.projectclearwater.org
> *Subject:* Re: [Project Clearwater] Clearwater Digest, Vol 40, Issue 24
>
>
>
> HI Matt,
>
> Thanks.
>
>
> I am trying to follow https://github.com/Metaswitch/
> crest/blob/dev/src/metaswitch/crest/tools/sstable_provisioning/README.md
> for bulk provisioning.
>
>
> When I am trying to execute sudo ./BulkProvision homer 21000 29999
> example.com 7kkzTyGW in all-in-one image,
> I am getting an error  java.lang.UnsupportedClassVersionError:
> ClearwaterBulkProvisioner : Unsupported major.minor version 52.0
>
> Java version info in all-in-one image:
> [cw-aio]ubuntu at cwaio:/usr/share/clearwater/crest/tools/sstable_provisioning$
> java -version
> java version "1.7.0_101"
> OpenJDK Runtime Environment (IcedTea 2.6.6) (7u101-2.6.6-0ubuntu0.14.04.1)
> OpenJDK 64-Bit Server VM (build 24.95-b01, mixed mode)
>
> Thanks
>
> Kosala
>
>
>
>
>
>
> On Mon, Aug 15, 2016 at 2:17 PM, <clearwater-request at lists.
> projectclearwater.org> wrote:
>
> Send Clearwater mailing list submissions to
>         clearwater at lists.projectclearwater.org
>
> To subscribe or unsubscribe via the World Wide Web, visit
>         http://lists.projectclearwater.org/mailman/
> listinfo/clearwater_lists.projectclearwater.org
>
> or, via email, send a message with subject or body 'help' to
>         clearwater-request at lists.projectclearwater.org
>
> You can reach the person managing the list at
>         clearwater-owner at lists.projectclearwater.org
>
> When replying, please edit your Subject line so it is more specific
> than "Re: Contents of Clearwater digest..."
>
>
> Today's Topics:
>
>    1. Stress Testing (Kosala)
>    2. Re: Stress Testing (Matt Williams (projectclearwater.org))
>    3. Re: Stress Testing (Matt Williams (projectclearwater.org))
>
>
> ----------------------------------------------------------------------
>
> Message: 1
> Date: Mon, 15 Aug 2016 10:38:57 +0100
> From: Kosala <kosalayb at gmail.com>
> To: clearwater at lists.projectclearwater.org
> Subject: [Project Clearwater] Stress Testing
> Message-ID:
>         <CAGEe17an2B_bGj8NfKFwms+nU=vJURyhT5CE+mcY1pjcm4YF+A at mail.
> gmail.com>
> Content-Type: text/plain; charset="utf-8"
>
> Hi Team,
>
> I installed clearwater "all-in-one" image on Oracle Virtual Box.
> 1. Can I do stress testing ?
> 2. How to do that?
>
> I am trying to follow Stress Testing on
> http://clearwater.readthedocs.io/en/stable/Clearwater_stress_testing.html#
> configuring-udp-stress
> .
>
> Using chef - > It seems chef/knife install only supports in the Cloud
> approach (The automated install is only supported for deployments running
> in Amazon?s EC2 cloud).
>
> Manual approach, It looks not supporting all in one image.
>
> Many Thanks
> Kosala
> -------------- next part --------------
> An HTML attachment was scrubbed...
> URL: <http://lists.projectclearwater.org/pipermail/clearwater_lists.
> projectclearwater.org/attachments/20160815/15fc3b07/attachment-0001.html>
>
> ------------------------------
>
> Message: 2
> Date: Mon, 15 Aug 2016 09:54:02 +0000
> From: "Matt Williams (projectclearwater.org)"
>         <matt at projectclearwater.org>
> To: Kosala <kosalayb at gmail.com>
> Cc: "clearwater at lists.projectclearwater.org"
>         <clearwater at lists.projectclearwater.org>
> Subject: Re: [Project Clearwater] Stress Testing
> Message-ID:
>         <CY1PR0201MB15636F1F20EB91BB180F053390120 at CY1PR0201MB1563.
> namprd02.prod.outlook.com>
>
> Content-Type: text/plain; charset="utf-8"
>
> Kosala,
>
> While it's theoretically possible to do stress testing against an
> all-in-one image, I'd recommend against it - the all-in-one image has been
> squeezed down a lot to fit on a single VM and we'd expect very low
> performance out of it, and I could believe that overload behavior might be
> suboptimal.  If you're looking to stress test for performance reasons, I'd
> strongly recommend running a full deployment as this will give you much
> more reliable numbers.  If you're looking to stress test for other reasons,
> please can you share a bit more about what you're trying to achieve, and we
> can have a think about what would work best?
>
> If you do really want to run stress testing against an all-in-one image,
> it should probably work, even though http://clearwater.readthedocs.
> io/en/latest/Clearwater_stress_testing.html#manual-i-
> e-non-chef-stress-runs only talks about Chef and manual installs.  You'd
> need to set the "bono_servers" option in /etc/clearwater/shared_config to
> point to your all-in-one node, and I suspect you'd need to reduce the
> "count" option to something a lot lower - I'd start around 5000 and see how
> that goes.
>
> I hope that helps.  Please let me know how you get on.
>
> Thanks,
>
> Matt
>
> From: Clearwater [mailto:clearwater-bounces at lists.projectclearwater.org]
> On Behalf Of Kosala
> Sent: 15 August 2016 10:39
> To: clearwater at lists.projectclearwater.org
> Subject: [Project Clearwater] Stress Testing
>
> Hi Team,
> I installed clearwater "all-in-one" image on Oracle Virtual Box.
> 1. Can I do stress testing ?
> 2. How to do that?
> I am trying to follow Stress Testing on http://clearwater.readthedocs.
> io/en/stable/Clearwater_stress_testing.html#configuring-udp-stress.
> Using chef - > It seems chef/knife install only supports in the Cloud
> approach (The automated install is only supported for deployments running
> in Amazon?s EC2 cloud).
> Manual approach, It looks not supporting all in one image.
> Many Thanks
> Kosala
>
> -------------- next part --------------
> An HTML attachment was scrubbed...
> URL: <http://lists.projectclearwater.org/pipermail/clearwater_lists.
> projectclearwater.org/attachments/20160815/29d6328d/attachment-0001.html>
>
> ------------------------------
>
> Message: 3
> Date: Mon, 15 Aug 2016 13:16:47 +0000
> From: "Matt Williams (projectclearwater.org)"
>         <matt at projectclearwater.org>
> To: "clearwater at lists.projectclearwater.org"
>         <clearwater at lists.projectclearwater.org>
> Subject: Re: [Project Clearwater] Stress Testing
> Message-ID:
>         <CY1PR0201MB156372246DC5A77B11839F9D90120 at CY1PR0201MB1563.
> namprd02.prod.outlook.com>
>
> Content-Type: text/plain; charset="utf-8"
>
> Kosala,
>
> You'll need to follow all the steps in http://clearwater.readthedocs.
> io/en/latest/Clearwater_stress_testing.html#manual-i-
> e-non-chef-stress-runs, i.e. bulk provisioning subscribers and installing
> clearwater-sip-stress, but that should be it.
>
> Just to be clear, though, you'll need to set the configuration and install
> the clearwater-sip-stress package on a separate VM, not on the all-in-one
> image itself - the all-in-one image almost certainly opens up ports that
> conflict with those that clearwater-sip-stress tries to use.
>
> This isn't a very well-trodden path, though, so you may hit further issues
> - let me know if so, and we can try to work through them.
>
> Cheers,
>
> Matt
>
> From: Kosala [mailto:kosalayb at gmail.com]
> Sent: 15 August 2016 13:41
> To: Matt Williams (projectclearwater.org) <matt at projectclearwater.org>
> Subject: Re: [Project Clearwater] Stress Testing
>
> Hi Matt,
> Thanks. I set the bono_servers option. Should I add count =5000 to
> /etc/clearwater/shared_config ?
>
> Do I need other changes to run stress tests on all-in-one image?
> Thanks
> Kosala
>
>
>
> On Mon, Aug 15, 2016 at 10:54 AM, Matt Williams (projectclearwater.org<
> http://projectclearwater.org>) <matt at projectclearwater.org<mailto:
> matt at projectclearwater.org>> wrote:
> Kosala,
>
> While it's theoretically possible to do stress testing against an
> all-in-one image, I'd recommend against it - the all-in-one image has been
> squeezed down a lot to fit on a single VM and we'd expect very low
> performance out of it, and I could believe that overload behavior might be
> suboptimal.  If you're looking to stress test for performance reasons, I'd
> strongly recommend running a full deployment as this will give you much
> more reliable numbers.  If you're looking to stress test for other reasons,
> please can you share a bit more about what you're trying to achieve, and we
> can have a think about what would work best?
>
> If you do really want to run stress testing against an all-in-one image,
> it should probably work, even though http://clearwater.readthedocs.
> io/en/latest/Clearwater_stress_testing.html#manual-i-
> e-non-chef-stress-runs only talks about Chef and manual installs.  You'd
> need to set the "bono_servers" option in /etc/clearwater/shared_config to
> point to your all-in-one node, and I suspect you'd need to reduce the
> "count" option to something a lot lower - I'd start around 5000 and see how
> that goes.
>
> I hope that helps.  Please let me know how you get on.
>
> Thanks,
>
> Matt
>
> From: Clearwater [mailto:clearwater-bounces at lists.projectclearwater.org<
> mailto:clearwater-bounces at lists.projectclearwater.org>] On Behalf Of
> Kosala
> Sent: 15 August 2016 10:39
> To: clearwater at lists.projectclearwater.org<mailto:clearwater at lists.
> projectclearwater.org>
> Subject: [Project Clearwater] Stress Testing
>
> Hi Team,
> I installed clearwater "all-in-one" image on Oracle Virtual Box.
> 1. Can I do stress testing ?
> 2. How to do that?
> I am trying to follow Stress Testing on http://clearwater.readthedocs.
> io/en/stable/Clearwater_stress_testing.html#configuring-udp-stress.
> Using chef - > It seems chef/knife install only supports in the Cloud
> approach (The automated install is only supported for deployments running
> in Amazon?s EC2 cloud).
> Manual approach, It looks not supporting all in one image.
> Many Thanks
> Kosala
>
>
> -------------- next part --------------
> An HTML attachment was scrubbed...
> URL: <http://lists.projectclearwater.org/pipermail/clearwater_lists.
> projectclearwater.org/attachments/20160815/11781755/attachment.html>
>
> ------------------------------
>
> Subject: Digest Footer
>
> _______________________________________________
> Clearwater mailing list
> Clearwater at lists.projectclearwater.org
> http://lists.projectclearwater.org/mailman/listinfo/clearwater_lists.
> projectclearwater.org
>
>
> ------------------------------
>
> End of Clearwater Digest, Vol 40, Issue 24
> ******************************************
>
>
>
>
>
>
>
>
>
>
>
>
>
>
>
>
>
>
>
>
>
>
>
>
>
>
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.projectclearwater.org/pipermail/clearwater_lists.projectclearwater.org/attachments/20160819/f12ef665/attachment.html>

From arvindas at hpe.com  Mon Aug 22 03:09:12 2016
From: arvindas at hpe.com (Shirabur, Aravind Ashok (CMS))
Date: Mon, 22 Aug 2016 07:09:12 +0000
Subject: [Project Clearwater] Privacy header delimiter ','
Message-ID: <TU4PR84MB00649C882ADC2BE90305E219DCE80@TU4PR84MB0064.NAMPRD84.PROD.OUTLOOK.COM>

Hi,

We are testing project clear water (clearwater-infrastructure  1.0-160518.173307) , we find that "," is used as delimiter for separating multiple values of the Privacy header (example: "Privacy: id, user, history"). As per RFC-3323 (https://www.ietf.org/rfc/rfc3323.txt) privacy header values must be separated by ";".

[cid:image001.jpg at 01D1FC71.223FB700]

Impact of this multiple Privacy header like  "Privacy: id;user;history"; this has been removed by the Clearwater IMS network.

Can you please comment on if this observation is correct ?

Thanks
Aravind

-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.projectclearwater.org/pipermail/clearwater_lists.projectclearwater.org/attachments/20160822/7cb25afd/attachment.html>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: image001.jpg
Type: image/jpeg
Size: 9466 bytes
Desc: image001.jpg
URL: <http://lists.projectclearwater.org/pipermail/clearwater_lists.projectclearwater.org/attachments/20160822/7cb25afd/attachment.jpg>

From Richard.Whitehouse at metaswitch.com  Mon Aug 22 06:59:54 2016
From: Richard.Whitehouse at metaswitch.com (Richard Whitehouse)
Date: Mon, 22 Aug 2016 10:59:54 +0000
Subject: [Project Clearwater] Privacy header delimiter ','
In-Reply-To: <TU4PR84MB00649C882ADC2BE90305E219DCE80@TU4PR84MB0064.NAMPRD84.PROD.OUTLOOK.COM>
References: <TU4PR84MB00649C882ADC2BE90305E219DCE80@TU4PR84MB0064.NAMPRD84.PROD.OUTLOOK.COM>
Message-ID: <BY2PR0201MB1816868615F0381697B2E4C2F0E80@BY2PR0201MB1816.namprd02.prod.outlook.com>

Aravind,

Thanks for your report - your analysis looks correct - I've raised Sprout Issue 1514 to cover correcting this - https://github.com/Metaswitch/sprout/issues/1514

Looking at the code, I believe that the options will only get stripped if the MMTel application server is being invoked, as that looks to be the only place we will fully parse and control the Privacy header options. If you don't need this function, then removing the MMTel application server might be a workaround for you. We don't normally use this MMTel application server in production environments. You should be able to prevent this being invoked by modifying the subscriber's configured initial filter criteria.

If you aren't running the MMTel Application Server, can you clarify the scenario in which you are seeing the Privacy options being modified by Clearwater?

Richard


From: Clearwater [mailto:clearwater-bounces at lists.projectclearwater.org] On Behalf Of Shirabur, Aravind Ashok (CMS)
Sent: 22 August 2016 08:09
To: Clearwater at lists.projectclearwater.org
Subject: [Project Clearwater] Privacy header delimiter ','

Hi,

We are testing project clear water (clearwater-infrastructure  1.0-160518.173307) , we find that "," is used as delimiter for separating multiple values of the Privacy header (example: "Privacy: id, user, history"). As per RFC-3323 (https://www.ietf.org/rfc/rfc3323.txt) privacy header values must be separated by ";".

[cid:image001.jpg at 01D1FC6C.B0A81CD0]

Impact of this multiple Privacy header like  "Privacy: id;user;history"; this has been removed by the Clearwater IMS network.

Can you please comment on if this observation is correct ?

Thanks
Aravind

-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.projectclearwater.org/pipermail/clearwater_lists.projectclearwater.org/attachments/20160822/2fd091e2/attachment.html>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: image001.jpg
Type: image/jpeg
Size: 9466 bytes
Desc: image001.jpg
URL: <http://lists.projectclearwater.org/pipermail/clearwater_lists.projectclearwater.org/attachments/20160822/2fd091e2/attachment.jpg>

From arvindas at hpe.com  Mon Aug 22 07:34:51 2016
From: arvindas at hpe.com (Shirabur, Aravind Ashok (CMS))
Date: Mon, 22 Aug 2016 11:34:51 +0000
Subject: [Project Clearwater] Privacy header delimiter ','
In-Reply-To: <BY2PR0201MB1816868615F0381697B2E4C2F0E80@BY2PR0201MB1816.namprd02.prod.outlook.com>
References: <TU4PR84MB00649C882ADC2BE90305E219DCE80@TU4PR84MB0064.NAMPRD84.PROD.OUTLOOK.COM>
	<BY2PR0201MB1816868615F0381697B2E4C2F0E80@BY2PR0201MB1816.namprd02.prod.outlook.com>
Message-ID: <TU4PR84MB006479AC3FE48BDB64458344DCE80@TU4PR84MB0064.NAMPRD84.PROD.OUTLOOK.COM>

Thank you for the confirmation. It is indeed the MMtel AS scenario. Do we have workaround /hotfix to avoid this issue ?


Thanks
Aravind
From: Richard Whitehouse [mailto:Richard.Whitehouse at metaswitch.com]
Sent: Monday, August 22, 2016 4:30 PM
To: clearwater at lists.projectclearwater.org; Shirabur, Aravind Ashok (CMS) <arvindas at hpe.com>
Subject: RE: Privacy header delimiter ','

Aravind,

Thanks for your report - your analysis looks correct - I've raised Sprout Issue 1514 to cover correcting this - https://github.com/Metaswitch/sprout/issues/1514

Looking at the code, I believe that the options will only get stripped if the MMTel application server is being invoked, as that looks to be the only place we will fully parse and control the Privacy header options. If you don't need this function, then removing the MMTel application server might be a workaround for you. We don't normally use this MMTel application server in production environments. You should be able to prevent this being invoked by modifying the subscriber's configured initial filter criteria.

If you aren't running the MMTel Application Server, can you clarify the scenario in which you are seeing the Privacy options being modified by Clearwater?

Richard


From: Clearwater [mailto:clearwater-bounces at lists.projectclearwater.org] On Behalf Of Shirabur, Aravind Ashok (CMS)
Sent: 22 August 2016 08:09
To: Clearwater at lists.projectclearwater.org<mailto:Clearwater at lists.projectclearwater.org>
Subject: [Project Clearwater] Privacy header delimiter ','

Hi,

We are testing project clear water (clearwater-infrastructure  1.0-160518.173307) , we find that "," is used as delimiter for separating multiple values of the Privacy header (example: "Privacy: id, user, history"). As per RFC-3323 (https://www.ietf.org/rfc/rfc3323.txt) privacy header values must be separated by ";".

[cid:image001.jpg at 01D1FC97.452C7DE0]

Impact of this multiple Privacy header like  "Privacy: id;user;history"; this has been removed by the Clearwater IMS network.

Can you please comment on if this observation is correct ?

Thanks
Aravind

-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.projectclearwater.org/pipermail/clearwater_lists.projectclearwater.org/attachments/20160822/db098b6b/attachment.html>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: image001.jpg
Type: image/jpeg
Size: 9466 bytes
Desc: image001.jpg
URL: <http://lists.projectclearwater.org/pipermail/clearwater_lists.projectclearwater.org/attachments/20160822/db098b6b/attachment.jpg>

From BENDRISS-Jaafar at live.fr  Mon Aug 22 09:07:36 2016
From: BENDRISS-Jaafar at live.fr (jaafar BENDRISS)
Date: Mon, 22 Aug 2016 13:07:36 +0000
Subject: [Project Clearwater] CLearwater Integration in Openstack
Message-ID: <VI1PR0802MB2269ABC658D9DF14635ACAA9F2E80@VI1PR0802MB2269.eurprd08.prod.outlook.com>


Hello,



Please I am struggling with the configuration and installation of Clearwater in openstack. I have the following problem:

sudo service clearwater-etcd start
etcd cluster has no published client endpoints.
Try '--no-sync' if you want to access non-published client endpoints(http://10.11.12.2:4000,http://10.11.12.8:4000,http://10.11.12.4:4000,http://10.11.12.14:4000,http://,http://10.11.12.6:4000).
Error:  client: no endpoints available
Rejoining cluster...


Could you help please

Thank you


Jaafar
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.projectclearwater.org/pipermail/clearwater_lists.projectclearwater.org/attachments/20160822/4747e7ba/attachment.html>

From michaelkatsoulis88 at gmail.com  Tue Aug 23 04:37:07 2016
From: michaelkatsoulis88 at gmail.com (=?UTF-8?B?zpzOuc+HzqzOu863z4IgzprOsc+Ez4POv8+NzrvOt8+C?=)
Date: Tue, 23 Aug 2016 11:37:07 +0300
Subject: [Project Clearwater] SIP Client cannot connect after Clearwater
 manual installation
In-Reply-To: <CY1PR02MB1181AF7F33A9643A4ED32E45E1070@CY1PR02MB1181.namprd02.prod.outlook.com>
References: <CAJG3f9OtD-_LpTYgbOk1LAAU7-vHD5ytnqeB9XxL_+8XzM=Fog@mail.gmail.com>
	<CY1PR02MB1181AF7F33A9643A4ED32E45E1070@CY1PR02MB1181.namprd02.prod.outlook.com>
Message-ID: <CAJG3f9NgEMO47LwwuCBWTdx4U7KO=4XLnbVa9Mxh9qJrcvrhOw@mail.gmail.com>

Hi Chris,


thank you a lot for your answer.
I opened all needed ports in all the nodes as mentioned in
http://clearwater.readthedocs.io/en/stable/Clearwater_IP_Port_Usage.html .
I also used tcpdump & netcat to monitor & test the connection and
everything seems to be working fine.
Now i can see some interesting logs in Bono and Sprout but still the
registration fails due to request timeout.

The logs from the nodes are the following:

*Bono:*

OPTIONS sip:poll-sip at 192.168.99.131:5058 SIP/2.0
Via: SIP/2.0/TCP 192.168.99.131;rport;branch=z9hG4bK-108925
Max-Forwards: 2
To: <sip:poll-sip at 192.168.99.131:5058>
From: poll-sip <sip:poll-sip at 192.168.99.131>;tag=108925
Call-ID: poll-sip-108925
CSeq: 108925 OPTIONS
Contact: <sip:192.168.99.131>
Accept: application/sdp
Content-Length: 0
User-Agent: poll-sip


--end msg--
05-08-2016 13:41:11.509 UTC Debug uri_classifier.cpp:169: home domain:
false, local_to_node: true, is_gruu: false, enforce_user_phone: false,
prefer_sip: true, treat_number_as_phone: false
05-08-2016 13:41:11.509 UTC Debug uri_classifier.cpp:199: Classified URI as
3
05-08-2016 13:41:11.509 UTC Debug common_sip_processing.cpp:212: Skipping
SAS logging for OPTIONS request
05-08-2016 13:41:11.509 UTC Debug thread_dispatcher.cpp:253: Queuing cloned
received message 0x7f3e283eeb38 for worker threads
05-08-2016 13:41:11.509 UTC Debug thread_dispatcher.cpp:149: Worker thread
dequeue message 0x7f3e283eeb38
05-08-2016 13:41:11.509 UTC Debug pjsip: sip_endpoint.c Distributing rdata
to modules: Request msg OPTIONS/cseq=108925 (rdata0x7f3e283eeb38)
05-08-2016 13:41:11.509 UTC Debug uri_classifier.cpp:169: home domain:
false, local_to_node: true, is_gruu: false, enforce_user_phone: false,
prefer_sip: true, treat_number_as_phone: false
05-08-2016 13:41:11.509 UTC Debug uri_classifier.cpp:199: Classified URI as
3
05-08-2016 13:41:11.509 UTC Debug pjsip:       endpoint Response msg
200/OPTIONS/cseq=108925 (tdta0x7f3e2404d980) created
05-08-2016 13:41:11.509 UTC Verbose common_sip_processing.cpp:136: TX 290
bytes Response msg 200/OPTIONS/cseq=108925 (tdta0x7f3e2404d980) to TCP
192.168.99.131:35677:
--start msg--

SIP/2.0 200 OK
Via: SIP/2.0/TCP 192.168.99.131;rport=35677;received=192.168.99.131;
branch=z9hG4bK-108925
Call-ID: poll-sip-108925
From: "poll-sip" <sip:poll-sip at 192.168.99.131>;tag=108925
To: <sip:poll-sip at 192.168.99.131>;tag=z9hG4bK-108925
CSeq: 108925 OPTIONS
Content-Length:  0


--end msg--
05-08-2016 13:41:11.509 UTC Debug common_sip_processing.cpp:254: Skipping
SAS logging for OPTIONS response
05-08-2016 13:41:11.509 UTC Debug pjsip: tdta0x7f3e2404 Destroying txdata
Response msg 200/OPTIONS/cseq=108925 (tdta0x7f3e2404d980)
05-08-2016 13:41:11.509 UTC Debug thread_dispatcher.cpp:193: Worker thread
completed processing message 0x7f3e283eeb38
05-08-2016 13:41:11.509 UTC Debug thread_dispatcher.cpp:199: Request
latency = 221us
05-08-2016 13:41:12.509 UTC Verbose pjsip: tcps0x7f3e283e TCP connection
closed
05-08-2016 13:41:12.509 UTC Debug connection_tracker.cpp:92: Connection
0x7f3e283ec298 has been destroyed
05-08-2016 13:41:12.509 UTC Verbose pjsip: tcps0x7f3e283e TCP transport
destroyed with reason 70016: End of file (PJ_EEOF)


*Sprout:*

SIP/2.0 200 OK
Via: SIP/2.0/TCP 192.168.99.132;rport=60774;received=192.168.99.132;
branch=z9hG4bK-13204
Call-ID: poll-sip-13204
From: "poll-sip" <sip:poll-sip at 192.168.99.132>;tag=13204
To: <sip:poll-sip at 192.168.99.132>;tag=z9hG4bK-13204
CSeq: 13204 OPTIONS
Content-Length:  0


--end msg--
05-08-2016 13:21:30.373 UTC Debug common_sip_processing.cpp:254: Skipping
SAS logging for OPTIONS response
05-08-2016 13:21:30.373 UTC Debug pjsip: tdta0x7fb31001 Destroying txdata
Response msg 200/OPTIONS/cseq=13204 (tdta0x7fb310017c20)
05-08-2016 13:21:30.373 UTC Debug thread_dispatcher.cpp:193: Worker thread
completed processing message 0x7fb310097278
05-08-2016 13:21:30.373 UTC Debug thread_dispatcher.cpp:199: Request
latency = 225us
05-08-2016 13:21:30.380 UTC Verbose httpstack.cpp:293: Process request for
URL /ping, args (null)
05-08-2016 13:21:30.381 UTC Verbose httpstack.cpp:69: Sending response 200
to request for URL /ping, args (null)
05-08-2016 13:21:30.907 UTC Verbose pjsip:    tcplis:5052 TCP listener
192.168.99.132:5052: got incoming TCP connection from 192.168.99.131:50451,
sock=753
05-08-2016 13:21:30.907 UTC Verbose pjsip: tcps0x7fb31009 TCP server
transport created
05-08-2016 13:21:30.911 UTC Verbose pjsip: tcps0x7fb31000 TCP connection
closed
05-08-2016 13:21:30.911 UTC Verbose pjsip: tcps0x7fb31000 TCP transport
destroyed with reason 70016: End of file (PJ_EEOF)
05-08-2016 13:21:31.374 UTC Verbose pjsip: tcps0x7fb31007 TCP connection
closed
05-08-2016 13:21:31.375 UTC Debug connection_tracker.cpp:92: Connection
0x7fb31007ca08 has been destroyed
05-08-2016 13:21:31.375 UTC Verbose pjsip: tcps0x7fb31007 TCP transport
destroyed with reason 70016: End of file (PJ_EEOF)
05-08-2016 13:21:33.268 UTC Debug alarm.cpp:253: Reraising all alarms with
a known state
05-08-2016 13:21:33.268 UTC Status alarm.cpp:62: sprout issued 1001.1 alarm
^C
root at sprout:/var/log/sprout# netstat -tulpn | grep 7000
root at sprout:/var/log/sprout# tailf sprout_current.txt
05-08-2016 13:42:18.061 UTC Verbose pjsip: tcps0x7fb31004 TCP transport
destroyed with reason 70016: End of file (PJ_EEOF)
05-08-2016 13:42:25.060 UTC Verbose pjsip:    tcplis:5052 TCP listener
192.168.99.132:5052: got incoming TCP connection from 192.168.99.131:56176,
sock=691
05-08-2016 13:42:25.060 UTC Verbose pjsip: tcps0x7fb31004 TCP server
transport created
05-08-2016 13:42:25.067 UTC Verbose pjsip: tcps0x7fb31007 TCP connection
closed
05-08-2016 13:42:25.067 UTC Verbose pjsip: tcps0x7fb31007 TCP transport
destroyed with reason 70016: End of file (PJ_EEOF)
05-08-2016 13:42:25.989 UTC Verbose pjsip: tcps0x7fb31007 TCP transport
destroyed normally
05-08-2016 13:42:26.060 UTC Verbose pjsip:    tcplis:5052 TCP listener
192.168.99.132:5052: got incoming TCP connection from 192.168.99.131:36330,
sock=693
05-08-2016 13:42:26.060 UTC Verbose pjsip: tcps0x7fb31007 TCP server
transport created
05-08-2016 13:42:33.273 UTC Debug alarm.cpp:253: Reraising all alarms with
a known state
05-08-2016 13:42:33.273 UTC Status alarm.cpp:62: sprout issued 1001.1 alarm
05-08-2016 13:42:34.989 UTC Verbose pjsip: tcps0x7fb31003 TCP transport
destroyed normally
05-08-2016 13:42:35.061 UTC Verbose pjsip:    tcplis:5052 TCP listener
192.168.99.132:5052: got incoming TCP connection from 192.168.99.131:52252,
sock=707
05-08-2016 13:42:35.061 UTC Verbose pjsip: tcps0x7fb31003 TCP server
transport created
05-08-2016 13:42:41.062 UTC Verbose pjsip:    tcplis:5052 TCP listener
192.168.99.132:5052: got incoming TCP connection from 192.168.99.131:56261,
sock=709
05-08-2016 13:42:41.062 UTC Verbose pjsip: tcps0x7fb31007 TCP server
transport created
05-08-2016 13:42:41.064 UTC Verbose pjsip: tcps0x7fb31002 TCP connection
closed
05-08-2016 13:42:41.064 UTC Verbose pjsip: tcps0x7fb31002 TCP transport
destroyed with reason 70016: End of file (PJ_EEOF)




*Zoiper configuration:*

domain: ims (or or bono_IP:port)
Username: 6505550731
Password: ***********
Caller ID Name: Clearwater

Auth.username:  6505550731 at ims
Outbound Proxy: -

In Advanced options i choose "use custome STUN" option
with
Server Hostname/IP : bono_ip
Port: 8888



*Zoiper logs:*

Network discovered for STUN = 172.28.40.181; Blocked (STUN server could be
down) (result =0)
Account registering. Account = '6505550731 at ims' failed, protocol_code =
923, cause code =63 (service or option not available, unspecified)


I have checked restund service in my Bono node and it is running. If i
restart the service the following logs appear.

httpdb: configured url http://hs.ims:8888/impi/%s/digest
httpd: using URI workaround
turn: server deployed behind static NAT addr=172.28.40.181:0
turn: extended channels enabled


Could you help me ?

Thanks in advance,

Michael Katsoulis























2016-08-04 16:10 GMT+03:00 Chris Elford (projectclearwater.org) <
chris at projectclearwater.org>:

> Hi Michael,
>
>
>
> Thank you for getting in touch.
>
>
>
> You say below that Zoiper and Ekiga are taking a long time to connect.
> From the fact that nothing is showing up in Bono?s logs, it sounds like the
> phones are never registering. Is that correct?
>
>
>
> If the registrations are failing, and nothing is showing up in the Bono
> logs, it sounds like there may be something in your network stopping the
> registrations from getting through. This is possible even if the two
> machines can ping each other, as SIP traffic runs on a different port to
> pings. I would suggest using tcpdump to carry out a packet capture on Bono
> and check that all of the expected messages in the registration flow are
> getting through.
>
>
>
> Yours,
>
>
>
> Chris
>
>
>
> *From:* Clearwater [mailto:clearwater-bounces at lists.projectclearwater.org]
> *On Behalf Of *??????? ?ats?????
> *Sent:* 04 August 2016 13:41
> *To:* Clearwater at lists.projectclearwater.org
> *Subject:* [Project Clearwater] SIP Client cannot connect after
> Clearwater manual installation
>
>
>
> Hi All,
>
>
>
> i have just performed the *manual installation *of project Clearwater
> using *6 nodes *(1x ellis, 1x bono, 1x sprout, 1x homer, 1x homestead, 1x
> ralf)
>
>
>
> Now I am trying to connect a SIP client (tried both with Zoiper and
> Ekiga). The VM in which Zoiper/Ekiga is installed has ping connectivity
> with the Clearwater nodes.
>
>
>
>
>
> The *system configuration* is the following:
>
>
>
> *Shared Config*:
>
>
>
>  # Deployment definitions
>
> home_domain=ims
>
> sprout_hostname=sprout.ims
>
> hs_hostname=hs.ims:8888
>
> hs_provisioning_hostname=hs.ims:8889
>
> ralf_hostname=ralf.ims:10888
>
> xdms_hostname=homer.ims:7888
>
>
>
>
>
> # Keys
>
> signup_key=<secret>
>
> turn_workaround=<secret>
>
> ellis_api_key=<secret>
>
> ellis_cookie_key=<secret>
>
>
>
>
>
> *local config *: (for example in Bono node)
>
>
>
> local_ip=192.168.99.131
>
> public_ip=172.28.40.181
>
> public_hostname=bono-1
>
> etcd_cluster="192.168.99.130,192.168.99.131,192.168.88.132,1
> 92.168.99.133,192.168.99.134,192.168.99.135"
>
>
>
>
>
> ------------------------------------------------------------
> -----------------------
>
> The process I follow to create the account is the following:
>
>
>
> - Produce a number in Ellis dashboard:
>
>
>
> Private Identity:
>
>
>
> 6505550731 at ims
>
> Password: *******
>
> only shown once
>
>
>
>
>
> - Fill the required fields in the client:
>
>
>
>   a) Ekiga
>
>     name: Clearwater
>
>     Registrar: ims (or bono_IP:port)
>
>     User: 6505550731
>
>     Authentication user: 6505550731 at ims
>
>     Password: ********
>
>
>
>    b) Zoiper:
>
>       user/user at host : 6505550731
>
>       Password: *********
>
>       Domain / Outbound Proxy: ims (or bono_IP:port)
>
>
>
> Both clients take a long time trying to connect but nothing (relative to
> the registration) seems to be written in the log files in any node.
>
>
>
> The whole setup is behind a *corporate proxy *and I have configured the
> http[s]_proxy, no_proxy environment variables.
>
>
>
> Can anyone help ?
>
>
>
>
>
> Thanks,
>
> Michael Katsoulis
>
>
>
>
>
>
>
>
>
>
>
>
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.projectclearwater.org/pipermail/clearwater_lists.projectclearwater.org/attachments/20160823/404d0f05/attachment.html>

From richard.whitehouse at projectclearwater.org  Tue Aug 23 17:54:43 2016
From: richard.whitehouse at projectclearwater.org (Richard Whitehouse (projectclearwater.org))
Date: Tue, 23 Aug 2016 21:54:43 +0000
Subject: [Project Clearwater] SIP Client cannot connect after Clearwater
 manual installation
In-Reply-To: <CAJG3f9NgEMO47LwwuCBWTdx4U7KO=4XLnbVa9Mxh9qJrcvrhOw@mail.gmail.com>
References: <CAJG3f9OtD-_LpTYgbOk1LAAU7-vHD5ytnqeB9XxL_+8XzM=Fog@mail.gmail.com>
	<CY1PR02MB1181AF7F33A9643A4ED32E45E1070@CY1PR02MB1181.namprd02.prod.outlook.com>
	<CAJG3f9NgEMO47LwwuCBWTdx4U7KO=4XLnbVa9Mxh9qJrcvrhOw@mail.gmail.com>
Message-ID: <BY2PR0201MB18164E2ADCAD293A973E62A3F0EB0@BY2PR0201MB1816.namprd02.prod.outlook.com>

Michael,

The logs you show below suggests that OPTIONS polling is occurring, but there?s nothing suggesting that the registration attempt is working.

The STUN output suggests it?s unable to contact the STUN server? Is traffic allowed into the node on port 8888 ? which is what you have configured, which is different from the default which is 3478? Can you see traffic on this port when you run tcpdump on the bono node?

It would be useful if you could provide the packet capture, taken from Bono. From what you?ve provided it looks like there?s still a connectivity issue between your client and the Bono node.


Richard

From: Clearwater [mailto:clearwater-bounces at lists.projectclearwater.org] On Behalf Of ??????? ?ats?????
Sent: 23 August 2016 09:37
To: Clearwater at lists.projectclearwater.org
Cc: Chris Elford (projectclearwater.org) <chris at projectclearwater.org>
Subject: Re: [Project Clearwater] SIP Client cannot connect after Clearwater manual installation


Hi Chris,


thank you a lot for your answer.
I opened all needed ports in all the nodes as mentioned in http://clearwater.readthedocs.io/en/stable/Clearwater_IP_Port_Usage.html .
I also used tcpdump & netcat to monitor & test the connection and everything seems to be working fine.
Now i can see some interesting logs in Bono and Sprout but still the registration fails due to request timeout.

The logs from the nodes are the following:

Bono:

OPTIONS sip:poll-sip at 192.168.99.131:5058<http://sip:poll-sip at 192.168.99.131:5058> SIP/2.0
Via: SIP/2.0/TCP 192.168.99.131;rport;branch=z9hG4bK-108925
Max-Forwards: 2
To: <sip:poll-sip at 192.168.99.131:5058<http://sip:poll-sip at 192.168.99.131:5058>>
From: poll-sip <sip:poll-sip at 192.168.99.131<mailto:sip%3Apoll-sip at 192.168.99.131>>;tag=108925
Call-ID: poll-sip-108925
CSeq: 108925 OPTIONS
Contact: <sip:192.168.99.131>
Accept: application/sdp
Content-Length: 0
User-Agent: poll-sip


--end msg--
05-08-2016 13:41:11.509 UTC Debug uri_classifier.cpp:169: home domain: false, local_to_node: true, is_gruu: false, enforce_user_phone: false, prefer_sip: true, treat_number_as_phone: false
05-08-2016 13:41:11.509 UTC Debug uri_classifier.cpp:199: Classified URI as 3
05-08-2016 13:41:11.509 UTC Debug common_sip_processing.cpp:212: Skipping SAS logging for OPTIONS request
05-08-2016 13:41:11.509 UTC Debug thread_dispatcher.cpp:253: Queuing cloned received message 0x7f3e283eeb38 for worker threads
05-08-2016 13:41:11.509 UTC Debug thread_dispatcher.cpp:149: Worker thread dequeue message 0x7f3e283eeb38
05-08-2016 13:41:11.509 UTC Debug pjsip: sip_endpoint.c Distributing rdata to modules: Request msg OPTIONS/cseq=108925 (rdata0x7f3e283eeb38)
05-08-2016 13:41:11.509 UTC Debug uri_classifier.cpp:169: home domain: false, local_to_node: true, is_gruu: false, enforce_user_phone: false, prefer_sip: true, treat_number_as_phone: false
05-08-2016 13:41:11.509 UTC Debug uri_classifier.cpp:199: Classified URI as 3
05-08-2016 13:41:11.509 UTC Debug pjsip:       endpoint Response msg 200/OPTIONS/cseq=108925 (tdta0x7f3e2404d980) created
05-08-2016 13:41:11.509 UTC Verbose common_sip_processing.cpp:136: TX 290 bytes Response msg 200/OPTIONS/cseq=108925 (tdta0x7f3e2404d980) to TCP 192.168.99.131:35677<http://192.168.99.131:35677>:
--start msg--

SIP/2.0 200 OK
Via: SIP/2.0/TCP 192.168.99.131;rport=35677;received=192.168.99.131;branch=z9hG4bK-108925
Call-ID: poll-sip-108925
From: "poll-sip" <sip:poll-sip at 192.168.99.131<mailto:sip%3Apoll-sip at 192.168.99.131>>;tag=108925
To: <sip:poll-sip at 192.168.99.131<mailto:sip%3Apoll-sip at 192.168.99.131>>;tag=z9hG4bK-108925
CSeq: 108925 OPTIONS
Content-Length:  0


--end msg--
05-08-2016 13:41:11.509 UTC Debug common_sip_processing.cpp:254: Skipping SAS logging for OPTIONS response
05-08-2016 13:41:11.509 UTC Debug pjsip: tdta0x7f3e2404 Destroying txdata Response msg 200/OPTIONS/cseq=108925 (tdta0x7f3e2404d980)
05-08-2016 13:41:11.509 UTC Debug thread_dispatcher.cpp:193: Worker thread completed processing message 0x7f3e283eeb38
05-08-2016 13:41:11.509 UTC Debug thread_dispatcher.cpp:199: Request latency = 221us
05-08-2016 13:41:12.509 UTC Verbose pjsip: tcps0x7f3e283e TCP connection closed
05-08-2016 13:41:12.509 UTC Debug connection_tracker.cpp:92: Connection 0x7f3e283ec298 has been destroyed
05-08-2016 13:41:12.509 UTC Verbose pjsip: tcps0x7f3e283e TCP transport destroyed with reason 70016: End of file (PJ_EEOF)


Sprout:

SIP/2.0 200 OK
Via: SIP/2.0/TCP 192.168.99.132;rport=60774;received=192.168.99.132;branch=z9hG4bK-13204
Call-ID: poll-sip-13204
From: "poll-sip" <sip:poll-sip at 192.168.99.132<mailto:sip%3Apoll-sip at 192.168.99.132>>;tag=13204
To: <sip:poll-sip at 192.168.99.132<mailto:sip%3Apoll-sip at 192.168.99.132>>;tag=z9hG4bK-13204
CSeq: 13204 OPTIONS
Content-Length:  0


--end msg--
05-08-2016 13:21:30.373 UTC Debug common_sip_processing.cpp:254: Skipping SAS logging for OPTIONS response
05-08-2016 13:21:30.373 UTC Debug pjsip: tdta0x7fb31001 Destroying txdata Response msg 200/OPTIONS/cseq=13204 (tdta0x7fb310017c20)
05-08-2016 13:21:30.373 UTC Debug thread_dispatcher.cpp:193: Worker thread completed processing message 0x7fb310097278
05-08-2016 13:21:30.373 UTC Debug thread_dispatcher.cpp:199: Request latency = 225us
05-08-2016 13:21:30.380 UTC Verbose httpstack.cpp:293: Process request for URL /ping, args (null)
05-08-2016 13:21:30.381 UTC Verbose httpstack.cpp:69: Sending response 200 to request for URL /ping, args (null)
05-08-2016 13:21:30.907 UTC Verbose pjsip:    tcplis:5052 TCP listener 192.168.99.132:5052<http://192.168.99.132:5052>: got incoming TCP connection from 192.168.99.131:50451<http://192.168.99.131:50451>, sock=753
05-08-2016 13:21:30.907 UTC Verbose pjsip: tcps0x7fb31009 TCP server transport created
05-08-2016 13:21:30.911 UTC Verbose pjsip: tcps0x7fb31000 TCP connection closed
05-08-2016 13:21:30.911 UTC Verbose pjsip: tcps0x7fb31000 TCP transport destroyed with reason 70016: End of file (PJ_EEOF)
05-08-2016 13:21:31.374 UTC Verbose pjsip: tcps0x7fb31007 TCP connection closed
05-08-2016 13:21:31.375 UTC Debug connection_tracker.cpp:92: Connection 0x7fb31007ca08 has been destroyed
05-08-2016 13:21:31.375 UTC Verbose pjsip: tcps0x7fb31007 TCP transport destroyed with reason 70016: End of file (PJ_EEOF)
05-08-2016 13:21:33.268 UTC Debug alarm.cpp:253: Reraising all alarms with a known state
05-08-2016 13:21:33.268 UTC Status alarm.cpp:62: sprout issued 1001.1 alarm
^C
root at sprout:/var/log/sprout# netstat -tulpn | grep 7000
root at sprout:/var/log/sprout# tailf sprout_current.txt
05-08-2016 13:42:18.061 UTC Verbose pjsip: tcps0x7fb31004 TCP transport destroyed with reason 70016: End of file (PJ_EEOF)
05-08-2016 13:42:25.060 UTC Verbose pjsip:    tcplis:5052 TCP listener 192.168.99.132:5052<http://192.168.99.132:5052>: got incoming TCP connection from 192.168.99.131:56176<http://192.168.99.131:56176>, sock=691
05-08-2016 13:42:25.060 UTC Verbose pjsip: tcps0x7fb31004 TCP server transport created
05-08-2016 13:42:25.067 UTC Verbose pjsip: tcps0x7fb31007 TCP connection closed
05-08-2016 13:42:25.067 UTC Verbose pjsip: tcps0x7fb31007 TCP transport destroyed with reason 70016: End of file (PJ_EEOF)
05-08-2016 13:42:25.989 UTC Verbose pjsip: tcps0x7fb31007 TCP transport destroyed normally
05-08-2016 13:42:26.060 UTC Verbose pjsip:    tcplis:5052 TCP listener 192.168.99.132:5052<http://192.168.99.132:5052>: got incoming TCP connection from 192.168.99.131:36330<http://192.168.99.131:36330>, sock=693
05-08-2016 13:42:26.060 UTC Verbose pjsip: tcps0x7fb31007 TCP server transport created
05-08-2016 13:42:33.273 UTC Debug alarm.cpp:253: Reraising all alarms with a known state
05-08-2016 13:42:33.273 UTC Status alarm.cpp:62: sprout issued 1001.1 alarm
05-08-2016 13:42:34.989 UTC Verbose pjsip: tcps0x7fb31003 TCP transport destroyed normally
05-08-2016 13:42:35.061 UTC Verbose pjsip:    tcplis:5052 TCP listener 192.168.99.132:5052<http://192.168.99.132:5052>: got incoming TCP connection from 192.168.99.131:52252<http://192.168.99.131:52252>, sock=707
05-08-2016 13:42:35.061 UTC Verbose pjsip: tcps0x7fb31003 TCP server transport created
05-08-2016 13:42:41.062 UTC Verbose pjsip:    tcplis:5052 TCP listener 192.168.99.132:5052<http://192.168.99.132:5052>: got incoming TCP connection from 192.168.99.131:56261<http://192.168.99.131:56261>, sock=709
05-08-2016 13:42:41.062 UTC Verbose pjsip: tcps0x7fb31007 TCP server transport created
05-08-2016 13:42:41.064 UTC Verbose pjsip: tcps0x7fb31002 TCP connection closed
05-08-2016 13:42:41.064 UTC Verbose pjsip: tcps0x7fb31002 TCP transport destroyed with reason 70016: End of file (PJ_EEOF)




Zoiper configuration:

domain: ims (or or bono_IP:port)
Username: 6505550731
Password: ***********
Caller ID Name: Clearwater

Auth.username:  6505550731 at ims
Outbound Proxy: -

In Advanced options i choose "use custome STUN" option
with
Server Hostname/IP : bono_ip
Port: 8888



Zoiper logs:

Network discovered for STUN = 172.28.40.181; Blocked (STUN server could be down) (result =0)
Account registering. Account = '6505550731 at ims' failed, protocol_code = 923, cause code =63 (service or option not available, unspecified)


I have checked restund service in my Bono node and it is running. If i restart the service the following logs appear.

httpdb: configured url http://hs.ims:8888/impi/%s/digest<http://hs.ims:8888/impi/%25s/digest>
httpd: using URI workaround
turn: server deployed behind static NAT addr=172.28.40.181:0<http://172.28.40.181:0>
turn: extended channels enabled


Could you help me ?

Thanks in advance,
Michael Katsoulis























2016-08-04 16:10 GMT+03:00 Chris Elford (projectclearwater.org<http://projectclearwater.org>) <chris at projectclearwater.org<mailto:chris at projectclearwater.org>>:
Hi Michael,

Thank you for getting in touch.

You say below that Zoiper and Ekiga are taking a long time to connect. From the fact that nothing is showing up in Bono?s logs, it sounds like the phones are never registering. Is that correct?

If the registrations are failing, and nothing is showing up in the Bono logs, it sounds like there may be something in your network stopping the registrations from getting through. This is possible even if the two machines can ping each other, as SIP traffic runs on a different port to pings. I would suggest using tcpdump to carry out a packet capture on Bono and check that all of the expected messages in the registration flow are getting through.

Yours,

Chris

From: Clearwater [mailto:clearwater-bounces at lists.projectclearwater.org<mailto:clearwater-bounces at lists.projectclearwater.org>] On Behalf Of ??????? ?ats?????
Sent: 04 August 2016 13:41
To: Clearwater at lists.projectclearwater.org<mailto:Clearwater at lists.projectclearwater.org>
Subject: [Project Clearwater] SIP Client cannot connect after Clearwater manual installation

Hi All,

i have just performed the manual installation of project Clearwater using 6 nodes (1x ellis, 1x bono, 1x sprout, 1x homer, 1x homestead, 1x ralf)

Now I am trying to connect a SIP client (tried both with Zoiper and Ekiga). The VM in which Zoiper/Ekiga is installed has ping connectivity with the Clearwater nodes.


The system configuration is the following:

Shared Config:

 # Deployment definitions
home_domain=ims
sprout_hostname=sprout.ims
hs_hostname=hs.ims:8888
hs_provisioning_hostname=hs.im<http://hs.im>s:8889
ralf_hostname=ralf.ims:10888
xdms_hostname=homer.ims:7888


# Keys
signup_key=<secret>
turn_workaround=<secret>
ellis_api_key=<secret>
ellis_cookie_key=<secret>


local config : (for example in Bono node)

local_ip=192.168.99.131
public_ip=172.28.40.181
public_hostname=bono-1
etcd_cluster="192.168.99.130,192.168.99.131,192.168.88.132,192.168.99.133,192.168.99.134,192.168.99.135"


-----------------------------------------------------------------------------------
The process I follow to create the account is the following:

- Produce a number in Ellis dashboard:

Private Identity:

6505550731<tel:6505550731>@ims
Password: *******
only shown once


- Fill the required fields in the client:

  a) Ekiga
    name: Clearwater
    Registrar: ims (or bono_IP:port)
    User: 6505550731<tel:6505550731>
    Authentication user: 6505550731<tel:6505550731>@ims
    Password: ********

   b) Zoiper:
      user/user at host : 6505550731<tel:6505550731>
      Password: *********
      Domain / Outbound Proxy: ims (or bono_IP:port)

Both clients take a long time trying to connect but nothing (relative to the registration) seems to be written in the log files in any node.

The whole setup is behind a corporate proxy and I have configured the http[s]_proxy, no_proxy environment variables.

Can anyone help ?


Thanks,
Michael Katsoulis







-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.projectclearwater.org/pipermail/clearwater_lists.projectclearwater.org/attachments/20160823/f0b3b18c/attachment.html>

From richard.whitehouse at projectclearwater.org  Tue Aug 23 18:00:13 2016
From: richard.whitehouse at projectclearwater.org (Richard Whitehouse (projectclearwater.org))
Date: Tue, 23 Aug 2016 22:00:13 +0000
Subject: [Project Clearwater] CLearwater Integration in Openstack
In-Reply-To: <VI1PR0802MB2269ABC658D9DF14635ACAA9F2E80@VI1PR0802MB2269.eurprd08.prod.outlook.com>
References: <VI1PR0802MB2269ABC658D9DF14635ACAA9F2E80@VI1PR0802MB2269.eurprd08.prod.outlook.com>
Message-ID: <BY2PR0201MB1816725F72B3F14088FF489BF0EB0@BY2PR0201MB1816.namprd02.prod.outlook.com>

Jaafar,

It looks like your etcd cluster isn't able to form as it can't contact the other nodes in the cluster.

Do you have more than one node running? Have you allowed opened TCP port 4000 on all of your instances to allow traffic to be sent to that node, from all of the other nodes in your deployment.

This requirement is documented in http://clearwater.readthedocs.io/en/stable/Clearwater_IP_Port_Usage.html - you should check that you have allowed all the ports required by the nodes in your deployment.


Richard

From: Clearwater [mailto:clearwater-bounces at lists.projectclearwater.org] On Behalf Of jaafar BENDRISS
Sent: 22 August 2016 14:08
To: clearwater at lists.projectclearwater.org
Subject: [Project Clearwater] CLearwater Integration in Openstack




Hello,





Please I am struggling with the configuration and installation of Clearwater in openstack. I have the following problem:
sudo service clearwater-etcd start
etcd cluster has no published client endpoints.
Try '--no-sync' if you want to access non-published client endpoints(http://10.11.12.2:4000,http://10.11.12.8:4000,http://10.11.12.4:4000,http://10.11.12.14:4000,http://,http://10.11.12.6:4000<http://10.11.12.2:4000,http:/10.11.12.8:4000,http:/10.11.12.4:4000,http:/10.11.12.14:4000,http:/,http:/10.11.12.6:4000>).
Error:  client: no endpoints available
Rejoining cluster...



Could you help please

Thank you



Jaafar
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.projectclearwater.org/pipermail/clearwater_lists.projectclearwater.org/attachments/20160823/e6ae7a5e/attachment.html>

From crbertoldo at gmail.com  Tue Aug 23 21:56:13 2016
From: crbertoldo at gmail.com (Claudio Bertoldo)
Date: Tue, 23 Aug 2016 22:56:13 -0300
Subject: [Project Clearwater] Doubt about querying SIP registered
	subscribers
In-Reply-To: <BL2PR02MB2084A62A1F223E76C664CE6B9B130@BL2PR02MB2084.namprd02.prod.outlook.com>
References: <CAC6=c0fpfr9-C_QEaKEzbYoW9sbQ2VWNiHpFcFt6DHzh8xzA6w@mail.gmail.com>
	<BL2PR02MB208471FDBF223CB10666DD3E9B1F0@BL2PR02MB2084.namprd02.prod.outlook.com>
	<CAC6=c0f6qNz-HUr7ur9kxyWKjwszpMH8rzYLz3w+0iheAwGg_w@mail.gmail.com>
	<BL2PR02MB2084A62A1F223E76C664CE6B9B130@BL2PR02MB2084.namprd02.prod.outlook.com>
Message-ID: <CAC6=c0f=PomtyLeCU_gQA1q0Nc5Nuhi69A4TLCENhMkDSZHCwg@mail.gmail.com>

Hi Peter,

Thanks a lot and sorry for the delay. This solution has helped me a lot.

For instance, the user below (2010099999 at example.com) was registered from
192.168.56.1, but this IP address is purposely not sent in my SIP packet,
but Clearwater knows it. Thru the command below I can't see as well, but I
know that Clearwater relates 2010099999 at example.com to 192.168.56.1 because
when I INVITE 2010099999 at example.com, an INVITE packet is sent from
Clearwater (192.168.56.110) to 192.168.56.1. If you know any way to query
this real IP address (not that sent inside the packet, i.e., 127.0.0.1 like
below), please let me know.

*get reg\\sip:2010099999 at example.com <sip%3A2010099999 at example.com>*
VALUE reg\\sip:2010099999 at example.com 3111270053 488
{"bindings":{"<urn:uuid:00000000-0000-0000-0000-000000000001>:1":{"uri":"sip:2010099999 at 127.0.1.1:5061
;transport=UDP;ob","cid":"2010099999///1-4842 at 127.0.1.1
","cseq":2,"expires":1471990385,"priority":0,"params":{"+sip.ice":"","+sip.instance":"\"<urn:uuid:00000000-0000-0000-0000-000000000001>\"","reg-id":"1"},"paths":["sip:j663TAPCIj at 192.168.56.110:5058
;transport=TCP;lr;ob"],"timer_id":"","private_id":"2010099999 at example.com
","emergency_reg":false}},"subscriptions":{},"notify_cseq":2}
*END*

@Ellie,

Thank you very much. I'll try to go further with this expiration time to be
sure and if applicable I ask for help again here.

Best,

Claudio Bertoldo

On Tue, Aug 16, 2016 at 1:42 PM, Eleanor Merry (projectclearwater.org) <
eleanor at projectclearwater.org> wrote:

> Hi Claudio,
>
>
>
> There?s no minimum expiry time setting within Project Clearwater. Your SIP
> client may impose a minimum expiry time, as might the P-CSCF if you?re not
> using Bono.
>
>
>
> If you don?t think anything should be setting a minimum expiry time, can
> you please send debug logs over for a register for Sprout and Bono? You can
> see how to turn on debug logs at: http://clearwater.readthedocs.
> io/en/stable/Troubleshooting_and_Recovery.html#sprout.
>
>
>
> Thanks,
>
>
>
> Ellie
>
>
>
> *From:* Claudio Bertoldo [mailto:crbertoldo at gmail.com]
> *Sent:* 15 August 2016 20:12
> *To:* Eleanor Merry (projectclearwater.org)
> *Cc:* clearwater at lists.projectclearwater.org
> *Subject:* Re: [Project Clearwater] Doubt about querying SIP registered
> subscribers
>
>
>
> Hi Ellie,
>
>
>
> Thanks a lot.
>
>
>
> Besides of other applications, I'd like to know why registered users with
> desired lifespan of 1s ('Expires: 1') take more than it to expire. I think
> there's a minimum time, is that right?
>
>
>
> Anyway, if/when a best way to query it arise, please let me know.
>
>
>
> Thanks in advance.
>
>
>
> Best,
>
>
>
> Claudio
>
>
>
>
>
> On Fri, Aug 12, 2016 at 2:38 PM, Eleanor Merry (projectclearwater.org) <
> eleanor at projectclearwater.org> wrote:
>
> Hi Claudio,
>
>
>
> There?s no official way of getting this information I?m afraid.
>
>
>
> The information you want is stored in our memcached database. I?ve had a
> look around for supported methods of pulling all the values out of
> memcached, but I?ve not had much luck.
>
>
>
> There?s ?memcached-tool? (/usr/share/memcached/scripts/memcached-tool
> <local ip>:11211 dump) which should report all the keys and values stored
> in memcached, but I?ve found this just hangs on my machine.
>
>
>
> There?s also using the output of ?stats cachedump?, but I?ve found that
> this gives me the output ?SERVER_ERROR out of memory writing stats? (and it
> doesn?t appear to be an officially supported debug tool from memcached).
>
>
>
> You may have more luck with these methods!
>
>
>
> Ellie
>
>
>
> *From:* Clearwater [mailto:clearwater-bounces at lists.projectclearwater.org]
> *On Behalf Of *Claudio Bertoldo
> *Sent:* 11 August 2016 02:45
> *To:* clearwater at lists.projectclearwater.org
> *Subject:* [Project Clearwater] Doubt about querying SIP registered
> subscribers
>
>
>
> Hi,
>
>
>
> I'd like to know if it's possible to query the current registered
> subscribers, their expiration time (remaining time preferably) and their IP
> address. I could not find this info in this list neither in the official
> documentation, so if that is there, sorry in advance.
>
>
>
> Best regards,
>
>
>
> Claudio Bertoldo
>
>
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.projectclearwater.org/pipermail/clearwater_lists.projectclearwater.org/attachments/20160823/944f51fb/attachment.html>

From matt at projectclearwater.org  Wed Aug 24 04:05:36 2016
From: matt at projectclearwater.org (Matt Williams (projectclearwater.org))
Date: Wed, 24 Aug 2016 08:05:36 +0000
Subject: [Project Clearwater] Doubt about querying SIP
	registered	subscribers
In-Reply-To: <CAC6=c0f=PomtyLeCU_gQA1q0Nc5Nuhi69A4TLCENhMkDSZHCwg@mail.gmail.com>
References: <CAC6=c0fpfr9-C_QEaKEzbYoW9sbQ2VWNiHpFcFt6DHzh8xzA6w@mail.gmail.com>
	<BL2PR02MB208471FDBF223CB10666DD3E9B1F0@BL2PR02MB2084.namprd02.prod.outlook.com>
	<CAC6=c0f6qNz-HUr7ur9kxyWKjwszpMH8rzYLz3w+0iheAwGg_w@mail.gmail.com>
	<BL2PR02MB2084A62A1F223E76C664CE6B9B130@BL2PR02MB2084.namprd02.prod.outlook.com>
	<CAC6=c0f=PomtyLeCU_gQA1q0Nc5Nuhi69A4TLCENhMkDSZHCwg@mail.gmail.com>
Message-ID: <CY1PR0201MB15631EE4912ABD3F720F568C90EA0@CY1PR0201MB1563.namprd02.prod.outlook.com>

Claudio,

Yes, the S-CSCF's registration entry for each subscriber is stored in memcached in JSON format, and that's what you're seeing here.  The key things from a routing perspective are the Contact and Path headers - these are used to construct INVITEs to send out to the UE.

I'm guessing here that

?         192.168.56.110 is your P-CSCF (e.g. Bono)

?         192.168.56.1 is your UE's actual IP address

?         127.0.1.1 is the IP address your UE presents.
Is that right?

If so, I don't think you'll see the 192.168.56.1 IP address in any of the S-CSCF's data - I think only the P-CSCF knows how to reach the UE (by matching on the flow token - "j663TAPCIj" in your example).

Unfortunately, Bono doesn't store its data in an external database, and it doesn't have an interface to view this information.  It would be possible to add such an interface... and I believe other P-CSCFs (e.g. Metaswitch Perimeta - http://www.metaswitch.com/perimeta-session-border-controller-sbc) already have interfaces like this.

I hope that helps.

Matt

From: Clearwater [mailto:clearwater-bounces at lists.projectclearwater.org] On Behalf Of Claudio Bertoldo
Sent: 24 August 2016 02:56
To: Eleanor Merry (projectclearwater.org) <eleanor at projectclearwater.org>
Cc: clearwater at lists.projectclearwater.org
Subject: Re: [Project Clearwater] Doubt about querying SIP registered subscribers

Hi Peter,

Thanks a lot and sorry for the delay. This solution has helped me a lot.

For instance, the user below (2010099999 at example.com<mailto:2010099999 at example.com>) was registered from 192.168.56.1, but this IP address is purposely not sent in my SIP packet, but Clearwater knows it. Thru the command below I can't see as well, but I know that Clearwater relates 2010099999 at example.com<mailto:2010099999 at example.com> to 192.168.56.1 because when I INVITE 2010099999 at example.com<mailto:2010099999 at example.com>, an INVITE packet is sent from Clearwater (192.168.56.110) to 192.168.56.1. If you know any way to query this real IP address (not that sent inside the packet, i.e., 127.0.0.1 like below), please let me know.

get reg\\sip:2010099999 at example.com<mailto:sip%3A2010099999 at example.com>
VALUE reg\\sip:2010099999 at example.com<mailto:sip%3A2010099999 at example.com> 3111270053 488
{"bindings":{"<urn:uuid:00000000-0000-0000-0000-000000000001>:1":{"uri":"sip:2010099999 at 127.0.1.1:5061;transport=UDP;ob","cid":"2010099999///1-4842 at 127.0.1.1<mailto:1-4842 at 127.0.1.1>","cseq":2,"expires":1471990385,"priority":0,"params":{"+sip.ice":"","+sip.instance":"\"<urn:uuid:00000000-0000-0000-0000-000000000001>\"","reg-id":"1"},"paths":["sip:j663TAPCIj at 192.168.56.110:5058;transport=TCP;lr;ob"],"timer_id":"","private_id":"2010099999 at example.com<mailto:2010099999 at example.com>","emergency_reg":false}},"subscriptions":{},"notify_cseq":2}
END

@Ellie,

Thank you very much. I'll try to go further with this expiration time to be sure and if applicable I ask for help again here.

Best,

Claudio Bertoldo

On Tue, Aug 16, 2016 at 1:42 PM, Eleanor Merry (projectclearwater.org<http://projectclearwater.org>) <eleanor at projectclearwater.org<mailto:eleanor at projectclearwater.org>> wrote:
Hi Claudio,

There?s no minimum expiry time setting within Project Clearwater. Your SIP client may impose a minimum expiry time, as might the P-CSCF if you?re not using Bono.

If you don?t think anything should be setting a minimum expiry time, can you please send debug logs over for a register for Sprout and Bono? You can see how to turn on debug logs at: http://clearwater.readthedocs.io/en/stable/Troubleshooting_and_Recovery.html#sprout.

Thanks,

Ellie

From: Claudio Bertoldo [mailto:crbertoldo at gmail.com<mailto:crbertoldo at gmail.com>]
Sent: 15 August 2016 20:12
To: Eleanor Merry (projectclearwater.org<http://projectclearwater.org>)
Cc: clearwater at lists.projectclearwater.org<mailto:clearwater at lists.projectclearwater.org>
Subject: Re: [Project Clearwater] Doubt about querying SIP registered subscribers

Hi Ellie,

Thanks a lot.

Besides of other applications, I'd like to know why registered users with desired lifespan of 1s ('Expires: 1') take more than it to expire. I think there's a minimum time, is that right?

Anyway, if/when a best way to query it arise, please let me know.

Thanks in advance.

Best,

Claudio


On Fri, Aug 12, 2016 at 2:38 PM, Eleanor Merry (projectclearwater.org<http://projectclearwater.org>) <eleanor at projectclearwater.org<mailto:eleanor at projectclearwater.org>> wrote:
Hi Claudio,

There?s no official way of getting this information I?m afraid.

The information you want is stored in our memcached database. I?ve had a look around for supported methods of pulling all the values out of memcached, but I?ve not had much luck.

There?s ?memcached-tool? (/usr/share/memcached/scripts/memcached-tool <local ip>:11211 dump) which should report all the keys and values stored in memcached, but I?ve found this just hangs on my machine.

There?s also using the output of ?stats cachedump?, but I?ve found that this gives me the output ?SERVER_ERROR out of memory writing stats? (and it doesn?t appear to be an officially supported debug tool from memcached).

You may have more luck with these methods!

Ellie

From: Clearwater [mailto:clearwater-bounces at lists.projectclearwater.org<mailto:clearwater-bounces at lists.projectclearwater.org>] On Behalf Of Claudio Bertoldo
Sent: 11 August 2016 02:45
To: clearwater at lists.projectclearwater.org<mailto:clearwater at lists.projectclearwater.org>
Subject: [Project Clearwater] Doubt about querying SIP registered subscribers

Hi,

I'd like to know if it's possible to query the current registered subscribers, their expiration time (remaining time preferably) and their IP address. I could not find this info in this list neither in the official documentation, so if that is there, sorry in advance.

Best regards,

Claudio Bertoldo


-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.projectclearwater.org/pipermail/clearwater_lists.projectclearwater.org/attachments/20160824/2eaf9013/attachment.html>

From surya.nayani at gmail.com  Wed Aug 24 05:51:45 2016
From: surya.nayani at gmail.com (surya)
Date: Wed, 24 Aug 2016 15:21:45 +0530
Subject: [Project Clearwater] Clearwater installation on Hlinux
In-Reply-To: <CY1PR02MB11815AA2C377482E6FAA1D02E11F0@CY1PR02MB1181.namprd02.prod.outlook.com>
References: <CANivR2gMd2+8wKgULn6rCmVvHvMJFoLR4D4xN54qvzvV32Dh+w@mail.gmail.com>
	<CY1PR02MB1181DA8B1DE66EFF30CF3D4EE11D0@CY1PR02MB1181.namprd02.prod.outlook.com>
	<CANivR2jdXxKApA5u4cm+jYdCN4Oig5aj8wERjxvDBN+GCg34aA@mail.gmail.com>
	<CANivR2hmBCiLmAK6dqJ8BRvEcy5Qbv_oF2v3Vq1hXdrkdwR9Dw@mail.gmail.com>
	<CY1PR02MB11815AA2C377482E6FAA1D02E11F0@CY1PR02MB1181.namprd02.prod.outlook.com>
Message-ID: <CANivR2jDGUBeB7x+f00Tp2BZScZLzBGKXhoCvQZkh3SLgf1bBg@mail.gmail.com>

Hi all,

Clearwater installation on Hlinux is completed. All services are running
fine.

nfvadmin at clw-validator-2:~/clearwater-live-test$ rake test[cwhpe.com]
SIGNUP_CODE=secret PROXY=bono.cwhpe.com ELLIS=ellis.cwhpe.com TESTS="Basic
Call*" TRANSPORT=tcp

Basic Call - Mainline (TCP) - (6505550000, 6505550004) Passed

Basic Call - SDP (TCP) - (6505550006, 6505550000) Passed

Basic Call - Tel URIs (TCP) - (6505550002, 6505550008) Passed

Basic Call - Unknown number (TCP) - (6505550004, 6505550003) Passed

Basic Call - Rejected by remote endpoint (TCP) - (6505550000, 6505550002)
Passed

Basic Call - Messages - Pager model (TCP) - (6505550004, 6505550003) Passed

Basic Call - Pracks (TCP) - (6505550002, 6505550001) Passed

0 failures out of 7 tests run

0 tests skipped

But the sip call test is failing.

all-Id: 4950-11856 at 192.168.10.25, receive timeout on message Clearwater
phone number registration:1 without label to jump to (ontimeout attribute):
aborting call.
sipp: There were more errors, see 'reg_unreg_11856_errors.log' file



Command used to test the call:

 /home/nfvadmin/surya/sipp-3.3.990#  ./sipp 192.168.10.3 -sf reg_unreg.xml
-inf sippuser.csv  -r 10 -rate_increase 50 -rate_max 250 -recv_timeout
10000 -trace_screen -trace_stat -fd 30 -trace_err

192.168.10.3   - bono IP



Please find the attached VM logs.

Could any one please provide us any solution for this issue

Thanks & Regards,
Surya


On Fri, Aug 12, 2016 at 3:28 PM, Chris Elford (projectclearwater.org) <
chris at projectclearwater.org> wrote:

> Hi Surya,
>
>
>
> Thank you for sending over the details. It looks like Cassandra is
> starting up, but that Homestead is failing to connect to it.
>
>
>
> You can see that Cassandra is listening on 0.0.0.0:9160 from netstat.txt,
> and from /var/log/cassandra/system.log:
>
>
>
> INFO [main] 2016-08-10 11:45:21,948 TServerCustomFactory.java (line 47)
> Using synchronous/threadpool thrift server on 0.0.0.0 : 9160
>
> INFO [Thread-8] 2016-08-10 11:45:21,948 ThriftServer.java (line 135)
> Listening for thrift clients...
>
>
>
> After this, Homestead still fails to connect. From
> /var/log/homestead/homestead_err.log:
>
>
>
> Thrift: Wed Aug 10 11:45:51 2016 TSocket::open() connect() <Host:
> localhost Port: 9160>Connection refused
>
> Thrift: Wed Aug 10 11:46:32 2016 TSocket::open() connect() <Host:
> localhost Port: 9160>Connection refused
>
>
>
> Our current best theory is that localhost on your system is resolving to
> the IPv6 address ::0 rather than the IP address 127.0.0.1. As Cassandra is
> listening on IPv4 only, that would stop Homestead connecting.
>
>
>
> You can confirm that by running nslookup localhost on your system.
>
>
>
> If that is the issue, then we can work out how to fix it.
>
>
>
> I?m on vacation from tomorrow, so I won?t be able to respond to any emails
> on this issue. I suggest mailing the list for help while I?m gone.
>
>
>
> Chris
>
>
>
> *From:* surya [mailto:surya.nayani at gmail.com]
> *Sent:* 10 August 2016 16:57
> *To:* Chris Elford (projectclearwater.org) <chris at projectclearwater.org>
> *Subject:* Re: [Project Clearwater] Clearwater installation on Hlinux
>
>
>
> Hello Chris,
>
>
>
> I have reinstalled the clearwater VM's.  This time I got the dump file
>
>
>
> Please find the attached log file
>
>
>
>
>
> Please let me know if you need any other logs
>
>
>
> Thanks & regards,
>
> Surya
>
>
>
> On Wed, Aug 10, 2016 at 3:44 PM, surya <surya.nayani at gmail.com> wrote:
>
> Hello Chris,
>
>
>
> Thanks a lot for responding
>
>
>
> I could not find any dumps in homestead node
>
>
>
> This is the output on my node
>
>
>
> [homestead]root at homestead:/var/clearwater-diags-monitor# cd dumps/
>
> [homestead]root at homestead:/var/clearwater-diags-monitor/dumps# ls
>
> [homestead]root at homestead:/var/clearwater-diags-monitor/dumps# cd ../tmp/
>
> [homestead]root at homestead:/var/clearwater-diags-monitor/tmp# ls
>
> [homestead]root at homestead:/var/clearwater-diags-monitor/tmp# cd ..
>
> [homestead]root at homestead:/var/clearwater-diags-monitor#
> /usr/share/clearwater/bin/gather_diags
>
> gather_diags:
>
> This script triggers diagnostics collection.
>
>
>
> The packaged diagnostics are created in /var/clearwater-diags-monitor/
> dumps/*.tar.gz
>
> [homestead]root at homestead:/var/clearwater-diags-monitor# cd dumps/
>
> [homestead]root at homestead:/var/clearwater-diags-monitor/dumps# ls
>
> [homestead]root at homestead:/var/clearwater-diags-monitor/dumps# ls -a
>
> .  ..
>
>
>
>
>
>
>
>
>
> Please let me know if you need any other logs
>
>
>
> Thanks & Regards,
>
> Surya
>
>
>
> On Wed, Aug 10, 2016 at 3:34 PM, Chris Elford (projectclearwater.org) <
> chris at projectclearwater.org> wrote:
>
> Hi Surya,
>
>
>
> The log below shows that Homestead was trying to connect to Cassandra on
> port 9160, but that this failed. We have seen this in the past, for a
> couple of different reasons.
>
>
>
> The first possibility is that Cassandra is just not up and running yet. If
> you wait 10min, does the issue clear?
>
>
>
> The second possibility is that something has gone wrong with Cassandra.
> From the monit output, it looks like it is running, but we should check
> that:
>
> ?         Run `sudo monit status` and check the Cassandra process? uptime.
>
> ?         Look for errors in the logs in /var/log/Cassandra.
>
>
>
> Otherwise, there are a few places that setting up Cassandra might have
> gone wrong. If you send me over a diagnostics bundle I may be able to help
> track down what has gone wrong. If you do, please send this it me directly
> ? it will not send through the mailing list. You can find instructions for
> gathering a diagnostics bundle here
> <https://github.com/Metaswitch/clearwater-infrastructure/blob/master/clearwater-diags-monitor.md>.
> It would be great if there is a bundle from Friday.
>
>
>
> Yours,
>
>
>
> Chris
>
>
>
> *From:* Clearwater [mailto:clearwater-bounces at lists.projectclearwater.org]
> *On Behalf Of *surya
> *Sent:* 05 August 2016 13:37
> *To:* clearwater at lists.projectclearwater.org
> *Subject:* [Project Clearwater] Clearwater installation on Hlinux
>
>
>
> HI all,
>
>
>
> I'm trying to install clearwater on Hlinux( HP version of linux)
>
>
>
> I have installed all required packages
>
>
>
> Bono,Ellis,Homer services are installed and configure properly. but I'm
> facing issues with homestead service
>
>
>
>
>
> [homestead]root at homestead:~# monit summary
>
> Monit 5.18.1 uptime: 51m
>
>  Service Name                     Status                      Type
>
>  node-homestead                   Running                     System
>
>  ntp_process                      Running                     Process
>
>  nginx_process                    Running                     Process
>
> * homestead_process                Execution failed | Does...  Process*
>
>  clearwater_queue_manager_pro...  Running                     Process
>
>  etcd_process                     Running                     Process
>
>  clearwater_diags_monitor_pro...  Running                     Process
>
>  clearwater_config_manager        Running                     Process
>
>  clearwater_cluster_manager       Running                     Process
>
>  cassandra_process                Running                     Process
>
>  nginx_uptime                     Status ok                   Program
>
>  monit_uptime                     Status ok                   Program
>
>  homestead_uptime                 Not monitored               Program
>
>  poll_homestead                   Not monitored               Program
>
>  clearwater_queue_manager_uptime  Status ok                   Program
>
>  etcd_uptime                      Status ok                   Program
>
>  poll_etcd_cluster                Status ok                   Program
>
>  poll_etcd                        Status ok                   Program
>
>  cassandra_uptime                 Status ok                   Program
>
>  poll_cassandra                   Status ok                   Program
>
>
>
>
>
> [homestead]root at homestead:~# LD_LIBRARY_PATH=/usr/share/clearwater/homestead/lib
> /usr/share/clearwater/bin/homestead
>
> Thrift: Fri Aug  5 07:58:11 2016 TSocket::open() connect() <Host:
> localhost Port: 9160>Connection refused
>
> 05-08-2016 11:58:11.407 UTC Error cassandra_store.cpp:189: Store caught
> InvalidRequestException: Keyspace 'homestead_cache' does not exist
>
> 05-08-2016 11:58:11.408 UTC Error main.cpp:720: Failed to initialize the
> Cassandra cache with error code 1.
>
>
>
>
>
> And this is the issue I have seenin homestead log
>
>
>
>
>
> 5-08-2016 12:32:02.163 UTC Error cassandra_store.cpp:189: Store caught
> InvalidRequestException: Keyspace 'homestead_cache' does not exist
>
> 05-08-2016 12:32:02.163 UTC Error main.cpp:720: Failed to initialize the
> Cassandra cache with error code 1.
>
> 05-08-2016 12:32:02.163 UTC Status main.cpp:721: Homestead is shutting down
>
>
>
>
>
>
>
>
>
> Please let me know if I'm missing any configuration here
>
>
>
>
>
>
>
> Thanks & Regards,
>
> Surya
>
>
>
> --
>
> surya
>
>
>
>
>
> --
>
> surya
>
>
>
>
>
> --
>
> surya
>



-- 
surya
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.projectclearwater.org/pipermail/clearwater_lists.projectclearwater.org/attachments/20160824/7c04e15c/attachment.html>
-------------- next part --------------
-08-2016 09:36:48.555 UTC Warning (Net-SNMP): Warning: Failed to connect to the agentx master agent ([NIL]):
24-08-2016 09:37:03.570 UTC Warning (Net-SNMP): Warning: Failed to connect to the agentx master agent ([NIL]):
24-08-2016 09:37:07.416 UTC Debug alarm.cpp:253: Reraising all alarms with a known state
24-08-2016 09:37:07.416 UTC Debug alarm.cpp:312: AlarmReqAgent: queue overflowed
24-08-2016 09:37:07.416 UTC Status alarm.cpp:62: homestead issued 1501.1 alarm
24-08-2016 09:37:18.585 UTC Warning (Net-SNMP): Warning: Failed to connect to the agentx master agent ([NIL]):
24-08-2016 09:37:33.599 UTC Warning (Net-SNMP): Warning: Failed to connect to the agentx master agent ([NIL]):
24-08-2016 09:37:37.416 UTC Debug alarm.cpp:253: Reraising all alarms with a known state
24-08-2016 09:37:37.416 UTC Debug alarm.cpp:312: AlarmReqAgent: queue overflowed
24-08-2016 09:37:37.416 UTC Status alarm.cpp:62: homestead issued 1501.1 alarm
24-08-2016 09:37:48.607 UTC Warning (Net-SNMP): Warning: Failed to connect to the agentx master agent ([NIL]):
24-08-2016 09:38:03.619 UTC Warning (Net-SNMP): Warning: Failed to connect to the agentx master agent ([NIL]):
24-08-2016 09:38:07.416 UTC Debug alarm.cpp:253: Reraising all alarms with a known state
24-08-2016 09:38:07.416 UTC Debug alarm.cpp:312: AlarmReqAgent: queue overflowed
24-08-2016 09:38:07.416 UTC Status alarm.cpp:62: homestead issued 1501.1 alarm
24-08-2016 09:38:18.633 UTC Warning (Net-SNMP): Warning: Failed to connect to the agentx master agent ([NIL]):
24-08-2016 09:38:33.637 UTC Warning (Net-SNMP): Warning: Failed to connect to the agentx master agent ([NIL]):
24-08-2016 09:38:37.416 UTC Debug alarm.cpp:253: Reraising all alarms with a known state
24-08-2016 09:38:37.416 UTC Debug alarm.cpp:312: AlarmReqAgent: queue overflowed
24-08-2016 09:38:37.416 UTC Status alarm.cpp:62: homestead issued 1501.1 alarm
24-08-2016 09:38:48.651 UTC Warning (Net-SNMP): Warning: Failed to connect to the agentx master agent ([NIL]
-------------- next part --------------
A non-text attachment was scrubbed...
Name: homer_err.log
Type: application/octet-stream
Size: 2246 bytes
Desc: not available
URL: <http://lists.projectclearwater.org/pipermail/clearwater_lists.projectclearwater.org/attachments/20160824/7c04e15c/attachment.obj>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: bono.log
Type: application/octet-stream
Size: 303810 bytes
Desc: not available
URL: <http://lists.projectclearwater.org/pipermail/clearwater_lists.projectclearwater.org/attachments/20160824/7c04e15c/attachment-0001.obj>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: reg_unreg_11856_errors.log
Type: application/octet-stream
Size: 4752 bytes
Desc: not available
URL: <http://lists.projectclearwater.org/pipermail/clearwater_lists.projectclearwater.org/attachments/20160824/7c04e15c/attachment-0002.obj>

From marstonaustin at gmail.com  Wed Aug 24 12:40:02 2016
From: marstonaustin at gmail.com (Austin Marston)
Date: Wed, 24 Aug 2016 18:40:02 +0200
Subject: [Project Clearwater] Clearwater SIPp Node Errors 401,
	403 and 503
In-Reply-To: <CABNCMD0nCg0WxXe6UXPWco-gBqnRGfpy0PfgG=0MoDLYfuvj1w@mail.gmail.com>
References: <CABNCMD0nCg0WxXe6UXPWco-gBqnRGfpy0PfgG=0MoDLYfuvj1w@mail.gmail.com>
Message-ID: <4BDB076A-51DE-4CA3-A0C8-138EBDE82EF9@gmail.com>

Hi Hocine,

Did you see this thread : https://www.mail-archive.com/clearwater at lists.projectclearwater.org/msg01942.html ?

Austin

Le 30 juil. 2016 ? 12:47, Bouzidi Hocine a ?crit :

> Hello,
> 
> I deployed the clearwater system on OpenStack using manual installation, I generated 1000 numbers starting at sip:6505550000 at ims.cl
> sudo bash -c "export PATH=/usr/share/clearwater/ellis/env/bin:$PATH ; 
>               cd /usr/share/clearwater/ellis/src/metaswitch/ellis/tools/ ; 
>               python create_numbers.py --start 6505550000 --count 1000"
> 
> I have created numbers in bulk, and created the SIPp node following the 
> instructions at : http://clearwater.readthedocs.io/en/latest/Clearwater_stress_testing.html 
> However, when I start the SIPp node, all requests are rejected by Bono with either 401, 403 or 503 error code.
> 
> 
> 
> I put below my configuration and logs of different machines.
> 
> I would be grateful, to help me solve this problem,
> Thanks and Regards,
> Hocine.
> 
> **************************************************************************************************************************
> 
> ellis :             192.168.1.30
> bono :           192.168.1.31
> sprout :         192.168.1.32
> homer :         192.168.1.33
> hs :                192.168.1.34
> ralf :              192.168.1.35
> SIPp node : 192.168.1.3
> 
> **************************************************************************************************************************
> 
> [ellis]root at ellis:/var/log/ellis# lsb_release -a
> No LSB modules are available.
> Distributor ID:    Ubuntu
> Description:    Ubuntu 14.04.4 LTS
> Release:    14.04
> Codename:    trusty
> 
> **************************************************************************************************************************
> 
> local_config for : (ellis, bono, sprout, homer, homestead, ralf) :
> 
> local_ip=(192.168.1.31)/*for bono*/
> public_ip=pub_ip_bono
> public_hostname=bono.ims.cl
> etcd_cluster="192.168.1.30,192.168.1.31,192.168.1.32,192.168.1.33,192.168.1.34,192.168.1.35"
> 
> **************************************************************************************************************************
> 
> shared_config for : (ellis, bono, sprout, homer, homestead, ralf) :
> 
> # Deployment definitions
> home_domain=ims.cl
> sprout_hostname=sprout.ims.cl
> hs_hostname=hs.ims.cl:8888
> hs_provisioning_hostname=hs.ims.cl:8889
> ralf_hostname=ralf.ims.cl:10888
> xdms_hostname=homer.ims.cl:7888
> 
> # Email server configuration
> #smtp_smarthost=<smtp server>
> #smtp_username=<username>
> #smtp_password=<password>
> #email_recovery_sender=clearwater at example.org
> 
> # Keys
> signup_key="secret"
> turn_workaround="secret"
> ellis_api_key="secret"
> ellis_cookie_key="secret"
> 
> **************************************************************************************************************************
> 
> local_config for SIPp node :
> 
> home_domain=ims.cl
> local_ip=192.168.1.3
> bono_servers=192.168.1.31
> stress_target=192.168.1.31
> base=6505550000
> count=1000
> 
> **************************************************************************************************************************
> 
> shared_config for SIPp node :
> 
> home_domain=ims.cl
> 
> **************************************************************************************************************************
> 
> chronos de sprout :
> 
> [http]
> bind-address = 192.168.1.32
> bind-port = 7253
> threads = 50
> 
> [logging]
> folder = /var/log/chronos
> level = 2
> 
> [alarms]
> enabled = true
> 
> [exceptions]
> max_ttl = 600
> 
> **************************************************************************************************************************
> 
> chronos de ralf :
> 
> [http]
> bind-address = 192.168.1.35
> bind-port = 7253
> threads = 50
> 
> [logging]
> folder = /var/log/chronos
> level = 2
> 
> [alarms]
> enabled = true
> 
> [exceptions]
> max_ttl = 600
> 
> **************************************************************************************************************************
> 
> Dns config :
> 
> $TTL 5m ; Default TTL
> 
> @                 3600       IN SOA  ns admin ( 2014010800 ; Serial
>                                           3600       ; Refresh
>                                           3600       ; Retry
>                                           3600       ; Expire
>                                           300 )      ; Minimum TTL
> @                 3600       IN NS   ns
> ns                3600       IN A     pub_ip_dns ; IPv4 address of BIND server
> bono                            IN A     pub_ip_bono
> @                                  IN A     pub_ip_bono
> @                                  IN NAPTR 1 1 "S" "SIP+D2T" "" _sip._tcp
> @                                  IN NAPTR 2 1 "S" "SIP+D2U" "" _sip._udp
> _sip._tcp                    IN SRV   0 0 5060 bono
> _sip._udp                   IN SRV   0 0 5060 bono
> sprout                          IN A     pub_ip_sprout
> scscf.sprout               IN A     pub_ip_sprout
> sprout                          IN NAPTR 1 1 "S" "SIP+D2T" "" _sip._tcp.sprout
> _sip._tcp.sprout       IN SRV   0 0 5054 sprout
> scscf.sprout               IN NAPTR 1 1 "S" "SIP+D2T" "" _sip._tcp.scscf.sprout
> _sip._tcp.scscf.sprout IN SRV   0 0 5054 sprout
> icscf.sprout               IN A     pub_ip_sprout
> icscf.sprout               IN NAPTR 1 1 "S" "SIP+D2T" "" _sip._tcp.icscf.sprout
> _sip._tcp.icscf.sprout IN SRV   0 0 5052 sprout
> homestead                IN A     pub_ip_hs
> hs                                IN A     pub_ip_hs
> homer                        IN A     pub_ip_homer
> ralf                              IN A     pub_ip_ralf
> ellis                            IN A     pub_ip_ellis
> benchmark              IN A     pub_ip_sip_stress_testing
> 
> **************************************************************************************************************************
> 
> Ping results :
> 
> 64 bytes from ellis.ims.cl: icmp_seq=1 ttl=60 time=1.39 ms
> 64 bytes from bono.ims.cl: icmp_seq=2 ttl=60 time=0.681 ms
> 64 bytes from sprout.ims.cl: icmp_seq=2 ttl=60 time=0.999 ms
> 64 bytes from homer.ims.cl: icmp_seq=3 ttl=60 time=0.754 ms
> 64 bytes from hs.ims.cl: icmp_seq=3 ttl=63 time=0.554 ms
> 64 bytes from ralf.ims.cl: icmp_seq=3 ttl=60 time=0.953 ms
> 64 bytes from scscf.sprout.ims.cl: icmp_seq=3 ttl=60 time=1.17 ms
> 64 bytes from icscf.sprout.ims.cl: icmp_seq=2 ttl=60 time=1.08 ms
> 
> **************************************************************************************************************************
> 
> Sip stress testing logs in SIPp node : 192.168.1.3
> 
> 1 - sip-stress_counts.csv :
> 
> CurrentTime;ElapsedTime;1_Pause_Sessions;1_Pause_Unexp;2_REGISTER_Sent;2_REGISTER_Retrans;3_401_Recv;3_401_Retrans;3_401_Timeout;3_401_Unexp;4_REGISTER_Sent;4_REGISTER_Retrans;5_200_Recv;5_200_Retrans;5_200_Timeout;5_200_Unexp;6_REGISTER_Sent;6_REGISTER_Retrans;7_401_Recv;7_401_Retrans;7_401_Timeout;7_401_Unexp;8_REGISTER_Sent;8_REGISTER_Retrans;9_200_Recv;9_200_Retrans;9_200_Timeout;9_200_Unexp;10_Pause_Sessions;10_Pause_Unexp;11_REGISTER_Sent;11_REGISTER_Retrans;12_200_Recv;12_200_Retrans;12_200_Timeout;12_200_Unexp;13_REGISTER_Sent;13_REGISTER_Retrans;14_200_Recv;14_200_Retrans;14_200_Timeout;14_200_Unexp;15_Pause_Sessions;15_Pause_Unexp;17_Pause_Sessions;17_Pause_Unexp;18_INVITE_Sent;18_INVITE_Retrans;19_100_Recv;19_100_Retrans;19_100_Timeout;19_100_Unexp;20_INVITE_Recv;20_INVITE_Retrans;20_INVITE_Timeout;20_INVITE_Unexp;22_100_Recv;22_100_Retrans;22_100_Timeout;22_100_Unexp;23_INVITE_Recv;23_INVITE_Retrans;23_INVITE_Timeout;23_INVITE_Unexp;25_100_Sent;25_100_Retrans;26_180_Sent;26_180_Retrans;27_180_Recv;27_180_Retrans;27_180_Timeout;27_180_Unexp;28_Pause_Sessions;28_Pause_Unexp;29_200_Sent;29_200_Retrans;30_200_Recv;30_200_Retrans;30_200_Timeout;30_200_Unexp;31_ACK_Sent;31_ACK_Retrans;32_ACK_Recv;32_ACK_Retrans;32_ACK_Timeout;32_ACK_Unexp;33_UPDATE_Sent;33_UPDATE_Retrans;34_UPDATE_Recv;34_UPDATE_Retrans;34_UPDATE_Timeout;34_UPDATE_Unexp;35_200_Sent;35_200_Retrans;36_200_Recv;36_200_Retrans;36_200_Timeout;36_200_Unexp;37_Pause_Sessions;37_Pause_Unexp;38_BYE_Sent;38_BYE_Retrans;39_BYE_Recv;39_BYE_Retrans;39_BYE_Timeout;39_BYE_Unexp;40_200_Sent;40_200_Retrans;41_200_Recv;41_200_Retrans;41_200_Timeout;41_200_Unexp;42_Pause_Sessions;42_Pause_Unexp;
> 2016-07-30      04:48:58:500    1469846938.500563;00:00:00:011;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;
> 2016-07-30      04:49:58:502    1469846998.502974;00:01:00:014;500;0;42;0;0;0;36;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;
> 2016-07-30      04:50:58:504    1469847058.504622;00:02:00:015;500;0;92;0;0;0;86;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;
> 2016-07-30      04:51:58:505    1469847118.505831;00:03:00:017;500;0;141;0;0;0;129;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;
> 2016-07-30      04:52:58:506    1469847178.506461;00:04:00:017;500;0;198;0;0;0;188;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;
> 2016-07-30      04:53:58:509    1469847238.509161;00:05:00:020;500;0;245;0;0;0;236;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;
> 
> 2 - sip-stress_errors.log :
> 
> sipp: The following events occured:
> 2016-07-30      10:37:34:620    1469867854.620808: Aborting call on unexpected message for Call-Id '278-7048 at 192.168.1.3': while expecting '401' (index 3), received 'SIP/2.0 403 Forbidden
> Via: SIP/2.0/UDP 192.168.1.3:17935;rport=17935;received=192.168.1.3;branch=z9hG4bK-7048-278-2-6505550444-
> Call-ID: 6505550444///278-7048 at 192.168.1.3
> From: <sip:6505550444 at ims.cl>;tag=7048SIPpTag00278
> To: <sip:6505550444 at ims.cl>;tag=z9hG4bKPjkl8MxPlBeHQfAfafWpFy0dCwc6ddxiuT
> CSeq: 1 REGISTER
> Content-Length:  0
> 
> 2016-07-30      10:37:36:507    1469867856.507272: Aborting call on unexpected message for Call-Id '472-7048 at 192.168.1.3': while expecting '401' (index 3), received 'SIP/2.0 403 Forbidden
> Via: SIP/2.0/UDP 192.168.1.3:29919;rport=29919;received=192.168.1.3;branch=z9hG4bK-7048-472-2-6505550056-
> Call-ID: 6505550056///472-7048 at 192.168.1.3
> From: <sip:6505550056 at ims.cl>;tag=7048SIPpTag00472
> To: <sip:6505550056 at ims.cl>;tag=z9hG4bKPj.RjEm.RjZAiHN6eVY2B4V0tKa.VdqJtn
> CSeq: 1 REGISTER
> Content-Length:  
> 
> 
> 3 - cat /usr/share/clearwater/sip-stress/users.csv.1 (SIPp node : 192.168.1.3)
> 
> USER
> 6505550000;[authentication username=6505550000 at ims.clpassword=7kkzTyGW];6505550001;[authentication username=6505550001 at ims.cl password=7kkzTyGW]
> 6505550002;[authentication username=6505550002 at ims.clpassword=7kkzTyGW];6505550003;[authentication username=6505550003 at ims.cl password=7kkzTyGW]
> 6505550004;[authentication username=6505550004 at ims.clpassword=7kkzTyGW];6505550005;[authentication username=6505550005 at ims.cl password=7kkzTyGW]
> *
> *
> *
> 
> 
> **************************************************************************************************************************
> 
> Ellis_log :
> 
> [ellis]root at ellis:/var/log/ellis# cat ellis_20160730T100000Z.txt
> 30-07-2016 08:00:05.890 UTC INFO web.py:1447: 200 GET /ping (0.0.0.0) 0.34ms
> 30-07-2016 08:00:15.933 UTC INFO web.py:1447: 200 GET /ping (0.0.0.0) 1.07ms
> 30-07-2016 08:00:25.985 UTC INFO web.py:1447: 200 GET /ping (0.0.0.0) 0.39ms
> 30-07-2016 08:00:36.030 UTC INFO web.py:1447: 200 GET /ping (0.0.0.0) 0.98ms
> 30-07-2016 08:00:46.094 UTC INFO web.py:1447: 200 GET /ping (0.0.0.0) 0.35ms
> 30-07-2016 08:00:56.176 UTC INFO web.py:1447: 200 GET /ping (0.0.0.0) 0.36ms
> 30-07-2016 08:01:06.208 UTC INFO web.py:1447: 200 GET /ping (0.0.0.0) 0.32ms
> 30-07-2016 08:01:16.233 UTC INFO web.py:1447: 200 GET /ping (0.0.0.0) 0.53ms
> 30-07-2016 08:01:26.298 UTC INFO web.py:1447: 200 GET /ping (0.0.0.0) 0.95ms
> 30-07-2016 08:01:36.345 UTC INFO web.py:1447: 200 GET /ping (0.0.0.0) 0.96ms
> 30-07-2016 08:01:46.372 UTC INFO web.py:1447: 200 GET /ping (0.0.0.0) 0.40ms
> 30-07-2016 08:01:56.448 UTC INFO web.py:1447: 200 GET /ping (0.0.0.0) 0.54ms
> 30-07-2016 08:02:06.476 UTC INFO web.py:1447: 200 GET /ping (0.0.0.0) 2.20ms
> 
> **************************************************************************************************************************
> 
> Bono_logs :
> 
> [bono]root at bono:/var/log/bono# tail -f log_current.txt 
> 30-07-2016 08:23:45.065 UTC Call-Disconnected: CALL_ID=6505550182///409-6675 at 192.168.1.3 REASON=401
> 30-07-2016 08:23:45.086 UTC Call-Disconnected: CALL_ID=6505550182///409-6675 at 192.168.1.3 REASON=403
> 30-07-2016 08:23:46.255 UTC Call-Disconnected: CALL_ID=6505550210///395-6675 at 192.168.1.3 REASON=403
> 30-07-2016 08:23:47.800 UTC Call-Disconnected: CALL_ID=6505550056///472-6675 at 192.168.1.3 REASON=403
> 30-07-2016 08:23:51.497 UTC Call-Disconnected: CALL_ID=6505550942///29-6675 at 192.168.1.3 REASON=403
> 30-07-2016 08:23:51.610 UTC Call-Disconnected: CALL_ID=6505550956///22-6675 at 192.168.1.3 REASON=403
> 30-07-2016 08:23:52.268 UTC Call-Disconnected: CALL_ID=6505550590///205-6675 at 192.168.1.3 REASON=403
> 30-07-2016 08:23:55.526 UTC Call-Disconnected: CALL_ID=6505550576///212-6675 at 192.168.1.3 REASON=403
> 
> [bono]root at bono:/var/log/bono# tail -f bono_current.txt 
> 30-07-2016 08:24:00.865 UTC Status load_monitor.cpp:285: Maximum incoming request rate/second unchanged - only handled 20 requests in last 13068ms, minimum threshold for a change is 3909.096191
> 30-07-2016 08:24:08.866 UTC Warning (Net-SNMP): Warning: Failed to connect to the agentx master agent ([NIL]): 
> 30-07-2016 08:24:10.008 UTC Status connection_pool.cpp:447: Recycle TCP connection slot 5
> 30-07-2016 08:24:14.019 UTC Status load_monitor.cpp:285: Maximum incoming request rate/second unchanged - only handled 20 requests in last 13155ms, minimum threshold for a change is 3935.121094
> 30-07-2016 08:24:23.803 UTC Status load_monitor.cpp:285: Maximum incoming request rate/second unchanged - only handled 20 requests in last 9784ms, minimum threshold for a change is 2926.737061
> 30-07-2016 08:24:23.871 UTC Warning (Net-SNMP): Warning: Failed to connect to the agentx master agent ([NIL]): 
> 30-07-2016 08:24:31.333 UTC Status load_monitor.cpp:285: Maximum incoming request rate/second unchanged - only handled 20 requests in last 7528ms, minimum threshold for a change is 2251.888184
> 30-07-2016 08:24:38.876 UTC Warning (Net-SNMP): Warning: Failed to connect to the agentx master agent ([NIL]): 
> 30-07-2016 08:24:40.036 UTC Status load_monitor.cpp:285: Maximum incoming request rate/second unchanged - only handled 20 requests in last 8704ms, minimum threshold for a change is 2603.670898
> 30-07-2016 08:24:47.807 UTC Status load_monitor.cpp:285: Maximum incoming request rate/second unchanged - only handled 20 requests in last 7771ms, minimum threshold for a change is 2324.578369
> 
> **************************************************************************************************************************
> 
> Sprout_logs :
> 
> [sprout]root at sprout:/var/log/sprout# tail -f access_current.txt 
> 30-07-2016 08:24:43.600 UTC 200 GET /ping 0.000000 seconds
> 30-07-2016 08:24:53.659 UTC 200 GET /ping 0.000000 seconds
> 30-07-2016 08:25:03.745 UTC 200 GET /ping 0.000000 seconds
> 30-07-2016 08:25:13.815 UTC 200 GET /ping 0.000000 seconds
> 30-07-2016 08:25:23.862 UTC 200 GET /ping 0.000000 seconds
> 30-07-2016 08:25:25.064 UTC 200 POST /authentication-timeout 0.005699 seconds
> 30-07-2016 08:25:33.927 UTC 200 GET /ping 0.000000 seconds
> 30-07-2016 08:25:43.975 UTC 200 GET /ping 0.000000 seconds
> 30-07-2016 08:25:54.090 UTC 200 GET /ping 0.000000 seconds
> 30-07-2016 08:26:04.234 UTC 200 GET /ping 0.000000 seconds
> 
> 
> [sprout]root at sprout:/var/log/sprout# tail -f log_current.txt 
> 30-07-2016 08:22:13.464 UTC Auth-Failure: Private Identity=6505550810 at ims.cl Public Identity=sip:6505550810 at ims.cl
> 30-07-2016 08:22:23.094 UTC Auth-Failure: Private Identity=6505550914 at ims.cl Public Identity=sip:6505550914 at ims.cl
> 30-07-2016 08:22:40.326 UTC Auth-Failure: Private Identity=6505550908 at ims.cl Public Identity=sip:6505550908 at ims.cl
> 30-07-2016 08:22:42.571 UTC Auth-Failure: Private Identity=6505550196 at ims.cl Public Identity=sip:6505550196 at ims.cl
> 30-07-2016 08:22:49.856 UTC Auth-Failure: Private Identity=6505550272 at ims.cl Public Identity=sip:6505550272 at ims.cl
> 30-07-2016 08:22:50.968 UTC Auth-Failure: Private Identity=6505550782 at ims.cl Public Identity=sip:6505550782 at ims.cl
> 30-07-2016 08:23:13.020 UTC Auth-Failure: Private Identity=6505550236 at ims.cl Public Identity=sip:6505550236 at ims.cl
> 30-07-2016 08:23:45.078 UTC Auth-Failure: Private Identity=6505550182 at ims.cl Public Identity=sip:6505550182 at ims.cl
> 30-07-2016 08:24:55.072 UTC Auth-Failure: Private Identity=6505550808 at ims.cl Public Identity=sip:6505550808 at ims.cl
> 30-07-2016 08:26:43.027 UTC Auth-Failure: Private Identity=6505550090 at ims.cl Public Identity=sip:6505550090 at ims.cl
> 
> [sprout]root at sprout:/var/log/sprout# tail -f sprout_current.txt 
> 30-07-2016 08:27:51.005 UTC Error httpconnection.cpp:762: cURL failure with cURL error code 0 (see man 3 libcurl-errors) and HTTP error code 404
> 30-07-2016 08:27:51.005 UTC Error hssconnection.cpp:149: Failed to get Authentication Vector for 6505550046 at ims.cl
> 30-07-2016 08:27:51.105 UTC Error httpconnection.cpp:762: cURL failure with cURL error code 0 (see man 3 libcurl-errors) and HTTP error code 404
> 30-07-2016 08:27:51.105 UTC Error hssconnection.cpp:149: Failed to get Authentication Vector for 6505550302 at ims.cl
> 30-07-2016 08:27:51.474 UTC Error authentication.cpp:1134: Authentication failed, Invalid authorization digest (PJSIP_EAUTHINVALIDDIGEST)
> 30-07-2016 08:27:53.358 UTC Error httpconnection.cpp:762: cURL failure with cURL error code 0 (see man 3 libcurl-errors) and HTTP error code 404
> 30-07-2016 08:27:53.358 UTC Error hssconnection.cpp:149: Failed to get Authentication Vector for 6505550420 at ims.cl
> 30-07-2016 08:27:53.359 UTC Status load_monitor.cpp:285: Maximum incoming request rate/second unchanged - only handled 20 requests in last 5400ms, minimum threshold for a change is 1350.000000
> 30-07-2016 08:27:55.616 UTC Error httpconnection.cpp:762: cURL failure with cURL error code 0 (see man 3 libcurl-errors) and HTTP error code 404
> 30-07-2016 08:27:55.616 UTC Error hssconnection.cpp:149: Failed to get Authentication Vector for 6505550186 at ims.cl
> 
> **************************************************************************************************************************
> 
> Homer logs :
> 
> [homer]root at homer:/var/log/homer# cat homer_20160729T160000Z.txt
> 29-07-2016 14:09:08.931 UTC INFO base.py:261: Received request from localhost - PUT http://http_homer/org.etsi.ngn.simservs/users/sip%3A6505550201%40ims.cl/simservs.xml
> 29-07-2016 14:09:08.933 UTC INFO xsd.py:76: Performing XSD validation
> 29-07-2016 14:09:09.248 UTC INFO base.py:274: Sending 200 response to localhost for PUT http://http_homer/org.etsi.ngn.simservs/users/sip%3A6505550201%40ims.cl/simservs.xml
> 29-07-2016 14:09:21.152 UTC INFO base.py:261: Received request from localhost - PUT http://http_homer/org.etsi.ngn.simservs/users/sip%3A6505550639%40ims.cl/simservs.xml
> 29-07-2016 14:09:21.154 UTC INFO xsd.py:76: Performing XSD validation
> 29-07-2016 14:09:21.162 UTC INFO base.py:274: Sending 200 response to localhost for PUT http://http_homer/org.etsi.ngn.simservs/users/sip%3A6505550639%40ims.cl/simservs.xml
> 29-07-2016 14:09:26.452 UTC INFO base.py:261: Received request from localhost - PUT http://http_homer/org.etsi.ngn.simservs/users/sip%3A6505550782%40ims.cl/simservs.xml
> 29-07-2016 14:09:26.452 UTC INFO xsd.py:76: Performing XSD validation
> 29-07-2016 14:09:26.458 UTC INFO base.py:274: Sending 200 response to localhost for PUT http://http_homer/org.etsi.ngn.simservs/users/sip%3A6505550782%40ims.cl/simservs.xml
> 29-07-2016 14:09:31.049 UTC INFO base.py:261: Received request from localhost - PUT http://http_homer/org.etsi.ngn.simservs/users/sip%3A6505550238%40ims.cl/simservs.xml
> 
> **************************************************************************************************************************
> 
> Homestead logs :
> 
> [homestead]root at hs:/var/log/homestead# tail -f access_current.txt 
> 30-07-2016 08:31:39.008 UTC 200 GET /impi/6505550516%40ims.cl/registration-status 0.000078 seconds
> 30-07-2016 08:31:39.013 UTC 404 GET /impi/6505550516%40ims.cl/av0.001185 seconds
> 30-07-2016 08:31:39.797 UTC 200 GET /impi/6505550156%40ims.cl/registration-status 0.000063 seconds
> 30-07-2016 08:31:39.802 UTC 404 GET /impi/6505550156%40ims.cl/av0.001314 seconds
> 30-07-2016 08:31:43.599 UTC 200 GET /impi/6505550628%40ims.cl/registration-status 0.000092 seconds
> 30-07-2016 08:31:43.603 UTC 200 GET /impi/6505550628%40ims.cl/av0.001139 seconds
> 30-07-2016 08:31:43.628 UTC 200 GET /impi/6505550628%40ims.cl/registration-status 0.000056 seconds
> 30-07-2016 08:31:43.636 UTC 200 PUT /impu/sip%3A6505550628%40ims.cl/reg-data 0.001479 seconds
> 30-07-2016 08:31:44.481 UTC 200 GET /impi/6505550670%40ims.cl/registration-status 0.000097 seconds
> 30-07-2016 08:31:44.484 UTC 404 GET /impi/6505550670%40ims.cl/av0.001131 seconds
> 30-07-2016 08:31:44.656 UTC 200 PUT /impu/sip%3A6505550944%40ims.cl/reg-data 0.001341 seconds
> 30-07-2016 08:31:45.981 UTC 200 GET /impi/6505550060%40ims.cl/registration-status 0.000096 seconds
> 30-07-2016 08:31:45.985 UTC 404 GET /impi/6505550060%40ims.cl/av0.001087 seconds
> 
> [homestead]root at hs:/var/log/homestead# tail -f homestead_current.txt 
> 30-07-2016 08:31:17.865 UTC Status load_monitor.cpp:285: Maximum incoming request rate/second unchanged - only handled 21 requests in last 6852ms, minimum threshold for a change is 2053.612793
> 30-07-2016 08:31:27.025 UTC Warning (Net-SNMP): Warning: Failed to connect to the agentx master agent ([NIL]): 
> 30-07-2016 08:31:31.596 UTC Status load_monitor.cpp:285: Maximum incoming request rate/second unchanged - only handled 21 requests in last 13732ms, minimum threshold for a change is 4115.617676
> 30-07-2016 08:31:36.324 UTC Status alarm.cpp:62: homestead issued 1501.1 alarm
> 30-07-2016 08:31:39.009 UTC Status load_monitor.cpp:285: Maximum incoming request rate/second unchanged - only handled 21 requests in last 7412ms, minimum threshold for a change is 2221.450439
> 30-07-2016 08:31:42.039 UTC Warning (Net-SNMP): Warning: Failed to connect to the agentx master agent ([NIL]): 
> 30-07-2016 08:31:49.028 UTC Status load_monitor.cpp:285: Maximum incoming request rate/second unchanged - only handled 21 requests in last 10020ms, minimum threshold for a change is 3003.093994
> 
> **************************************************************************************************************************
> 
> Ralf  logs :
> 
> [ralf]root at ralf:/var/log/ralf# tail -f access_current.txt 
> 30-07-2016 08:33:04.253 UTC 200 POST /call-id/6505550206%2F%2F%2F397-6860%40192.168.1.3 0.000102 seconds
> 30-07-2016 08:33:06.682 UTC 200 POST /call-id/6505550514%2F%2F%2F243-6860%40192.168.1.3 0.000129 seconds
> 30-07-2016 08:33:06.786 UTC 200 GET /ping 0.000000 seconds
> 30-07-2016 08:33:07.288 UTC 200 POST /call-id/6505550878%2F%2F%2F61-6860%40192.168.1.3 0.000097 seconds
> 30-07-2016 08:33:08.146 UTC 200 POST /call-id/6505550172%2F%2F%2F414-6860%40192.168.1.3 0.000158 seconds
> 30-07-2016 08:33:08.267 UTC 200 POST /call-id/6505550780%2F%2F%2F110-6860%40192.168.1.3 0.000088 seconds
> 30-07-2016 08:33:09.995 UTC 200 POST /call-id/6505550862%2F%2F%2F69-6860%40192.168.1.3 0.000136 seconds
> 30-07-2016 08:33:11.214 UTC 200 POST /call-id/6505550192%2F%2F%2F404-6860%40192.168.1.3 0.000113 seconds
> 30-07-2016 08:33:12.733 UTC 200 POST /call-id/6505550034%2F%2F%2F483-6860%40192.168.1.3 0.000103 seconds
> 30-07-2016 08:33:13.037 UTC 200 POST /call-id/6505550854%2F%2F%2F73-6860%40192.168.1.3 0.000123 seconds
> 30-07-2016 08:33:14.125 UTC 200 POST /call-id/6505550758%2F%2F%2F121-6860%40192.168.1.3 0.000134 seconds
> 30-07-2016 08:33:14.742 UTC 200 POST /call-id/6505550094%2F%2F%2F453-6860%40192.168.1.3 0.000093 seconds
> 
> 
> 
> [ralf]root at ralf:/var/log/ralf# tail -f ralf_current.txt 
> 30-07-2016 08:33:54.508 UTC Error peer_message_sender.cpp:145: Failed to connect to all CCFs, message not sent
> 30-07-2016 08:33:54.508 UTC Warning session_manager.cpp:414: Session for 6505550928///36-6860 at 192.168.1.3 received error from CDF
> 30-07-2016 08:33:55.760 UTC Error diameterstack.cpp:293: Routing error: 'No remaining suitable candidate to route the message to' for message with Command-Code 271, Destination-Host  and Destination-Realm ims.cl
> 30-07-2016 08:33:55.761 UTC Warning peer_message_sender.cpp:125: Failed to send ACR to  (number 0)
> 30-07-2016 08:33:55.761 UTC Error peer_message_sender.cpp:145: Failed to connect to all CCFs, message not sent
> 30-07-2016 08:33:55.761 UTC Warning session_manager.cpp:414: Session for 6505550162///419-6860 at 192.168.1.3 received error from CDF
> 30-07-2016 08:33:56.680 UTC Error diameterstack.cpp:293: Routing error: 'No remaining suitable candidate to route the message to' for message with Command-Code 271, Destination-Host  and Destination-Realm ims.cl
> 30-07-2016 08:33:56.681 UTC Warning peer_message_sender.cpp:125: Failed to send ACR to  (number 0)
> 30-07-2016 08:33:56.681 UTC Error peer_message_sender.cpp:145: Failed to connect to all CCFs, message not sent
> 30-07-2016 08:33:56.681 UTC Warning session_manager.cpp:414: Session for 6505550954///23-6860 at 192.168.1.3 received error from CDF
> 30-07-2016 08:33:57.543 UTC Error diameterstack.cpp:854: No Diameter peers have been found
> 
> **************************************************************************************************************************
> 
> ELLIS 
> 
> [ellis]root at ellis:/var/log/ellis# monit summary
> Monit 5.18.1 uptime: 21h 36m
>  Service Name                      Status                      Type          
>  node-ellis.ims.cl                Running                     System        
>  ntp_process                         Running                     Process       
>  nginx_process                    Running                     Process       
>  mysql_process                    Running                     Process       
>  ellis_process                                           Running                     Process       
>  clearwater_queue_manager_pro...  Running                     Process       
>  etcd_process                     Running                     Process       
>  clearwater_diags_monitor_pro...  Running                     Process       
>  clearwater_config_manager        Running                     Process       
>  clearwater_cluster_manager       Running                     Process       
>  nginx_uptime                     Status ok                   Program       
>  monit_uptime                     Status ok                   Program       
>  poll_ellis                       Status ok                   Program       
>  poll_ellis_https                 Status ok                   Program       
>  clearwater_queue_manager_uptime  Status ok                   Program       
>  etcd_uptime                      Status ok                   Program       
>  poll_etcd_cluster                Status ok                   Program       
>  poll_etcd                        Status ok                   Program  
> 
> **************************************************************************************************************************
> 
> BONO 
> 
> [bono]root at bono:/var/log/bono# monit summary
> Monit 5.18.1 uptime: 21h 37m
>  Service Name                     Status                      Type          
>  node-bono.ims.cl                 Running                     System        
>  restund_process                  Running                     Process       
>  ntp_process                      Running                     Process       
>  clearwater_queue_manager_pro...  Running                     Process       
>  etcd_process                     Running                     Process       
>  clearwater_diags_monitor_pro...  Running                     Process       
>  clearwater_config_manager        Running                     Process       
>  clearwater_cluster_manager       Running                     Process       
>  bono_process                     Running                     Process       
>  poll_restund                     Status ok                   Program       
>  monit_uptime                     Status ok                   Program       
>  clearwater_queue_manager_uptime  Status ok                   Program       
>  etcd_uptime                      Status ok                   Program       
>  poll_etcd_cluster                Status ok                   Program       
>  poll_etcd                        Status ok                   Program       
>  poll_bono                        Status ok                   Program     
> 
> **************************************************************************************************************************
> 
> SPROUT 
> 
> [sprout]root at sprout:/var/log/sprout# monit summary
> Monit 5.18.1 uptime: 21h 37m
>  Service Name                     Status                      Type          
>  node-sprout.ims.cl               Running                     System        
>  sprout_process                   Running                     Process       
>  snmpd_process                    Running                     Process       
>  ntp_process                      Running                     Process       
>  memcached_process                Running                     Process       
>  clearwater_queue_manager_pro...  Running                     Process       
>  etcd_process                     Running                     Process       
>  clearwater_diags_monitor_pro...  Running                     Process       
>  clearwater_config_manager        Running                     Process       
>  clearwater_cluster_manager       Running                     Process       
>  chronos_process                  Running                     Process       
>  astaire_process                  Running                     Process       
>  sprout_uptime                    Status ok                   Program       
>  poll_sprout_sip                  Status ok                   Program       
>  poll_sprout_http                 Status ok                   Program       
>  monit_uptime                     Status ok                   Program       
>  memcached_uptime                 Status ok                   Program       
>  poll_memcached                   Status ok                   Program       
>  clearwater_queue_manager_uptime  Status ok                   Program       
>  etcd_uptime                      Status ok                   Program       
>  poll_etcd_cluster                Status ok                   Program       
>  poll_etcd                        Status ok                   Program       
>  chronos_uptime                   Status ok                   Program       
>  poll_chronos                     Status ok                   Program       
>  astaire_uptime                   Status ok                   Program 
> 
> **************************************************************************************************************************
> 
> HOMER
> 
> [homer]root at homer:/var/log/homer# monit summary
> Monit 5.18.1 uptime: 21h 38m
>  Service Name                     Status                      Type          
>  node-homer.ims.cl                Running                     System        
>  ntp_process                      Running                     Process       
>  nginx_process                    Running                     Process       
>  homer_process                    Running                     Process       
>  clearwater_queue_manager_pro...  Running                     Process       
>  etcd_process                     Running                     Process       
>  clearwater_diags_monitor_pro...  Running                     Process       
>  clearwater_config_manager        Running                     Process       
>  clearwater_cluster_manager       Running                     Process       
>  cassandra_process                Running                     Process       
>  nginx_uptime                     Status ok                   Program       
>  monit_uptime                     Status ok                   Program       
>  poll_homer                       Status ok                   Program       
>  clearwater_queue_manager_uptime  Status ok                   Program       
>  etcd_uptime                      Status ok                   Program       
>  poll_etcd_cluster                Status ok                   Program       
>  poll_etcd                        Status ok                   Program       
>  cassandra_uptime                 Status ok                   Program       
>  poll_cassandra                   Status ok                   Program     
> 
> **************************************************************************************************************************
> 
> HOMESTEAD
> 
> [homestead]root at hs:/var/log/homestead# monit summary
> Monit 5.18.1 uptime: 21h 38m
>  Service Name                     Status                      Type          
>  node-hs.ims.cl                   Running                     System        
>  ntp_process                      Running                     Process       
>  nginx_process                    Running                     Process       
>  homestead_process                Running                     Process       
>  homestead-prov_process           Running                     Process       
>  clearwater_queue_manager_pro...  Running                     Process       
>  etcd_process                     Running                     Process       
>  clearwater_diags_monitor_pro...  Running                     Process       
>  clearwater_config_manager        Running                     Process       
>  clearwater_cluster_manager       Running                     Process       
>  cassandra_process                Running                     Process       
>  nginx_uptime                     Status ok                   Program       
>  monit_uptime                     Status ok                   Program       
>  homestead_uptime                 Status ok                   Program       
>  poll_homestead                   Status ok                   Program       
>  poll_homestead-prov              Status ok                   Program       
>  clearwater_queue_manager_uptime  Status ok                   Program       
>  etcd_uptime                      Status ok                   Program       
>  poll_etcd_cluster                Status ok                   Program       
>  poll_etcd                        Status ok                   Program       
>  cassandra_uptime                 Status ok                   Program       
>  poll_cassandra                   Status ok                   Program 
> 
> **************************************************************************************************************************
> 
> RALF
> 
> [ralf]root at ralf:/var/log/ralf# monit summary
> Monit 5.18.1 uptime: 21h 38m
>  Service Name                     Status                      Type          
>  node-ralf.ims.cl                 Running                     System        
>  snmpd_process                    Running                     Process       
>  ralf_process                     Running                     Process       
>  ntp_process                      Running                     Process       
>  memcached_process                Running                     Process       
>  clearwater_queue_manager_pro...  Running                     Process       
>  etcd_process                     Running                     Process       
>  clearwater_diags_monitor_pro...  Running                     Process       
>  clearwater_config_manager        Running                     Process       
>  clearwater_cluster_manager       Running                     Process       
>  chronos_process                  Running                     Process       
>  astaire_process                  Running                     Process       
>  poll_ralf                        Status ok                   Program       
>  monit_uptime                     Status ok                   Program       
>  memcached_uptime                 Status ok                   Program       
>  poll_memcached                   Status ok                   Program       
>  clearwater_queue_manager_uptime  Status ok                   Program       
>  etcd_uptime                      Status ok                   Program       
>  poll_etcd_cluster                Status ok                   Program       
>  poll_etcd                        Status ok                   Program       
>  chronos_uptime                   Status ok                   Program       
>  poll_chronos                     Status ok                   Program       
>  astaire_uptime                   Status ok                   Program
> _______________________________________________
> Clearwater mailing list
> Clearwater at lists.projectclearwater.org
> http://lists.projectclearwater.org/mailman/listinfo/clearwater_lists.projectclearwater.org

-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.projectclearwater.org/pipermail/clearwater_lists.projectclearwater.org/attachments/20160824/650af718/attachment.html>

From michaelkatsoulis88 at gmail.com  Mon Aug 29 07:01:08 2016
From: michaelkatsoulis88 at gmail.com (=?UTF-8?B?zpzOuc+HzqzOu863z4IgzprOsc+Ez4POv8+NzrvOt8+C?=)
Date: Mon, 29 Aug 2016 14:01:08 +0300
Subject: [Project Clearwater] Fwd: SIP Client cannot connect after
 Clearwater manual installation
In-Reply-To: <CAJG3f9NMEthwY8D4DuadRZweTOAsEcNtJrc4-DeS+U_i-DDy5w@mail.gmail.com>
References: <CAJG3f9OtD-_LpTYgbOk1LAAU7-vHD5ytnqeB9XxL_+8XzM=Fog@mail.gmail.com>
	<CY1PR02MB1181AF7F33A9643A4ED32E45E1070@CY1PR02MB1181.namprd02.prod.outlook.com>
	<CAJG3f9NgEMO47LwwuCBWTdx4U7KO=4XLnbVa9Mxh9qJrcvrhOw@mail.gmail.com>
	<BY2PR0201MB18164E2ADCAD293A973E62A3F0EB0@BY2PR0201MB1816.namprd02.prod.outlook.com>
	<CAJG3f9NMEthwY8D4DuadRZweTOAsEcNtJrc4-DeS+U_i-DDy5w@mail.gmail.com>
Message-ID: <CAJG3f9PTr8LFLRWjZD+a1LZ+-2grEqOn=B+-1k2Mk5BA5F1e8w@mail.gmail.com>

Hi all,

i have noticed a misconfiguration in the local_config file in all my
clearwater nodes

*local config *: (for example in Bono node)

local_ip=192.168.99.131
public_ip=172.28.40.181
public_hostname=bono-1
etcd_cluster="192.168.99.130,192.168.99.131,*192.168.88.132*,1
92.168.99.133,192.168.99.134,192.168.99.135"

where i wrote ip *192.168.88.132 *instead of *192.168.99.132. *After
changing that the etcd cluster fails to come up in all nodes except Bono
where also cluster health is unhealthy. When i run command *clearwater-etcdctl
member list *in Bono i get the following results.:

6e96c9bc1333552: name=192-168-99-130 peerURLs=http://192.168.99.130:2380
clientURLs=http://192.168.99.130:4000
824f03eef0ce358b[unstarted]: peerURLs=http://192.168.99.132:2380
86e00b64ed90627c: name=192-168-99-131 peerURLs=http://192.168.99.131:2380
clientURLs=http://192.168.99.131:4000
bda85538fbbfe2ef[unstarted]: peerURLs=http://192.168.99.133:2380

and when i issue this command on the other nodes i get the following
(example ellis):
Error:  dial tcp 192.168.99.135:4000: getsockopt: connection refused

I tried to reinstall the packages in the nodes but nothing changes.

Could anyone help?

Thank you in advance,
Michael Katsoulis



2016-08-24 0:54 GMT+03:00 Richard Whitehouse (projectclearwater.org) <
richard.whitehouse at projectclearwater.org>:

> Michael,
>
>
>
> The logs you show below suggests that OPTIONS polling is occurring, but
> there?s nothing suggesting that the registration attempt is working.
>
>
>
> The STUN output suggests it?s unable to contact the STUN server? Is
> traffic allowed into the node on port 8888 ? which is what you have
> configured, which is different from the default which is 3478? Can you see
> traffic on this port when you run tcpdump on the bono node?
>
>
>
> It would be useful if you could provide the packet capture, taken from
> Bono. From what you?ve provided it looks like there?s still a connectivity
> issue between your client and the Bono node.
>
>
>
>
>
> Richard
>
>
>
> *From:* Clearwater [mailto:clearwater-bounces at lists.projectclearwater.org]
> *On Behalf Of *??????? ?ats?????
> *Sent:* 23 August 2016 09:37
> *To:* Clearwater at lists.projectclearwater.org
> *Cc:* Chris Elford (projectclearwater.org) <chris at projectclearwater.org>
> *Subject:* Re: [Project Clearwater] SIP Client cannot connect after
> Clearwater manual installation
>
>
>
>
>
> Hi Chris,
>
>
>
>
>
> thank you a lot for your answer.
>
> I opened all needed ports in all the nodes as mentioned in
> http://clearwater.readthedocs.io/en/stable/Clearwater_IP_Port_Usage.html .
>
> I also used tcpdump & netcat to monitor & test the connection and
> everything seems to be working fine.
>
> Now i can see some interesting logs in Bono and Sprout but still the
> registration fails due to request timeout.
>
>
>
> The logs from the nodes are the following:
>
>
>
> *Bono:*
>
>
>
> OPTIONS sip:poll-sip at 192.168.99.131:5058 SIP/2.0
>
> Via: SIP/2.0/TCP 192.168.99.131;rport;branch=z9hG4bK-108925
>
> Max-Forwards: 2
>
> To: <sip:poll-sip at 192.168.99.131:5058>
>
> From: poll-sip <sip:poll-sip at 192.168.99.131>;tag=108925
>
> Call-ID: poll-sip-108925
>
> CSeq: 108925 OPTIONS
>
> Contact: <sip:192.168.99.131>
>
> Accept: application/sdp
>
> Content-Length: 0
>
> User-Agent: poll-sip
>
>
>
>
>
> --end msg--
>
> 05-08-2016 13:41:11.509 UTC Debug uri_classifier.cpp:169: home domain:
> false, local_to_node: true, is_gruu: false, enforce_user_phone: false,
> prefer_sip: true, treat_number_as_phone: false
>
> 05-08-2016 13:41:11.509 UTC Debug uri_classifier.cpp:199: Classified URI
> as 3
>
> 05-08-2016 13:41:11.509 UTC Debug common_sip_processing.cpp:212: Skipping
> SAS logging for OPTIONS request
>
> 05-08-2016 13:41:11.509 UTC Debug thread_dispatcher.cpp:253: Queuing
> cloned received message 0x7f3e283eeb38 for worker threads
>
> 05-08-2016 13:41:11.509 UTC Debug thread_dispatcher.cpp:149: Worker thread
> dequeue message 0x7f3e283eeb38
>
> 05-08-2016 13:41:11.509 UTC Debug pjsip: sip_endpoint.c Distributing rdata
> to modules: Request msg OPTIONS/cseq=108925 (rdata0x7f3e283eeb38)
>
> 05-08-2016 13:41:11.509 UTC Debug uri_classifier.cpp:169: home domain:
> false, local_to_node: true, is_gruu: false, enforce_user_phone: false,
> prefer_sip: true, treat_number_as_phone: false
>
> 05-08-2016 13:41:11.509 UTC Debug uri_classifier.cpp:199: Classified URI
> as 3
>
> 05-08-2016 13:41:11.509 UTC Debug pjsip:       endpoint Response msg
> 200/OPTIONS/cseq=108925 (tdta0x7f3e2404d980) created
>
> 05-08-2016 13:41:11.509 UTC Verbose common_sip_processing.cpp:136: TX 290
> bytes Response msg 200/OPTIONS/cseq=108925 (tdta0x7f3e2404d980) to TCP
> 192.168.99.131:35677:
>
> --start msg--
>
>
>
> SIP/2.0 200 OK
>
> Via: SIP/2.0/TCP 192.168.99.131;rport=35677;rec
> eived=192.168.99.131;branch=z9hG4bK-108925
>
> Call-ID: poll-sip-108925
>
> From: "poll-sip" <sip:poll-sip at 192.168.99.131>;tag=108925
>
> To: <sip:poll-sip at 192.168.99.131>;tag=z9hG4bK-108925
>
> CSeq: 108925 OPTIONS
>
> Content-Length:  0
>
>
>
>
>
> --end msg--
>
> 05-08-2016 13:41:11.509 UTC Debug common_sip_processing.cpp:254: Skipping
> SAS logging for OPTIONS response
>
> 05-08-2016 13:41:11.509 UTC Debug pjsip: tdta0x7f3e2404 Destroying txdata
> Response msg 200/OPTIONS/cseq=108925 (tdta0x7f3e2404d980)
>
> 05-08-2016 13:41:11.509 UTC Debug thread_dispatcher.cpp:193: Worker thread
> completed processing message 0x7f3e283eeb38
>
> 05-08-2016 13:41:11.509 UTC Debug thread_dispatcher.cpp:199: Request
> latency = 221us
>
> 05-08-2016 13:41:12.509 UTC Verbose pjsip: tcps0x7f3e283e TCP connection
> closed
>
> 05-08-2016 13:41:12.509 UTC Debug connection_tracker.cpp:92: Connection
> 0x7f3e283ec298 has been destroyed
>
> 05-08-2016 13:41:12.509 UTC Verbose pjsip: tcps0x7f3e283e TCP transport
> destroyed with reason 70016: End of file (PJ_EEOF)
>
>
>
>
>
> *Sprout:*
>
>
>
> SIP/2.0 200 OK
>
> Via: SIP/2.0/TCP 192.168.99.132;rport=60774;rec
> eived=192.168.99.132;branch=z9hG4bK-13204
>
> Call-ID: poll-sip-13204
>
> From: "poll-sip" <sip:poll-sip at 192.168.99.132>;tag=13204
>
> To: <sip:poll-sip at 192.168.99.132>;tag=z9hG4bK-13204
>
> CSeq: 13204 OPTIONS
>
> Content-Length:  0
>
>
>
>
>
> --end msg--
>
> 05-08-2016 13:21:30.373 UTC Debug common_sip_processing.cpp:254: Skipping
> SAS logging for OPTIONS response
>
> 05-08-2016 13:21:30.373 UTC Debug pjsip: tdta0x7fb31001 Destroying txdata
> Response msg 200/OPTIONS/cseq=13204 (tdta0x7fb310017c20)
>
> 05-08-2016 13:21:30.373 UTC Debug thread_dispatcher.cpp:193: Worker thread
> completed processing message 0x7fb310097278
>
> 05-08-2016 13:21:30.373 UTC Debug thread_dispatcher.cpp:199: Request
> latency = 225us
>
> 05-08-2016 13:21:30.380 UTC Verbose httpstack.cpp:293: Process request for
> URL /ping, args (null)
>
> 05-08-2016 13:21:30.381 UTC Verbose httpstack.cpp:69: Sending response 200
> to request for URL /ping, args (null)
>
> 05-08-2016 13:21:30.907 UTC Verbose pjsip:    tcplis:5052 TCP listener
> 192.168.99.132:5052: got incoming TCP connection from 192.168.99.131:50451,
> sock=753
>
> 05-08-2016 13:21:30.907 UTC Verbose pjsip: tcps0x7fb31009 TCP server
> transport created
>
> 05-08-2016 13:21:30.911 UTC Verbose pjsip: tcps0x7fb31000 TCP connection
> closed
>
> 05-08-2016 13:21:30.911 UTC Verbose pjsip: tcps0x7fb31000 TCP transport
> destroyed with reason 70016: End of file (PJ_EEOF)
>
> 05-08-2016 13:21:31.374 UTC Verbose pjsip: tcps0x7fb31007 TCP connection
> closed
>
> 05-08-2016 13:21:31.375 UTC Debug connection_tracker.cpp:92: Connection
> 0x7fb31007ca08 has been destroyed
>
> 05-08-2016 13:21:31.375 UTC Verbose pjsip: tcps0x7fb31007 TCP transport
> destroyed with reason 70016: End of file (PJ_EEOF)
>
> 05-08-2016 13:21:33.268 UTC Debug alarm.cpp:253: Reraising all alarms with
> a known state
>
> 05-08-2016 13:21:33.268 UTC Status alarm.cpp:62: sprout issued 1001.1 alarm
>
> ^C
>
> root at sprout:/var/log/sprout# netstat -tulpn | grep 7000
>
> root at sprout:/var/log/sprout# tailf sprout_current.txt
>
> 05-08-2016 13:42:18.061 UTC Verbose pjsip: tcps0x7fb31004 TCP transport
> destroyed with reason 70016: End of file (PJ_EEOF)
>
> 05-08-2016 13:42:25.060 UTC Verbose pjsip:    tcplis:5052 TCP listener
> 192.168.99.132:5052: got incoming TCP connection from 192.168.99.131:56176,
> sock=691
>
> 05-08-2016 13:42:25.060 UTC Verbose pjsip: tcps0x7fb31004 TCP server
> transport created
>
> 05-08-2016 13:42:25.067 UTC Verbose pjsip: tcps0x7fb31007 TCP connection
> closed
>
> 05-08-2016 13:42:25.067 UTC Verbose pjsip: tcps0x7fb31007 TCP transport
> destroyed with reason 70016: End of file (PJ_EEOF)
>
> 05-08-2016 13:42:25.989 UTC Verbose pjsip: tcps0x7fb31007 TCP transport
> destroyed normally
>
> 05-08-2016 13:42:26.060 UTC Verbose pjsip:    tcplis:5052 TCP listener
> 192.168.99.132:5052: got incoming TCP connection from 192.168.99.131:36330,
> sock=693
>
> 05-08-2016 13:42:26.060 UTC Verbose pjsip: tcps0x7fb31007 TCP server
> transport created
>
> 05-08-2016 13:42:33.273 UTC Debug alarm.cpp:253: Reraising all alarms with
> a known state
>
> 05-08-2016 13:42:33.273 UTC Status alarm.cpp:62: sprout issued 1001.1 alarm
>
> 05-08-2016 13:42:34.989 UTC Verbose pjsip: tcps0x7fb31003 TCP transport
> destroyed normally
>
> 05-08-2016 13:42:35.061 UTC Verbose pjsip:    tcplis:5052 TCP listener
> 192.168.99.132:5052: got incoming TCP connection from 192.168.99.131:52252,
> sock=707
>
> 05-08-2016 13:42:35.061 UTC Verbose pjsip: tcps0x7fb31003 TCP server
> transport created
>
> 05-08-2016 13:42:41.062 UTC Verbose pjsip:    tcplis:5052 TCP listener
> 192.168.99.132:5052: got incoming TCP connection from 192.168.99.131:56261,
> sock=709
>
> 05-08-2016 13:42:41.062 UTC Verbose pjsip: tcps0x7fb31007 TCP server
> transport created
>
> 05-08-2016 13:42:41.064 UTC Verbose pjsip: tcps0x7fb31002 TCP connection
> closed
>
> 05-08-2016 13:42:41.064 UTC Verbose pjsip: tcps0x7fb31002 TCP transport
> destroyed with reason 70016: End of file (PJ_EEOF)
>
>
>
>
>
>
>
>
>
> *Zoiper configuration:*
>
>
>
> domain: ims (or or bono_IP:port)
>
> Username: 6505550731
>
> Password: ***********
>
> Caller ID Name: Clearwater
>
>
>
> Auth.username:  6505550731 at ims
>
> Outbound Proxy: -
>
>
>
> In Advanced options i choose "use custome STUN" option
>
> with
>
> Server Hostname/IP : bono_ip
>
> Port: 8888
>
>
>
>
>
>
>
> *Zoiper logs:*
>
>
>
> Network discovered for STUN = 172.28.40.181; Blocked (STUN server could be
> down) (result =0)
>
> Account registering. Account = '6505550731 at ims' failed, protocol_code =
> 923, cause code =63 (service or option not available, unspecified)
>
>
>
>
>
> I have checked restund service in my Bono node and it is running. If i
> restart the service the following logs appear.
>
>
>
> httpdb: configured url http://hs.ims:8888/impi/%s/digest
>
> httpd: using URI workaround
>
> turn: server deployed behind static NAT addr=172.28.40.181:0
>
> turn: extended channels enabled
>
>
>
>
>
> Could you help me ?
>
>
>
> Thanks in advance,
>
> Michael Katsoulis
>
>
>
>
>
>
>
>
>
>
>
>
>
>
>
>
>
>
>
>
>
>
>
>
>
>
>
>
>
>
>
>
>
>
>
>
>
>
>
>
>
>
>
>
>
>
>
> 2016-08-04 16:10 GMT+03:00 Chris Elford (projectclearwater.org) <
> chris at projectclearwater.org>:
>
> Hi Michael,
>
>
>
> Thank you for getting in touch.
>
>
>
> You say below that Zoiper and Ekiga are taking a long time to connect.
> From the fact that nothing is showing up in Bono?s logs, it sounds like the
> phones are never registering. Is that correct?
>
>
>
> If the registrations are failing, and nothing is showing up in the Bono
> logs, it sounds like there may be something in your network stopping the
> registrations from getting through. This is possible even if the two
> machines can ping each other, as SIP traffic runs on a different port to
> pings. I would suggest using tcpdump to carry out a packet capture on Bono
> and check that all of the expected messages in the registration flow are
> getting through.
>
>
>
> Yours,
>
>
>
> Chris
>
>
>
> *From:* Clearwater [mailto:clearwater-bounces at lists.projectclearwater.org]
> *On Behalf Of *??????? ?ats?????
> *Sent:* 04 August 2016 13:41
> *To:* Clearwater at lists.projectclearwater.org
> *Subject:* [Project Clearwater] SIP Client cannot connect after
> Clearwater manual installation
>
>
>
> Hi All,
>
>
>
> i have just performed the *manual installation *of project Clearwater
> using *6 nodes *(1x ellis, 1x bono, 1x sprout, 1x homer, 1x homestead, 1x
> ralf)
>
>
>
> Now I am trying to connect a SIP client (tried both with Zoiper and
> Ekiga). The VM in which Zoiper/Ekiga is installed has ping connectivity
> with the Clearwater nodes.
>
>
>
>
>
> The *system configuration* is the following:
>
>
>
> *Shared Config*:
>
>
>
>  # Deployment definitions
>
> home_domain=ims
>
> sprout_hostname=sprout.ims
>
> hs_hostname=hs.ims:8888
>
> hs_provisioning_hostname=hs.ims:8889
>
> ralf_hostname=ralf.ims:10888
>
> xdms_hostname=homer.ims:7888
>
>
>
>
>
> # Keys
>
> signup_key=<secret>
>
> turn_workaround=<secret>
>
> ellis_api_key=<secret>
>
> ellis_cookie_key=<secret>
>
>
>
>
>
> *local config *: (for example in Bono node)
>
>
>
> local_ip=192.168.99.131
>
> public_ip=172.28.40.181
>
> public_hostname=bono-1
>
> etcd_cluster="192.168.99.130,192.168.99.131,192.168.88.132,1
> 92.168.99.133,192.168.99.134,192.168.99.135"
>
>
>
>
>
> ------------------------------------------------------------
> -----------------------
>
> The process I follow to create the account is the following:
>
>
>
> - Produce a number in Ellis dashboard:
>
>
>
> Private Identity:
>
>
>
> 6505550731 at ims
>
> Password: *******
>
> only shown once
>
>
>
>
>
> - Fill the required fields in the client:
>
>
>
>   a) Ekiga
>
>     name: Clearwater
>
>     Registrar: ims (or bono_IP:port)
>
>     User: 6505550731
>
>     Authentication user: 6505550731 at ims
>
>     Password: ********
>
>
>
>    b) Zoiper:
>
>       user/user at host : 6505550731
>
>       Password: *********
>
>       Domain / Outbound Proxy: ims (or bono_IP:port)
>
>
>
> Both clients take a long time trying to connect but nothing (relative to
> the registration) seems to be written in the log files in any node.
>
>
>
> The whole setup is behind a *corporate proxy *and I have configured the
> http[s]_proxy, no_proxy environment variables.
>
>
>
> Can anyone help ?
>
>
>
>
>
> Thanks,
>
> Michael Katsoulis
>
>
>
>
>
>
>
>
>
>
>
>
>
>
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.projectclearwater.org/pipermail/clearwater_lists.projectclearwater.org/attachments/20160829/64634e66/attachment.html>

From aalshabawi at gmail.com  Mon Aug 29 04:56:47 2016
From: aalshabawi at gmail.com (Abdulaziz Fahad)
Date: Mon, 29 Aug 2016 11:56:47 +0300
Subject: [Project Clearwater] problem on how to enable services in cw-aio
Message-ID: <CAAimRk7jC6yQ67tJhhgF3WBAmSAatjzX6v9JwQZC=eSLPLOvCQ@mail.gmail.com>

Dear clearwater staff ,,

i have download the image cw-aio in all in one OVF installation process ,
but i have problem in how to enable SSH ,HTTP and SIP .
thank you in advance

Best wishes
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.projectclearwater.org/pipermail/clearwater_lists.projectclearwater.org/attachments/20160829/a1e7e3b5/attachment.html>

From morrisyan123 at gmail.com  Tue Aug 30 06:14:47 2016
From: morrisyan123 at gmail.com (yan morris)
Date: Tue, 30 Aug 2016 18:14:47 +0800
Subject: [Project Clearwater] Cannot make a call when Clearwater deploy on
	Openstack
Message-ID: <CAM_v+eT_WaKfFtqiyYUu1KDvrG0pxw3Ev_Kbft-GQHEG76Uaow@mail.gmail.com>

Hi,

I have deployed Clearwater on OpenStack.

All six components is under private network.

I set floating IP on Elise and  Bono , Elise is working properly.

But , I cannot sign in Clearwater , it would give messages that "408
request timeout"

My security group setting is open to any connection .

Do you have any ideas about this situation?

Thank you.

Morris
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.projectclearwater.org/pipermail/clearwater_lists.projectclearwater.org/attachments/20160830/900fb32f/attachment.html>

From Richard.Whitehouse at metaswitch.com  Tue Aug 30 13:07:11 2016
From: Richard.Whitehouse at metaswitch.com (Richard Whitehouse)
Date: Tue, 30 Aug 2016 17:07:11 +0000
Subject: [Project Clearwater] Cannot make a call when Clearwater deploy
	on	Openstack
In-Reply-To: <CAM_v+eT_WaKfFtqiyYUu1KDvrG0pxw3Ev_Kbft-GQHEG76Uaow@mail.gmail.com>
References: <CAM_v+eT_WaKfFtqiyYUu1KDvrG0pxw3Ev_Kbft-GQHEG76Uaow@mail.gmail.com>
Message-ID: <CY1PR0201MB1818CEA0458F4A6428B3D302F0E00@CY1PR0201MB1818.namprd02.prod.outlook.com>

Morris,

I?d recommend tracing the REGISTER through the network using Wireshark / tcpdump to see where it?s getting stuck, and whether the 408 Request Timeout is getting generated by the client as it?s unable to connect to Bono, or Bono being unable to connect to Sprout.

If the message isn?t captured when you run tcpdump on the node, then I?d double check your firewall and IP connectivity setup.

Thanks,

Richard

From: Clearwater [mailto:clearwater-bounces at lists.projectclearwater.org] On Behalf Of yan morris
Sent: 30 August 2016 11:15
To: clearwater at lists.projectclearwater.org
Subject: [Project Clearwater] Cannot make a call when Clearwater deploy on Openstack

Hi,

I have deployed Clearwater on OpenStack.

All six components is under private network.

I set floating IP on Elise and  Bono , Elise is working properly.

But , I cannot sign in Clearwater , it would give messages that "408 request timeout"

My security group setting is open to any connection .

Do you have any ideas about this situation?

Thank you.

Morris

-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.projectclearwater.org/pipermail/clearwater_lists.projectclearwater.org/attachments/20160830/4663c5aa/attachment.html>

From Richard.Whitehouse at metaswitch.com  Tue Aug 30 13:11:36 2016
From: Richard.Whitehouse at metaswitch.com (Richard Whitehouse)
Date: Tue, 30 Aug 2016 17:11:36 +0000
Subject: [Project Clearwater] problem on how to enable services in cw-aio
In-Reply-To: <CAAimRk7jC6yQ67tJhhgF3WBAmSAatjzX6v9JwQZC=eSLPLOvCQ@mail.gmail.com>
References: <CAAimRk7jC6yQ67tJhhgF3WBAmSAatjzX6v9JwQZC=eSLPLOvCQ@mail.gmail.com>
Message-ID: <CY1PR0201MB1818ED5B399307BE5EA01E4BF0E00@CY1PR0201MB1818.namprd02.prod.outlook.com>

Abdulaziz Fahad,

SSH, HTTP and SIP should be available once the image has finished booting ? you shouldn?t need to manually enable them.

Have you checked that you?ve setup appropriate Firewall configuration to allow the relevant ports to be open? The configuration you?ll need is documented under http://clearwater.readthedocs.io/en/stable/Clearwater_IP_Port_Usage.html

What infrastructure are you using to run the all in one node ? Amazon EC2, OpenStack, Virtual Box or VMWare?


Richard

From: Clearwater [mailto:clearwater-bounces at lists.projectclearwater.org] On Behalf Of Abdulaziz Fahad
Sent: 29 August 2016 09:57
To: clearwater at lists.projectclearwater.org
Subject: [Project Clearwater] problem on how to enable services in cw-aio

Dear clearwater staff ,,
i have download the image cw-aio in all in one OVF installation process , but i have problem in how to enable SSH ,HTTP and SIP .
thank you in advance
Best wishes


-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.projectclearwater.org/pipermail/clearwater_lists.projectclearwater.org/attachments/20160830/2697a173/attachment.html>

From trey.ormsbee at interoptechnologies.com  Tue Aug 30 17:03:27 2016
From: trey.ormsbee at interoptechnologies.com (Trey Ormsbee)
Date: Tue, 30 Aug 2016 16:03:27 -0500
Subject: [Project Clearwater] repo keys changed? packages unauthenticated
Message-ID: <1472591007.6400.12.camel@interoptechnologies.com>

Hello

Have the repo keys used to sign the packages in repo.cw-ngv.com changed?
I am unable to authenticate the latest build,  I keep archives of older
builds and if I go back to a mirror i have from 2016-08-15 I am able to
install but the latest version that I mirrored on 818 and the main repo
will not install as they are not authenticated.

root at sprout03:~# DEBIAN_FRONTEND=noninteractive /usr/bin/apt-get install
sprout --yes
Reading package lists... Done
Building dependency tree       
Reading state information... Done
The following extra packages will be installed:
  astaire astaire-libs chronos clearwater-diags-monitor
  clearwater-infrastructure clearwater-log-cleanup clearwater-memcached
  clearwater-monit clearwater-snmp-handler-astaire clearwater-snmpd
  clearwater-socket-factory clearwater-tcp-scalability cpulimit dnsmasq
  dnsmasq-base gnutls-bin inotify-tools libboost-filesystem1.54.0
  libboost-program-options1.54.0 libboost-regex1.54.0
libboost-system1.54.0
  libboost-thread1.54.0 libc-ares-dev libevent-2.0-5 libevent-core-2.0-5
  libevent-pthreads-2.0-5 libicu52 libinotifytools0 libmnl0
libmysqlclient18
  libnetfilter-conntrack3 libopts25 libperl5.18 libpgm-5.1-0
libsnmp-base
  libsnmp30 libzmq3 memcached mysql-common ntp python-pkg-resources
  python-setuptools realpath snmp snmpd sprout-base sprout-bgcf
sprout-icscf
  sprout-libs sprout-mmtel-as sprout-scscf
Suggested packages:
  astaire-dbg clearwater-auto-config clearwater-auto-upgrade
  clearwater-secure-connections exim4 postfix mail-transport-agent
  snmp-mibs-downloader libcache-memcached-perl libmemcached ntp-doc
  python-distribute python-distribute-doc sprout-dbg clearwater-logging
  clearwater-snmp-alarm-agent sprout-bgcf-dbg sprout-icscf-dbg
  sprout-mmtel-as-dbg sprout-scscf-dbg
The following NEW packages will be installed:
  astaire astaire-libs chronos clearwater-diags-monitor
  clearwater-infrastructure clearwater-log-cleanup clearwater-memcached
  clearwater-monit clearwater-snmp-handler-astaire clearwater-snmpd
  clearwater-socket-factory clearwater-tcp-scalability cpulimit dnsmasq
  dnsmasq-base gnutls-bin inotify-tools libboost-filesystem1.54.0
  libboost-program-options1.54.0 libboost-regex1.54.0
libboost-system1.54.0
  libboost-thread1.54.0 libc-ares-dev libevent-2.0-5 libevent-core-2.0-5
  libevent-pthreads-2.0-5 libicu52 libinotifytools0 libmnl0
libmysqlclient18
  libnetfilter-conntrack3 libopts25 libperl5.18 libpgm-5.1-0
libsnmp-base
  libsnmp30 libzmq3 memcached mysql-common ntp python-pkg-resources
  python-setuptools realpath snmp snmpd sprout sprout-base sprout-bgcf
  sprout-icscf sprout-libs sprout-mmtel-as sprout-scscf
0 upgraded, 52 newly installed, 0 to remove and 0 not upgraded.
Need to get 5,714 kB/15.9 MB of archives.
After this operation, 65.4 MB of additional disk space will be used.
WARNING: The following packages cannot be authenticated!
  libsnmp-base libsnmp30 clearwater-infrastructure
clearwater-tcp-scalability
  clearwater-log-cleanup astaire-libs clearwater-monit astaire snmp
snmpd
  clearwater-snmpd chronos clearwater-diags-monitor memcached
  clearwater-memcached clearwater-snmp-handler-astaire
  clearwater-socket-factory sprout-libs sprout-base sprout-scscf
sprout-icscf
  sprout-bgcf sprout-mmtel-as sprout
E: There are problems and -y was used without --force-yes
root at sprout03:~# apt-key finger
/etc/apt/trusted.gpg
--------------------
pub   1024D/437D05B5 2004-09-12
      Key fingerprint = 6302 39CC 130E 1A7F D81A  27B1 4097 6EAF 437D
05B5
uid                  Ubuntu Archive Automatic Signing Key
<ftpmaster at ubuntu.com>
sub   2048g/79164387 2004-09-12

pub   1024D/FBB75451 2004-12-30
      Key fingerprint = C598 6B4F 1257 FFA8 6632  CBA7 4618 1433 FBB7
5451
uid                  Ubuntu CD Image Automatic Signing Key
<cdimage at ubuntu.com>

pub   4096R/C0B21F32 2012-05-11
      Key fingerprint = 790B C727 7767 219C 42C8  6F93 3B4F E6AC C0B2
1F32
uid                  Ubuntu Archive Automatic Signing Key (2012)
<ftpmaster at ubuntu.com>

pub   4096R/EFE21092 2012-05-11
      Key fingerprint = 8439 38DF 228D 22F7 B374  2BC0 D94A A3F0 EFE2
1092
uid                  Ubuntu CD Image Automatic Signing Key (2012)
<cdimage at ubuntu.com>

pub   4096R/22B97904 2013-04-30
      Key fingerprint = 9213 4604 DE32 7DF7 FEB7  2026 111D BE47 22B9
7904
uid                  Project Clearwater Maintainers
<maintainers at projectclearwater.org>
sub   4096R/46EC5B7F 2013-04-30

root at sprout03:~# 


Everything looks like it is supposed to,  so not sure what is going on
here.

Thanks,
Trey
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.projectclearwater.org/pipermail/clearwater_lists.projectclearwater.org/attachments/20160830/0c35644d/attachment.html>

From kosalayb at gmail.com  Wed Aug 31 03:32:29 2016
From: kosalayb at gmail.com (Kosala)
Date: Wed, 31 Aug 2016 08:32:29 +0100
Subject: [Project Clearwater] Stress Testing - Manual Install
Message-ID: <CAGEe17Yf7WeH9NkLqRKNBrF5dVBUuC6=Y06EMpRFf45NuNED_g@mail.gmail.com>

Hi Team,

I have clearwater installed in VMs in Orange Box. I did bulk provisioning
successfully. I have a separate SIP node (outside the Orange Box) for
stress testing.

In my case count is 900. I can see a time out error in ZIP node logs. When
I check logs in the sprout node, I can see the following.

...
30-08-2016 14:28:19.430 UTC Warning (Net-SNMP): Warning: Failed to connect
to the agentx master agent ([NIL]):
30-08-2016 14:28:34.444 UTC Warning (Net-SNMP): Warning: Failed to connect
to the agentx master agent ([NIL]):
30-08-2016 14:28:49.459 UTC Warning (Net-SNMP): Warning: Failed to connect
to the agentx master agent ([NIL]):
30-08-2016 14:29:00.473 UTC Status load_monitor.cpp:260: *Maximum incoming
request rate/second unchanged - only handled 20 requests in last 200988ms*,
minimum threshold for a change is 25123.500000
30-08-2016 14:29:04.472 UTC Warning (Net-SNMP): Warning: Failed to connect
to the agentx master agent ([NIL]):
30-08-2016 14:29:19.486 UTC Warning (Net-SNMP): Warning: Failed to connect
to the agentx master agent ([NIL]):
30-08-2016 14:29:34.501 UTC Warning (Net-SNMP): Warning: Failed to connect
to the agentx master agent ([NIL]):
30-08-2016 14:29:49.515 UTC Warning (Net-SNMP): Warning: Failed to connect
to the agentx master agent ([NIL]):
...



Any help is appreciated.

Many Thanks
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.projectclearwater.org/pipermail/clearwater_lists.projectclearwater.org/attachments/20160831/f3ca86ea/attachment.html>

From gilles.lecorgne at orange.com  Wed Aug 31 04:49:50 2016
From: gilles.lecorgne at orange.com (gilles.lecorgne at orange.com)
Date: Wed, 31 Aug 2016 08:49:50 +0000
Subject: [Project Clearwater] access to memcached data in sprout node
Message-ID: <4912_1472633390_57C69A2E_4912_1270_7_3D8CCA413E49D6439A7E95F805D77A4C2025145A@OPEXCLILM43.corporate.adroot.infra.ftgroup>

Hello,

We have installed Clearwater nodes in our lab. We have 3 sprout nodes deployed in our environment, and the IMS traffic is load-balanced between the 3 nodes. We are interested  about the registration process in IMS Clearwater and how data session is distributed over the different sprout nodes (in memcached database). Is there a script or command line to access/read the data (registration and session context) on the different nodes?

Thank you for your support,

Best regards,

Gilles



_________________________________________________________________________________________________________________________

Ce message et ses pieces jointes peuvent contenir des informations confidentielles ou privilegiees et ne doivent donc
pas etre diffuses, exploites ou copies sans autorisation. Si vous avez recu ce message par erreur, veuillez le signaler
a l'expediteur et le detruire ainsi que les pieces jointes. Les messages electroniques etant susceptibles d'alteration,
Orange decline toute responsabilite si ce message a ete altere, deforme ou falsifie. Merci.

This message and its attachments may contain confidential or privileged information that may be protected by law;
they should not be distributed, used or copied without authorisation.
If you have received this email in error, please notify the sender and delete this message and its attachments.
As emails may be altered, Orange is not liable for messages that have been modified, changed or falsified.
Thank you.

-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.projectclearwater.org/pipermail/clearwater_lists.projectclearwater.org/attachments/20160831/ce8962f3/attachment.html>

From kosalayb at gmail.com  Wed Aug 31 04:56:41 2016
From: kosalayb at gmail.com (Kosala)
Date: Wed, 31 Aug 2016 09:56:41 +0100
Subject: [Project Clearwater] /etc/clearwater/shared_config
Message-ID: <CAGEe17Yj3D5TCooiR7PY1GT2tkh_DDV6kvPMiWw115HepsbPgA@mail.gmail.com>

I am just wondering, if I am right in defining shared_config file.
I installed clear water nodes in Orange Box.

Then I defined shared_config as:

home_domain= openstacklocal

sprout_hostname=IP of sprout node in orange box (OB)

hs_hostname=IP of homestead node in OB :8888

hs_provisioning_hostname= IP of homestead node in OB: 8889

ralf_hostname=IP of ralf node in OB:10888

xdms_hostname=IP of homer node in OB:7888

bono_servers = IP of Bono node in OB
stress_target = IP of bono server
base=2010000000
count=1000

Is this correct?

Many Thanks
Kosala
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.projectclearwater.org/pipermail/clearwater_lists.projectclearwater.org/attachments/20160831/17f40312/attachment.html>

From kosalayb at gmail.com  Wed Aug 31 10:03:44 2016
From: kosalayb at gmail.com (Kosala)
Date: Wed, 31 Aug 2016 15:03:44 +0100
Subject: [Project Clearwater] SIP node for stress testing
Message-ID: <CAGEe17Yq8rLJ_tvij_4hOPo4FEF=71Jt3XcgnfowE0mh0d2u5Q@mail.gmail.com>

Hi Team,

Can I use all-in-one image as a SIP node?


Firstly, I made changes to /etc/clearwater/local_config *and*
/etc/clearwater/shared_config as described in Manual stress runs (
http://clearwater.readthedocs.io/en/latest/Clearwater_stress_testing.html#manual-i-e-non-chef-stress-runs
).


Secondly, Run > sudo apt-get install clearwater-sip-stress


Thanks

Kosala
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.projectclearwater.org/pipermail/clearwater_lists.projectclearwater.org/attachments/20160831/4b03dbf8/attachment.html>

From richard.whitehouse at projectclearwater.org  Wed Aug 31 12:02:42 2016
From: richard.whitehouse at projectclearwater.org (Richard Whitehouse (projectclearwater.org))
Date: Wed, 31 Aug 2016 16:02:42 +0000
Subject: [Project Clearwater] Privacy header delimiter ','
In-Reply-To: <TU4PR84MB006479AC3FE48BDB64458344DCE80@TU4PR84MB0064.NAMPRD84.PROD.OUTLOOK.COM>
References: <TU4PR84MB00649C882ADC2BE90305E219DCE80@TU4PR84MB0064.NAMPRD84.PROD.OUTLOOK.COM>
	<BY2PR0201MB1816868615F0381697B2E4C2F0E80@BY2PR0201MB1816.namprd02.prod.outlook.com>
	<TU4PR84MB006479AC3FE48BDB64458344DCE80@TU4PR84MB0064.NAMPRD84.PROD.OUTLOOK.COM>
Message-ID: <BY2PR0201MB181601E041CBBF42A5AD53F3F0E30@BY2PR0201MB1816.namprd02.prod.outlook.com>

Aravind,

We don't provide hotfixes for Project Clearwater. The only workaround I can suggest is not using the MMTel AS - but if you are particularly interested in the MMTel AS function, obviously that might not be a workable solution.

However, a fix for this is now available in the latest code, and will be released shortly as part of the next release cut.

Thanks,

Richard

From: Shirabur, Aravind Ashok (CMS) [mailto:arvindas at hpe.com]
Sent: 22 August 2016 12:35
To: Richard Whitehouse <Richard.Whitehouse at metaswitch.com>; clearwater at lists.projectclearwater.org
Subject: RE: Privacy header delimiter ','

Thank you for the confirmation. It is indeed the MMtel AS scenario. Do we have workaround /hotfix to avoid this issue ?


Thanks
Aravind
From: Richard Whitehouse [mailto:Richard.Whitehouse at metaswitch.com]
Sent: Monday, August 22, 2016 4:30 PM
To: clearwater at lists.projectclearwater.org<mailto:clearwater at lists.projectclearwater.org>; Shirabur, Aravind Ashok (CMS) <arvindas at hpe.com<mailto:arvindas at hpe.com>>
Subject: RE: Privacy header delimiter ','

Aravind,

Thanks for your report - your analysis looks correct - I've raised Sprout Issue 1514 to cover correcting this - https://github.com/Metaswitch/sprout/issues/1514

Looking at the code, I believe that the options will only get stripped if the MMTel application server is being invoked, as that looks to be the only place we will fully parse and control the Privacy header options. If you don't need this function, then removing the MMTel application server might be a workaround for you. We don't normally use this MMTel application server in production environments. You should be able to prevent this being invoked by modifying the subscriber's configured initial filter criteria.

If you aren't running the MMTel Application Server, can you clarify the scenario in which you are seeing the Privacy options being modified by Clearwater?

Richard


From: Clearwater [mailto:clearwater-bounces at lists.projectclearwater.org] On Behalf Of Shirabur, Aravind Ashok (CMS)
Sent: 22 August 2016 08:09
To: Clearwater at lists.projectclearwater.org<mailto:Clearwater at lists.projectclearwater.org>
Subject: [Project Clearwater] Privacy header delimiter ','

Hi,

We are testing project clear water (clearwater-infrastructure  1.0-160518.173307) , we find that "," is used as delimiter for separating multiple values of the Privacy header (example: "Privacy: id, user, history"). As per RFC-3323 (https://www.ietf.org/rfc/rfc3323.txt) privacy header values must be separated by ";".

[cid:image001.jpg at 01D203A9.7C140990]

Impact of this multiple Privacy header like  "Privacy: id;user;history"; this has been removed by the Clearwater IMS network.

Can you please comment on if this observation is correct ?

Thanks
Aravind

-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.projectclearwater.org/pipermail/clearwater_lists.projectclearwater.org/attachments/20160831/24a3e3a5/attachment.html>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: image001.jpg
Type: image/jpeg
Size: 9466 bytes
Desc: image001.jpg
URL: <http://lists.projectclearwater.org/pipermail/clearwater_lists.projectclearwater.org/attachments/20160831/24a3e3a5/attachment.jpg>

From morrisyan123 at gmail.com  Wed Aug 31 12:05:20 2016
From: morrisyan123 at gmail.com (yan morris)
Date: Thu, 1 Sep 2016 00:05:20 +0800
Subject: [Project Clearwater] Is Bono a multi-thread program?
Message-ID: <CAM_v+eT6WPxEny2EiCPbw1-EjN=p6OwzoUuAzA9rKRS-fgwBeQ@mail.gmail.com>

Hi ,

I want to know , if Bono is a multi-thread program or not.

I see the source code of Bono , I look at the function "proxy_on_rx_request"

which process incoming request , but I don't see any code is creating a new
thread when request income .

Therefore ,  I want to know if Bono processes request using multi-thread ?

If it does , could you tell where I can find the codes which concerned
about?

(or It is implemented by PJSIP , please let me know , too)

Thank you very much

Morris
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.projectclearwater.org/pipermail/clearwater_lists.projectclearwater.org/attachments/20160901/ee2877c5/attachment.html>

From richard.whitehouse at projectclearwater.org  Wed Aug 31 12:16:30 2016
From: richard.whitehouse at projectclearwater.org (Richard Whitehouse (projectclearwater.org))
Date: Wed, 31 Aug 2016 16:16:30 +0000
Subject: [Project Clearwater] Is Bono a multi-thread program?
In-Reply-To: <CAM_v+eT6WPxEny2EiCPbw1-EjN=p6OwzoUuAzA9rKRS-fgwBeQ@mail.gmail.com>
References: <CAM_v+eT6WPxEny2EiCPbw1-EjN=p6OwzoUuAzA9rKRS-fgwBeQ@mail.gmail.com>
Message-ID: <BY2PR0201MB1816C068F7DA89FC69C28971F0E30@BY2PR0201MB1816.namprd02.prod.outlook.com>

Morris,

Yes, Bono is multi-threaded. It?s architected with a transport thread which handles incoming PJSIP requests and a number of worker threads, which SIP messages are dispatched onto.

The worker threads are created by thread_dispatcher. By default bono has one worker thread per CPU core.

The threads are created using PJSIP?s pj_thread functions.

Thanks,

Richard

From: Clearwater [mailto:clearwater-bounces at lists.projectclearwater.org] On Behalf Of yan morris
Sent: 31 August 2016 17:05
To: clearwater at lists.projectclearwater.org
Subject: [Project Clearwater] Is Bono a multi-thread program?

Hi ,

I want to know , if Bono is a multi-thread program or not.

I see the source code of Bono , I look at the function "proxy_on_rx_request"

which process incoming request , but I don't see any code is creating a new thread when request income .

Therefore ,  I want to know if Bono processes request using multi-thread ?

If it does , could you tell where I can find the codes which concerned about?

(or It is implemented by PJSIP , please let me know , too)

Thank you very much

Morris



-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.projectclearwater.org/pipermail/clearwater_lists.projectclearwater.org/attachments/20160831/a3dd2c3a/attachment.html>

From richard.whitehouse at projectclearwater.org  Wed Aug 31 12:56:31 2016
From: richard.whitehouse at projectclearwater.org (Richard Whitehouse (projectclearwater.org))
Date: Wed, 31 Aug 2016 16:56:31 +0000
Subject: [Project Clearwater] repo keys changed? packages unauthenticated
In-Reply-To: <1472591007.6400.12.camel@interoptechnologies.com>
References: <1472591007.6400.12.camel@interoptechnologies.com>
Message-ID: <BY2PR0201MB1816470D729A9099C81AA10AF0E30@BY2PR0201MB1816.namprd02.prod.outlook.com>

Trey,

The repo keys haven?t changed, however when the last release was cut it was incorrectly not signed, hence the warning you are seeing. We are looking into how this happened.

We?ve fixed the signing problem ? signing the binaries that were there, so this error you no longer be present ? you may need to run `sudo apt-get update` to pick up the signing information.


Thanks for letting us know,

Richard

From: Clearwater [mailto:clearwater-bounces at lists.projectclearwater.org] On Behalf Of Trey Ormsbee
Sent: 30 August 2016 22:03
To: clearwater at lists.projectclearwater.org
Subject: [Project Clearwater] repo keys changed? packages unauthenticated

Hello

Have the repo keys used to sign the packages in repo.cw-ngv.com changed?  I am unable to authenticate the latest build,  I keep archives of older builds and if I go back to a mirror i have from 2016-08-15 I am able to install but the latest version that I mirrored on 818 and the main repo will not install as they are not authenticated.

root at sprout03<mailto:root at sprout03>:~# DEBIAN_FRONTEND=noninteractive /usr/bin/apt-get install sprout --yes
Reading package lists... Done
Building dependency tree
Reading state information... Done
The following extra packages will be installed:
  astaire astaire-libs chronos clearwater-diags-monitor
  clearwater-infrastructure clearwater-log-cleanup clearwater-memcached
  clearwater-monit clearwater-snmp-handler-astaire clearwater-snmpd
  clearwater-socket-factory clearwater-tcp-scalability cpulimit dnsmasq
  dnsmasq-base gnutls-bin inotify-tools libboost-filesystem1.54.0
  libboost-program-options1.54.0 libboost-regex1.54.0 libboost-system1.54.0
  libboost-thread1.54.0 libc-ares-dev libevent-2.0-5 libevent-core-2.0-5
  libevent-pthreads-2.0-5 libicu52 libinotifytools0 libmnl0 libmysqlclient18
  libnetfilter-conntrack3 libopts25 libperl5.18 libpgm-5.1-0 libsnmp-base
  libsnmp30 libzmq3 memcached mysql-common ntp python-pkg-resources
  python-setuptools realpath snmp snmpd sprout-base sprout-bgcf sprout-icscf
  sprout-libs sprout-mmtel-as sprout-scscf
Suggested packages:
  astaire-dbg clearwater-auto-config clearwater-auto-upgrade
  clearwater-secure-connections exim4 postfix mail-transport-agent
  snmp-mibs-downloader libcache-memcached-perl libmemcached ntp-doc
  python-distribute python-distribute-doc sprout-dbg clearwater-logging
  clearwater-snmp-alarm-agent sprout-bgcf-dbg sprout-icscf-dbg
  sprout-mmtel-as-dbg sprout-scscf-dbg
The following NEW packages will be installed:
  astaire astaire-libs chronos clearwater-diags-monitor
  clearwater-infrastructure clearwater-log-cleanup clearwater-memcached
  clearwater-monit clearwater-snmp-handler-astaire clearwater-snmpd
  clearwater-socket-factory clearwater-tcp-scalability cpulimit dnsmasq
  dnsmasq-base gnutls-bin inotify-tools libboost-filesystem1.54.0
  libboost-program-options1.54.0 libboost-regex1.54.0 libboost-system1.54.0
  libboost-thread1.54.0 libc-ares-dev libevent-2.0-5 libevent-core-2.0-5
  libevent-pthreads-2.0-5 libicu52 libinotifytools0 libmnl0 libmysqlclient18
  libnetfilter-conntrack3 libopts25 libperl5.18 libpgm-5.1-0 libsnmp-base
  libsnmp30 libzmq3 memcached mysql-common ntp python-pkg-resources
  python-setuptools realpath snmp snmpd sprout sprout-base sprout-bgcf
  sprout-icscf sprout-libs sprout-mmtel-as sprout-scscf
0 upgraded, 52 newly installed, 0 to remove and 0 not upgraded.
Need to get 5,714 kB/15.9 MB of archives.
After this operation, 65.4 MB of additional disk space will be used.
WARNING: The following packages cannot be authenticated!
  libsnmp-base libsnmp30 clearwater-infrastructure clearwater-tcp-scalability
  clearwater-log-cleanup astaire-libs clearwater-monit astaire snmp snmpd
  clearwater-snmpd chronos clearwater-diags-monitor memcached
  clearwater-memcached clearwater-snmp-handler-astaire
  clearwater-socket-factory sprout-libs sprout-base sprout-scscf sprout-icscf
  sprout-bgcf sprout-mmtel-as sprout
E: There are problems and -y was used without --force-yes
root at sprout03<mailto:root at sprout03>:~# apt-key finger
/etc/apt/trusted.gpg
--------------------
pub   1024D/437D05B5 2004-09-12
      Key fingerprint = 6302 39CC 130E 1A7F D81A  27B1 4097 6EAF 437D 05B5
uid                  Ubuntu Archive Automatic Signing Key <ftpmaster at ubuntu.com<mailto:ftpmaster at ubuntu.com>>
sub   2048g/79164387 2004-09-12

pub   1024D/FBB75451 2004-12-30
      Key fingerprint = C598 6B4F 1257 FFA8 6632  CBA7 4618 1433 FBB7 5451
uid                  Ubuntu CD Image Automatic Signing Key <cdimage at ubuntu.com<mailto:cdimage at ubuntu.com>>

pub   4096R/C0B21F32 2012-05-11
      Key fingerprint = 790B C727 7767 219C 42C8  6F93 3B4F E6AC C0B2 1F32
uid                  Ubuntu Archive Automatic Signing Key (2012) <ftpmaster at ubuntu.com<mailto:ftpmaster at ubuntu.com>>

pub   4096R/EFE21092 2012-05-11
      Key fingerprint = 8439 38DF 228D 22F7 B374  2BC0 D94A A3F0 EFE2 1092
uid                  Ubuntu CD Image Automatic Signing Key (2012) <cdimage at ubuntu.com<mailto:cdimage at ubuntu.com>>

pub   4096R/22B97904 2013-04-30
      Key fingerprint = 9213 4604 DE32 7DF7 FEB7  2026 111D BE47 22B9 7904
uid                  Project Clearwater Maintainers <maintainers at projectclearwater.org<mailto:maintainers at projectclearwater.org>>
sub   4096R/46EC5B7F 2013-04-30

root at sprout03<mailto:root at sprout03>:~#


Everything looks like it is supposed to,  so not sure what is going on here.

Thanks,
Trey
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.projectclearwater.org/pipermail/clearwater_lists.projectclearwater.org/attachments/20160831/644872b2/attachment.html>

From trey.ormsbee at interoptechnologies.com  Wed Aug 31 13:16:45 2016
From: trey.ormsbee at interoptechnologies.com (Trey Ormsbee)
Date: Wed, 31 Aug 2016 12:16:45 -0500
Subject: [Project Clearwater] repo keys changed? packages unauthenticated
In-Reply-To: <BY2PR0201MB1816470D729A9099C81AA10AF0E30@BY2PR0201MB1816.namprd02.prod.outlook.com>
References: <1472591007.6400.12.camel@interoptechnologies.com>
	<BY2PR0201MB1816470D729A9099C81AA10AF0E30@BY2PR0201MB1816.namprd02.prod.outlook.com>
Message-ID: <1472663805.6400.13.camel@interoptechnologies.com>

Richard,

Thank you for looking into this and correcting it,  it is much
appreciated.

Thanks,
Trey

-----Original Message-----From: Richard Whitehouse
(projectclearwater.org) <richard.whitehouse at projectclearwater.org>
To: clearwater at lists.projectclearwater.org
<clearwater at lists.projectclearwater.org>, "Ormsbee, Trey"
<Trey.Ormsbee at interoptechnologies.com>
Subject: RE: [Project Clearwater] repo keys changed? packages
unauthenticated
Date: Wed, 31 Aug 2016 12:56:31 -0400

Trey,

 

The repo keys haven?t changed, however when the last release was cut it
was incorrectly not signed, hence the warning you are seeing. We are
looking into how this happened.

 

We?ve fixed the signing problem ? signing the binaries that were there,
so this error you no longer be present ? you may need to run `sudo
apt-get update` to pick up the signing information.

 

 

Thanks for letting us know,

 

Richard

 

From: Clearwater [mailto:clearwater-bounces at lists.projectclearwater.org]
On Behalf Of Trey Ormsbee
Sent: 30 August 2016 22:03
To: clearwater at lists.projectclearwater.org
Subject: [Project Clearwater] repo keys changed? packages
unauthenticated


 

Hello

Have the repo keys used to sign the packages in repo.cw-ngv.com changed?
I am unable to authenticate the latest build,  I keep archives of older
builds and if I go back to a mirror i have from 2016-08-15 I am able to
install but the latest version that I mirrored on 818 and the main repo
will not install as they are not authenticated.

root at sprout03:~# DEBIAN_FRONTEND=noninteractive /usr/bin/apt-get install
sprout --yes
Reading package lists... Done
Building dependency tree       
Reading state information... Done
The following extra packages will be installed:
  astaire astaire-libs chronos clearwater-diags-monitor
  clearwater-infrastructure clearwater-log-cleanup clearwater-memcached
  clearwater-monit clearwater-snmp-handler-astaire clearwater-snmpd
  clearwater-socket-factory clearwater-tcp-scalability cpulimit dnsmasq
  dnsmasq-base gnutls-bin inotify-tools libboost-filesystem1.54.0
  libboost-program-options1.54.0 libboost-regex1.54.0
libboost-system1.54.0
  libboost-thread1.54.0 libc-ares-dev libevent-2.0-5 libevent-core-2.0-5
  libevent-pthreads-2.0-5 libicu52 libinotifytools0 libmnl0
libmysqlclient18
  libnetfilter-conntrack3 libopts25 libperl5.18 libpgm-5.1-0
libsnmp-base
  libsnmp30 libzmq3 memcached mysql-common ntp python-pkg-resources
  python-setuptools realpath snmp snmpd sprout-base sprout-bgcf
sprout-icscf
  sprout-libs sprout-mmtel-as sprout-scscf
Suggested packages:
  astaire-dbg clearwater-auto-config clearwater-auto-upgrade
  clearwater-secure-connections exim4 postfix mail-transport-agent
  snmp-mibs-downloader libcache-memcached-perl libmemcached ntp-doc
  python-distribute python-distribute-doc sprout-dbg clearwater-logging
  clearwater-snmp-alarm-agent sprout-bgcf-dbg sprout-icscf-dbg
  sprout-mmtel-as-dbg sprout-scscf-dbg
The following NEW packages will be installed:
  astaire astaire-libs chronos clearwater-diags-monitor
  clearwater-infrastructure clearwater-log-cleanup clearwater-memcached
  clearwater-monit clearwater-snmp-handler-astaire clearwater-snmpd
  clearwater-socket-factory clearwater-tcp-scalability cpulimit dnsmasq
  dnsmasq-base gnutls-bin inotify-tools libboost-filesystem1.54.0
  libboost-program-options1.54.0 libboost-regex1.54.0
libboost-system1.54.0
  libboost-thread1.54.0 libc-ares-dev libevent-2.0-5 libevent-core-2.0-5
  libevent-pthreads-2.0-5 libicu52 libinotifytools0 libmnl0
libmysqlclient18
  libnetfilter-conntrack3 libopts25 libperl5.18 libpgm-5.1-0
libsnmp-base
  libsnmp30 libzmq3 memcached mysql-common ntp python-pkg-resources
  python-setuptools realpath snmp snmpd sprout sprout-base sprout-bgcf
  sprout-icscf sprout-libs sprout-mmtel-as sprout-scscf
0 upgraded, 52 newly installed, 0 to remove and 0 not upgraded.
Need to get 5,714 kB/15.9 MB of archives.
After this operation, 65.4 MB of additional disk space will be used.
WARNING: The following packages cannot be authenticated!
  libsnmp-base libsnmp30 clearwater-infrastructure
clearwater-tcp-scalability
  clearwater-log-cleanup astaire-libs clearwater-monit astaire snmp
snmpd
  clearwater-snmpd chronos clearwater-diags-monitor memcached
  clearwater-memcached clearwater-snmp-handler-astaire
  clearwater-socket-factory sprout-libs sprout-base sprout-scscf
sprout-icscf
  sprout-bgcf sprout-mmtel-as sprout
E: There are problems and -y was used without --force-yes
root at sprout03:~# apt-key finger
/etc/apt/trusted.gpg
--------------------
pub   1024D/437D05B5 2004-09-12
      Key fingerprint = 6302 39CC 130E 1A7F D81A  27B1 4097 6EAF 437D
05B5
uid                  Ubuntu Archive Automatic Signing Key
<ftpmaster at ubuntu.com>
sub   2048g/79164387 2004-09-12

pub   1024D/FBB75451 2004-12-30
      Key fingerprint = C598 6B4F 1257 FFA8 6632  CBA7 4618 1433 FBB7
5451
uid                  Ubuntu CD Image Automatic Signing Key
<cdimage at ubuntu.com>

pub   4096R/C0B21F32 2012-05-11
      Key fingerprint = 790B C727 7767 219C 42C8  6F93 3B4F E6AC C0B2
1F32
uid                  Ubuntu Archive Automatic Signing Key (2012)
<ftpmaster at ubuntu.com>

pub   4096R/EFE21092 2012-05-11
      Key fingerprint = 8439 38DF 228D 22F7 B374  2BC0 D94A A3F0 EFE2
1092
uid                  Ubuntu CD Image Automatic Signing Key (2012)
<cdimage at ubuntu.com>

pub   4096R/22B97904 2013-04-30
      Key fingerprint = 9213 4604 DE32 7DF7 FEB7  2026 111D BE47 22B9
7904
uid                  Project Clearwater Maintainers
<maintainers at projectclearwater.org>
sub   4096R/46EC5B7F 2013-04-30

root at sprout03:~# 


Everything looks like it is supposed to,  so not sure what is going on
here.

Thanks,
Trey 



-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.projectclearwater.org/pipermail/clearwater_lists.projectclearwater.org/attachments/20160831/55149c85/attachment.html>

